import{r as e,a as t,R as n,b as i}from"./vendor-DD48japz.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var r={exports:{}},a={},o=e,s=Symbol.for("react.element"),l=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,d=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function h(e,t,n){var i,r={},a=null,o=null;for(i in void 0!==n&&(a=""+n),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(o=t.ref),t)c.call(t,i)&&!u.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:s,type:e,key:a,ref:o,props:r,_owner:d.current}}a.Fragment=l,a.jsx=h,a.jsxs=h,r.exports=a;var p,m,g,f=r.exports,x=t;
/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},y.apply(this,arguments)}p=x.createRoot,x.hydrateRoot,(g=m||(m={})).Pop="POP",g.Push="PUSH",g.Replace="REPLACE";const b="popstate";function v(e){return void 0===e&&(e={}),function(e,t,n,i){void 0===i&&(i={});let{window:r=document.defaultView,v5Compat:a=!1}=i,o=r.history,s=m.Pop,l=null,c=d();null==c&&(c=0,o.replaceState(y({},o.state,{idx:c}),""));function d(){return(o.state||{idx:null}).idx}function u(){s=m.Pop;let e=d(),t=null==e?null:e-c;c=e,l&&l({action:s,location:f.location,delta:t})}function h(e,t){s=m.Push;let n=S(f.location,e,t);c=d()+1;let i=j(n,c),u=f.createHref(n);try{o.pushState(i,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;r.location.assign(u)}a&&l&&l({action:s,location:f.location,delta:1})}function p(e,t){s=m.Replace;let n=S(f.location,e,t);c=d();let i=j(n,c),r=f.createHref(n);o.replaceState(i,"",r),a&&l&&l({action:s,location:f.location,delta:0})}function g(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"==typeof e?e:T(e);return n=n.replace(/ $/,"%20"),k(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}let f={get action(){return s},get location(){return e(r,o)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(b,u),l=e,()=>{r.removeEventListener(b,u),l=null}},createHref:e=>t(r,e),createURL:g,encodeLocation(e){let t=g(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:h,replace:p,go:e=>o.go(e)};return f}(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return S("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:T(t)},0,e)}function k(e,t){if(!1===e||null==e)throw new Error(t)}function w(e,t){if(!e)try{throw new Error(t)}catch(n){}}function j(e,t){return{usr:e.state,key:e.key,idx:t}}function S(e,t,n,i){return void 0===n&&(n=null),y({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?C(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function T(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function C(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}var I,B;function R(e,t,n){return void 0===n&&(n="/"),function(e,t,n){let i="string"==typeof t?C(t):t,r=U(i.pathname||"/",n);if(null==r)return null;let a=A(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let o=null;for(let s=0;null==o&&s<a.length;++s){let e=q(r);o=L(a[s],e)}return o}(e,t,n)}function A(e,t,n,i){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===i&&(i="");let r=(e,r,a)=>{let o={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};o.relativePath.startsWith("/")&&(k(o.relativePath.startsWith(i),'Absolute route path "'+o.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(i.length));let s=K([i,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(k(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),A(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:M(s,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let i of F(e.path))r(e,t,i);else r(e,t)}),t}function F(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===i.length)return r?[a,""]:[a];let o=F(i.join("/")),s=[];return s.push(...o.map(e=>""===e?a:[a,e].join("/"))),r&&s.push(...o),s.map(t=>e.startsWith("/")&&""===t?"/":t)}(B=I||(I={})).data="data",B.deferred="deferred",B.redirect="redirect",B.error="error";const z=/^:[\w-]+$/,E=3,_=2,N=1,P=10,D=-2,W=e=>"*"===e;function M(e,t){let n=e.split("/"),i=n.length;return n.some(W)&&(i+=D),t&&(i+=_),n.filter(e=>!W(e)).reduce((e,t)=>e+(z.test(t)?E:""===t?N:P),i)}function L(e,t,n){let{routesMeta:i}=e,r={},a="/",o=[];for(let s=0;s<i.length;++s){let e=i[s],n=s===i.length-1,l="/"===a?t:t.slice(a.length)||"/",c=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:n},l),d=e.route;if(!c)return null;Object.assign(r,c.params),o.push({params:r,pathname:K([a,c.pathname]),pathnameBase:$(K([a,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(a=K([a,c.pathnameBase]))}return o}function O(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);w("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let a=new RegExp(r,t?void 0:"i");return[a,i]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let a=r[0],o=a.replace(/(.)\/+$/,"$1"),s=r.slice(1);return{params:i.reduce((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=s[n]||"";o=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[i]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:a,pathnameBase:o,pattern:e}}function q(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return w(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function U(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function H(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function V(e,t,n,i){let r;void 0===i&&(i=!1),"string"==typeof e?r=C(e):(r=y({},e),k(!r.pathname||!r.pathname.includes("?"),H("?","pathname","search",r)),k(!r.pathname||!r.pathname.includes("#"),H("#","pathname","hash",r)),k(!r.search||!r.search.includes("#"),H("#","search","hash",r)));let a,o=""===e||""===r.pathname,s=o?"/":r.pathname;if(null==s)a=n;else{let e=t.length-1;if(!i&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}a=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:i="",hash:r=""}="string"==typeof e?C(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:G(i),hash:Q(r)}}(r,a),c=s&&"/"!==s&&s.endsWith("/"),d=(o||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}const K=e=>e.join("/").replace(/\/\/+/g,"/"),$=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),G=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";const Y=["post","put","patch","delete"];new Set(Y);const J=["get",...Y];
/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */
function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},X.apply(this,arguments)}new Set(J);const Z=e.createContext(null),ee=e.createContext(null),te=e.createContext(null),ne=e.createContext(null),ie=e.createContext({outlet:null,matches:[],isDataRoute:!1}),re=e.createContext(null);function ae(){return null!=e.useContext(ne)}function oe(){return ae()||k(!1),e.useContext(ne).location}function se(t){e.useContext(te).static||e.useLayoutEffect(t)}function le(){let{isDataRoute:t}=e.useContext(ie);return t?function(){let{router:t}=function(){let t=e.useContext(Z);return t||k(!1),t}(me.UseNavigateStable),n=fe(ge.UseNavigateStable),i=e.useRef(!1);return se(()=>{i.current=!0}),e.useCallback(function(e,r){void 0===r&&(r={}),i.current&&("number"==typeof e?t.navigate(e):t.navigate(e,X({fromRouteId:n},r)))},[t,n])}():function(){ae()||k(!1);let t=e.useContext(Z),{basename:n,future:i,navigator:r}=e.useContext(te),{matches:a}=e.useContext(ie),{pathname:o}=oe(),s=JSON.stringify(function(e,t){let n=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}(a,i.v7_relativeSplatPath)),l=e.useRef(!1);return se(()=>{l.current=!0}),e.useCallback(function(e,i){if(void 0===i&&(i={}),!l.current)return;if("number"==typeof e)return void r.go(e);let a=V(e,JSON.parse(s),o,"path"===i.relative);null==t&&"/"!==n&&(a.pathname="/"===a.pathname?n:K([n,a.pathname])),(i.replace?r.replace:r.push)(a,i.state,i)},[n,r,s,o,t])}()}function ce(t,n){return function(t,n,i,r){ae()||k(!1);let{navigator:a}=e.useContext(te),{matches:o}=e.useContext(ie),s=o[o.length-1],l=s?s.params:{};!s||s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let d,u=oe();if(n){var h;let e="string"==typeof n?C(n):n;"/"===c||(null==(h=e.pathname)?void 0:h.startsWith(c))||k(!1),d=e}else d=u;let p=d.pathname||"/",g=p;if("/"!==c){let e=c.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let f=R(t,{pathname:g}),x=function(t,n,i,r){var a;void 0===n&&(n=[]);void 0===i&&(i=null);void 0===r&&(r=null);if(null==t){var o;if(!i)return null;if(i.errors)t=i.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===n.length&&!i.initialized&&i.matches.length>0))return null;t=i.matches}}let s=t,l=null==(a=i)?void 0:a.errors;if(null!=l){let e=s.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||k(!1),s=s.slice(0,Math.min(s.length,e+1))}let c=!1,d=-1;if(i&&r&&r.v7_partialHydration)for(let e=0;e<s.length;e++){let t=s[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(d=e),t.route.id){let{loaderData:e,errors:n}=i,r=t.route.loader&&void 0===e[t.route.id]&&(!n||void 0===n[t.route.id]);if(t.route.lazy||r){c=!0,s=d>=0?s.slice(0,d+1):[s[0]];break}}}return s.reduceRight((t,r,a)=>{let o,u=!1,h=null,p=null;var m;i&&(o=l&&r.route.id?l[r.route.id]:void 0,h=r.route.errorElement||ue,c&&(d<0&&0===a?(xe[m="route-fallback"]||(xe[m]=!0),u=!0,p=null):d===a&&(u=!0,p=r.route.hydrateFallbackElement||null)));let g=n.concat(s.slice(0,a+1)),f=()=>{let n;return n=o?h:u?p:r.route.Component?e.createElement(r.route.Component,null):r.route.element?r.route.element:t,e.createElement(pe,{match:r,routeContext:{outlet:t,matches:g,isDataRoute:null!=i},children:n})};return i&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?e.createElement(he,{location:i.location,revalidation:i.revalidation,component:h,error:o,children:f(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):f()},null)}(f&&f.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:K([c,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:K([c,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,i,r);if(n&&x)return e.createElement(ne.Provider,{value:{location:X({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:m.Pop}},x);return x}(t,n)}function de(){let t=function(){var t;let n=e.useContext(re),i=function(){let t=e.useContext(ee);return t||k(!1),t}(),r=fe();if(void 0!==n)return n;return null==(t=i.errors)?void 0:t[r]}(),n=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),i=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),i?e.createElement("pre",{style:r},i):null,null)}const ue=e.createElement(de,null);class he extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){}render(){return void 0!==this.state.error?e.createElement(ie.Provider,{value:this.props.routeContext},e.createElement(re.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pe(t){let{routeContext:n,match:i,children:r}=t,a=e.useContext(Z);return a&&a.static&&a.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=i.route.id),e.createElement(ie.Provider,{value:n},r)}var me=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(me||{}),ge=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ge||{});function fe(t){let n=function(){let t=e.useContext(ie);return t||k(!1),t}(),i=n.matches[n.matches.length-1];return i.route.id||k(!1),i.route.id}const xe={};function ye(e){k(!1)}function be(t){let{basename:n="/",children:i=null,location:r,navigationType:a=m.Pop,navigator:o,static:s=!1,future:l}=t;ae()&&k(!1);let c=n.replace(/^\/*/,"/"),d=e.useMemo(()=>({basename:c,navigator:o,static:s,future:X({v7_relativeSplatPath:!1},l)}),[c,l,o,s]);"string"==typeof r&&(r=C(r));let{pathname:u="/",search:h="",hash:p="",state:g=null,key:f="default"}=r,x=e.useMemo(()=>{let e=U(u,c);return null==e?null:{location:{pathname:e,search:h,hash:p,state:g,key:f},navigationType:a}},[c,u,h,p,g,f,a]);return null==x?null:e.createElement(te.Provider,{value:d},e.createElement(ne.Provider,{children:i,value:x}))}function ve(e){let{children:t,location:n}=e;return ce(ke(t),n)}function ke(t,n){void 0===n&&(n=[]);let i=[];return e.Children.forEach(t,(t,r)=>{if(!e.isValidElement(t))return;let a=[...n,r];if(t.type===e.Fragment)return void i.push.apply(i,ke(t.props.children,a));t.type!==ye&&k(!1),t.props.index&&t.props.children&&k(!1);let o={id:t.props.id||a.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(o.children=ke(t.props.children,a)),i.push(o)}),i}
/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function we(e){return void 0===e&&(e=""),new URLSearchParams("string"==typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(e=>[n,e]):[[n,i]])},[]))}new Promise(()=>{});try{window.__reactRouterVersion="6"}catch(RB){}const je=n.startTransition;function Se(t){let{basename:n,children:i,future:r,window:a}=t,o=e.useRef();null==o.current&&(o.current=v({window:a,v5Compat:!0}));let s=o.current,[l,c]=e.useState({action:s.action,location:s.location}),{v7_startTransition:d}=r||{},u=e.useCallback(e=>{d&&je?je(()=>c(e)):c(e)},[c,d]);return e.useLayoutEffect(()=>s.listen(u),[s,u]),e.useEffect(()=>{return null==(e=r)||e.v7_startTransition,void(null==e||e.v7_relativeSplatPath);var e},[r]),e.createElement(be,{basename:n,children:i,location:l.location,navigationType:l.action,navigator:s,future:r})}var Te,Ce,Ie,Be;function Re(t){let n=e.useRef(we(t)),i=e.useRef(!1),r=oe(),a=e.useMemo(()=>function(e,t){let n=we(e);return t&&t.forEach((e,i)=>{n.has(i)||t.getAll(i).forEach(e=>{n.append(i,e)})}),n}(r.search,i.current?null:n.current),[r.search]),o=le(),s=e.useCallback((e,t)=>{const n=we("function"==typeof e?e(a):e);i.current=!0,o("?"+n,t)},[o,a]);return[a,s]}(Ce=Te||(Te={})).UseScrollRestoration="useScrollRestoration",Ce.UseSubmit="useSubmit",Ce.UseSubmitFetcher="useSubmitFetcher",Ce.UseFetcher="useFetcher",Ce.useViewTransitionState="useViewTransitionState",(Be=Ie||(Ie={})).UseFetcher="useFetcher",Be.UseFetchers="useFetchers",Be.UseScrollRestoration="useScrollRestoration";const Ae=()=>{const[t,n]=e.useState(!0),[i,r]=e.useState(0),[a,o]=e.useState(!1),[s,l]=e.useState(!1),c=le();return e.useEffect(()=>{(async()=>{r(1),o(!0),l(!0),await new Promise(e=>setTimeout(e,2e3)),await new Promise(e=>setTimeout(e,500)),r(0),await new Promise(e=>setTimeout(e,400)),c("/home")})()},[c]),f.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"radial-gradient(ellipse 80% 60% at 50% 50%, #fff 0%, #e3eafc 70%, #b3c6f7 100%)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,opacity:t?1:0,transition:"opacity 0.5s ease-in-out",overflow:"hidden"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:i,transition:"opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:[f.jsx("div",{style:{position:"absolute",width:320,height:220,borderRadius:"50% / 40%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1,pointerEvents:"none",animation:a?"halo-rotate 2.5s linear forwards":"none",opacity:.85,background:"conic-gradient(from 0deg, #fff 0deg, #ffd700 60deg, #b3c6f7 180deg, #fff 300deg, #fff 360deg)",filter:"blur(2px)"}}),f.jsx("div",{style:{position:"absolute",width:260,height:260,borderRadius:"50%",background:"radial-gradient(circle, #fff 0%, rgba(255,255,255,0.7) 50%, transparent 80%)",zIndex:2,top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}}),f.jsx("img",{src:"/ctx-logo.png",alt:"CTX Logo",style:{width:"200px",height:"200px",filter:"drop-shadow(0 8px 32px rgba(40, 40, 40, 0.35)) drop-shadow(0 2px 8px #fff)",zIndex:3,animation:s?"logo-scale-rotate 2.5s cubic-bezier(0.4,0,0.2,1) forwards":"none",transformOrigin:"50% 50%",transform:s?void 0:"scale(1) rotate(0deg)",opacity:s?void 0:1}}),f.jsx("div",{style:{marginTop:"20px",color:"#232946",fontSize:"24px",fontWeight:"bold",textAlign:"center",textShadow:"0 2px 8px rgba(255,255,255,0.5)",zIndex:3},children:"Restarter™"}),f.jsx("div",{style:{marginTop:"8px",color:"#ffd700",fontSize:"16px",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",zIndex:3},children:"重啟人生的平台"})]}),f.jsx("style",{children:"\n        @keyframes halo-rotate {\n          0% { transform: translate(-50%, -50%) rotate(0deg); }\n          100% { transform: translate(-50%, -50%) rotate(360deg); }\n        }\n        @keyframes logo-scale-rotate {\n          0% { transform: scale(0.1) rotate(-180deg); opacity: 0.2; }\n          20% { opacity: 1; }\n          100% { transform: scale(1) rotate(0deg); opacity: 1; }\n        }\n      "})]})};var Fe={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ze=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},Ee={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<e.length;r+=3){const t=e[r],a=r+1<e.length,o=a?e[r+1]:0,s=r+2<e.length,l=s?e[r+2]:0,c=t>>2,d=(3&t)<<4|o>>4;let u=(15&o)<<2|l>>6,h=63&l;s||(h=64,a||(u=64)),i.push(n[c],n[d],n[u],n[h])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ze(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const a=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&a)}else if(r>239&&r<365){const a=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(a>>10)),t[i++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&a)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<e.length;){const t=n[e.charAt(r++)],a=r<e.length?n[e.charAt(r)]:0;++r;const o=r<e.length?n[e.charAt(r)]:64;++r;const s=r<e.length?n[e.charAt(r)]:64;if(++r,null==t||null==a||null==o||null==s)throw new _e;const l=t<<2|a>>4;if(i.push(l),64!==o){const e=a<<4&240|o>>2;if(i.push(e),64!==s){const e=o<<6&192|s;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class _e extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ne=function(e){return function(e){const t=ze(e);return Ee.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Pe=function(e){try{return Ee.decodeString(e,!0)}catch(RB){}return null};
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function De(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const We=()=>{try{return De().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process)return;const e=Fe.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(RB){return}const t=e&&Pe(e[1]);return t&&JSON.parse(t)})()}catch(RB){return}},Me=e=>{var t,n;return null===(n=null===(t=We())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Le=e=>{const t=Me(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},Oe=()=>{var e;return null===(e=We())||void 0===e?void 0:e.config},qe=e=>{var t;return null===(t=We())||void 0===t?void 0:t[`_${e}`]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ue{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}
/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function He(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function Ve(e){return(await fetch(e,{credentials:"include"})).ok}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ne(JSON.stringify({alg:"none",type:"JWT"})),Ne(JSON.stringify(a)),""].join(".")}const $e={};let Ge=!1;function Qe(e,t){if("undefined"==typeof window||"undefined"==typeof document||!He(window.location.host)||$e[e]===t||$e[e]||Ge)return;function n(e){return`__firebase__banner__${e}`}$e[e]=t;const i="__firebase__banner",r=function(){const e={prod:[],emulator:[]};for(const t of Object.keys($e))$e[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function a(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{Ge=!0,function(){const e=document.getElementById(i);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(i),t=n("text"),o=document.getElementById(t)||document.createElement("span"),s=n("learnmore"),l=document.getElementById(s)||document.createElement("a"),c=n("preprendIcon"),d=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,s);const n=a();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(d,c),t.append(d,o,l,n),document.body.appendChild(t)}r?(o.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Je(){var e;const t=null===(e=We())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(RB){return!1}}function Xe(){return!Je()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ze(){return!Je()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function et(){try{return"object"==typeof indexedDB}catch(RB){return!1}}class tt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,tt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nt.prototype.create)}}class nt{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],a=r?function(e,t){return e.replace(it,(e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`})}(r,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new tt(i,o,n)}}const it=/\{\$([^}]+)}/g;function rt(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],a=t[r];if(at(n)&&at(a)){if(!rt(n,a))return!1}else if(n!==a)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function at(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function st(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}}),t}function lt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ct{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=dt),void 0===i.error&&(i.error=dt),void 0===i.complete&&(i.complete=dt);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(RB){}}),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(RB){"undefined"!=typeof console&&console.error}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dt(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(e){return e&&e._delegate?e._delegate:e}class ht{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pt="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Ue;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(RB){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(RB){if(i)return null;throw RB}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:pt})}catch(RB){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(RB){}}}}clearInstance(e=pt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=pt){return this.instances.has(e)}getOptions(e=pt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&a.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&e(a,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(i){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===pt?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(r){}var i;return n||null}normalizeInstanceIdentifier(e=pt){return this.component?this.component.multipleInstances?e:pt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class gt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new mt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,xt;(xt=ft||(ft={}))[xt.DEBUG=0]="DEBUG",xt[xt.VERBOSE=1]="VERBOSE",xt[xt.INFO=2]="INFO",xt[xt.WARN=3]="WARN",xt[xt.ERROR=4]="ERROR",xt[xt.SILENT=5]="SILENT";const yt={debug:ft.DEBUG,verbose:ft.VERBOSE,info:ft.INFO,warn:ft.WARN,error:ft.ERROR,silent:ft.SILENT},bt=ft.INFO,vt={[ft.DEBUG]:"log",[ft.VERBOSE]:"log",[ft.INFO]:"info",[ft.WARN]:"warn",[ft.ERROR]:"error"},kt=(e,t,...n)=>{if(t<e.logLevel)return;(new Date).toISOString();if(!vt[t])throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class wt{constructor(e){this.name=e,this._logLevel=bt,this._logHandler=kt,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ft))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?yt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ft.DEBUG,...e),this._logHandler(this,ft.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ft.VERBOSE,...e),this._logHandler(this,ft.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ft.INFO,...e),this._logHandler(this,ft.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ft.WARN,...e),this._logHandler(this,ft.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ft.ERROR,...e),this._logHandler(this,ft.ERROR,...e)}}let jt,St;const Tt=new WeakMap,Ct=new WeakMap,It=new WeakMap,Bt=new WeakMap,Rt=new WeakMap;let At={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ct.get(e);if("objectStoreNames"===t)return e.objectStoreNames||It.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Et(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Ft(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(St||(St=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(_t(this),t),Et(Tt.get(this))}:function(...t){return Et(e.apply(_t(this),t))}:function(t,...n){const i=e.call(_t(this),t,...n);return It.set(i,t.sort?t.sort():[t]),Et(i)}}function zt(e){return"function"==typeof e?Ft(e):(e instanceof IDBTransaction&&function(e){if(Ct.has(e))return;const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),i()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)});Ct.set(e,t)}(e),t=e,(jt||(jt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,At):e);var t}function Et(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(Et(e.result)),i()},a=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",a)});return t.then(t=>{t instanceof IDBCursor&&Tt.set(t,e)}).catch(()=>{}),Rt.set(t,e),t}(e);if(Bt.has(e))return Bt.get(e);const t=zt(e);return t!==e&&(Bt.set(e,t),Rt.set(t,e)),t}const _t=e=>Rt.get(e);const Nt=["get","getKey","getAll","getAllKeys","count"],Pt=["put","add","delete","clear"],Dt=new Map;function Wt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Dt.get(t))return Dt.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=Pt.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Nt.includes(n))return;const a=async function(e,...t){const a=this.transaction(e,r?"readwrite":"readonly");let o=a.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&a.done]))[0]};return Dt.set(t,a),a}At=(e=>({...e,get:(t,n,i)=>Wt(t,n)||e.get(t,n,i),has:(t,n)=>!!Wt(t,n)||e.has(t,n)}))(At);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Mt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const Lt="@firebase/app",Ot="0.13.2",qt=new wt("@firebase/app"),Ut="@firebase/app-compat",Ht="@firebase/analytics-compat",Vt="@firebase/analytics",Kt="@firebase/app-check-compat",$t="@firebase/app-check",Gt="@firebase/auth",Qt="@firebase/auth-compat",Yt="@firebase/database",Jt="@firebase/data-connect",Xt="@firebase/database-compat",Zt="@firebase/functions",en="@firebase/functions-compat",tn="@firebase/installations",nn="@firebase/installations-compat",rn="@firebase/messaging",an="@firebase/messaging-compat",on="@firebase/performance",sn="@firebase/performance-compat",ln="@firebase/remote-config",cn="@firebase/remote-config-compat",dn="@firebase/storage",un="@firebase/storage-compat",hn="@firebase/firestore",pn="@firebase/ai",mn="@firebase/firestore-compat",gn="firebase",fn="[DEFAULT]",xn={[Lt]:"fire-core",[Ut]:"fire-core-compat",[Vt]:"fire-analytics",[Ht]:"fire-analytics-compat",[$t]:"fire-app-check",[Kt]:"fire-app-check-compat",[Gt]:"fire-auth",[Qt]:"fire-auth-compat",[Yt]:"fire-rtdb",[Jt]:"fire-data-connect",[Xt]:"fire-rtdb-compat",[Zt]:"fire-fn",[en]:"fire-fn-compat",[tn]:"fire-iid",[nn]:"fire-iid-compat",[rn]:"fire-fcm",[an]:"fire-fcm-compat",[on]:"fire-perf",[sn]:"fire-perf-compat",[ln]:"fire-rc",[cn]:"fire-rc-compat",[dn]:"fire-gcs",[un]:"fire-gcs-compat",[hn]:"fire-fst",[mn]:"fire-fst-compat",[pn]:"fire-vertex","fire-js":"fire-js",[gn]:"fire-js-all"},yn=new Map,bn=new Map,vn=new Map;function kn(e,t){try{e.container.addComponent(t)}catch(RB){qt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,RB)}}function wn(e){const t=e.name;if(vn.has(t))return qt.debug(`There were multiple attempts to register component ${t}.`),!1;vn.set(t,e);for(const n of yn.values())kn(n,e);for(const n of bn.values())kn(n,e);return!0}function jn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Sn(e){return null!=e&&void 0!==e.settings}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn=new nt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Cn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ht("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tn.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="11.10.0";function Bn(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const i=Object.assign({name:fn,automaticDataCollectionEnabled:!0},t),r=i.name;if("string"!=typeof r||!r)throw Tn.create("bad-app-name",{appName:String(r)});if(n||(n=Oe()),!n)throw Tn.create("no-options");const a=yn.get(r);if(a){if(rt(n,a.options)&&rt(i,a.config))return a;throw Tn.create("duplicate-app",{appName:r})}const o=new gt(r);for(const l of vn.values())o.addComponent(l);const s=new Cn(n,i,o);return yn.set(r,s),s}function Rn(e=fn){const t=yn.get(e);if(!t&&e===fn&&Oe())return Bn();if(!t)throw Tn.create("no-app",{appName:e});return t}function An(e,t,n){var i;let r=null!==(i=xn[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const a=r.match(/\s|\//),o=t.match(/\s|\//);if(a||o){const e=[`Unable to register library "${r}" with version "${t}":`];return a&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void qt.warn(e.join(" "))}wn(new ht(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn="firebase-heartbeat-store";let zn=null;function En(){return zn||(zn=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:a}={}){const o=indexedDB.open(e,t),s=Et(o);return i&&o.addEventListener("upgradeneeded",e=>{i(Et(o.result),e.oldVersion,e.newVersion,Et(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{a&&e.addEventListener("close",()=>a()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Fn)}catch(RB){}}}).catch(e=>{throw Tn.create("idb-open",{originalErrorMessage:e.message})})),zn}async function _n(e,t){try{const n=(await En()).transaction(Fn,"readwrite"),i=n.objectStore(Fn);await i.put(t,Nn(e)),await n.done}catch(RB){if(RB instanceof tt)qt.warn(RB.message);else{const t=Tn.create("idb-set",{originalErrorMessage:null==RB?void 0:RB.message});qt.warn(t.message)}}}function Nn(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Wn(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Dn();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(e=>e.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let i=1;i<e.length;i++)e[i].date<n&&(n=e[i].date,t=i);return t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(RB){qt.warn(RB)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Dn(),{heartbeatsToSend:n,unsentEntries:i}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find(e=>e.agent===r.agent);if(e){if(e.dates.push(r.date),Mn(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Mn(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),r=Ne(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(RB){return qt.warn(RB),""}}}function Dn(){return(new Date).toISOString().substring(0,10)}class Wn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!et()&&new Promise((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await En()).transaction(Fn),n=await t.objectStore(Fn).get(Nn(e));return await t.done,n}catch(RB){if(RB instanceof tt)qt.warn(RB.message);else{const t=Tn.create("idb-get",{originalErrorMessage:null==RB?void 0:RB.message});qt.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return _n(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return _n(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Mn(e){return Ne(JSON.stringify({version:2,heartbeats:e})).length}var Ln;Ln="",wn(new ht("platform-logger",e=>new Mt(e),"PRIVATE")),wn(new ht("heartbeat",e=>new Pn(e),"PRIVATE")),An(Lt,Ot,Ln),An(Lt,Ot,"esm2017"),An("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
An("firebase","11.10.0","app");var On,qn,Un="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/(function(){var e;
/** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  */function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var a=e.g[3],o=t+(a^n&(r^a))+i[0]+3614090360&4294967295;o=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=(n=(r=(a=(t=n+(o<<7&4294967295|o>>>25))+((o=a+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^a&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(a^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(r^a))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=a+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^a&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(a^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(r^a))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=a+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^a&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(a^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(a^n&(r^a))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=a+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^a&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(a^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^a&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(a^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(r^a))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^a&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(a^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(r^a))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^a&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(a^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(r^a))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^a&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=a+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(a^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(a^t&(r^a))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^a)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(a^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^a^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^a)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(a^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^a^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^a)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(a^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^a^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^a)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=a+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(a^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^a^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~a))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(a|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~a))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(a|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~a))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(a|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(a^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((a=(t=n+((o=t+(r^(n|~a))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=a+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=a+((o=r+(t^(a|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+a&4294967295}function i(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var a=0|e[r];i&&a==t||(n[r]=a,i=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return t.prototype[n].apply(e,r)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var i=t-this.blockSize,r=this.B,a=this.h,o=0;o<t;){if(0==a)for(;o<=i;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(r[a++]=e.charCodeAt(o++),a==this.blockSize){n(this,r),a=0;break}}else for(;o<t;)if(r[a++]=e[o++],a==this.blockSize){n(this,r),a=0;break}}this.h=a,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var r={};function a(e){return-128<=e&&128>e?function(e,t){var n=r;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new i([0|e],0>e?-1:0)}):new i([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return s;if(0>e)return h(o(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var s=a(0),l=a(1),c=a(16777216);function d(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function u(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(l)}function p(e,t){return e.add(h(t))}function m(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function f(e,t){if(d(t))throw Error("division by zero");if(d(e))return new g(s,s);if(u(e))return t=f(h(e),t),new g(h(t.g),h(t.h));if(u(t))return t=f(e,h(t)),new g(h(t.g),t.h);if(30<e.g.length){if(u(e)||u(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,i=t;0>=i.l(e);)n=x(n),i=x(i);var r=y(n,1),a=y(i,1);for(i=y(i,2),n=y(n,2);!d(i);){var c=a.add(i);0>=c.l(e)&&(r=r.add(n),a=c),i=y(i,1),n=y(n,1)}return t=p(e,r.j(t)),new g(r,t)}for(r=s;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),c=(a=o(n)).j(t);u(c)||0<c.l(e);)c=(a=o(n-=i)).j(t);d(a)&&(a=l),r=r.add(a),e=p(e,c)}return new g(r,e)}function x(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,a=[],o=0;o<r;o++)a[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new i(a,e.h)}(e=i.prototype).m=function(){if(u(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.i(n);e+=(0<=i?i:4294967296+i)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(d(this))return"0";if(u(this))return"-"+h(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,i="";;){var r=f(n,t).g,a=((0<(n=p(n,r.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(d(n=r))return a+i;for(;6>a.length;)a="0"+a;i=a+i}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return u(e=p(this,e))?-1:d(e)?0:1},e.abs=function(){return u(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,a=0;a<=t;a++){var o=r+(65535&this.i(a))+(65535&e.i(a)),s=(o>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);r=s>>>16,o&=65535,s&=65535,n[a]=s<<16|o}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(d(this)||d(e))return s;if(u(this))return u(e)?h(this).j(h(e)):h(h(this).j(e));if(u(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var a=0;a<e.g.length;a++){var l=this.i(r)>>>16,p=65535&this.i(r),g=e.i(a)>>>16,f=65535&e.i(a);n[2*r+2*a]+=p*f,m(n,2*r+2*a),n[2*r+2*a+1]+=l*f,m(n,2*r+2*a+1),n[2*r+2*a+1]+=p*g,m(n,2*r+2*a+1),n[2*r+2*a+2]+=l*g,m(n,2*r+2*a+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return f(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,qn=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=o,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=o(Math.pow(n,8)),r=s,a=0;a<t.length;a+=8){var l=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+l),n);8>l?(l=o(Math.pow(n,l)),r=r.j(l).add(o(c))):r=(r=r.j(i)).add(o(c))}return r},On=i}).apply(void 0!==Un?Un:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Hn,Vn,Kn,$n,Gn,Qn,Yn,Jn,Xn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Xn&&Xn];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,i){if(i)e:{var r=n;e=e.split(".");for(var a=0;a<e.length-1;a++){var o=e[a];if(!(o in r))break e;r=r[o]}(i=i(a=r[e=e[e.length-1]]))!=a&&null!=i&&t(r,e,{configurable:!0,writable:!0,value:i})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,i=!1,r={next:function(){if(!i&&n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,function(e,t){return t})}});
/** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  */
var i=i||{},r=this||self;function a(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function s(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:l).apply(null,arguments)}function d(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return t.prototype[n].apply(e,r)}}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function p(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(a(t)){const n=e.length||0,i=t.length||0;e.length=n+i;for(let r=0;r<i;r++)e[n+r]=t[r]}else e.push(t)}}function m(e){return/^[\s\xa0]*$/.test(e)}function g(){var e=r.navigator;return e&&(e=e.userAgent)?e:""}function f(e){return f[" "](e),e}f[" "]=function(){};var x=!(-1==g().indexOf("Gecko")||-1!=g().toLowerCase().indexOf("webkit")&&-1==g().indexOf("Edge")||-1!=g().indexOf("Trident")||-1!=g().indexOf("MSIE")||-1!=g().indexOf("Edge"));function y(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(e,t){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)e[n]=i[n];for(let t=0;t<v.length;t++)n=v[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function w(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function j(e){r.setTimeout(()=>{throw e},0)}function S(){var e=R;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var T=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new C,e=>e.reset());class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let I,B=!1,R=new class{constructor(){this.h=this.g=null}add(e,t){const n=T.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const e=r.Promise.resolve(void 0);I=()=>{e.then(F)}};var F=()=>{for(var e;e=S();){try{e.h.call(e.g)}catch(n){j(n)}var t=T;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}B=!1};function z(){this.s=this.s,this.C=this.C}function E(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}z.prototype.s=!1,z.prototype.ma=function(){this.s||(this.s=!0,this.N())},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},E.prototype.h=function(){this.defaultPrevented=!0};var _=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};r.addEventListener("test",e,t),r.removeEventListener("test",e,t)}catch(n){}return e}();function N(e,t){if(E.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(x){e:{try{f(t.nodeName);var r=!0;break e}catch(a){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:P[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&N.aa.h.call(this)}}u(N,E);var P={2:"touch",3:"pen",4:"mouse"};N.prototype.h=function(){N.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var D="closure_listenable_"+(1e6*Math.random()|0),W=0;function M(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.ha=r,this.key=++W,this.da=this.fa=!1}function L(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function O(e){this.src=e,this.g={},this.h=0}function q(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],a=Array.prototype.indexOf.call(r,t,void 0);(i=0<=a)&&Array.prototype.splice.call(r,a,1),i&&(L(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function U(e,t,n,i){for(var r=0;r<e.length;++r){var a=e[r];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==i)return r}return-1}O.prototype.add=function(e,t,n,i,r){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=U(e,t,i,r);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new M(t,this.src,a,!!i,r)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),V={};function K(e,t,n,i,r){if(Array.isArray(t)){for(var a=0;a<t.length;a++)K(e,t[a],n,i,r);return null}return n=Z(n),e&&e[D]?e.K(t,n,!!o(i)&&!!i.capture,r):function(e,t,n,i,r,a){if(!t)throw Error("Invalid event type");var s=o(r)?!!r.capture:!!r,l=J(e);if(l||(e[H]=l=new O(e)),n=l.add(t,n,i,s,a),n.proxy)return n;if(i=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Y;return e}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)_||(r=s),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(Q(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}(e,t,n,!1,i,r)}function $(e,t,n,i,r){if(Array.isArray(t))for(var a=0;a<t.length;a++)$(e,t[a],n,i,r);else i=o(i)?!!i.capture:!!i,n=Z(n),e&&e[D]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=U(a=e.g[t],n,i,r))&&(L(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=J(e))&&(t=e.g[t.toString()],e=-1,t&&(e=U(t,n,i,r)),(n=-1<e?t[e]:null)&&G(n))}function G(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[D])q(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(Q(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=J(t))?(q(n,e),0==n.h&&(n.src=null,t[H]=null)):L(e)}}}function Q(e){return e in V?V[e]:V[e]="on"+e}function Y(e,t){if(e.da)e=!0;else{t=new N(t,this);var n=e.listener,i=e.ha||e.src;e.fa&&G(e),e=n.call(i,t)}return e}function J(e){return(e=e[H])instanceof O?e:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function Z(e){return"function"==typeof e?e:(e[X]||(e[X]=function(t){return e.handleEvent(t)}),e[X])}function ee(){z.call(this),this.i=new O(this),this.M=this,this.F=null}function te(e,t){var n,i=e.F;if(i)for(n=[];i;i=i.F)n.push(i);if(e=e.M,i=t.type||t,"string"==typeof t)t=new E(t,e);else if(t instanceof E)t.target=t.target||e;else{var r=t;k(t=new E(i,e),r)}if(r=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];r=ne(o,i,!0,t)&&r}if(r=ne(o=t.g=e,i,!0,t)&&r,r=ne(o,i,!1,t)&&r,n)for(a=0;a<n.length;a++)r=ne(o=t.g=n[a],i,!1,t)&&r}function ne(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.da&&o.capture==n){var s=o.listener,l=o.ha||o.src;o.fa&&q(e.i,o),r=!1!==s.call(l,i)&&r}}return r&&!i.defaultPrevented}function ie(e,t,n){if("function"==typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:r.setTimeout(e,t||0)}function re(e){e.g=ie(()=>{e.g=null,e.i&&(e.i=!1,re(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(ee,z),ee.prototype[D]=!0,ee.prototype.removeEventListener=function(e,t,n,i){$(this,e,t,n,i)},ee.prototype.N=function(){if(ee.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)L(n[i]);delete t.g[e],t.h--}}this.F=null},ee.prototype.K=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},ee.prototype.L=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};class ae extends z{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:re(this)}N(){super.N(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oe(e){z.call(this),this.h=e,this.g={}}u(oe,z);var se=[];function le(e){y(e.g,function(e,t){this.g.hasOwnProperty(t)&&G(e)},e),e.g={}}oe.prototype.N=function(){oe.aa.N.call(this),le(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=r.JSON.stringify,de=r.JSON.parse,ue=class{stringify(e){return r.JSON.stringify(e,void 0)}parse(e){return r.JSON.parse(e,void 0)}};function he(){}function pe(e){return e.h||(e.h=e.i())}function me(){}he.prototype.h=null;var ge={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fe(){E.call(this,"d")}function xe(){E.call(this,"c")}u(fe,E),u(xe,E);var ye={},be=null;function ve(){return be=be||new ee}function ke(e){E.call(this,ye.La,e)}function we(e){const t=ve();te(t,new ke(t))}function je(e,t){E.call(this,ye.STAT_EVENT,e),this.stat=t}function Se(e){const t=ve();te(t,new je(t,e))}function Te(e,t){E.call(this,ye.Ma,e),this.size=t}function Ce(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){e()},t)}function Ie(){this.g=!0}function Be(e,t,n,i){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<r.length;o++)r[o]=""}}}return ce(n)}catch(s){return t}}(e,n)+(i?" "+i:"")})}ye.La="serverreachability",u(ke,E),ye.STAT_EVENT="statevent",u(je,E),ye.Ma="timingevent",u(Te,E),Ie.prototype.xa=function(){this.g=!1},Ie.prototype.info=function(){};var Re,Ae={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function ze(){}function Ee(e,t,n,i){this.j=e,this.i=t,this.l=n,this.R=i||1,this.U=new oe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _e}function _e(){this.i=null,this.g="",this.h=!1}u(ze,he),ze.prototype.g=function(){return new XMLHttpRequest},ze.prototype.i=function(){return{}},Re=new ze;var Ne={},Pe={};function De(e,t,n){e.L=1,e.v=ct(rt(t)),e.m=n,e.P=!0,We(e,null)}function We(e,t){e.F=Date.now(),Oe(e),e.A=rt(e.v);var n=e.A,i=e.R;Array.isArray(i)||(i=[String(i)]),wt(n.i,"t",i),e.C=0,n=e.j.J,e.h=new _e,e.g=dn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,i=e.ca;var r="readystatechange";Array.isArray(r)||(r&&(se[0]=r.toString()),r=se);for(var a=0;a<r.length;a++){var o=K(n,r[a],i||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),we(),function(e,t,n,i,r,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),l=0;l<s.length;l++){var c=s[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");o=2<=u.length&&"type"==u[1]?o+(d+"=")+c+"&":o+(d+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Me(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Le(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?Pe:(n=Number(t.substring(n,i)),isNaN(n)?Ne:(i+=1)+n>t.length?Pe:(t=t.slice(i,i+n),e.C=i+n,t))}function Oe(e){e.S=Date.now()+e.I,qe(e,e.I)}function qe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ce(c(e.ba,e),t)}function Ue(e){e.B&&(r.clearTimeout(e.B),e.B=null)}function He(e){0==e.j.G||e.J||an(e.j,e)}function Ve(e){Ue(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,le(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ke(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Je(n.h,e)))if(!e.K&&Je(n.h,e)&&3==n.G){try{var i=n.Da.g.parse(t)}catch(d){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;rn(n),$t(n)}en(n),Se(18)}}else n.za=r[1],0<n.za-n.T&&37500>r[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ce(c(n.Za,n),6e3));if(1>=Ye(n.h)&&n.ca){try{n.ca()}catch(d){}n.ca=void 0}}else sn(n,11)}else if((e.K||n.g==e)&&rn(n),!m(t))for(r=n.Da.g.parse(t),t=0;t<r.length;t++){let c=r[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const r=c[4];null!=r&&(n.Aa=r,n.j.info("SVER="+n.Aa));const d=c[5];null!=d&&"number"==typeof d&&0<d&&(i=1.5*d,n.L=i,n.j.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=i.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(Xe(a,a.h),a.h=null))}if(i.D){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.ya=e,lt(i.I,i.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((i=n).qa=cn(i,i.J?i.ia:null,i.W),o.K){Ze(i.h,o);var s=o,l=i.L;l&&(s.I=l),s.B&&(Ue(s),Oe(s)),i.g=o}else Zt(i);0<n.i.length&&Qt(n)}else"stop"!=c[0]&&"close"!=c[0]||sn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?sn(n,7):Kt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}we()}catch(d){}}Ee.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==qt(e)?t.j():this.Y(e)},Ee.prototype.Y=function(e){try{if(e==this.g)e:{const h=qt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Ut(this.g)))){this.J||4!=h||7==t||we(),Ue(this);var n=this.g.Z();this.X=n;t:if(Me(this)){var i=Ut(this.g);e="";var a=i.length,o=4==qt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ve(this),He(this);var s="";break t}this.h.i=new r.TextDecoder}for(t=0;t<a;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:!(o&&t==a-1)});i.length=0,this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.oa();if(this.o=200==n,function(e,t,n,i,r,a,o){e.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!m(l)){var d=l;break t}}d=null}if(!(n=d)){this.o=!1,this.s=3,Se(12),Ve(this),He(this);break e}Be(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ke(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<s.length;){if(e=Le(this,s),e==Pe){4==h&&(this.s=4,Se(14),n=!1),Be(this.i,this.l,null,"[Incomplete Response]");break}if(e==Ne){this.s=4,Se(15),Be(this.i,this.l,s,"[Invalid Chunk]"),n=!1;break}Be(this.i,this.l,e,null),Ke(this,e)}if(Me(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=s.length||this.h.h||(this.s=1,Se(16),n=!1),this.o=this.o&&n,n){if(0<s.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),tn(u),u.M=!0,Se(11))}}else Be(this.i,this.l,s,"[Invalid Chunked Response]"),Ve(this),He(this)}else Be(this.i,this.l,s,null),Ke(this,s);4==h&&Ve(this),this.o&&!this.J&&(4==h?an(this.j,this):(this.o=!1,Oe(this)))}else(function(e){const t={};e=(e.g&&2<=qt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(m(e[i]))continue;var n=w(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const a=t[r]||[];t[r]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.s=3,Se(12)):(this.s=0,Se(13)),Ve(this),He(this)}}}catch(h){}},Ee.prototype.cancel=function(){this.J=!0,Ve(this)},Ee.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(we(),Se(17)),Ve(this),this.s=2,He(this)):qe(this,this.S-e)};var $e=class{constructor(e,t){this.g=e,this.map=t}};function Ge(e){this.l=e||10,r.PerformanceNavigationTiming?e=0<(e=r.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(r.chrome&&r.chrome.loadTimes&&r.chrome.loadTimes()&&r.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ye(e){return e.h?1:e.g?e.g.size:0}function Je(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Xe(e,t){e.g?e.g.add(t):e.h=t}function Ze(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function et(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return h(e.i)}function tt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(a(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(a(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(a(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,o=0;o<r;o++)t.call(void 0,i[o],n&&n[o],e)}Ge.prototype.cancel=function(){if(this.i=et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var nt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,ot(this,e.s),this.l=e.l;var t=e.i,n=new yt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),st(this,n),this.m=e.m}else e&&(t=String(e).match(nt))?(this.h=!1,at(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),ot(this,t[4]),this.l=dt(t[5]||"",!0),st(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new yt(null,this.h))}function rt(e){return new it(e)}function at(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ot(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function st(e,t,n){t instanceof yt?(e.i=t,function(e,t){t&&!e.j&&(bt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(vt(this,t),wt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ut(t,ft)),e.i=new yt(t,e.h))}function lt(e,t,n){e.i.set(t,n)}function ct(e){return lt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ut(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ht),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ht(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ut(t,pt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ut(t,pt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ut(n,"/"==n.charAt(0)?gt:mt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ut(n,xt)),e.join("")};var pt=/[#\/\?@]/g,mt=/[#\?:]/g,gt=/[#\?]/g,ft=/[#\?@]/g,xt=/#/g;function yt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function bt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var a=e[n].substring(0,i);r=e[n].substring(i+1)}else a=e[n];t(a,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function vt(e,t){bt(e),t=jt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function kt(e,t){return bt(e),t=jt(e,t),e.g.has(t)}function wt(e,t,n){vt(e,t),0<n.length&&(e.i=null,e.g.set(jt(e,t),h(n)),e.h+=n.length)}function jt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function St(e,t,n,i,r){try{r&&(r.onload=null,r.onerror=null,r.onabort=null,r.ontimeout=null),i(n)}catch(a){}}function Tt(){this.g=new ue}function Ct(e,t,n){const i=n||"";try{tt(e,function(e,n){let r=e;o(e)&&(r=ce(e)),t.push(i+n+"="+encodeURIComponent(r))})}catch(RB){throw t.push(i+"type="+encodeURIComponent("_badmap")),RB}}function It(e){this.l=e.Ub||null,this.j=e.eb||!1}function Bt(e,t){ee.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function At(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ft(e)}function Ft(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function zt(e){let t="";return y(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Et(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=zt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):lt(e,t,n))}function _t(e){ee.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=yt.prototype).add=function(e,t){bt(this),this.i=null,e=jt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){bt(this),this.g.forEach(function(n,i){n.forEach(function(n){e.call(t,n,i,this)},this)},this)},e.na=function(){bt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},e.V=function(e){bt(this);let t=[];if("string"==typeof e)kt(this,e)&&(t=t.concat(this.g.get(jt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return bt(this),this.i=null,kt(this,e=jt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const a=encodeURIComponent(String(i)),o=this.V(i);for(i=0;i<o.length;i++){var r=a;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")},u(It,he),It.prototype.g=function(){return new Bt(this.l,this.j)},It.prototype.i=function(e){return function(){return e}}({}),u(Bt,ee),(e=Bt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ft(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||r).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,At(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ft(this)),this.g&&(this.readyState=3,Ft(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?At(this):Ft(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,At(this))},e.Qa=function(e){this.g&&(this.response=e,At(this))},e.ga=function(){this.g&&At(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Bt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(_t,ee);var Nt=/^https?$/i,Pt=["POST","PUT"];function Dt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Wt(e),Lt(e)}function Wt(e){e.A||(e.A=!0,te(e,"complete"),te(e,"error"))}function Mt(e){if(e.h&&void 0!==i&&(!e.v[1]||4!=qt(e)||2!=e.Z()))if(e.u&&4==qt(e))ie(e.Ea,0,e);else if(te(e,"readystatechange"),4==qt(e)){e.h=!1;try{const i=e.Z();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var a;if(a=0===i){var o=String(e.D).match(nt)[1]||null;!o&&r.self&&r.self.location&&(o=r.self.location.protocol.slice(0,-1)),a=!Nt.test(o?o.toLowerCase():"")}n=a}if(n)te(e,"complete"),te(e,"success");else{e.m=6;try{var s=2<qt(e)?e.g.statusText:""}catch(l){s=""}e.l=s+" ["+e.Z()+"]",Wt(e)}}finally{Lt(e)}}}function Lt(e,t){if(e.g){Ot(e);const n=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||te(e,"ready");try{n.onreadystatechange=i}catch(RB){}}}function Ot(e){e.I&&(r.clearTimeout(e.I),e.I=null)}function qt(e){return e.g?e.g.readyState:0}function Ut(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Ht(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Vt(e){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ht("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ht("baseRetryDelayMs",5e3,e),this.cb=Ht("retryDelaySeedMs",1e4,e),this.Wa=Ht("forwardChannelMaxRetries",2,e),this.wa=Ht("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ge(e&&e.concurrentRequestLimit),this.Da=new Tt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Kt(e){if(Gt(e),3==e.G){var t=e.U++,n=rt(e.I);if(lt(n,"SID",e.K),lt(n,"RID",t),lt(n,"TYPE","terminate"),Jt(e,n),(t=new Ee(e,e.j,t)).L=2,t.v=ct(rt(n)),n=!1,r.navigator&&r.navigator.sendBeacon)try{n=r.navigator.sendBeacon(t.v.toString(),"")}catch(i){}!n&&r.Image&&((new Image).src=t.v,n=!0),n||(t.g=dn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Oe(t)}ln(e)}function $t(e){e.g&&(tn(e),e.g.cancel(),e.g=null)}function Gt(e){$t(e),e.u&&(r.clearTimeout(e.u),e.u=null),rn(e),e.h.cancel(),e.s&&("number"==typeof e.s&&r.clearTimeout(e.s),e.s=null)}function Qt(e){if(!Qe(e.h)&&!e.s){e.s=!0;var t=e.Ga;I||A(),B||(I(),B=!0),R.add(t,e),e.B=0}}function Yt(e,t){var n;n=t?t.l:e.U++;const i=rt(e.I);lt(i,"SID",e.K),lt(i,"RID",n),lt(i,"AID",e.T),Jt(e,i),e.m&&e.o&&Et(i,e.m,e.o),n=new Ee(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=Xt(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),Xe(e.h,n),De(n,i,t)}function Jt(e,t){e.H&&y(e.H,function(e,n){lt(t,n,e)}),e.l&&tt({},function(e,n){lt(t,n,e)})}function Xt(e,t,n){n=Math.min(e.i.length,n);var i=e.l?c(e.l.Na,e.l,e):null;e:{var r=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let s=0;s<n;s++){let n=r[s].g;const l=r[s].map;if(n-=t,0>n)t=Math.max(0,r[s].g-100),o=!1;else try{Ct(l,e,"req"+n+"_")}catch(a){i&&i(l)}}if(o){i=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,i}function Zt(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;I||A(),B||(I(),B=!0),R.add(t,e),e.v=0}}function en(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ce(c(e.Fa,e),on(e,e.v)),e.v++,!0)}function tn(e){null!=e.A&&(r.clearTimeout(e.A),e.A=null)}function nn(e){e.g=new Ee(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=rt(e.qa);lt(t,"RID","rpc"),lt(t,"SID",e.K),lt(t,"AID",e.T),lt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&lt(t,"TO",e.ja),lt(t,"TYPE","xmlhttp"),Jt(e,t),e.m&&e.o&&Et(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ct(rt(t)),n.m=null,n.P=!0,We(n,e)}function rn(e){null!=e.C&&(r.clearTimeout(e.C),e.C=null)}function an(e,t){var n=null;if(e.g==t){rn(e),tn(e),e.g=null;var i=2}else{if(!Je(e.h,t))return;n=t.D,Ze(e.h,t),i=1}if(0!=e.G)if(t.o)if(1==i){n=t.m?t.m.length:0,t=Date.now()-t.F;var r=e.B;te(i=ve(),new Te(i,n)),Qt(e)}else Zt(e);else if(3==(r=t.s)||0==r&&0<t.X||!(1==i&&function(e,t){return!(Ye(e.h)>=e.h.j-(e.s?1:0)||(e.s?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa)||(e.s=Ce(c(e.Ga,e,t),on(e,e.B)),e.B++,0)))}(e,t)||2==i&&en(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),r){case 1:sn(e,5);break;case 4:sn(e,10);break;case 3:sn(e,6);break;default:sn(e,2)}}function on(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function sn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),i=e.Xa;const t=!i;i=new it(i||"//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||at(i,"https"),ct(i),t?function(e,t){const n=new Ie;if(r.Image){const i=new Image;i.onload=d(St,n,"TestLoadImage: loaded",!0,t,i),i.onerror=d(St,n,"TestLoadImage: error",!1,t,i),i.onabort=d(St,n,"TestLoadImage: abort",!1,t,i),i.ontimeout=d(St,n,"TestLoadImage: timeout",!1,t,i),r.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=e}else t(!1)}(i.toString(),n):function(e,t){new Ie;const n=new AbortController,i=setTimeout(()=>{n.abort(),St(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(i),e.ok?St(0,0,!0,t):St(0,0,!1,t)}).catch(()=>{clearTimeout(i),St(0,0,!1,t)})}(i.toString(),n)}else Se(2);e.G=0,e.l&&e.l.sa(t),ln(e),Gt(e)}function ln(e){if(e.G=0,e.ka=[],e.l){const t=et(e.h);0==t.length&&0==e.i.length||(p(e.ka,t),p(e.ka,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.ra()}}function cn(e,t,n){var i=n instanceof it?rt(n):new it(n);if(""!=i.g)t&&(i.g=t+"."+i.g),ot(i,i.s);else{var a=r.location;i=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var o=new it(null);i&&at(o,i),t&&(o.g=t),a&&ot(o,a),n&&(o.l=n),i=o}return n=e.D,t=e.ya,n&&t&&lt(i,n,t),lt(i,"VER",e.la),Jt(e,i),i}function dn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new _t(new It({eb:n})):new _t(e.pa)).Ha(e.J),t}function un(){}function hn(){}function pn(e,t){ee.call(this),this.g=new Vt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!m(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!m(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new fn(this)}function mn(e){fe.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function gn(){xe.call(this),this.status=1}function fn(e){this.g=e}(e=_t.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Re.g(),this.v=this.o?pe(this.o):pe(Re),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Dt(this,o)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var a in i)n.set(a,i[a]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),a=r.FormData&&e instanceof r.FormData,!(0<=Array.prototype.indexOf.call(Pt,t,void 0))||i||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,s]of n)this.g.setRequestHeader(r,s);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ot(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){Dt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,te(this,"complete"),te(this,"abort"),Lt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Lt(this,!0)),_t.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Mt(this):this.bb())},e.bb=function(){Mt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<qt(this)?this.g.status:-1}catch(e){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Vt.prototype).la=8,e.G=1,e.connect=function(e,t,n,i){Se(0),this.W=e,this.H=t||{},n&&void 0!==i&&(this.H.OSID=n,this.H.OAID=i),this.F=this.X,this.I=cn(this,null,this.W),Qt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const r=new Ee(this,this.j,e);let a=this.o;if(this.S&&(a?(a=b(a),k(a,this.S)):a=this.S),null!==this.m||this.O||(r.H=a,a=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var i=this.i[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Xt(this,r,t),lt(n=rt(this.I),"RID",e),lt(n,"CVER",22),this.D&&lt(n,"X-HTTP-Session-Id",this.D),Jt(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(zt(a)))+"&"+t:this.m&&Et(n,this.m,a)),Xe(this.h,r),this.Ua&&lt(n,"TYPE","init"),this.P?(lt(n,"$req",t),lt(n,"SID","null"),r.T=!0,De(r,n,null)):De(r,n,t),this.G=2}}else 3==this.G&&(e?Yt(this,e):0==this.i.length||Qe(this.h)||Yt(this))},e.Fa=function(){if(this.u=null,nn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ce(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Se(10),$t(this),nn(this))},e.Za=function(){null!=this.C&&(this.C=null,$t(this),en(this),Se(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Se(2)):(this.j.info("Failed to ping google.com"),Se(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=un.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},hn.prototype.g=function(e,t){return new pn(e,t)},u(pn,ee),pn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pn.prototype.close=function(){Kt(this.g)},pn.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=ce(e),e=n);t.i.push(new $e(t.Ya++,e)),3==t.G&&Qt(t)},pn.prototype.N=function(){this.g.l=null,delete this.j,Kt(this.g),delete this.g,pn.aa.N.call(this)},u(mn,fe),u(gn,xe),u(fn,un),fn.prototype.ua=function(){te(this.g,"a")},fn.prototype.ta=function(e){te(this.g,new mn(e))},fn.prototype.sa=function(e){te(this.g,new gn)},fn.prototype.ra=function(){te(this.g,"b")},hn.prototype.createWebChannel=hn.prototype.g,pn.prototype.send=pn.prototype.o,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,Jn=function(){return new hn},Yn=function(){return ve()},Qn=ye,Gn={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,$n=Ae,Fe.COMPLETE="complete",Kn=Fe,me.EventType=ge,ge.OPEN="a",ge.CLOSE="b",ge.ERROR="c",ge.MESSAGE="d",ee.prototype.listen=ee.prototype.K,Vn=me,_t.prototype.listenOnce=_t.prototype.L,_t.prototype.getLastError=_t.prototype.Ka,_t.prototype.getLastErrorCode=_t.prototype.Ba,_t.prototype.getStatus=_t.prototype.Z,_t.prototype.getResponseJson=_t.prototype.Oa,_t.prototype.getResponseText=_t.prototype.oa,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Ha,Hn=_t}).apply(void 0!==Xn?Xn:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const Zn="@firebase/firestore",ei="4.8.0";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ti.UNAUTHENTICATED=new ti(null),ti.GOOGLE_CREDENTIALS=new ti("google-credentials-uid"),ti.FIRST_PARTY=new ti("first-party-uid"),ti.MOCK_USER=new ti("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let ni="11.10.0";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii=new wt("@firebase/firestore");function ri(){return ii.logLevel}function ai(e,...t){if(ii.logLevel<=ft.DEBUG){const n=t.map(li);ii.debug(`Firestore (${ni}): ${e}`,...n)}}function oi(e,...t){if(ii.logLevel<=ft.ERROR){const n=t.map(li);ii.error(`Firestore (${ni}): ${e}`,...n)}}function si(e,...t){if(ii.logLevel<=ft.WARN){const n=t.map(li);ii.warn(`Firestore (${ni}): ${e}`,...n)}}function li(e){if("string"==typeof e)return e;try{
/**
    * @license
    * Copyright 2020 Google LLC
    *
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    *   http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    */
return t=e,JSON.stringify(t)}catch(n){return e}var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(e,t,n){let i="Unexpected state";"string"==typeof t?i=t:n=t,di(e,i,n)}function di(e,t,n){let i=`FIRESTORE (${ni}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{i+=" CONTEXT: "+JSON.stringify(n)}catch(r){i+=" CONTEXT: "+n}throw oi(i),new Error(i)}function ui(e,t,n,i){let r="Unexpected state";"string"==typeof n?r=n:i=n,e||di(t,r,i)}function hi(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class mi extends tt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ti.UNAUTHENTICATED))}shutdown(){}}class yi{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class bi{constructor(e){this.t=e,this.currentUser=ti.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ui(void 0===this.o,42304);let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new gi;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new gi,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const t=r;e.enqueueRetryable(async()=>{await t.promise,await i(this.currentUser)})},o=e=>{ai("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(ai("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new gi)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(ai("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ui("string"==typeof t.accessToken,31837,{l:t}),new fi(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ui(null===e||"string"==typeof e,2055,{h:e}),new ti(e)}}class vi{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=ti.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ki{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new vi(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ti.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wi{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ji{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Sn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ui(void 0===this.o,3512);const n=e=>{null!=e.error&&ai("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,ai("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const i=e=>{ai("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>i(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?i(e):ai("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new wi(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(ui("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new wi(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Si(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let i=0;i<e;i++)n[i]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(){return new TextEncoder}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Si(40);for(let i=0;i<n.length;++i)t.length<20&&n[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return t}}function Ii(e,t){return e<t?-1:e>t?1:0}function Bi(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=e.codePointAt(n),r=t.codePointAt(n);if(i!==r){if(i<128&&r<128)return Ii(i,r);{const a=Ti(),o=Ai(a.encode(Ri(e,n)),a.encode(Ri(t,n)));return 0!==o?o:Ii(i,r)}}n+=i>65535?2:1}return Ii(e.length,t.length)}function Ri(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function Ai(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Ii(e[n],t[n]);return Ii(e.length,t.length)}function Fi(e,t,n){return e.length===t.length&&e.every((e,i)=>n(e,t[i]))}function zi(e){return e+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei="__name__";class _i{constructor(e,t,n){void 0===t?t=0:t>e.length&&ci(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&ci(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===_i.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _i?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=_i.compareSegments(e.get(i),t.get(i));if(0!==n)return n}return Ii(e.length,t.length)}static compareSegments(e,t){const n=_i.isNumericId(e),i=_i.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?_i.extractNumericId(e).compare(_i.extractNumericId(t)):Bi(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return On.fromString(e.substring(4,e.length-2))}}class Ni extends _i{construct(e,t,n){return new Ni(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new mi(pi.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new Ni(t)}static emptyPath(){return new Ni([])}}const Pi=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Di extends _i{construct(e,t,n){return new Di(e,t,n)}static isValidIdentifier(e){return Pi.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Di.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ei}static keyField(){return new Di([Ei])}static fromServerFormat(e){const t=[];let n="",i=0;const r=()=>{if(0===n.length)throw new mi(pi.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const t=e[i];if("\\"===t){if(i+1===e.length)throw new mi(pi.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new mi(pi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,i+=2}else"`"===t?(a=!a,i++):"."!==t||a?(n+=t,i++):(r(),i++)}if(r(),a)throw new mi(pi.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Di(t)}static emptyPath(){return new Di([])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.path=e}static fromPath(e){return new Wi(Ni.fromString(e))}static fromName(e){return new Wi(Ni.fromString(e).popFirst(5))}static empty(){return new Wi(Ni.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ni.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ni.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Wi(new Ni(e.slice()))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(e,t,n){if(!n)throw new mi(pi.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Li(e,t,n,i){if(!0===t&&!0===i)throw new mi(pi.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Oi(e){if(!Wi.isDocumentKey(e))throw new mi(pi.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function qi(e){if(Wi.isDocumentKey(e))throw new mi(pi.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ui(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Hi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":ci(12329,{type:typeof e})}function Vi(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new mi(pi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Hi(e);throw new mi(pi.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Ki(e,t){if(t<=0)throw new mi(pi.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}
/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(e,t){const n={typeString:e};return t&&(n.value=t),n}function Gi(e,t){if(!Ui(e))throw new mi(pi.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in t)if(t[i]){const r=t[i].typeString,a="value"in t[i]?{value:t[i].value}:void 0;if(!(i in e)){n=`JSON missing required field: '${i}'`;break}const o=e[i];if(r&&typeof o!==r){n=`JSON field '${i}' must be a ${r}.`;break}if(void 0!==a&&o!==a.value){n=`Expected '${i}' field to equal '${a.value}'`;break}}if(n)throw new mi(pi.INVALID_ARGUMENT,n);return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=-62135596800,Yi=1e6;class Ji{static now(){return Ji.fromMillis(Date.now())}static fromDate(e){return Ji.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Yi);return new Ji(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new mi(pi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new mi(pi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Qi)throw new mi(pi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new mi(pi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Yi}_compareTo(e){return this.seconds===e.seconds?Ii(this.nanoseconds,e.nanoseconds):Ii(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ji._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Gi(e,Ji._jsonSchema))return new Ji(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Qi;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ji._jsonSchemaVersion="firestore/timestamp/1.0",Ji._jsonSchema={type:$i("string",Ji._jsonSchemaVersion),seconds:$i("number"),nanoseconds:$i("number")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Xi{static fromTimestamp(e){return new Xi(e)}static min(){return new Xi(new Ji(0,0))}static max(){return new Xi(new Ji(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=-1;class er{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function tr(e){return e.fields.find(e=>2===e.kind)}function nr(e){return e.fields.filter(e=>2!==e.kind)}function ir(e,t){let n=Ii(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let i=0;i<Math.min(e.fields.length,t.fields.length);++i)if(n=ar(e.fields[i],t.fields[i]),0!==n)return n;return Ii(e.fields.length,t.fields.length)}er.UNKNOWN_ID=-1;class rr{constructor(e,t){this.fieldPath=e,this.kind=t}}function ar(e,t){const n=Di.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:Ii(e.kind,t.kind)}class or{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new or(0,cr.min())}}function sr(e,t){const n=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,r=Xi.fromTimestamp(1e9===i?new Ji(n+1,0):new Ji(n,i));return new cr(r,Wi.empty(),t)}function lr(e){return new cr(e.readTime,e.key,Zi)}class cr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new cr(Xi.min(),Wi.empty(),Zi)}static max(){return new cr(Xi.max(),Wi.empty(),Zi)}}function dr(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Wi.comparator(e.documentKey,t.documentKey),0!==n?n:Ii(e.largestBatchId,t.largestBatchId)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}const ur="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pr(e){if(e.code!==pi.FAILED_PRECONDITION||e.message!==ur)throw e;ai("LocalStore","Unexpectedly lost primary lease")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ci(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new mr((n,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof mr?t:mr.resolve(t)}catch(t){return mr.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):mr.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):mr.reject(t)}static resolve(e){return new mr((t,n)=>{t(e)})}static reject(e){return new mr((t,n)=>{n(e)})}static waitFor(e){return new mr((t,n)=>{let i=0,r=0,a=!1;e.forEach(e=>{++i,e.next(()=>{++r,a&&r===i&&t()},e=>n(e))}),a=!0,r===i&&t()})}static or(e){let t=mr.resolve(!1);for(const n of e)t=t.next(e=>e?mr.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,i)=>{n.push(t.call(this,e,i))}),this.waitFor(n)}static mapArray(e,t){return new mr((n,i)=>{const r=e.length,a=new Array(r);let o=0;for(let s=0;s<r;s++){const l=s;t(e[l]).next(e=>{a[l]=e,++o,o===r&&n(a)},e=>i(e))}})}static doWhile(e,t){return new mr((n,i)=>{const r=()=>{!0===e()?t().next(()=>{r()},i):n()};r()})}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr="SimpleDb";class fr{static open(e,t,n,i){try{return new fr(t,e.transaction(i,n))}catch(r){throw new vr(t,r)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new gi,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new vr(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const n=Tr(t.target.error);this.S.reject(new vr(e,n))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ai(gr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new wr(t)}}class xr{static delete(e){return ai(gr,"Removing database:",e),jr(De().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!et())return!1;if(xr.F())return!0;const e=Ye(),t=xr.M(e),n=0<t&&t<10,i=yr(e),r=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||r)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.O)}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,12.2===xr.M(Ye())&&oi("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(ai(gr,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=e=>{const n=e.target.result;t(n)},i.onblocked=()=>{n(new vr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=t=>{const i=t.target.error;"VersionError"===i.name?n(new mi(pi.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===i.name?n(new mi(pi.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+i)):n(new vr(e,i))},i.onupgradeneeded=e=>{ai(gr,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;if(null!==this.L&&this.L!==e.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${e.oldVersion}, event.newVersion=${e.newVersion}, db.version=${t.version}`);this.B.q(t,i.transaction,e.oldVersion,this.version).next(()=>{ai(gr,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",e=>{const t=e.target;this.L=t.version},{passive:!0})),this.db.addEventListener("versionchange",e=>{var t;null===e.newVersion&&(si('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),null===(t=this.databaseDeletedListener)||void 0===t||t.call(this))},{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,t,n,i){const r="readonly"===t;let a=0;for(;;){++a;try{this.db=await this.k(e);const t=fr.open(this.db,e,r?"readonly":"readwrite",n),a=i(t).next(e=>(t.v(),e)).catch(e=>(t.abort(e),mr.reject(e))).toPromise();return a.catch(()=>{}),await t.D,a}catch(o){const e=o,t="FirebaseError"!==e.name&&a<3;if(ai(gr,"Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}function yr(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class br{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return jr(this.$.delete())}}class vr extends mi{constructor(e,t){super(pi.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function kr(e){return"IndexedDbTransactionError"===e.name}class wr{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(ai(gr,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(ai(gr,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),jr(n)}add(e){return ai(gr,"ADD",this.store.name,e,e),jr(this.store.add(e))}get(e){return jr(this.store.get(e)).next(t=>(void 0===t&&(t=null),ai(gr,"GET",this.store.name,e,t),t))}delete(e){return ai(gr,"DELETE",this.store.name,e),jr(this.store.delete(e))}count(){return ai(gr,"COUNT",this.store.name),jr(this.store.count())}j(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if("function"==typeof i.getAll){const e=i.getAll(n.range);return new mr((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{const e=this.cursor(n),t=[];return this.J(e,(e,n)=>{t.push(n)}).next(()=>t)}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new mr((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}Y(e,t){ai(gr,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Z=!1;const i=this.cursor(n);return this.J(i,(e,t,n)=>n.delete())}X(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.J(i,t)}ee(e){const t=this.cursor({});return new mr((n,i)=>{t.onerror=e=>{const t=Tr(e.target.error);i(t)},t.onsuccess=t=>{const i=t.target.result;i?e(i.primaryKey,i.value).next(e=>{e?i.continue():n()}):n()}})}J(e,t){const n=[];return new mr((i,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{const r=e.target.result;if(!r)return void i();const a=new br(r),o=t(r.primaryKey,r.value,a);if(o instanceof mr){const e=o.catch(e=>(a.done(),mr.reject(e)));n.push(e)}a.isDone?i():null===a.W?r.continue():r.continue(a.W)}}).next(()=>mr.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Z?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function jr(e){return new mr((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Tr(e.target.error);n(t)}})}let Sr=!1;function Tr(e){const t=xr.M(Ye());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new mi("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Sr||(Sr=!0,setTimeout(()=>{throw e},0)),e}}return e}const Cr="IndexBackfiller";class Ir{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ne(e){ai(Cr,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const e=await this.te.re();ai(Cr,`Documents written: ${e}`)}catch(e){kr(e)?ai(Cr,"Ignoring IndexedDB error during index backfill: ",e):await pr(e)}await this.ne(6e4)})}}class Br{constructor(e,t){this.localStore=e,this.persistence=t}async re(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ie(t,e))}ie(e,t){const n=new Set;let i=t,r=!0;return mr.doWhile(()=>!0===r&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return ai(Cr,`Processing collection: ${t}`),this.se(e,t,i).next(e=>{i-=e,n.add(t)});r=!1})).next(()=>t-i)}se(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(n=>{const r=n.changes;return this.localStore.indexManager.updateIndexEntries(e,r).next(()=>this.oe(i,n)).next(n=>(ai(Cr,`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>r.size)}))}oe(e,t){let n=e;return t.changes.forEach((e,t)=>{const i=lr(t);dr(i,n)>0&&(n=i)}),new cr(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this._e(e),this.ae=e=>t.writeSequenceNumber(e))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Rr.ue=-1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ar=-1;function Fr(e){return null==e}function zr(e){return 0===e&&1/e==-1/0}function Er(e){return"number"==typeof e&&Number.isInteger(e)&&!zr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r="";function Nr(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Dr(t)),t=Pr(e.get(n),t);return Dr(t)}function Pr(e,t){let n=t;const i=e.length;for(let r=0;r<i;r++){const t=e.charAt(r);switch(t){case"\0":n+="";break;case _r:n+="";break;default:n+=t}}return n}function Dr(e){return e+_r+""}function Wr(e){const t=e.length;if(ui(t>=2,64408,{path:e}),2===t)return ui(e.charAt(0)===_r&&""===e.charAt(1),56145,{path:e}),Ni.emptyPath();const n=t-2,i=[];let r="";for(let a=0;a<t;){const t=e.indexOf(_r,a);switch((t<0||t>n)&&ci(50515,{path:e}),e.charAt(t+1)){case"":const n=e.substring(a,t);let o;0===r.length?o=n:(r+=n,o=r,r=""),i.push(o);break;case"":r+=e.substring(a,t),r+="\0";break;case"":r+=e.substring(a,t+1);break;default:ci(61167,{path:e})}a=t+2}return new Ni(i)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="remoteDocuments",Lr="owner",Or="owner",qr="mutationQueues",Ur="mutations",Hr="batchId",Vr="userMutationsIndex",Kr=["userId","batchId"];
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(e,t){return[e,Nr(t)]}function Gr(e,t,n){return[e,Nr(t),n]}const Qr={},Yr="documentMutations",Jr="remoteDocumentsV14",Xr=["prefixPath","collectionGroup","readTime","documentId"],Zr="documentKeyIndex",ea=["prefixPath","collectionGroup","documentId"],ta="collectionGroupIndex",na=["collectionGroup","readTime","prefixPath","documentId"],ia="remoteDocumentGlobal",ra="remoteDocumentGlobalKey",aa="targets",oa="queryTargetsIndex",sa=["canonicalId","targetId"],la="targetDocuments",ca=["targetId","path"],da="documentTargetsIndex",ua=["path","targetId"],ha="targetGlobalKey",pa="targetGlobal",ma="collectionParents",ga=["collectionId","parent"],fa="clientMetadata",xa="bundles",ya="namedQueries",ba="indexConfiguration",va="collectionGroupIndex",ka="indexState",wa=["indexId","uid"],ja="sequenceNumberIndex",Sa=["uid","sequenceNumber"],Ta="indexEntries",Ca=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ia="documentKeyIndex",Ba=["indexId","uid","orderedDocumentKey"],Ra="documentOverlays",Aa=["userId","collectionPath","documentId"],Fa="collectionPathOverlayIndex",za=["userId","collectionPath","largestBatchId"],Ea="collectionGroupOverlayIndex",_a=["userId","collectionGroup","largestBatchId"],Na="globals",Pa=[qr,Ur,Yr,Mr,aa,Lr,pa,la,fa,ia,ma,xa,ya],Da=[...Pa,Ra],Wa=[qr,Ur,Yr,Jr,aa,Lr,pa,la,fa,ia,ma,xa,ya,Ra],Ma=Wa,La=[...Ma,ba,ka,Ta],Oa=La,qa=[...La,Na],Ua=qa;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha extends hr{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}}function Va(e,t){const n=hi(e);return xr.N(n.ce,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ka(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function $a(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ga(e,t){const n=[];for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.push(t(e[i],i,e));return n}function Qa(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,t){this.comparator=e,this.root=t||Xa.EMPTY}insert(e,t){return new Ya(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xa.BLACK,null,null))}remove(e){return new Ya(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ja(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ja(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ja(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ja(this.root,e,this.comparator,!0)}}class Ja{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xa{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Xa.RED,this.left=null!=i?i:Xa.EMPTY,this.right=null!=r?r:Xa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new Xa(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Xa.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ci(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ci(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ci(27949);return e+(this.isRed()?0:1)}}Xa.EMPTY=null,Xa.RED=!0,Xa.BLACK=!1,Xa.EMPTY=new class{constructor(){this.size=0}get key(){throw ci(57766)}get value(){throw ci(16141)}get color(){throw ci(16727)}get left(){throw ci(29726)}get right(){throw ci(36894)}copy(e,t,n,i,r){return this}insert(e,t,n){return new Xa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Za{constructor(e){this.comparator=e,this.data=new Ya(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new eo(this.data.getIterator())}getIteratorFrom(e){return new eo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Za))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Za(this.comparator);return t.data=e,t}}class eo{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function to(e){return e.hasNext()?e.getNext():void 0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e){this.fields=e,e.sort(Di.comparator)}static empty(){return new no([])}unionWith(e){let t=new Za(Di.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new no(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fi(this.fields,e.fields,(e,t)=>e.isEqual(t))}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ro{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new io("Invalid base64 string: "+t):t}}(e);return new ro(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ro(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ii(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ro.EMPTY_BYTE_STRING=new ro("");const ao=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oo(e){if(ui(!!e,39018),"string"==typeof e){let t=0;const n=ao.exec(e);if(ui(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:so(e.seconds),nanos:so(e.nanos)}}function so(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function lo(e){return"string"==typeof e?ro.fromBase64String(e):ro.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="server_timestamp",uo="__type__",ho="__previous_value__",po="__local_write_time__";function mo(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[uo])||void 0===n?void 0:n.stringValue)===co}function go(e){const t=e.mapValue.fields[ho];return mo(t)?go(t):t}function fo(e){const t=oo(e.mapValue.fields[po].timestampValue);return new Ji(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,t,n,i,r,a,o,s,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=l,this.isUsingEmulator=c}}const yo="(default)";class bo{constructor(e,t){this.projectId=e,this.database=t||yo}static empty(){return new bo("","")}get isDefaultDatabase(){return this.database===yo}isEqual(e){return e instanceof bo&&e.projectId===this.projectId&&e.database===this.database}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="__type__",ko="__max__",wo={mapValue:{fields:{__type__:{stringValue:ko}}}},jo="__vector__",So="value",To={nullValue:"NULL_VALUE"};function Co(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?mo(e)?4:Uo(e)?9007199254740991:Oo(e)?10:11:ci(28295,{value:e})}function Io(e,t){if(e===t)return!0;const n=Co(e);if(n!==Co(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return fo(e).isEqual(fo(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=oo(e.timestampValue),i=oo(t.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return i=t,lo(e.bytesValue).isEqual(lo(i.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return so(e.geoPointValue.latitude)===so(t.geoPointValue.latitude)&&so(e.geoPointValue.longitude)===so(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return so(e.integerValue)===so(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=so(e.doubleValue),i=so(t.doubleValue);return n===i?zr(n)===zr(i):isNaN(n)&&isNaN(i)}return!1}(e,t);case 9:return Fi(e.arrayValue.values||[],t.arrayValue.values||[],Io);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},i=t.mapValue.fields||{};if(Ka(n)!==Ka(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!Io(n[r],i[r])))return!1;return!0}(e,t);default:return ci(52216,{left:e})}var i}function Bo(e,t){return void 0!==(e.values||[]).find(e=>Io(e,t))}function Ro(e,t){if(e===t)return 0;const n=Co(e),i=Co(t);if(n!==i)return Ii(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ii(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=so(e.integerValue||e.doubleValue),i=so(t.integerValue||t.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(e,t);case 3:return Ao(e.timestampValue,t.timestampValue);case 4:return Ao(fo(e),fo(t));case 5:return Bi(e.stringValue,t.stringValue);case 6:return function(e,t){const n=lo(e),i=lo(t);return n.compareTo(i)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),i=t.split("/");for(let r=0;r<n.length&&r<i.length;r++){const e=Ii(n[r],i[r]);if(0!==e)return e}return Ii(n.length,i.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Ii(so(e.latitude),so(t.latitude));return 0!==n?n:Ii(so(e.longitude),so(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Fo(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,i,r,a;const o=e.fields||{},s=t.fields||{},l=null===(n=o[So])||void 0===n?void 0:n.arrayValue,c=null===(i=s[So])||void 0===i?void 0:i.arrayValue,d=Ii((null===(r=null==l?void 0:l.values)||void 0===r?void 0:r.length)||0,(null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0);return 0!==d?d:Fo(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===wo.mapValue&&t===wo.mapValue)return 0;if(e===wo.mapValue)return 1;if(t===wo.mapValue)return-1;const n=e.fields||{},i=Object.keys(n),r=t.fields||{},a=Object.keys(r);i.sort(),a.sort();for(let o=0;o<i.length&&o<a.length;++o){const e=Bi(i[o],a[o]);if(0!==e)return e;const t=Ro(n[i[o]],r[a[o]]);if(0!==t)return t}return Ii(i.length,a.length)}(e.mapValue,t.mapValue);default:throw ci(23264,{le:n})}}function Ao(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Ii(e,t);const n=oo(e),i=oo(t),r=Ii(n.seconds,i.seconds);return 0!==r?r:Ii(n.nanos,i.nanos)}function Fo(e,t){const n=e.values||[],i=t.values||[];for(let r=0;r<n.length&&r<i.length;++r){const e=Ro(n[r],i[r]);if(e)return e}return Ii(n.length,i.length)}function zo(e){return Eo(e)}function Eo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=oo(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?lo(e.bytesValue).toBase64():"referenceValue"in e?function(e){return Wi.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const i of e.values||[])n?n=!1:t+=",",t+=Eo(i);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",i=!0;for(const r of t)i?i=!1:n+=",",n+=`${r}:${Eo(e.fields[r])}`;return n+"}"}(e.mapValue):ci(61005,{value:e})}function _o(e){switch(Co(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=go(e);return t?16+_o(t):16;case 5:return 2*e.stringValue.length;case 6:return lo(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,t)=>e+_o(t),0);case 10:case 11:return function(e){let t=0;return $a(e.fields,(e,n)=>{t+=e.length+_o(n)}),t}(e.mapValue);default:throw ci(13486,{value:e})}}function No(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Po(e){return!!e&&"integerValue"in e}function Do(e){return!!e&&"arrayValue"in e}function Wo(e){return!!e&&"nullValue"in e}function Mo(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Lo(e){return!!e&&"mapValue"in e}function Oo(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[vo])||void 0===n?void 0:n.stringValue)===jo}function qo(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return $a(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=qo(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=qo(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Uo(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ko}const Ho={mapValue:{fields:{[vo]:{stringValue:jo},[So]:{arrayValue:{}}}}};function Vo(e){return"nullValue"in e?To:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?No(bo.empty(),Wi.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Oo(e)?Ho:{mapValue:{}}:ci(35942,{value:e})}function Ko(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?No(bo.empty(),Wi.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?Ho:"mapValue"in e?Oo(e)?{mapValue:{}}:wo:ci(61959,{value:e})}function $o(e,t){const n=Ro(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Go(e,t){const n=Ro(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e){this.value=e}static empty(){return new Qo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Lo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=qo(t)}setAll(e){let t=Di.emptyPath(),n={},i=[];e.forEach((e,r)=>{if(!t.isImmediateParentOf(r)){const e=this.getFieldsMap(t);this.applyChanges(e,n,i),n={},i=[],t=r.popLast()}e?n[r.lastSegment()]=qo(e):i.push(r.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,n,i)}delete(e){const t=this.field(e.popLast());Lo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Io(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Lo(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){$a(t,(t,n)=>e[t]=n);for(const i of n)delete e[i]}clone(){return new Qo(qo(this.value))}}function Yo(e){const t=[];return $a(e.fields,(e,n)=>{const i=new Di([e]);if(Lo(n)){const e=Yo(n.mapValue).fields;if(0===e.length)t.push(i);else for(const n of e)t.push(i.child(n))}else t.push(i)}),new no(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Jo{constructor(e,t,n,i,r,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=r,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Jo(e,0,Xi.min(),Xi.min(),Xi.min(),Qo.empty(),0)}static newFoundDocument(e,t,n,i){return new Jo(e,1,t,Xi.min(),n,i,0)}static newNoDocument(e,t){return new Jo(e,2,t,Xi.min(),Xi.min(),Qo.empty(),0)}static newUnknownDocument(e,t){return new Jo(e,3,t,Xi.min(),Xi.min(),Qo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xi.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xi.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Jo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Jo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,t){this.position=e,this.inclusive=t}}function Zo(e,t,n){let i=0;for(let r=0;r<e.position.length;r++){const a=t[r],o=e.position[r];if(i=a.field.isKeyField()?Wi.comparator(Wi.fromName(o.referenceValue),n.key):Ro(o,n.data.field(a.field)),"desc"===a.dir&&(i*=-1),0!==i)break}return i}function es(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Io(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,t="asc"){this.field=e,this.dir=t}}function ns(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{}class rs extends is{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new ms(e,t,n):"array-contains"===t?new ys(e,n):"in"===t?new bs(e,n):"not-in"===t?new vs(e,n):"array-contains-any"===t?new ks(e,n):new rs(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new gs(e,n):new fs(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Ro(t,this.value)):null!==t&&Co(this.value)===Co(t)&&this.matchesComparison(Ro(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ci(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class as extends is{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new as(e,t)}matches(e){return os(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function os(e){return"and"===e.op}function ss(e){return"or"===e.op}function ls(e){return cs(e)&&os(e)}function cs(e){for(const t of e.filters)if(t instanceof as)return!1;return!0}function ds(e){if(e instanceof rs)return e.field.canonicalString()+e.op.toString()+zo(e.value);if(ls(e))return e.filters.map(e=>ds(e)).join(",");{const t=e.filters.map(e=>ds(e)).join(",");return`${e.op}(${t})`}}function us(e,t){return e instanceof rs?(n=e,(i=t)instanceof rs&&n.op===i.op&&n.field.isEqual(i.field)&&Io(n.value,i.value)):e instanceof as?function(e,t){return t instanceof as&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,i)=>e&&us(n,t.filters[i]),!0)}(e,t):void ci(19439);var n,i}function hs(e,t){const n=e.filters.concat(t);return as.create(n,e.op)}function ps(e){return e instanceof rs?`${(t=e).field.canonicalString()} ${t.op} ${zo(t.value)}`:e instanceof as?function(e){return e.op.toString()+" {"+e.getFilters().map(ps).join(" ,")+"}"}(e):"Filter";var t}class ms extends rs{constructor(e,t,n){super(e,t,n),this.key=Wi.fromName(n.referenceValue)}matches(e){const t=Wi.comparator(e.key,this.key);return this.matchesComparison(t)}}class gs extends rs{constructor(e,t){super(e,"in",t),this.keys=xs("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class fs extends rs{constructor(e,t){super(e,"not-in",t),this.keys=xs("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function xs(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Wi.fromName(e.referenceValue))}class ys extends rs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Do(t)&&Bo(t.arrayValue,this.value)}}class bs extends rs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Bo(this.value.arrayValue,t)}}class vs extends rs{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Bo(this.value.arrayValue,t)}}class ks extends rs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Do(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Bo(this.value.arrayValue,e))}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,t=null,n=[],i=[],r=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=a,this.endAt=o,this.Pe=null}}function js(e,t=null,n=[],i=[],r=null,a=null,o=null){return new ws(e,t,n,i,r,a,o)}function Ss(e){const t=hi(e);if(null===t.Pe){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>ds(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),Fr(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>zo(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>zo(e)).join(",")),t.Pe=e}return t.Pe}function Ts(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ns(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!us(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!es(e.startAt,t.startAt)&&es(e.endAt,t.endAt)}function Cs(e){return Wi.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Is(e,t){return e.filters.filter(e=>e instanceof rs&&e.field.isEqual(t))}function Bs(e,t,n){let i=To,r=!0;for(const a of Is(e,t)){let e=To,t=!0;switch(a.op){case"<":case"<=":e=Vo(a.value);break;case"==":case"in":case">=":e=a.value;break;case">":e=a.value,t=!1;break;case"!=":case"not-in":e=To}$o({value:i,inclusive:r},{value:e,inclusive:t})<0&&(i=e,r=t)}if(null!==n)for(let a=0;a<e.orderBy.length;++a)if(e.orderBy[a].field.isEqual(t)){const e=n.position[a];$o({value:i,inclusive:r},{value:e,inclusive:n.inclusive})<0&&(i=e,r=n.inclusive);break}return{value:i,inclusive:r}}function Rs(e,t,n){let i=wo,r=!0;for(const a of Is(e,t)){let e=wo,t=!0;switch(a.op){case">=":case">":e=Ko(a.value),t=!1;break;case"==":case"in":case"<=":e=a.value;break;case"<":e=a.value,t=!1;break;case"!=":case"not-in":e=wo}Go({value:i,inclusive:r},{value:e,inclusive:t})>0&&(i=e,r=t)}if(null!==n)for(let a=0;a<e.orderBy.length;++a)if(e.orderBy[a].field.isEqual(t)){const e=n.position[a];Go({value:i,inclusive:r},{value:e,inclusive:n.inclusive})>0&&(i=e,r=n.inclusive);break}return{value:i,inclusive:r}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,t=null,n=[],i=[],r=null,a="F",o=null,s=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=a,this.startAt=o,this.endAt=s,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Fs(e,t,n,i,r,a,o,s){return new As(e,t,n,i,r,a,o,s)}function zs(e){return new As(e)}function Es(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function _s(e){return null!==e.collectionGroup}function Ns(e){const t=hi(e);if(null===t.Te){t.Te=[];const e=new Set;for(const i of t.explicitOrderBy)t.Te.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new Za(Di.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t})(t).forEach(i=>{e.has(i.canonicalString())||i.isKeyField()||t.Te.push(new ts(i,n))}),e.has(Di.keyField().canonicalString())||t.Te.push(new ts(Di.keyField(),n))}return t.Te}function Ps(e){const t=hi(e);return t.Ie||(t.Ie=Ws(t,Ns(e))),t.Ie}function Ds(e){const t=hi(e);return t.de||(t.de=Ws(t,e.explicitOrderBy)),t.de}function Ws(e,t){if("F"===e.limitType)return js(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new ts(e.field,t)});const n=e.endAt?new Xo(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Xo(e.startAt.position,e.startAt.inclusive):null;return js(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}}function Ms(e,t){const n=e.filters.concat([t]);return new As(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Ls(e,t,n){return new As(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Os(e,t){return Ts(Ps(e),Ps(t))&&e.limitType===t.limitType}function qs(e){return`${Ss(Ps(e))}|lt:${e.limitType}`}function Us(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>ps(e)).join(", ")}]`),Fr(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>zo(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>zo(e)).join(",")),`Target(${t})`}(Ps(e))}; limitType=${e.limitType})`}function Hs(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Wi.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Ns(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(i=t,!((n=e).startAt&&!function(e,t,n){const i=Zo(e,t,n);return e.inclusive?i<=0:i<0}(n.startAt,Ns(n),i)||n.endAt&&!function(e,t,n){const i=Zo(e,t,n);return e.inclusive?i>=0:i>0}(n.endAt,Ns(n),i)));var n,i}function Vs(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Ks(e){return(t,n)=>{let i=!1;for(const r of Ns(e)){const e=$s(r,t,n);if(0!==e)return e;i=i||r.field.isKeyField()}return 0}}function $s(e,t,n){const i=e.field.isKeyField()?Wi.comparator(t.key,n.key):function(e,t,n){const i=t.data.field(e),r=n.data.field(e);return null!==i&&null!==r?Ro(i,r):ci(42886)}(e.field,t,n);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return ci(19790,{direction:e.dir})}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){$a(this.inner,(t,n)=>{for(const[i,r]of n)e(i,r)})}isEmpty(){return Qa(this.inner)}size(){return this.innerSize}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=new Ya(Wi.comparator);function Ys(){return Qs}const Js=new Ya(Wi.comparator);function Xs(...e){let t=Js;for(const n of e)t=t.insert(n.key,n);return t}function Zs(e){let t=Js;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function el(){return nl()}function tl(){return nl()}function nl(){return new Gs(e=>e.toString(),(e,t)=>e.isEqual(t))}const il=new Ya(Wi.comparator),rl=new Za(Wi.comparator);function al(...e){let t=rl;for(const n of e)t=t.add(n);return t}const ol=new Za(Ii);function sl(){return ol}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ll(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zr(t)?"-0":t}}function cl(e){return{integerValue:""+e}}function dl(e,t){return Er(t)?cl(t):ll(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(){this._=void 0}}function hl(e,t,n){return e instanceof gl?function(e,t){const n={fields:{[uo]:{stringValue:co},[po]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&mo(t)&&(t=go(t)),t&&(n.fields[ho]=t),{mapValue:n}}(n,t):e instanceof fl?xl(e,t):e instanceof yl?bl(e,t):function(e,t){const n=ml(e,t),i=kl(n)+kl(e.Ee);return Po(n)&&Po(e.Ee)?cl(i):ll(e.serializer,i)}(e,t)}function pl(e,t,n){return e instanceof fl?xl(e,t):e instanceof yl?bl(e,t):n}function ml(e,t){return e instanceof vl?Po(n=t)||(i=n)&&"doubleValue"in i?t:{integerValue:0}:null;var n,i}class gl extends ul{}class fl extends ul{constructor(e){super(),this.elements=e}}function xl(e,t){const n=wl(t);for(const i of e.elements)n.some(e=>Io(e,i))||n.push(i);return{arrayValue:{values:n}}}class yl extends ul{constructor(e){super(),this.elements=e}}function bl(e,t){let n=wl(t);for(const i of e.elements)n=n.filter(e=>!Io(e,i));return{arrayValue:{values:n}}}class vl extends ul{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function kl(e){return so(e.integerValue||e.doubleValue)}function wl(e){return Do(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,t){this.field=e,this.transform=t}}class Sl{constructor(e,t){this.version=e,this.transformResults=t}}class Tl{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Tl}static exists(e){return new Tl(void 0,e)}static updateTime(e){return new Tl(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cl(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Il{}function Bl(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Wl(e.key,Tl.none()):new El(e.key,e.data,Tl.none());{const n=e.data,i=Qo.empty();let r=new Za(Di.comparator);for(let e of t.fields)if(!r.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?i.delete(e):i.set(e,t),r=r.add(e)}return new _l(e.key,i,new no(r.toArray()),Tl.none())}}function Rl(e,t,n){var i;e instanceof El?function(e,t,n){const i=e.value.clone(),r=Pl(e.fieldTransforms,t,n.transformResults);i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):e instanceof _l?function(e,t,n){if(!Cl(e.precondition,t))return void t.convertToUnknownDocument(n.version);const i=Pl(e.fieldTransforms,t,n.transformResults),r=t.data;r.setAll(Nl(e)),r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):(i=n,t.convertToNoDocument(i.version).setHasCommittedMutations())}function Al(e,t,n,i){return e instanceof El?function(e,t,n,i){if(!Cl(e.precondition,t))return n;const r=e.value.clone(),a=Dl(e.fieldTransforms,i,t);return r.setAll(a),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null}(e,t,n,i):e instanceof _l?function(e,t,n,i){if(!Cl(e.precondition,t))return n;const r=Dl(e.fieldTransforms,i,t),a=t.data;return a.setAll(Nl(e)),a.setAll(r),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,i):(r=t,a=n,Cl(e.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):a);var r,a}function Fl(e,t){let n=null;for(const i of e.fieldTransforms){const e=t.data.field(i.field),r=ml(i.transform,e||null);null!=r&&(null===n&&(n=Qo.empty()),n.set(i.field,r))}return n||null}function zl(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,i=t.fieldTransforms,!!(void 0===n&&void 0===i||n&&i&&Fi(n,i,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,i=t.transform,n instanceof fl&&i instanceof fl||n instanceof yl&&i instanceof yl?Fi(n.elements,i.elements,Io):n instanceof vl&&i instanceof vl?Io(n.Ee,i.Ee):n instanceof gl&&i instanceof gl);var n,i}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,i}class El extends Il{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class _l extends Il{constructor(e,t,n,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Nl(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=e.data.field(n);t.set(n,i)}}),t}function Pl(e,t,n){const i=new Map;ui(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let r=0;r<n.length;r++){const a=e[r],o=a.transform,s=t.data.field(a.field);i.set(a.field,pl(o,s,n[r]))}return i}function Dl(e,t,n){const i=new Map;for(const r of e){const e=r.transform,a=n.data.field(r.field);i.set(r.field,hl(e,a,t))}return i}class Wl extends Il{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ml extends Il{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const t=this.mutations[i];t.key.isEqual(e.key)&&Rl(t,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Al(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Al(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=tl();return this.mutations.forEach(i=>{const r=e.get(i.key),a=r.overlayedDocument;let o=this.applyToLocalView(a,r.mutatedFields);o=t.has(i.key)?null:o;const s=Bl(a,o);null!==s&&n.set(i.key,s),a.isValidDocument()||a.convertToNoDocument(Xi.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),al())}isEqual(e){return this.batchId===e.batchId&&Fi(this.mutations,e.mutations,(e,t)=>zl(e,t))&&Fi(this.baseMutations,e.baseMutations,(e,t)=>zl(e,t))}}class Ol{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ui(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=function(){return il}();const r=e.mutations;for(let a=0;a<r.length;a++)i=i.insert(r[a].key,n[a].version);return new Ol(e,t,n,i)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vl,Kl;function $l(e){switch(e){case pi.OK:return ci(64938);case pi.CANCELLED:case pi.UNKNOWN:case pi.DEADLINE_EXCEEDED:case pi.RESOURCE_EXHAUSTED:case pi.INTERNAL:case pi.UNAVAILABLE:case pi.UNAUTHENTICATED:return!1;case pi.INVALID_ARGUMENT:case pi.NOT_FOUND:case pi.ALREADY_EXISTS:case pi.PERMISSION_DENIED:case pi.FAILED_PRECONDITION:case pi.ABORTED:case pi.OUT_OF_RANGE:case pi.UNIMPLEMENTED:case pi.DATA_LOSS:return!0;default:return ci(15467,{code:e})}}function Gl(e){if(void 0===e)return oi("GRPC error has no .code"),pi.UNKNOWN;switch(e){case Vl.OK:return pi.OK;case Vl.CANCELLED:return pi.CANCELLED;case Vl.UNKNOWN:return pi.UNKNOWN;case Vl.DEADLINE_EXCEEDED:return pi.DEADLINE_EXCEEDED;case Vl.RESOURCE_EXHAUSTED:return pi.RESOURCE_EXHAUSTED;case Vl.INTERNAL:return pi.INTERNAL;case Vl.UNAVAILABLE:return pi.UNAVAILABLE;case Vl.UNAUTHENTICATED:return pi.UNAUTHENTICATED;case Vl.INVALID_ARGUMENT:return pi.INVALID_ARGUMENT;case Vl.NOT_FOUND:return pi.NOT_FOUND;case Vl.ALREADY_EXISTS:return pi.ALREADY_EXISTS;case Vl.PERMISSION_DENIED:return pi.PERMISSION_DENIED;case Vl.FAILED_PRECONDITION:return pi.FAILED_PRECONDITION;case Vl.ABORTED:return pi.ABORTED;case Vl.OUT_OF_RANGE:return pi.OUT_OF_RANGE;case Vl.UNIMPLEMENTED:return pi.UNIMPLEMENTED;case Vl.DATA_LOSS:return pi.DATA_LOSS;default:return ci(39323,{code:e})}}(Kl=Vl||(Vl={}))[Kl.OK=0]="OK",Kl[Kl.CANCELLED=1]="CANCELLED",Kl[Kl.UNKNOWN=2]="UNKNOWN",Kl[Kl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kl[Kl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kl[Kl.NOT_FOUND=5]="NOT_FOUND",Kl[Kl.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kl[Kl.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kl[Kl.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kl[Kl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kl[Kl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kl[Kl.ABORTED=10]="ABORTED",Kl[Kl.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kl[Kl.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kl[Kl.INTERNAL=13]="INTERNAL",Kl[Kl.UNAVAILABLE=14]="UNAVAILABLE",Kl[Kl.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Ql=null;
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=new On([4294967295,4294967295],0);function Jl(e){const t=Ti().encode(e),n=new qn;return n.update(t),new Uint8Array(n.digest())}function Xl(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new On([n,i],0),new On([r,a],0)]}class Zl{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ec(`Invalid padding: ${t}`);if(n<0)throw new ec(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new ec(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ec(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=On.fromNumber(this.fe)}pe(e,t,n){let i=e.add(t.multiply(On.fromNumber(n)));return 1===i.compare(Yl)&&(i=new On([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.fe)return!1;const t=Jl(e),[n,i]=Xl(t);for(let r=0;r<this.hashCount;r++){const e=this.pe(n,i,r);if(!this.ye(e))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),a=new Zl(r,i,t);return n.forEach(e=>a.insert(e)),a}insert(e){if(0===this.fe)return;const t=Jl(e),[n,i]=Xl(t);for(let r=0;r<this.hashCount;r++){const e=this.pe(n,i,r);this.we(e)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ec extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t,n,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,nc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new tc(Xi.min(),i,new Ya(Ii),Ys(),al())}}class nc{constructor(e,t,n,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new nc(n,t,al(),al(),al())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,t,n,i){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=i}}class rc{constructor(e,t){this.targetId=e,this.De=t}}class ac{constructor(e,t,n=ro.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class oc{constructor(){this.ve=0,this.Ce=cc(),this.Fe=ro.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=al(),t=al(),n=al();return this.Ce.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:ci(38017,{changeType:r})}}),new nc(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=cc()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ui(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class sc{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ys(),this.je=lc(),this.Je=lc(),this.He=new Ya(Ii)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:ci(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((e,n)=>{this.nt(n)&&t(n)})}it(e){const t=e.targetId,n=e.De.count,i=this.st(t);if(i){const r=i.target;if(Cs(r))if(0===n){const e=new Wi(r.path);this.Xe(t,e,Jo.newNoDocument(e,Xi.min()))}else ui(1===n,20013,{expectedCount:n});else{const i=this.ot(t);if(i!==n){const n=this._t(e),r=n?this.ut(n,e,i):1;if(0!==r){this.rt(t);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,e)}null==Ql||Ql.ct(function(e,t,n,i,r){var a,o,s,l,c,d;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===r,hashCount:null!==(a=null==h?void 0:h.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(l=null===(s=null===(o=null==h?void 0:h.bits)||void 0===o?void 0:o.bitmap)||void 0===s?void 0:s.length)&&void 0!==l?l:0,padding:null!==(d=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==d?d:0,mightContain:e=>{var t;return null!==(t=null==i?void 0:i.mightContain(e))&&void 0!==t&&t}}),u}(i,e.De,this.We.lt(),n,r))}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:r=0}=t;let a,o;try{a=lo(n).toUint8Array()}catch(s){if(s instanceof io)return si("Decoding the base64 bloom filter in existence filter failed ("+s.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw s}try{o=new Zl(a,i,r)}catch(s){return si(s instanceof ec?"BloomFilter error: ":"Applying bloom filter failed: ",s),null}return 0===o.fe?null:o}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let i=0;return n.forEach(n=>{const r=this.We.lt(),a=`projects/${r.projectId}/databases/${r.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,n,null),i++)}),i}Pt(e){const t=new Map;this.Ge.forEach((n,i)=>{const r=this.st(i);if(r){if(n.current&&Cs(r.target)){const t=new Wi(r.target.path);this.Tt(t).has(i)||this.It(i,t)||this.Xe(i,t,Jo.newNoDocument(t,e))}n.Ne&&(t.set(i,n.Le()),n.ke())}});let n=al();this.Je.forEach((e,t)=>{let i=!0;t.forEachWhile(e=>{const t=this.st(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(i=!1,!1)}),i&&(n=n.add(e))}),this.ze.forEach((t,n)=>n.setReadTime(e));const i=new tc(e,t,this.He,this.ze,n);return this.ze=Ys(),this.je=lc(),this.Je=lc(),this.He=new Ya(Ii),i}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new oc,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Za(Ii),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Za(Ii),this.je=this.je.insert(e,t)),t}nt(e){const t=null!==this.st(e);return t||ai("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new oc),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function lc(){return new Ya(Wi.comparator)}function cc(){return new Ya(Wi.comparator)}const dc=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),uc=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),hc=(()=>({and:"AND",or:"OR"}))();class pc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function mc(e,t){return e.useProto3Json||Fr(t)?t:{value:t}}function gc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function fc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function xc(e,t){return gc(e,t.toTimestamp())}function yc(e){return ui(!!e,49232),Xi.fromTimestamp(function(e){const t=oo(e);return new Ji(t.seconds,t.nanos)}(e))}function bc(e,t){return vc(e,t).canonicalString()}function vc(e,t){const n=(i=e,new Ni(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===t?n:n.child(t)}function kc(e){const t=Ni.fromString(e);return ui(Hc(t),10190,{key:t.toString()}),t}function wc(e,t){return bc(e.databaseId,t.path)}function jc(e,t){const n=kc(t);if(n.get(1)!==e.databaseId.projectId)throw new mi(pi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new mi(pi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Wi(Ic(n))}function Sc(e,t){return bc(e.databaseId,t)}function Tc(e){const t=kc(e);return 4===t.length?Ni.emptyPath():Ic(t)}function Cc(e){return new Ni(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Ic(e){return ui(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Bc(e,t,n){return{name:wc(e,t),fields:n.value.mapValue.fields}}function Rc(e,t,n){const i=jc(e,t.name),r=yc(t.updateTime),a=t.createTime?yc(t.createTime):Xi.min(),o=new Qo({mapValue:{fields:t.fields}}),s=Jo.newFoundDocument(i,r,a,o);return n&&s.setHasCommittedMutations(),n?s.setHasCommittedMutations():s}function Ac(e,t){let n;if(t instanceof El)n={update:Bc(e,t.key,t.value)};else if(t instanceof Wl)n={delete:wc(e,t.key)};else if(t instanceof _l)n={update:Bc(e,t.key,t.data),updateMask:Uc(t.fieldMask)};else{if(!(t instanceof Ml))return ci(16599,{Rt:t.type});n={verify:wc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof gl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof fl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof yl)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof vl)return{fieldPath:t.field.canonicalString(),increment:n.Ee};throw ci(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=(i=e,void 0!==(r=t.precondition).updateTime?{updateTime:xc(i,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:ci(27497))),n;var i,r}function Fc(e,t){const n=t.currentDocument?void 0!==(r=t.currentDocument).updateTime?Tl.updateTime(yc(r.updateTime)):void 0!==r.exists?Tl.exists(r.exists):Tl.none():Tl.none(),i=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)ui("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),n=new gl;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new fl(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new yl(e)}else"increment"in t?n=new vl(e,t.increment):ci(16584,{proto:t});const i=Di.fromServerFormat(t.fieldPath);return new jl(i,n)}(e,t)):[];var r;if(t.update){t.update.name;const r=jc(e,t.update.name),a=new Qo({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new no(t.map(e=>Di.fromServerFormat(e)))}(t.updateMask);return new _l(r,a,e,n,i)}return new El(r,a,n,i)}if(t.delete){const i=jc(e,t.delete);return new Wl(i,n)}if(t.verify){const i=jc(e,t.verify);return new Ml(i,n)}return ci(1463,{proto:t})}function zc(e,t){return{documents:[Sc(e,t.path)]}}function Ec(e,t){const n={structuredQuery:{}},i=t.path;let r;null!==t.collectionGroup?(r=i,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Sc(e,r);const a=function(e){if(0!==e.length)return qc(as.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);const o=function(e){if(0!==e.length)return e.map(e=>{return{field:Lc((t=e).field),direction:Dc(t.dir)};var t})}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const s=mc(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{Vt:n,parent:r};var l}function _c(e,t,n,i){const{Vt:r,parent:a}=Ec(e,t),o={},s=[];let l=0;return n.forEach(e=>{const t=i?e.alias:"aggregate_"+l++;o[t]=e.alias,"count"===e.aggregateType?s.push({alias:t,count:{}}):"avg"===e.aggregateType?s.push({alias:t,avg:{field:Lc(e.fieldPath)}}):"sum"===e.aggregateType&&s.push({alias:t,sum:{field:Lc(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:r.structuredQuery},parent:r.parent},ft:o,parent:a}}function Nc(e){let t=Tc(e.parent);const n=e.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){ui(1===i,65062);const e=n.from[0];e.allDescendants?r=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Pc(e);return t instanceof as&&ls(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>{return new ts(Oc((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let s=null;n.limit&&(s=function(e){let t;return t="object"==typeof e?e.value:e,Fr(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Xo(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Xo(n,t)}(n.endAt)),Fs(t,r,o,a,s,"F",l,c)}function Pc(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Oc(e.unaryFilter.field);return rs.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Oc(e.unaryFilter.field);return rs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Oc(e.unaryFilter.field);return rs.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Oc(e.unaryFilter.field);return rs.create(r,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ci(61313);default:return ci(60726)}}(e):void 0!==e.fieldFilter?(t=e,rs.create(Oc(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ci(58110);default:return ci(50506)}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return as.create(e.compositeFilter.filters.map(e=>Pc(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ci(1026)}}(e.compositeFilter.op))}(e):ci(30097,{filter:e});var t}function Dc(e){return dc[e]}function Wc(e){return uc[e]}function Mc(e){return hc[e]}function Lc(e){return{fieldPath:e.canonicalString()}}function Oc(e){return Di.fromServerFormat(e.fieldPath)}function qc(e){return e instanceof rs?function(e){if("=="===e.op){if(Mo(e.value))return{unaryFilter:{field:Lc(e.field),op:"IS_NAN"}};if(Wo(e.value))return{unaryFilter:{field:Lc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Mo(e.value))return{unaryFilter:{field:Lc(e.field),op:"IS_NOT_NAN"}};if(Wo(e.value))return{unaryFilter:{field:Lc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lc(e.field),op:Wc(e.op),value:e.value}}}(e):e instanceof as?function(e){const t=e.getFilters().map(e=>qc(e));return 1===t.length?t[0]:{compositeFilter:{op:Mc(e.op),filters:t}}}(e):ci(54877,{filter:e})}function Uc(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Hc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,t,n,i,r=Xi.min(),a=Xi.min(),o=ro.EMPTY_BYTE_STRING,s=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=s}withSequenceNumber(e){return new Vc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Vc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e){this.gt=e}}function $c(e,t){const n=t.key,i={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Gc(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document={name:wc(r=e.gt,(a=t).key),fields:a.data.value.mapValue.fields,updateTime:gc(r,a.version.toTimestamp()),createTime:gc(r,a.createTime.toTimestamp())};else if(t.isNoDocument())i.noDocument={path:n.path.toArray(),readTime:Qc(t.version)};else{if(!t.isUnknownDocument())return ci(57904,{document:t});i.unknownDocument={path:n.path.toArray(),version:Qc(t.version)}}var r,a;return i}function Gc(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Qc(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Yc(e){const t=new Ji(e.seconds,e.nanoseconds);return Xi.fromTimestamp(t)}function Jc(e,t){const n=(t.baseMutations||[]).map(t=>Fc(e.gt,t));for(let a=0;a<t.mutations.length-1;++a){const e=t.mutations[a];if(a+1<t.mutations.length&&void 0!==t.mutations[a+1].transform){const n=t.mutations[a+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(a+1,1),++a}}const i=t.mutations.map(t=>Fc(e.gt,t)),r=Ji.fromMillis(t.localWriteTimeMs);return new Ll(t.batchId,r,n,i)}function Xc(e){const t=Yc(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Yc(e.lastLimboFreeSnapshotVersion):Xi.min();let i;return i=void 0!==e.query.documents?function(e){const t=e.documents.length;return ui(1===t,1966,{count:t}),Ps(zs(Tc(e.documents[0])))}(e.query):function(e){return Ps(Nc(e))}(e.query),new Vc(i,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,ro.fromBase64String(e.resumeToken))}function Zc(e,t){const n=Qc(t.snapshotVersion),i=Qc(t.lastLimboFreeSnapshotVersion);let r;r=Cs(t.target)?zc(e.gt,t.target):Ec(e.gt,t.target).Vt;const a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Ss(t.target),readTime:n,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function ed(e){const t=Nc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ls(t,t.limit,"L"):t}function td(e,t){return new ql(t.largestBatchId,Fc(e.gt,t.overlayMutation))}function nd(e,t){const n=t.path.lastSegment();return[e,Nr(t.path.popLast()),n]}function id(e,t,n,i){return{indexId:e,uid:t,sequenceNumber:n,readTime:Qc(i.readTime),documentKey:Nr(i.documentKey.path),largestBatchId:i.largestBatchId}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{getBundleMetadata(e,t){return ad(e).get(t).next(e=>{if(e)return{id:(t=e).bundleId,createTime:Yc(t.createTime),version:t.version};var t})}saveBundleMetadata(e,t){return ad(e).put({bundleId:(n=t).id,createTime:Qc(yc(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return od(e).get(t).next(e=>{if(e)return{name:(t=e).name,query:ed(t.bundledQuery),readTime:Yc(t.readTime)};var t})}saveNamedQuery(e,t){return od(e).put({name:(n=t).name,readTime:Qc(yc(n.readTime)),bundledQuery:n.bundledQuery});var n}}function ad(e){return Va(e,xa)}function od(e){return Va(e,ya)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){const n=t.uid||"";return new sd(e,n)}getOverlay(e,t){return ld(e).get(nd(this.userId,t)).next(e=>e?td(this.serializer,e):null)}getOverlays(e,t){const n=el();return mr.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((n,r)=>{const a=new ql(t,r);i.push(this.wt(e,a))}),mr.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(e=>i.add(Nr(e.getCollectionPath())));const r=[];return i.forEach(t=>{const i=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);r.push(ld(e).Y(Fa,i))}),mr.waitFor(r)}getOverlaysForCollection(e,t,n){const i=el(),r=Nr(t),a=IDBKeyRange.bound([this.userId,r,n],[this.userId,r,Number.POSITIVE_INFINITY],!0);return ld(e).j(Fa,a).next(e=>{for(const t of e){const e=td(this.serializer,t);i.set(e.getKey(),e)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const r=el();let a;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ld(e).X({index:Ea,range:o},(e,t,n)=>{const o=td(this.serializer,t);r.size()<i||o.largestBatchId===a?(r.set(o.getKey(),o),a=o.largestBatchId):n.done()}).next(()=>r)}wt(e,t){return ld(e).put(function(e,t,n){const[i,r,a]=nd(t,n.mutation.key);return{userId:t,collectionPath:r,documentId:a,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Ac(e.gt,n.mutation)}}(this.serializer,this.userId,t))}}function ld(e){return Va(e,Ra)}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{St(e){return Va(e,Na)}getSessionToken(e){return this.St(e).get("sessionToken").next(e=>{const t=null==e?void 0:e.value;return t?ro.fromUint8Array(t):ro.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(so(e.integerValue));else if("doubleValue"in e){const n=so(e.doubleValue);isNaN(n)?this.Ct(t,13):(this.Ct(t,15),zr(n)?t.Ft(0):t.Ft(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ct(t,20),"string"==typeof n&&(n=oo(n)),t.Mt(`${n.seconds||""}`),t.Ft(n.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(lo(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ct(t,45),t.Ft(n.latitude||0),t.Ft(n.longitude||0)}else"mapValue"in e?Uo(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Oo(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):ci(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const n=e.fields||{};this.Ct(t,55);for(const i of Object.keys(n))this.xt(i,t),this.Dt(n[i],t)}Lt(e,t){var n,i;const r=e.fields||{};this.Ct(t,53);const a=So,o=(null===(i=null===(n=r[a].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.length)||0;this.Ct(t,15),t.Ft(so(o)),this.xt(a,t),this.Dt(r[a],t)}qt(e,t){const n=e.values||[];this.Ct(t,50);for(const i of n)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),Wi.fromName(e).path.forEach(e=>{this.Ct(t,60),this.$t(e,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}dd.Ut=new dd;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ud=255;function hd(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function pd(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const i=hd(255&e[n]);if(t+=i,8!==i)break}return t}(e);return Math.ceil(t/8)}class md{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Wt(n.value),n=t.next();this.Gt()}zt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.jt(n.value),n=t.next();this.Jt()}Ht(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Wt(e);else if(e<2048)this.Wt(960|e>>>6),this.Wt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Wt(480|e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e);else{const e=t.codePointAt(0);this.Wt(240|e>>>18),this.Wt(128|63&e>>>12),this.Wt(128|63&e>>>6),this.Wt(128|63&e)}}this.Gt()}Yt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.jt(e);else if(e<2048)this.jt(960|e>>>6),this.jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.jt(480|e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e);else{const e=t.codePointAt(0);this.jt(240|e>>>18),this.jt(128|63&e>>>12),this.jt(128|63&e>>>6),this.jt(128|63&e)}}this.Jt()}Zt(e){const t=this.Xt(e),n=pd(t);this.en(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}tn(e){const t=this.Xt(e),n=pd(t);this.en(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}nn(){this.rn(ud),this.rn(255)}sn(){this._n(ud),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Wt(e){const t=255&e;0===t?(this.rn(0),this.rn(255)):t===ud?(this.rn(ud),this.rn(0)):this.rn(t)}jt(e){const t=255&e;0===t?(this._n(0),this._n(255)):t===ud?(this._n(ud),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class gd{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}}class fd{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}}class xd{constructor(){this.un=new md,this.cn=new gd(this.un),this.ln=new fd(this.un)}seed(e){this.un.seed(e)}hn(e){return 0===e?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,t,n,i){this.Pn=e,this.Tn=t,this.In=n,this.dn=i}En(){const e=this.dn.length,t=0===e||255===this.dn[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new yd(this.Pn,this.Tn,this.In,n)}An(e,t,n){return{indexId:this.Pn,uid:e,arrayValue:kd(this.In),directionalValue:kd(this.dn),orderedDocumentKey:kd(t),documentKey:n.path.toArray()}}Rn(e,t,n){const i=this.An(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function bd(e,t){let n=e.Pn-t.Pn;return 0!==n?n:(n=vd(e.In,t.In),0!==n?n:(n=vd(e.dn,t.dn),0!==n?n:Wi.comparator(e.Tn,t.Tn)))}function vd(e,t){for(let n=0;n<e.length&&n<t.length;++n){const i=e[n]-t[n];if(0!==i)return i}return e.length-t.length}function kd(e){return Ze()?function(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}(e):e}function wd(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)}class jd{constructor(e){this.Vn=new Za((e,t)=>Di.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Vn=this.Vn.add(e):this.fn.push(e)}}get gn(){return this.Vn.size>1}pn(e){if(ui(e.collectionGroup===this.collectionId,49279),this.gn)return!1;const t=tr(e);if(void 0!==t&&!this.yn(t))return!1;const n=nr(e);let i=new Set,r=0,a=0;for(;r<n.length&&this.yn(n[r]);++r)i=i.add(n[r].fieldPath.canonicalString());if(r===n.length)return!0;if(this.Vn.size>0){const e=this.Vn.getIterator().getNext();if(!i.has(e.field.canonicalString())){const t=n[r];if(!this.wn(e,t)||!this.Sn(this.mn[a++],t))return!1}++r}for(;r<n.length;++r){const e=n[r];if(a>=this.mn.length||!this.Sn(this.mn[a++],e))return!1}return!0}bn(){if(this.gn)return null;let e=new Za(Di.comparator);const t=[];for(const n of this.fn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new rr(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new rr(n.field,0))}for(const n of this.mn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new rr(n.field,"asc"===n.dir?0:1)));return new er(er.UNKNOWN_ID,this.collectionId,t,or.empty())}yn(e){for(const t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(e){var t,n;if(ui(e instanceof rs||e instanceof as,20012),e instanceof rs){if(e instanceof bs){const i=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>rs.create(e.field,"==",t)))||[];return as.create(i,"or")}return e}const i=e.filters.map(e=>Sd(e));return as.create(i,e.op)}function Td(e){if(0===e.getFilters().length)return[];const t=Rd(Sd(e));return ui(Bd(t),7391),Cd(t)||Id(t)?[t]:t.getFilters()}function Cd(e){return e instanceof rs}function Id(e){return e instanceof as&&ls(e)}function Bd(e){return Cd(e)||Id(e)||function(e){if(e instanceof as&&ss(e)){for(const t of e.getFilters())if(!Cd(t)&&!Id(t))return!1;return!0}return!1}(e)}function Rd(e){if(ui(e instanceof rs||e instanceof as,34018),e instanceof rs)return e;if(1===e.filters.length)return Rd(e.filters[0]);const t=e.filters.map(e=>Rd(e));let n=as.create(t,e.op);return n=zd(n),Bd(n)?n:(ui(n instanceof as,64498),ui(os(n),40251),ui(n.filters.length>1,57927),n.filters.reduce((e,t)=>Ad(e,t)))}function Ad(e,t){let n;return ui(e instanceof rs||e instanceof as,38388),ui(t instanceof rs||t instanceof as,25473),n=e instanceof rs?t instanceof rs?(i=e,r=t,as.create([i,r],"and")):Fd(e,t):t instanceof rs?Fd(t,e):function(e,t){if(ui(e.filters.length>0&&t.filters.length>0,48005),os(e)&&os(t))return hs(e,t.getFilters());const n=ss(e)?e:t,i=ss(e)?t:e,r=n.filters.map(e=>Ad(e,i));return as.create(r,"or")}(e,t),zd(n);var i,r}function Fd(e,t){if(os(t))return hs(t,e.getFilters());{const n=t.filters.map(t=>Ad(e,t));return as.create(n,"or")}}function zd(e){if(ui(e instanceof rs||e instanceof as,11850),e instanceof rs)return e;const t=e.getFilters();if(1===t.length)return zd(t[0]);if(cs(e))return e;const n=t.map(e=>zd(e)),i=[];return n.forEach(t=>{t instanceof rs?i.push(t):t instanceof as&&(t.op===e.op?i.push(...t.filters):i.push(t))}),1===i.length?i[0]:as.create(i,e.op)
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Ed{constructor(){this.Dn=new _d}addToCollectionParentIndex(e,t){return this.Dn.add(t),mr.resolve()}getCollectionParents(e,t){return mr.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return mr.resolve()}deleteFieldIndex(e,t){return mr.resolve()}deleteAllFieldIndexes(e){return mr.resolve()}createTargetIndexes(e,t){return mr.resolve()}getDocumentsMatchingTarget(e,t){return mr.resolve(null)}getIndexType(e,t){return mr.resolve(0)}getFieldIndexes(e,t){return mr.resolve([])}getNextCollectionGroupToUpdate(e){return mr.resolve(null)}getMinOffset(e,t){return mr.resolve(cr.min())}getMinOffsetFromCollectionGroup(e,t){return mr.resolve(cr.min())}updateCollectionGroup(e,t,n){return mr.resolve()}updateIndexEntries(e,t){return mr.resolve()}}class _d{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new Za(Ni.comparator),r=!i.has(n);return this.index[t]=i.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Za(Ni.comparator)).toArray()}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="IndexedDbIndexManager",Pd=new Uint8Array(0);class Dd{constructor(e,t){this.databaseId=t,this.vn=new _d,this.Cn=new Gs(e=>Ss(e),(e,t)=>Ts(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const r={collectionId:n,parent:Nr(i)};return Wd(e).put(r)}return mr.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[zi(t),""],!1,!0);return Wd(e).j(i).next(e=>{for(const i of e){if(i.collectionId!==t)break;n.push(Wr(i.parent))}return n})}addFieldIndex(e,t){const n=Ld(e),i={indexId:(r=t).indexId,collectionGroup:r.collectionGroup,fields:r.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};var r;delete i.indexId;const a=n.add(i);if(t.indexState){const n=Od(e);return a.next(e=>{n.put(id(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const n=Ld(e),i=Od(e),r=Md(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ld(e),n=Md(e),i=Od(e);return t.Y().next(()=>n.Y()).next(()=>i.Y())}createTargetIndexes(e,t){return mr.forEach(this.Fn(t),t=>this.getIndexType(e,t).next(n=>{if(0===n||1===n){const n=new jd(t).bn();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,t){const n=Md(e);let i=!0;const r=new Map;return mr.forEach(this.Fn(t),t=>this.Mn(e,t).next(e=>{i&&(i=!!e),r.set(t,e)})).next(()=>{if(i){let e=al();const i=[];return mr.forEach(r,(r,a)=>{var o;ai(Nd,`Using index ${o=r,`id=${o.indexId}|cg=${o.collectionGroup}|f=${o.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`} to execute ${Ss(t)}`);const s=function(e,t){const n=tr(t);if(void 0===n)return null;for(const i of Is(e,n.fieldPath))switch(i.op){case"array-contains-any":return i.value.arrayValue.values||[];case"array-contains":return[i.value]}return null}(a,r),l=function(e,t){const n=new Map;for(const i of nr(t))for(const t of Is(e,i.fieldPath))switch(t.op){case"==":case"in":n.set(i.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(i.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(a,r),c=function(e,t){const n=[];let i=!0;for(const r of nr(t)){const t=0===r.kind?Bs(e,r.fieldPath,e.startAt):Rs(e,r.fieldPath,e.startAt);n.push(t.value),i&&(i=t.inclusive)}return new Xo(n,i)}(a,r),d=function(e,t){const n=[];let i=!0;for(const r of nr(t)){const t=0===r.kind?Rs(e,r.fieldPath,e.endAt):Bs(e,r.fieldPath,e.endAt);n.push(t.value),i&&(i=t.inclusive)}return new Xo(n,i)}(a,r),u=this.xn(r,a,c),h=this.xn(r,a,d),p=this.On(r,a,l),m=this.Nn(r.indexId,s,u,c.inclusive,h,d.inclusive,p);return mr.forEach(m,r=>n.H(r,t.limit).next(t=>{t.forEach(t=>{const n=Wi.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),i.push(n))})}))}).next(()=>i)}return mr.resolve(null)})}Fn(e){let t=this.Cn.get(e);return t||(t=0===e.filters.length?[e]:Td(as.create(e.filters,"and")).map(t=>js(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t),t)}Nn(e,t,n,i,r,a,o){const s=(null!=t?t.length:1)*Math.max(n.length,r.length),l=s/(null!=t?t.length:1),c=[];for(let d=0;d<s;++d){const s=t?this.Bn(t[d/l]):Pd,u=this.Ln(e,s,n[d%l],i),h=this.kn(e,s,r[d%l],a),p=o.map(t=>this.Ln(e,s,t,!0));c.push(...this.createRange(u,h,p))}return c}Ln(e,t,n,i){const r=new yd(e,Wi.empty(),t,n);return i?r:r.En()}kn(e,t,n,i){const r=new yd(e,Wi.empty(),t,n);return i?r.En():r}Mn(e,t){const n=new jd(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(e=>{let t=null;for(const i of e)n.pn(i)&&(!t||i.fields.length>t.fields.length)&&(t=i);return t})}getIndexType(e,t){let n=2;const i=this.Fn(t);return mr.forEach(i,t=>this.Mn(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new Za(Di.comparator),n=!1;for(const i of e.filters)for(const e of i.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const i of e.orderBy)i.field.isKeyField()||(t=t.add(i.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>null!==t.limit&&i.length>1&&2===n?1:n)}qn(e,t){const n=new xd;for(const i of nr(e)){const e=t.data.field(i.fieldPath);if(null==e)return null;const r=n.hn(i.kind);dd.Ut.bt(e,r)}return n.an()}Bn(e){const t=new xd;return dd.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){const n=new xd;return dd.Ut.bt(No(this.databaseId,t),n.hn(function(e){const t=nr(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.an()}On(e,t,n){if(null===n)return[];let i=[];i.push(new xd);let r=0;for(const a of nr(e)){const e=n[r++];for(const n of i)if(this.$n(t,a.fieldPath)&&Do(e))i=this.Un(i,a,e);else{const t=n.hn(a.kind);dd.Ut.bt(e,t)}}return this.Kn(i)}xn(e,t,n){return this.On(e,t,n.position)}Kn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].an();return t}Un(e,t,n){const i=[...e],r=[];for(const a of n.arrayValue.values||[])for(const e of i){const n=new xd;n.seed(e.an()),dd.Ut.bt(a,n.hn(t.kind)),r.push(n)}return r}$n(e,t){return!!e.filters.find(e=>e instanceof rs&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=Ld(e),i=Od(e);return(t?n.j(va,IDBKeyRange.bound(t,t)):n.j()).next(e=>{const t=[];return mr.forEach(e,e=>i.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new or(t.sequenceNumber,new cr(Yc(t.readTime),new Wi(Wr(t.documentKey)),t.largestBatchId)):or.empty(),i=e.fields.map(([e,t])=>new rr(Di.fromServerFormat(e),t));return new er(e.indexId,e.collectionGroup,i,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Ii(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=Ld(e),r=Od(e);return this.Wn(e).next(e=>i.j(va,IDBKeyRange.bound(t,t)).next(t=>mr.forEach(t,t=>r.put(id(t.indexId,this.uid,e,n)))))}updateIndexEntries(e,t){const n=new Map;return mr.forEach(t,(t,i)=>{const r=n.get(t.collectionGroup);return(r?mr.resolve(r):this.getFieldIndexes(e,t.collectionGroup)).next(r=>(n.set(t.collectionGroup,r),mr.forEach(r,n=>this.Gn(e,t,n).next(t=>{const r=this.zn(i,n);return t.isEqual(r)?mr.resolve():this.jn(e,i,n,t,r)}))))})}Jn(e,t,n,i){return Md(e).put(i.An(this.uid,this.Qn(n,t.key),t.key))}Hn(e,t,n,i){return Md(e).delete(i.Rn(this.uid,this.Qn(n,t.key),t.key))}Gn(e,t,n){const i=Md(e);let r=new Za(bd);return i.X({index:Ia,range:IDBKeyRange.only([n.indexId,this.uid,kd(this.Qn(n,t))])},(e,i)=>{r=r.add(new yd(n.indexId,t,wd(i.arrayValue),wd(i.directionalValue)))}).next(()=>r)}zn(e,t){let n=new Za(bd);const i=this.qn(t,e);if(null==i)return n;const r=tr(t);if(null!=r){const a=e.data.field(r.fieldPath);if(Do(a))for(const r of a.arrayValue.values||[])n=n.add(new yd(t.indexId,e.key,this.Bn(r),i))}else n=n.add(new yd(t.indexId,e.key,Pd,i));return n}jn(e,t,n,i,r){ai(Nd,"Updating index entries for document '%s'",t.key);const a=[];return function(e,t,n,i,r){const a=e.getIterator(),o=t.getIterator();let s=to(a),l=to(o);for(;s||l;){let e=!1,t=!1;if(s&&l){const i=n(s,l);i<0?t=!0:i>0&&(e=!0)}else null!=s?t=!0:e=!0;e?(i(l),l=to(o)):t?(r(s),s=to(a)):(s=to(a),l=to(o))}}(i,r,bd,i=>{a.push(this.Jn(e,t,n,i))},i=>{a.push(this.Hn(e,t,n,i))}),mr.waitFor(a)}Wn(e){let t=1;return Od(e).X({index:ja,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,i)=>{i.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>bd(e,t)).filter((e,t,n)=>!t||0!==bd(e,n[t-1]));const i=[];i.push(e);for(const a of n){const n=bd(a,e),r=bd(a,t);if(0===n)i[0]=e.En();else if(n>0&&r<0)i.push(a),i.push(a.En());else if(r>0)break}i.push(t);const r=[];for(let a=0;a<i.length;a+=2){if(this.Yn(i[a],i[a+1]))return[];const e=i[a].Rn(this.uid,Pd,Wi.empty()),t=i[a+1].Rn(this.uid,Pd,Wi.empty());r.push(IDBKeyRange.bound(e,t))}return r}Yn(e,t){return bd(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(qd)}getMinOffset(e,t){return mr.mapArray(this.Fn(t),t=>this.Mn(e,t).next(e=>e||ci(44426))).next(qd)}}function Wd(e){return Va(e,ma)}function Md(e){return Va(e,Ta)}function Ld(e){return Va(e,ba)}function Od(e){return Va(e,ka)}function qd(e){ui(0!==e.length,28825);let t=e[0].indexState.offset,n=t.largestBatchId;for(let i=1;i<e.length;i++){const r=e[i].indexState.offset;dr(r,t)<0&&(t=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new cr(t.readTime,t.documentKey,n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Hd=41943040;class Vd{static withCacheSize(e){return new Vd(e,Vd.DEFAULT_COLLECTION_PERCENTILE,Vd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(e,t,n){const i=e.store(Ur),r=e.store(Yr),a=[],o=IDBKeyRange.only(n.batchId);let s=0;const l=i.X({range:o},(e,t,n)=>(s++,n.delete()));a.push(l.next(()=>{ui(1===s,47070,{batchId:n.batchId})}));const c=[];for(const d of n.mutations){const e=Gr(t,d.key.path,n.batchId);a.push(r.delete(e)),c.push(d.key)}return mr.waitFor(a).next(()=>c)}function $d(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw ci(14731);t=e.noDocument}return JSON.stringify(t).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vd.DEFAULT_COLLECTION_PERCENTILE=10,Vd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vd.DEFAULT=new Vd(Hd,Vd.DEFAULT_COLLECTION_PERCENTILE,Vd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vd.DISABLED=new Vd(-1,0,0);class Gd{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Zn={}}static yt(e,t,n,i){ui(""!==e.uid,64387);const r=e.isAuthenticated()?e.uid:"";return new Gd(r,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Yd(e).X({index:Vr,range:n},(e,n,i)=>{t=!1,i.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const r=Jd(e),a=Yd(e);return a.add({}).next(o=>{ui("number"==typeof o,49019);const s=new Ll(o,t,n,i),l=function(e,t,n){const i=n.baseMutations.map(t=>Ac(e.gt,t)),r=n.mutations.map(t=>Ac(e.gt,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:i,mutations:r}}(this.serializer,this.userId,s),c=[];let d=new Za((e,t)=>Ii(e.canonicalString(),t.canonicalString()));for(const e of i){const t=Gr(this.userId,e.key.path,o);d=d.add(e.key.path.popLast()),c.push(a.put(l)),c.push(r.put(t,Qr))}return d.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Zn[o]=s.keys()}),mr.waitFor(c).next(()=>s)})}lookupMutationBatch(e,t){return Yd(e).get(t).next(e=>e?(ui(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),Jc(this.serializer,e)):null)}Xn(e,t){return this.Zn[t]?mr.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Zn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let r=null;return Yd(e).X({index:Vr,range:i},(e,t,i)=>{t.userId===this.userId&&(ui(t.batchId>=n,47524,{er:n}),r=Jc(this.serializer,t)),i.done()}).next(()=>r)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Ar;return Yd(e).X({index:Vr,range:t,reverse:!0},(e,t,i)=>{n=t.batchId,i.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ar],[this.userId,Number.POSITIVE_INFINITY]);return Yd(e).j(Vr,t).next(e=>e.map(e=>Jc(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=$r(this.userId,t.path),i=IDBKeyRange.lowerBound(n),r=[];return Jd(e).X({range:i},(n,i,a)=>{const[o,s,l]=n,c=Wr(s);if(o===this.userId&&t.path.isEqual(c))return Yd(e).get(l).next(e=>{if(!e)throw ci(61480,{tr:n,batchId:l});ui(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),r.push(Jc(this.serializer,e))});a.done()}).next(()=>r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Za(Ii);const i=[];return t.forEach(t=>{const r=$r(this.userId,t.path),a=IDBKeyRange.lowerBound(r),o=Jd(e).X({range:a},(e,i,r)=>{const[a,o,s]=e,l=Wr(o);a===this.userId&&t.path.isEqual(l)?n=n.add(s):r.done()});i.push(o)}),mr.waitFor(i).next(()=>this.nr(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,r=$r(this.userId,n),a=IDBKeyRange.lowerBound(r);let o=new Za(Ii);return Jd(e).X({range:a},(e,t,r)=>{const[a,s,l]=e,c=Wr(s);a===this.userId&&n.isPrefixOf(c)?c.length===i&&(o=o.add(l)):r.done()}).next(()=>this.nr(e,o))}nr(e,t){const n=[],i=[];return t.forEach(t=>{i.push(Yd(e).get(t).next(e=>{if(null===e)throw ci(35274,{batchId:t});ui(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),n.push(Jc(this.serializer,e))}))}),mr.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return Kd(e.ce,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.rr(t.batchId)}),mr.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return mr.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),i=[];return Jd(e).X({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=Wr(e[1]);i.push(t)}else n.done()}).next(()=>{ui(0===i.length,56720,{ir:i.map(e=>e.canonicalString())})})})}containsKey(e,t){return Qd(e,this.userId,t)}sr(e){return Xd(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:Ar,lastStreamToken:""})}}function Qd(e,t,n){const i=$r(t,n.path),r=i[1],a=IDBKeyRange.lowerBound(i);let o=!1;return Jd(e).X({range:a,Z:!0},(e,n,i)=>{const[a,s,l]=e;a===t&&s===r&&(o=!0),i.done()}).next(()=>o)}function Yd(e){return Va(e,Ur)}function Jd(e){return Va(e,Yr)}function Xd(e){return Va(e,qr)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Zd(0)}static ur(){return new Zd(-1)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next(t=>{const n=new Zd(t.highestTargetId);return t.highestTargetId=n.next(),this.lr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.cr(e).next(e=>Xi.fromTimestamp(new Ji(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.cr(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.cr(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.lr(e,i)))}addTargetData(e,t){return this.hr(e,t).next(()=>this.cr(e).next(n=>(n.targetCount+=1,this.Pr(t,n),this.lr(e,n))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>tu(e).delete(t.targetId)).next(()=>this.cr(e)).next(t=>(ui(t.targetCount>0,8065),t.targetCount-=1,this.lr(e,t)))}removeTargets(e,t,n){let i=0;const r=[];return tu(e).X((a,o)=>{const s=Xc(o);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,r.push(this.removeTargetData(e,s)))}).next(()=>mr.waitFor(r)).next(()=>i)}forEachTarget(e,t){return tu(e).X((e,n)=>{const i=Xc(n);t(i)})}cr(e){return nu(e).get(ha).next(e=>(ui(null!==e,2888),e))}lr(e,t){return nu(e).put(ha,t)}hr(e,t){return tu(e).put(Zc(this.serializer,t))}Pr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.cr(e).next(e=>e.targetCount)}getTargetData(e,t){const n=Ss(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let r=null;return tu(e).X({range:i,index:oa},(e,n,i)=>{const a=Xc(n);Ts(t,a.target)&&(r=a,i.done())}).next(()=>r)}addMatchingKeys(e,t,n){const i=[],r=iu(e);return t.forEach(t=>{const a=Nr(t.path);i.push(r.put({targetId:n,path:a})),i.push(this.referenceDelegate.addReference(e,n,t))}),mr.waitFor(i)}removeMatchingKeys(e,t,n){const i=iu(e);return mr.forEach(t,t=>{const r=Nr(t.path);return mr.waitFor([i.delete([n,r]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=iu(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=iu(e);let r=al();return i.X({range:n,Z:!0},(e,t,n)=>{const i=Wr(e[1]),a=new Wi(i);r=r.add(a)}).next(()=>r)}containsKey(e,t){const n=Nr(t.path),i=IDBKeyRange.bound([n],[zi(n)],!1,!0);let r=0;return iu(e).X({index:da,Z:!0,range:i},([e,t],n,i)=>{0!==e&&(r++,i.done())}).next(()=>r>0)}Et(e,t){return tu(e).get(t).next(e=>e?Xc(e):null)}}function tu(e){return Va(e,aa)}function nu(e){return Va(e,pa)}function iu(e){return Va(e,la)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru="LruGarbageCollector",au=1048576;function ou([e,t],[n,i]){const r=Ii(e,n);return 0===r?Ii(t,i):r}class su{constructor(e){this.Tr=e,this.buffer=new Za(ou),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();ou(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class lu{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(e){ai(ru,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){kr(e)?ai(ru,"Ignoring IndexedDB error during garbage collection: ",e):await pr(e)}await this.Rr(3e5)})}}class cu{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return mr.resolve(Rr.ue);const n=new su(t);return this.Vr.forEachTarget(e,e=>n.Er(e.sequenceNumber)).next(()=>this.Vr.gr(e,e=>n.Er(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ai("LruGarbageCollector","Garbage collection skipped; disabled"),mr.resolve(Ud)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ai("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ud):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,i,r,a,o,s,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(ai("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),i=this.params.maximumSequenceNumbersToCollect):i=t,a=Date.now(),this.nthSequenceNumber(e,i))).next(i=>(n=i,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(r=t,s=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),ri()<=ft.DEBUG&&ai("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-c}ms\n\tDetermined least recently used ${i} in `+(o-a)+`ms\n\tRemoved ${r} targets in `+(s-o)+`ms\n\tRemoved ${e} documents in `+(l-s)+`ms\nTotal Duration: ${l-c}ms`),mr.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:e})))}}function du(e,t){return new cu(e,t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t){this.db=e,this.garbageCollector=du(this,t)}mr(e){const t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,(e,n)=>t(n))}addReference(e,t,n){return hu(e,n)}removeReference(e,t,n){return hu(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return hu(e,t)}Sr(e,t){return function(e,t){let n=!1;return Xd(e).ee(i=>Qd(e,i,t).next(e=>(e&&(n=!0),mr.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let r=0;return this.wr(e,(a,o)=>{if(o<=t){const t=this.Sr(e,a).next(t=>{if(!t)return r++,n.getEntry(e,a).next(()=>(n.removeEntry(a,Xi.min()),iu(e).delete([0,Nr(a.path)])))});i.push(t)}}).next(()=>mr.waitFor(i)).next(()=>n.apply(e)).next(()=>r)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return hu(e,t)}wr(e,t){const n=iu(e);let i,r=Rr.ue;return n.X({index:da},([e,n],{path:a,sequenceNumber:o})=>{0===e?(r!==Rr.ue&&t(new Wi(Wr(i)),r),r=o,i=a):r=Rr.ue}).next(()=>{r!==Rr.ue&&t(new Wi(Wr(i)),r)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function hu(e,t){return iu(e).put((n=t,i=e.currentSequenceNumber,{targetId:0,path:Nr(n.path),sequenceNumber:i}));var n,i}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(){this.changes=new Gs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Jo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?mr.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return yu(e).put(n)}removeEntry(e,t,n){return yu(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Gc(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.br(e,n)))}getEntry(e,t){let n=Jo.newInvalidDocument(t);return yu(e).X({index:Zr,range:IDBKeyRange.only(bu(t))},(e,i)=>{n=this.Dr(t,i)}).next(()=>n)}vr(e,t){let n={size:0,document:Jo.newInvalidDocument(t)};return yu(e).X({index:Zr,range:IDBKeyRange.only(bu(t))},(e,i)=>{n={document:this.Dr(t,i),size:$d(i)}}).next(()=>n)}getEntries(e,t){let n=Ys();return this.Cr(e,t,(e,t)=>{const i=this.Dr(e,t);n=n.insert(e,i)}).next(()=>n)}Fr(e,t){let n=Ys(),i=new Ya(Wi.comparator);return this.Cr(e,t,(e,t)=>{const r=this.Dr(e,t);n=n.insert(e,r),i=i.insert(e,$d(t))}).next(()=>({documents:n,Mr:i}))}Cr(e,t,n){if(t.isEmpty())return mr.resolve();let i=new Za(ku);t.forEach(e=>i=i.add(e));const r=IDBKeyRange.bound(bu(i.first()),bu(i.last())),a=i.getIterator();let o=a.getNext();return yu(e).X({index:Zr,range:r},(e,t,i)=>{const r=Wi.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&ku(o,r)<0;)n(o,null),o=a.getNext();o&&o.isEqual(r)&&(n(o,t),o=a.hasNext()?a.getNext():null),o?i.G(bu(o)):i.done()}).next(()=>{for(;o;)n(o,null),o=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,r){const a=t.path,o=[a.popLast().toArray(),a.lastSegment(),Gc(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return yu(e).j(IDBKeyRange.bound(o,s,!0)).next(e=>{null==r||r.incrementDocumentReadCount(e.length);let n=Ys();for(const r of e){const e=this.Dr(Wi.fromSegments(r.prefixPath.concat(r.collectionGroup,r.documentId)),r);e.isFoundDocument()&&(Hs(t,e)||i.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,i){let r=Ys();const a=vu(t,n),o=vu(t,cr.max());return yu(e).X({index:ta,range:IDBKeyRange.bound(a,o,!0)},(e,t,n)=>{const a=this.Dr(Wi.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);r=r.insert(a.key,a),r.size===i&&n.done()}).next(()=>r)}newChangeBuffer(e){return new fu(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return xu(e).get(ra).next(e=>(ui(!!e,20021),e))}br(e,t){return xu(e).put(ra,t)}Dr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Rc(e.gt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=Wi.fromSegments(t.noDocument.path),i=Yc(t.noDocument.readTime);n=Jo.newNoDocument(e,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return ci(56709);{const e=Wi.fromSegments(t.unknownDocument.path),i=Yc(t.unknownDocument.version);n=Jo.newUnknownDocument(e,i)}}return t.readTime&&n.setReadTime(function(e){const t=new Ji(e[0],e[1]);return Xi.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(Xi.min()))return e}return Jo.newInvalidDocument(e)}}function gu(e){return new mu(e)}class fu extends pu{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new Gs(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,i=new Za((e,t)=>Ii(e.canonicalString(),t.canonicalString()));return this.changes.forEach((r,a)=>{const o=this.Nr.get(r);if(t.push(this.Or.removeEntry(e,r,o.readTime)),a.isValidDocument()){const s=$c(this.Or.serializer,a);i=i.add(r.path.popLast());const l=$d(s);n+=l-o.size,t.push(this.Or.addEntry(e,r,s))}else if(n-=o.size,this.trackRemovals){const n=$c(this.Or.serializer,a.convertToNoDocument(Xi.min()));t.push(this.Or.addEntry(e,r,n))}}),i.forEach(n=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.Or.updateMetadata(e,n)),mr.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next(e=>(this.Nr.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Or.Fr(e,t).next(({documents:e,Mr:t})=>(t.forEach((t,n)=>{this.Nr.set(t,{size:n,readTime:e.get(t).readTime})}),e))}}function xu(e){return Va(e,ia)}function yu(e){return Va(e,Jr)}function bu(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function vu(e,t){const n=t.documentKey.path.toArray();return[e,Gc(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function ku(e,t){const n=e.path.toArray(),i=t.path.toArray();let r=0;for(let a=0;a<n.length-2&&a<i.length-2;++a)if(r=Ii(n[a],i[a]),r)return r;return r=Ii(n.length,i.length),r||(r=Ii(n[n.length-2],i[i.length-2]),r||Ii(n[n.length-1],i[i.length-1])
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}class wu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Al(n.mutation,e,no.empty(),Ji.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,al()).next(()=>t))}getLocalViewOfDocuments(e,t,n=al()){const i=el();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(e=>{let t=Xs();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=el();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,al()))}populateOverlays(e,t,n){const i=[];return n.forEach(e=>{t.has(e)||i.push(e)}),this.documentOverlayCache.getOverlays(e,i).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,i){let r=Ys();const a=nl(),o=nl();return t.forEach((e,t)=>{const o=n.get(t.key);i.has(t.key)&&(void 0===o||o.mutation instanceof _l)?r=r.insert(t.key,t):void 0!==o?(a.set(t.key,o.mutation.getFieldMask()),Al(o.mutation,t,o.mutation.getFieldMask(),Ji.now())):a.set(t.key,no.empty())}),this.recalculateAndSaveOverlays(e,r).next(e=>(e.forEach((e,t)=>a.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new wu(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=nl();let i=new Ya((e,t)=>e-t),r=al();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const r of e)r.keys().forEach(e=>{const a=t.get(e);if(null===a)return;let o=n.get(e)||no.empty();o=r.applyToLocalView(a,o),n.set(e,o);const s=(i.get(r.batchId)||al()).add(e);i=i.insert(r.batchId,s)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),s=i.key,l=i.value,c=tl();l.forEach(e=>{if(!r.has(e)){const i=Bl(t.get(e),n.get(e));null!==i&&c.set(e,i),r=r.add(e)}}),a.push(this.documentOverlayCache.saveOverlays(e,s,c))}return mr.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,i){return r=t,Wi.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):_s(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i);var r}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(r=>{const a=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-r.size):mr.resolve(el());let o=Zi,s=r;return a.next(t=>mr.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(t)?mr.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{s=s.insert(t,e)}))).next(()=>this.populateOverlays(e,t,r)).next(()=>this.computeViews(e,s,t,al())).next(e=>({batchId:o,changes:Zs(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Wi(t)).next(e=>{let t=Xs();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const r=t.collectionGroup;let a=Xs();return this.indexManager.getCollectionParents(e,r).next(o=>mr.forEach(o,o=>{const s=(l=t,c=o.child(r),new As(c,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,c;return this.getDocumentsMatchingCollectionQuery(e,s,n,i).next(e=>{e.forEach((e,t)=>{a=a.insert(e,t)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(r=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,i))).next(e=>{r.forEach((t,n)=>{const i=n.getKey();null===e.get(i)&&(e=e.insert(i,Jo.newInvalidDocument(i)))});let n=Xs();return e.forEach((e,i)=>{const a=r.get(e);void 0!==a&&Al(a.mutation,i,no.empty(),Ji.now()),Hs(t,i)&&(n=n.insert(e,i))}),n})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return mr.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,{id:(n=t).id,version:n.version,createTime:yc(n.createTime)}),mr.resolve();var n}getNamedQuery(e,t){return mr.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,{name:(n=t).name,query:ed(n.bundledQuery),readTime:yc(n.readTime)}),mr.resolve();var n}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(){this.overlays=new Ya(Wi.comparator),this.kr=new Map}getOverlay(e,t){return mr.resolve(this.overlays.get(t))}getOverlays(e,t){const n=el();return mr.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,i)=>{this.wt(e,t,i)}),mr.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.kr.get(n);return void 0!==i&&(i.forEach(e=>this.overlays=this.overlays.remove(e)),this.kr.delete(n)),mr.resolve()}getOverlaysForCollection(e,t,n){const i=el(),r=t.length+1,a=new Wi(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const e=o.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===r&&e.largestBatchId>n&&i.set(e.getKey(),e)}return mr.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let r=new Ya((e,t)=>e-t);const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=r.get(e.largestBatchId);null===t&&(t=el(),r=r.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=el(),s=r.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=i)););return mr.resolve(o)}wt(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const e=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new ql(t,n));let r=this.kr.get(t);void 0===r&&(r=al(),this.kr.set(t,r)),this.kr.set(t,r.add(n.key))}}
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(){this.sessionToken=ro.EMPTY_BYTE_STRING}getSessionToken(e){return mr.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,mr.resolve()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(){this.qr=new Za(Bu.Qr),this.$r=new Za(Bu.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new Bu(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new Bu(e,t))}Gr(e,t){e.forEach(e=>this.removeReference(e,t))}zr(e){const t=new Wi(new Ni([])),n=new Bu(t,e),i=new Bu(t,e+1),r=[];return this.$r.forEachInRange([n,i],e=>{this.Wr(e),r.push(e.key)}),r}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Wi(new Ni([])),n=new Bu(t,e),i=new Bu(t,e+1);let r=al();return this.$r.forEachInRange([n,i],e=>{r=r.add(e.key)}),r}containsKey(e){const t=new Bu(e,0),n=this.qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Bu{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Wi.comparator(e.key,t.key)||Ii(e.Hr,t.Hr)}static Ur(e,t){return Ii(e.Hr,t.Hr)||Wi.comparator(e.key,t.key)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Za(Bu.Qr)}checkEmpty(e){return mr.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const r=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Ll(r,t,n,i);this.mutationQueue.push(a);for(const o of i)this.Yr=this.Yr.add(new Bu(o.key,r)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return mr.resolve(a)}lookupMutationBatch(e,t){return mr.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Xr(n),r=i<0?0:i;return mr.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return mr.resolve(0===this.mutationQueue.length?Ar:this.er-1)}getAllMutationBatches(e){return mr.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Bu(t,0),i=new Bu(t,Number.POSITIVE_INFINITY),r=[];return this.Yr.forEachInRange([n,i],e=>{const t=this.Zr(e.Hr);r.push(t)}),mr.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Za(Ii);return t.forEach(e=>{const t=new Bu(e,0),i=new Bu(e,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([t,i],e=>{n=n.add(e.Hr)})}),mr.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let r=n;Wi.isDocumentKey(r)||(r=r.child(""));const a=new Bu(new Wi(r),0);let o=new Za(Ii);return this.Yr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===i&&(o=o.add(e.Hr)),!0)},a),mr.resolve(this.ei(o))}ei(e){const t=[];return e.forEach(e=>{const n=this.Zr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){ui(0===this.ti(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return mr.forEach(t.mutations,i=>{const r=new Bu(i.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new Bu(t,0),i=this.Yr.firstAfterOrEqual(n);return mr.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,mr.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e){this.ni=e,this.docs=new Ya(Wi.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),r=i?i.size:0,a=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return mr.resolve(n?n.document.mutableCopy():Jo.newInvalidDocument(t))}getEntries(e,t){let n=Ys();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Jo.newInvalidDocument(e))}),mr.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let r=Ys();const a=t.path,o=new Wi(a.child("__id-9223372036854775808__")),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){const{key:e,value:{document:o}}=s.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||dr(lr(o),n)<=0||(i.has(o.key)||Hs(t,o))&&(r=r.insert(o.key,o.mutableCopy()))}return mr.resolve(r)}getAllFromCollectionGroup(e,t,n,i){ci(9500)}ri(e,t){return mr.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Fu(this)}getSize(e){return mr.resolve(this.size)}}class Fu extends pu{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),mr.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e){this.persistence=e,this.ii=new Gs(e=>Ss(e),Ts),this.lastRemoteSnapshotVersion=Xi.min(),this.highestTargetId=0,this.si=0,this.oi=new Iu,this.targetCount=0,this._i=Zd.ar()}forEachTarget(e,t){return this.ii.forEach((e,n)=>t(n)),mr.resolve()}getLastRemoteSnapshotVersion(e){return mr.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return mr.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),mr.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),mr.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Zd(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,mr.resolve()}updateTargetData(e,t){return this.hr(t),mr.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,mr.resolve()}removeTargets(e,t,n){let i=0;const r=[];return this.ii.forEach((a,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.ii.delete(a),r.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),mr.waitFor(r).next(()=>i)}getTargetCount(e){return mr.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return mr.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),mr.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach(t=>{r.push(i.markPotentiallyOrphaned(e,t))}),mr.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),mr.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return mr.resolve(n)}containsKey(e,t){return mr.resolve(this.oi.containsKey(t))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,t){this.ai={},this.overlays={},this.ui=new Rr(0),this.ci=!1,this.ci=!0,this.li=new Cu,this.referenceDelegate=e(this),this.hi=new zu(this),this.indexManager=new Ed,this.remoteDocumentCache=new Au(e=>this.referenceDelegate.Pi(e)),this.serializer=new Kc(t),this.Ti=new Su(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Tu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new Ru(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){ai("MemoryPersistence","Starting transaction:",e);const i=new _u(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(e=>this.referenceDelegate.di(i).next(()=>e)).toPromise().then(e=>(i.raiseOnCommittedEvent(),e))}Ei(e,t){return mr.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class _u extends hr{constructor(e){super(),this.currentSequenceNumber=e}}class Nu{constructor(e){this.persistence=e,this.Ai=new Iu,this.Ri=null}static Vi(e){return new Nu(e)}get mi(){if(this.Ri)return this.Ri;throw ci(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),mr.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),mr.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),mr.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(e=>this.mi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.mi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return mr.forEach(this.mi,n=>{const i=Wi.fromPath(n);return this.fi(e,i).next(e=>{e||t.removeEntry(i,Xi.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(e=>{e?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return mr.or([()=>mr.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Pu{constructor(e,t){this.persistence=e,this.gi=new Gs(e=>Nr(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=du(this,t)}static Vi(e,t){return new Pu(e,t)}Ii(){}di(e){return mr.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}gr(e,t){return mr.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(e=>e?mr.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.ri(e,i=>this.Sr(e,i,t).next(e=>{e||(n++,r.removeEntry(i,Xi.min()))})).next(()=>r.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),mr.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),mr.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),mr.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),mr.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_o(e.data.value)),t}Sr(e,t,n){return mr.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.gi.get(t);return mr.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e){this.serializer=e}q(e,t,n,i){const r=new fr("createOrUpgrade",t);n<1&&i>=1&&(e.createObjectStore(Lr),function(e){e.createObjectStore(qr,{keyPath:"userId"});e.createObjectStore(Ur,{keyPath:Hr,autoIncrement:!0}).createIndex(Vr,Kr,{unique:!0}),e.createObjectStore(Yr)}(e),Wu(e),function(e){e.createObjectStore(Mr)}(e));let a=mr.resolve();return n<3&&i>=3&&(0!==n&&(function(e){e.deleteObjectStore(la),e.deleteObjectStore(aa),e.deleteObjectStore(pa)}(e),Wu(e)),a=a.next(()=>function(e){const t=e.store(pa),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xi.min().toTimestamp(),targetCount:0};return t.put(ha,n)}(r))),n<4&&i>=4&&(0!==n&&(a=a.next(()=>function(e,t){return t.store(Ur).j().next(n=>{e.deleteObjectStore(Ur),e.createObjectStore(Ur,{keyPath:Hr,autoIncrement:!0}).createIndex(Vr,Kr,{unique:!0});const i=t.store(Ur),r=n.map(e=>i.put(e));return mr.waitFor(r)})}(e,r))),a=a.next(()=>{!function(e){e.createObjectStore(fa,{keyPath:"clientId"})}(e)})),n<5&&i>=5&&(a=a.next(()=>this.pi(r))),n<6&&i>=6&&(a=a.next(()=>(function(e){e.createObjectStore(ia)}(e),this.yi(r)))),n<7&&i>=7&&(a=a.next(()=>this.wi(r))),n<8&&i>=8&&(a=a.next(()=>this.Si(e,r))),n<9&&i>=9&&(a=a.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&i>=10&&(a=a.next(()=>this.bi(r))),n<11&&i>=11&&(a=a.next(()=>{!function(e){e.createObjectStore(xa,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(ya,{keyPath:"name"})}(e)})),n<12&&i>=12&&(a=a.next(()=>{!function(e){const t=e.createObjectStore(Ra,{keyPath:Aa});t.createIndex(Fa,za,{unique:!1}),t.createIndex(Ea,_a,{unique:!1})}(e)})),n<13&&i>=13&&(a=a.next(()=>function(e){const t=e.createObjectStore(Jr,{keyPath:Xr});t.createIndex(Zr,ea),t.createIndex(ta,na)}(e)).next(()=>this.Di(e,r)).next(()=>e.deleteObjectStore(Mr))),n<14&&i>=14&&(a=a.next(()=>this.Ci(e,r))),n<15&&i>=15&&(a=a.next(()=>function(e){e.createObjectStore(ba,{keyPath:"indexId",autoIncrement:!0}).createIndex(va,"collectionGroup",{unique:!1});e.createObjectStore(ka,{keyPath:wa}).createIndex(ja,Sa,{unique:!1});e.createObjectStore(Ta,{keyPath:Ca}).createIndex(Ia,Ba,{unique:!1})}(e))),n<16&&i>=16&&(a=a.next(()=>{t.objectStore(ka).clear()}).next(()=>{t.objectStore(Ta).clear()})),n<17&&i>=17&&(a=a.next(()=>{!function(e){e.createObjectStore(Na,{keyPath:"name"})}(e)})),n<18&&i>=18&&Ze()&&(a=a.next(()=>{t.objectStore(ka).clear()}).next(()=>{t.objectStore(Ta).clear()})),a}yi(e){let t=0;return e.store(Mr).X((e,n)=>{t+=$d(n)}).next(()=>{const n={byteSize:t};return e.store(ia).put(ra,n)})}pi(e){const t=e.store(qr),n=e.store(Ur);return t.j().next(t=>mr.forEach(t,t=>{const i=IDBKeyRange.bound([t.userId,Ar],[t.userId,t.lastAcknowledgedBatchId]);return n.j(Vr,i).next(n=>mr.forEach(n,n=>{ui(n.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:n.batchId});const i=Jc(this.serializer,n);return Kd(e,t.userId,i).next(()=>{})}))}))}wi(e){const t=e.store(la),n=e.store(Mr);return e.store(pa).get(ha).next(e=>{const i=[];return n.X((n,r)=>{const a=new Ni(n),o=[0,Nr(a)];i.push(t.get(o).next(n=>{return n?mr.resolve():(i=a,t.put({targetId:0,path:Nr(i),sequenceNumber:e.highestListenSequenceNumber}));var i}))}).next(()=>mr.waitFor(i))})}Si(e,t){e.createObjectStore(ma,{keyPath:ga});const n=t.store(ma),i=new _d,r=e=>{if(i.add(e)){const t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:Nr(i)})}};return t.store(Mr).X({Z:!0},(e,t)=>{const n=new Ni(e);return r(n.popLast())}).next(()=>t.store(Yr).X({Z:!0},([e,t,n],i)=>{const a=Wr(t);return r(a.popLast())}))}bi(e){const t=e.store(aa);return t.X((e,n)=>{const i=Xc(n),r=Zc(this.serializer,i);return t.put(r)})}Di(e,t){const n=t.store(Mr),i=[];return n.X((e,n)=>{const r=t.store(Jr),a=(s=n,s.document?new Wi(Ni.fromString(s.document.name).popFirst(5)):s.noDocument?Wi.fromSegments(s.noDocument.path):s.unknownDocument?Wi.fromSegments(s.unknownDocument.path):ci(36783)).path.toArray(),o={prefixPath:a.slice(0,a.length-2),collectionGroup:a[a.length-2],documentId:a[a.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};var s;i.push(r.put(o))}).next(()=>mr.waitFor(i))}Ci(e,t){const n=t.store(Ur),i=gu(this.serializer),r=new Eu(Nu.Vi,this.serializer.gt);return n.j().next(e=>{const n=new Map;return e.forEach(e=>{var t;let i=null!==(t=n.get(e.userId))&&void 0!==t?t:al();Jc(this.serializer,e).keys().forEach(e=>i=i.add(e)),n.set(e.userId,i)}),mr.forEach(n,(e,n)=>{const a=new ti(n),o=sd.yt(this.serializer,a),s=r.getIndexManager(a),l=Gd.yt(a,this.serializer,s,r.referenceDelegate);return new ju(i,l,o,s).recalculateAndSaveOverlaysForDocumentKeys(new Ha(t,Rr.ue),e).next()})})}}function Wu(e){e.createObjectStore(la,{keyPath:ca}).createIndex(da,ua,{unique:!0}),e.createObjectStore(aa,{keyPath:"targetId"}).createIndex(oa,sa,{unique:!0}),e.createObjectStore(pa)}const Mu="IndexedDbPersistence",Lu=18e5,Ou=5e3,qu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Uu="main";class Hu{constructor(e,t,n,i,r,a,o,s,l,c,d=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Fi=r,this.window=a,this.document=o,this.Mi=l,this.xi=c,this.Oi=d,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=e=>Promise.resolve(),!Hu.C())throw new mi(pi.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new uu(this,i),this.Qi=t+Uu,this.serializer=new Kc(s),this.$i=new xr(this.Qi,this.Oi,new Du(this.serializer)),this.li=new cd,this.hi=new eu(this.referenceDelegate,this.serializer),this.remoteDocumentCache=gu(this.serializer),this.Ti=new rd,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,!1===c&&oi(Mu,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new mi(pi.FAILED_PRECONDITION,qu);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hi.getHighestSequenceNumber(e))}).then(e=>{this.ui=new Rr(e,this.Mi)}).then(()=>{this.ci=!0}).catch(e=>(this.$i&&this.$i.close(),Promise.reject(e)))}ji(e){return this.qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget(async()=>{this.started&&await this.Ki()}))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ku(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ji(e).next(e=>{e||(this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Yi(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if(kr(e))return ai(Mu,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ai(Mu,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable(()=>this.qi(e)),this.isPrimary=e})}Ji(e){return Vu(e).get(Or).next(e=>mr.resolve(this.Xi(e)))}es(e){return Ku(e).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,Lu)){this.ki=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=Va(e,fa);return t.j().next(e=>{const n=this.rs(e,Lu),i=e.filter(e=>-1===n.indexOf(e));return mr.forEach(i,e=>t.delete(e.clientId)).next(()=>i)})}).catch(()=>[]);if(this.Ui)for(const t of e)this.Ui.removeItem(this.ss(t.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ki().then(()=>this.ts()).then(()=>this.zi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?mr.resolve(!0):Vu(e).get(Or).next(t=>{if(null!==t&&this.ns(t.leaseTimestampMs,Ou)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new mi(pi.FAILED_PRECONDITION,qu);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ku(e).j().next(e=>void 0===this.rs(e,Ou).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,i=this.networkEnabled===e.networkEnabled;if(t||n&&i)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&ai(Mu,`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[Lr,fa],e=>{const t=new Ha(e,Rr.ue);return this.Yi(t).next(()=>this.es(t))}),this.$i.close(),this.hs()}rs(e,t){return e.filter(e=>this.ns(e.updateTimeMs,t)&&!this._s(e.clientId))}Ps(){return this.runTransaction("getActiveClients","readonly",e=>Ku(e).j().next(e=>this.rs(e,Lu).map(e=>e.clientId)))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return Gd.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Dd(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return sd.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,n){ai(Mu,"Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",r=18===(a=this.Oi)?Ua:17===a?qa:16===a?Oa:15===a?La:14===a?Ma:13===a?Wa:12===a?Da:11===a?Pa:void ci(60245);var a;let o;return this.$i.runTransaction(e,i,r,i=>(o=new Ha(i,this.ui?this.ui.next():Rr.ue),"readwrite-primary"===t?this.Ji(o).next(e=>!!e||this.Hi(o)).next(t=>{if(!t)throw oi(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)),new mi(pi.FAILED_PRECONDITION,ur);return n(o)}).next(e=>this.Zi(o).next(()=>e)):this.Ts(o).next(()=>n(o)))).then(e=>(o.raiseOnCommittedEvent(),e))}Ts(e){return Vu(e).get(Or).next(e=>{if(null!==e&&this.ns(e.leaseTimestampMs,Ou)&&!this._s(e.ownerId)&&!this.Xi(e)&&!(this.xi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new mi(pi.FAILED_PRECONDITION,qu)})}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vu(e).put(Or,t)}static C(){return xr.C()}Yi(e){const t=Vu(e);return t.get(Or).next(e=>this.Xi(e)?(ai(Mu,"Releasing primary lease."),t.delete(Or)):mr.resolve())}ns(e,t){const n=Date.now();return!(e<n-t||e>n&&(oi(`Detected an update time that is in the future: ${e} > ${n}`),1))}Wi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bi=()=>{this.Fi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ki()))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground="visible"===this.document.visibilityState)}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ni=()=>{this.us();const e=/(?:Version|Mobile)\/1[456]/;Xe()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{const n=null!==(null===(t=this.Ui)||void 0===t?void 0:t.getItem(this.ss(e)));return ai(Mu,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return oi(Mu,"Failed to get zombied client id.",n),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(RB){oi("Failed to set zombie client id.",RB)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch(RB){}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Vu(e){return Va(e,Lr)}function Ku(e){return Va(e,fa)}function $u(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Gu{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=i}static Es(e,t){let n=al(),i=al();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Gu(e,t.fromCache,n,i)}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=Xe()?8:yr(Ye())>0?6:4}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,i){const r={result:null};return this.ps(e,t).next(e=>{r.result=e}).next(()=>{if(!r.result)return this.ys(e,t,i,n).next(e=>{r.result=e})}).next(()=>{if(r.result)return;const n=new Qu;return this.ws(e,t,n).next(i=>{if(r.result=i,this.Rs)return this.Ss(e,t,n,i.size)})}).next(()=>r.result)}Ss(e,t,n,i){return n.documentReadCount<this.Vs?(ri()<=ft.DEBUG&&ai("QueryEngine","SDK will not create cache indexes for query:",Us(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),mr.resolve()):(ri()<=ft.DEBUG&&ai("QueryEngine","Query:",Us(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(ri()<=ft.DEBUG&&ai("QueryEngine","The SDK decides to create cache indexes for query:",Us(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ps(t))):mr.resolve())}ps(e,t){if(Es(t))return mr.resolve(null);let n=Ps(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Ls(t,null,"F"),n=Ps(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const r=al(...i);return this.gs.getDocuments(e,r).next(i=>this.indexManager.getMinOffset(e,n).next(n=>{const a=this.bs(t,i);return this.Ds(t,a,r,n.readTime)?this.ps(e,Ls(t,null,"F")):this.vs(e,a,t,n)}))})))}ys(e,t,n,i){return Es(t)||i.isEqual(Xi.min())?mr.resolve(null):this.gs.getDocuments(e,n).next(r=>{const a=this.bs(t,r);return this.Ds(t,a,n,i)?mr.resolve(null):(ri()<=ft.DEBUG&&ai("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Us(t)),this.vs(e,a,t,sr(i,Zi)).next(e=>e))})}bs(e,t){let n=new Za(Ks(e));return t.forEach((t,i)=>{Hs(e,i)&&(n=n.add(i))}),n}Ds(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const r="F"===e.limitType?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}ws(e,t,n){return ri()<=ft.DEBUG&&ai("QueryEngine","Using full collection scan to execute query:",Us(t)),this.gs.getDocumentsMatchingQuery(e,t,cr.min(),n)}vs(e,t,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju="LocalStore";class Xu{constructor(e,t,n,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new Ya(Ii),this.Ms=new Gs(e=>Ss(e),Ts),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ju(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function Zu(e,t,n,i){return new Xu(e,t,n,i)}async function eh(e,t){const n=hi(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let i;return n.mutationQueue.getAllMutationBatches(e).next(r=>(i=r,n.Ns(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const r=[],a=[];let o=al();for(const e of i){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Bs:e,removedBatchIds:r,addedBatchIds:a}))})})}function th(e){const t=hi(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.hi.getLastRemoteSnapshotVersion(e))}function nh(e,t,n){let i=al(),r=al();return n.forEach(e=>i=i.add(e)),t.getEntries(e,i).next(e=>{let i=Ys();return n.forEach((n,a)=>{const o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),a.isNoDocument()&&a.version.isEqual(Xi.min())?(t.removeEntry(n,a.readTime),i=i.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),i=i.insert(n,a)):ai(Ju,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Ls:i,ks:r}})}function ih(e,t){const n=hi(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Ar),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function rh(e,t){const n=hi(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let i;return n.hi.getTargetData(e,t).next(r=>r?(i=r,mr.resolve(i)):n.hi.allocateTargetId(e).next(r=>(i=new Vc(t,r,"TargetPurposeListen",e.currentSequenceNumber),n.hi.addTargetData(e,i).next(()=>i))))}).then(e=>{const i=n.Fs.get(e.targetId);return(null===i||e.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(e.targetId,e),n.Ms.set(t,e.targetId)),e})}async function ah(e,t,n){const i=hi(e),r=i.Fs.get(t),a=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",a,e=>i.persistence.referenceDelegate.removeTarget(e,r))}catch(o){if(!kr(o))throw o;ai(Ju,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Fs=i.Fs.remove(t),i.Ms.delete(r.target)}function oh(e,t,n){const i=hi(e);let r=Xi.min(),a=al();return i.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const i=hi(e),r=i.Ms.get(n);return void 0!==r?mr.resolve(i.Fs.get(r)):i.hi.getTargetData(t,n)}(i,e,Ps(t)).next(t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{a=e})}).next(()=>i.Cs.getDocumentsMatchingQuery(e,t,n?r:Xi.min(),n?a:al())).next(e=>(ch(i,Vs(t),e),{documents:e,qs:a})))}function sh(e,t){const n=hi(e),i=hi(n.hi),r=n.Fs.get(t);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",e=>i.Et(e,t).next(e=>e?e.target:null))}function lh(e,t){const n=hi(e),i=n.xs.get(t)||Xi.min();return n.persistence.runTransaction("Get new document changes","readonly",e=>n.Os.getAllFromCollectionGroup(e,t,sr(i,Zi),Number.MAX_SAFE_INTEGER)).then(e=>(ch(n,t,e),e))}function ch(e,t,n){let i=e.xs.get(t)||Xi.min();n.forEach((e,t)=>{t.readTime.compareTo(i)>0&&(i=t.readTime)}),e.xs.set(t,i)}async function dh(e,t,n=al()){const i=await rh(e,Ps(ed(t.bundledQuery))),r=hi(e);return r.persistence.runTransaction("Save named query","readwrite",e=>{const a=yc(t.readTime);if(i.snapshotVersion.compareTo(a)>=0)return r.Ti.saveNamedQuery(e,t);const o=i.withResumeToken(ro.EMPTY_BYTE_STRING,a);return r.Fs=r.Fs.insert(o.targetId,o),r.hi.updateTargetData(e,o).next(()=>r.hi.removeMatchingKeysForTargetId(e,i.targetId)).next(()=>r.hi.addMatchingKeys(e,n,i.targetId)).next(()=>r.Ti.saveNamedQuery(e,t))})}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="firestore_clients";function hh(e,t){return`${uh}_${e}_${t}`}const ph="firestore_mutations";function mh(e,t,n){let i=`${ph}_${e}_${n}`;return t.isAuthenticated()&&(i+=`_${t.uid}`),i}const gh="firestore_targets";function fh(e,t){return`${gh}_${e}_${t}`}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh="SharedClientState";class yh{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Ks(e,t,n){const i=JSON.parse(n);let r,a="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&(a="string"==typeof i.error.message&&"string"==typeof i.error.code,a&&(r=new mi(i.error.code,i.error.message))),a?new yh(e,t,i.state,r):(oi(xh,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class bh{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ks(e,t){const n=JSON.parse(t);let i,r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code,r&&(i=new mi(n.error.code,n.error.message))),r?new bh(e,n.state,i):(oi(xh,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class vh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ks(e,t){const n=JSON.parse(t);let i="object"==typeof n&&n.activeTargetIds instanceof Array,r=sl();for(let a=0;i&&a<n.activeTargetIds.length;++a)i=Er(n.activeTargetIds[a]),r=r.add(n.activeTargetIds[a]);return i?new vh(e,r):(oi(xh,`Failed to parse client data for instance '${e}': ${t}`),null)}}class kh{constructor(e,t){this.clientId=e,this.onlineState=t}static Ks(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new kh(t.clientId,t.onlineState):(oi(xh,`Failed to parse online state: ${e}`),null)}}class wh{constructor(){this.activeTargetIds=sl()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jh{constructor(e,t,n,i,r){this.window=e,this.Fi=t,this.persistenceKey=n,this.js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Js=this.Hs.bind(this),this.Ys=new Ya(Ii),this.started=!1,this.Zs=[];const a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=r,this.Xs=hh(this.persistenceKey,this.js),this.eo=`firestore_sequence_number_${this.persistenceKey}`,this.Ys=this.Ys.insert(this.js,new wh),this.no=new RegExp(`^${uh}_${a}_([^_]*)$`),this.ro=new RegExp(`^${ph}_${a}_(\\d+)(?:_(.*))?$`),this.io=new RegExp(`^${gh}_${a}_(\\d+)$`),this.so=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.oo=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Js)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ps();for(const n of e){if(n===this.js)continue;const e=this.getItem(hh(this.persistenceKey,n));if(e){const t=vh.Ks(n,e);t&&(this.Ys=this.Ys.insert(t.clientId,t))}}this._o();const t=this.storage.getItem(this.so);if(t){const e=this.ao(t);e&&this.uo(e)}for(const n of this.Zs)this.Hs(n);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.eo,JSON.stringify(e))}getAllActiveQueryTargets(){return this.co(this.Ys)}isActiveQueryTarget(e){let t=!1;return this.Ys.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.lo(e,"pending")}updateMutationState(e,t,n){this.lo(e,t,n),this.ho(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(fh(this.persistenceKey,e));if(t){const i=bh.Ks(e,t);i&&(n=i.state)}}return t&&this.Po.Gs(e),this._o(),n}removeLocalQueryTarget(e){this.Po.zs(e),this._o()}isLocalQueryTarget(e){return this.Po.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(fh(this.persistenceKey,e))}updateQueryState(e,t,n){this.To(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.ho(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Io(e)}notifyBundleLoaded(e){this.Eo(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ai(xh,"READ",e,t),t}setItem(e,t){ai(xh,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ai(xh,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(ai(xh,"EVENT",t.key,t.newValue),t.key===this.Xs)return void oi("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fi.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.no.test(t.key)){if(null==t.newValue){const e=this.Ao(t.key);return this.Ro(e,null)}{const e=this.Vo(t.key,t.newValue);if(e)return this.Ro(e.clientId,e)}}else if(this.ro.test(t.key)){if(null!==t.newValue){const e=this.mo(t.key,t.newValue);if(e)return this.fo(e)}}else if(this.io.test(t.key)){if(null!==t.newValue){const e=this.po(t.key,t.newValue);if(e)return this.yo(e)}}else if(t.key===this.so){if(null!==t.newValue){const e=this.ao(t.newValue);if(e)return this.uo(e)}}else if(t.key===this.eo){const e=function(e){let t=Rr.ue;if(null!=e)try{const n=JSON.parse(e);ui("number"==typeof n,30636,{wo:e}),t=n}catch(n){oi(xh,"Failed to read sequence number from WebStorage",n)}return t}(t.newValue);e!==Rr.ue&&this.sequenceNumberHandler(e)}else if(t.key===this.oo){const e=this.So(t.newValue);await Promise.all(e.map(e=>this.syncEngine.bo(e)))}}else this.Zs.push(t)})}}get Po(){return this.Ys.get(this.js)}_o(){this.setItem(this.Xs,this.Po.Ws())}lo(e,t,n){const i=new yh(this.currentUser,e,t,n),r=mh(this.persistenceKey,this.currentUser,e);this.setItem(r,i.Ws())}ho(e){const t=mh(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Io(e){const t={clientId:this.js,onlineState:e};this.storage.setItem(this.so,JSON.stringify(t))}To(e,t,n){const i=fh(this.persistenceKey,e),r=new bh(e,t,n);this.setItem(i,r.Ws())}Eo(e){const t=JSON.stringify(Array.from(e));this.setItem(this.oo,t)}Ao(e){const t=this.no.exec(e);return t?t[1]:null}Vo(e,t){const n=this.Ao(e);return vh.Ks(n,t)}mo(e,t){const n=this.ro.exec(e),i=Number(n[1]),r=void 0!==n[2]?n[2]:null;return yh.Ks(new ti(r),i,t)}po(e,t){const n=this.io.exec(e),i=Number(n[1]);return bh.Ks(i,t)}ao(e){return kh.Ks(e)}So(e){return JSON.parse(e)}async fo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Do(e.batchId,e.state,e.error);ai(xh,`Ignoring mutation for non-active user ${e.user.uid}`)}yo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Ro(e,t){const n=t?this.Ys.insert(e,t):this.Ys.remove(e),i=this.co(this.Ys),r=this.co(n),a=[],o=[];return r.forEach(e=>{i.has(e)||a.push(e)}),i.forEach(e=>{r.has(e)||o.push(e)}),this.syncEngine.Co(a,o).then(()=>{this.Ys=n})}uo(e){this.Ys.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}co(e){let t=sl();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class Sh{constructor(){this.Fo=new wh,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new wh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{xo(e){}shutdown(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="ConnectivityMonitor";class Ih{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ai(Ch,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ai(Ch,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bh=null;function Rh(){return null===Bh?Bh=268435456+Math.round(2147483648*Math.random()):Bh++,"0x"+Bh.toString(16)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const Ah="RestConnection",Fh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class zh{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===yo?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,t,n,i,r){const a=Rh(),o=this.Go(e,t.toUriEncodedString());ai(Ah,`Sending RPC '${e}' ${a}:`,o,n);const s={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(s,i,r);const{host:l}=new URL(o),c=He(l);return this.jo(e,o,s,n,c).then(t=>(ai(Ah,`Received RPC '${e}' ${a}: `,t),t),t=>{throw si(Ah,`RPC '${e}' ${a} failed with error: `,t,"url: ",o,"request:",n),t})}Jo(e,t,n,i,r,a){return this.Wo(e,t,n,i,r)}zo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ni,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Go(e,t){const n=Fh[e];return`${this.$o}/v1/${t}:${n}`}terminate(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="WebChannelConnection";class Nh extends zh{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,i,r){const a=Rh();return new Promise((r,o)=>{const s=new Hn;s.setWithCredentials(!0),s.listenOnce(Kn.COMPLETE,()=>{try{switch(s.getLastErrorCode()){case $n.NO_ERROR:const t=s.getResponseJson();ai(_h,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),r(t);break;case $n.TIMEOUT:ai(_h,`RPC '${e}' ${a} timed out`),o(new mi(pi.DEADLINE_EXCEEDED,"Request time out"));break;case $n.HTTP_ERROR:const n=s.getStatus();if(ai(_h,`RPC '${e}' ${a} failed with status:`,n,"response text:",s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(pi).indexOf(t)>=0?t:pi.UNKNOWN}(t.status);o(new mi(e,t.message))}else o(new mi(pi.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new mi(pi.UNAVAILABLE,"Connection failed."));break;default:ci(9055,{c_:e,streamId:a,l_:s.getLastErrorCode(),h_:s.getLastError()})}}finally{ai(_h,`RPC '${e}' ${a} completed.`)}});const l=JSON.stringify(i);ai(_h,`RPC '${e}' ${a} sending request:`,i),s.send(t,"POST",l,n,15)})}P_(e,t,n){const i=Rh(),r=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Jn(),o=Yn(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(s.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(s.useFetchStreams=!0),this.zo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;const c=r.join("");ai(_h,`Creating RPC '${e}' stream ${i}: ${c}`,s);const d=a.createWebChannel(c,s);this.T_(d);let u=!1,h=!1;const p=new Eh({Ho:t=>{h?ai(_h,`Not sending because RPC '${e}' stream ${i} is closed:`,t):(u||(ai(_h,`Opening RPC '${e}' stream ${i} transport.`),d.open(),u=!0),ai(_h,`RPC '${e}' stream ${i} sending:`,t),d.send(t))},Yo:()=>d.close()}),m=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return m(d,Vn.EventType.OPEN,()=>{h||(ai(_h,`RPC '${e}' stream ${i} transport opened.`),p.s_())}),m(d,Vn.EventType.CLOSE,()=>{h||(h=!0,ai(_h,`RPC '${e}' stream ${i} transport closed`),p.__(),this.I_(d))}),m(d,Vn.EventType.ERROR,t=>{h||(h=!0,si(_h,`RPC '${e}' stream ${i} transport errored. Name:`,t.name,"Message:",t.message),p.__(new mi(pi.UNAVAILABLE,"The operation could not be completed")))}),m(d,Vn.EventType.MESSAGE,t=>{var n;if(!h){const r=t.data[0];ui(!!r,16349);const a=r,o=(null==a?void 0:a.error)||(null===(n=a[0])||void 0===n?void 0:n.error);if(o){ai(_h,`RPC '${e}' stream ${i} received error:`,o);const t=o.status;let n=function(e){const t=Vl[e];if(void 0!==t)return Gl(t)}(t),r=o.message;void 0===n&&(n=pi.INTERNAL,r="Unknown error status: "+t+" with message "+o.message),h=!0,p.__(new mi(n,r)),d.close()}else ai(_h,`RPC '${e}' stream ${i} received:`,r),p.a_(r)}}),m(o,Qn.STAT_EVENT,t=>{t.stat===Gn.PROXY?ai(_h,`RPC '${e}' stream ${i} detected buffering proxy`):t.stat===Gn.NOPROXY&&ai(_h,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.o_()},0),p}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(){return"undefined"!=typeof window?window:null}function Dh(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(e){return new pc(e,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,t,n=1e3,i=1.5,r=6e4){this.Fi=e,this.timerId=t,this.d_=n,this.E_=i,this.A_=r,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-n);i>0&&ai("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="PersistentStream";class Oh{constructor(e,t,n,i,r,a,o,s){this.Fi=e,this.w_=n,this.S_=i,this.connection=r,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Mh(e,t)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==e?this.F_.reset():t&&t.code===pi.RESOURCE_EXHAUSTED?(oi(t.toString()),oi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===pi.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.b_===t&&this.W_(e,n)},t=>{e(()=>{const e=new mi(pi.UNKNOWN,"Fetching auth token failed: "+t.message);return this.G_(e)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(e=>{n(()=>this.G_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.C_?this.j_(e):this.onNext(e))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return ai(Lh,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(ai(Lh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class qh extends Oh{constructor(e,t,n,i,r,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=r}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r="NO_CHANGE"===(i=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:ci(39313,{state:i}),a=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(ui(void 0===t||"string"==typeof t,58123),ro.fromBase64String(t||"")):(ui(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),ro.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,l=s&&function(e){const t=void 0===e.code?pi.UNKNOWN:Gl(e.code);return new mi(t,e.message||"")}(s);n=new ac(r,a,o,l||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const r=jc(e,i.document.name),a=yc(i.document.updateTime),o=i.document.createTime?yc(i.document.createTime):Xi.min(),s=new Qo({mapValue:{fields:i.document.fields}}),l=Jo.newFoundDocument(r,a,o,s),c=i.targetIds||[],d=i.removedTargetIds||[];n=new ic(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const r=jc(e,i.document),a=i.readTime?yc(i.readTime):Xi.min(),o=Jo.newNoDocument(r,a),s=i.removedTargetIds||[];n=new ic([],s,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const r=jc(e,i.document),a=i.removedTargetIds||[];n=new ic([],a,r,null)}else{if(!("filter"in t))return ci(11601,{At:t});{t.filter;const e=t.filter;e.targetId;const{count:i=0,unchangedNames:r}=e,a=new Hl(i,r),o=e.targetId;n=new rc(o,a)}}var i;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Xi.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Xi.min():t.readTime?yc(t.readTime):Xi.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=Cc(this.serializer),t.addTarget=function(e,t){let n;const i=t.target;if(n=Cs(i)?{documents:zc(e,i)}:{query:Ec(e,i).Vt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=fc(e,t.resumeToken);const i=mc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}else if(t.snapshotVersion.compareTo(Xi.min())>0){n.readTime=gc(e,t.snapshotVersion.toTimestamp());const i=mc(e,t.expectedCount);null!==i&&(n.expectedCount=i)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ci(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=Cc(this.serializer),t.removeTarget=e,this.k_(t)}}class Uh extends Oh{constructor(e,t,n,i,r,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=r}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ui(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ui(!e.writeResults||0===e.writeResults.length,55816),this.listener.ea()}onNext(e){ui(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=function(e,t){return e&&e.length>0?(ui(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?yc(e.updateTime):yc(t);return n.isEqual(Xi.min())&&(n=yc(t)),new Sl(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=yc(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=Cc(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Ac(this.serializer,e))};this.k_(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{}class Vh extends Hh{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new mi(pi.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,a])=>this.connection.Wo(e,vc(t,n),i,r,a)).catch(e=>{throw"FirebaseError"===e.name?(e.code===pi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new mi(pi.UNKNOWN,e.toString())})}Jo(e,t,n,i,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Jo(e,vc(t,n),i,a,o,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===pi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new mi(pi.UNKNOWN,e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Kh{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,"Online"===e&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(oi(t),this._a=!1):ai("OnlineStateTracker",t)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h="RemoteStore";class Gh{constructor(e,t,n,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=r,this.Ea.xo(e=>{n.enqueueAndForget(async()=>{ip(this)&&(ai($h,"Restarting streams for network reachability change."),await async function(e){const t=hi(e);t.Ia.add(4),await Yh(t),t.Aa.set("Unknown"),t.Ia.delete(4),await Qh(t)}(this))})}),this.Aa=new Kh(n,i)}}async function Qh(e){if(ip(e))for(const t of e.da)await t(!0)}async function Yh(e){for(const t of e.da)await t(!1)}function Jh(e,t){const n=hi(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),np(n)?tp(n):wp(n).x_()&&Zh(n,t))}function Xh(e,t){const n=hi(e),i=wp(n);n.Ta.delete(t),i.x_()&&ep(n,t),0===n.Ta.size&&(i.x_()?i.B_():ip(n)&&n.Aa.set("Unknown"))}function Zh(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Xi.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}wp(e).H_(t)}function ep(e,t){e.Ra.$e(t),wp(e).Y_(t)}function tp(e){e.Ra=new sc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),wp(e).start(),e.Aa.aa()}function np(e){return ip(e)&&!wp(e).M_()&&e.Ta.size>0}function ip(e){return 0===hi(e).Ia.size}function rp(e){e.Ra=void 0}async function ap(e){e.Aa.set("Online")}async function op(e){e.Ta.forEach((t,n)=>{Zh(e,t)})}async function sp(e,t){rp(e),np(e)?(e.Aa.la(t),tp(e)):e.Aa.set("Unknown")}async function lp(e,t,n){if(e.Aa.set("Online"),t instanceof ac&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const i of t.targetIds)e.Ta.has(i)&&(await e.remoteSyncer.rejectListen(i,n),e.Ta.delete(i),e.Ra.removeTarget(i))}(e,t)}catch(i){ai($h,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await cp(e,i)}else if(t instanceof ic?e.Ra.Ye(t):t instanceof rc?e.Ra.it(t):e.Ra.et(t),!n.isEqual(Xi.min()))try{const t=await th(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ra.Pt(t);return n.targetChanges.forEach((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=e.Ta.get(i);r&&e.Ta.set(i,r.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const i=e.Ta.get(t);if(!i)return;e.Ta.set(t,i.withResumeToken(ro.EMPTY_BYTE_STRING,i.snapshotVersion)),ep(e,t);const r=new Vc(i.target,t,n,i.sequenceNumber);Zh(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(r){ai($h,"Failed to raise snapshot:",r),await cp(e,r)}}async function cp(e,t,n){if(!kr(t))throw t;e.Ia.add(1),await Yh(e),e.Aa.set("Offline"),n||(n=()=>th(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{ai($h,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await Qh(e)})}function dp(e,t){return t().catch(n=>cp(e,n,t))}async function up(e){const t=hi(e),n=jp(t);let i=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Ar;for(;hp(t);)try{const e=await ih(t.localStore,i);if(null===e){0===t.Pa.length&&n.B_();break}i=e.batchId,pp(t,e)}catch(r){await cp(t,r)}mp(t)&&gp(t)}function hp(e){return ip(e)&&e.Pa.length<10}function pp(e,t){e.Pa.push(t);const n=jp(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function mp(e){return ip(e)&&!jp(e).M_()&&e.Pa.length>0}function gp(e){jp(e).start()}async function fp(e){jp(e).na()}async function xp(e){const t=jp(e);for(const n of e.Pa)t.X_(n.mutations)}async function yp(e,t,n){const i=e.Pa.shift(),r=Ol.from(i,t,n);await dp(e,()=>e.remoteSyncer.applySuccessfulWrite(r)),await up(e)}async function bp(e,t){t&&jp(e).Z_&&await async function(e,t){if($l(n=t.code)&&n!==pi.ABORTED){const n=e.Pa.shift();jp(e).N_(),await dp(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await up(e)}var n}(e,t),mp(e)&&gp(e)}async function vp(e,t){const n=hi(e);n.asyncQueue.verifyOperationInProgress(),ai($h,"RemoteStore received new credentials");const i=ip(n);n.Ia.add(3),await Yh(n),i&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await Qh(n)}async function kp(e,t){const n=hi(e);t?(n.Ia.delete(2),await Qh(n)):t||(n.Ia.add(2),await Yh(n),n.Aa.set("Unknown"))}function wp(e){return e.Va||(e.Va=function(e,t,n){const i=hi(e);return i.ia(),new qh(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Zo:ap.bind(null,e),e_:op.bind(null,e),n_:sp.bind(null,e),J_:lp.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),np(e)?tp(e):e.Aa.set("Unknown")):(await e.Va.stop(),rp(e))})),e.Va}function jp(e){return e.ma||(e.ma=function(e,t,n){const i=hi(e);return i.ia(),new Uh(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:fp.bind(null,e),n_:bp.bind(null,e),ea:xp.bind(null,e),ta:yp.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await up(e)):(await e.ma.stop(),e.Pa.length>0&&(ai($h,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Sp{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,r){const a=Date.now()+n,o=new Sp(e,t,a,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new mi(pi.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tp(e,t){if(oi("AsyncQueue",`${t}: ${e}`),kr(e))return new mi(pi.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{static emptySet(e){return new Cp(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Wi.comparator(t.key,n.key):(e,t)=>Wi.comparator(e.key,t.key),this.keyedMap=Xs(),this.sortedSet=new Ya(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Cp))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(!e.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Cp;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(){this.fa=new Ya(Wi.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?0!==e.type&&3===n.type?this.fa=this.fa.insert(t,e):3===e.type&&1!==n.type?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.fa=this.fa.remove(t):1===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):ci(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class Bp{constructor(e,t,n,i,r,a,o,s,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,r){const a=[];return t.forEach(e=>{a.push({type:0,doc:e})}),new Bp(e,t,Cp.emptySet(t),a,n,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Os(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class Ap{constructor(){this.queries=Fp(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(e,t){const n=hi(e),i=n.queries;n.queries=Fp(),i.forEach((e,n)=>{for(const i of n.wa)i.onError(t)})}(this,new mi(pi.ABORTED,"Firestore shutting down"))}}function Fp(){return new Gs(e=>qs(e),Os)}async function zp(e,t){const n=hi(e);let i=3;const r=t.query;let a=n.queries.get(r);a?!a.Sa()&&t.ba()&&(i=2):(a=new Rp,i=t.ba()?0:1);try{switch(i){case 0:a.ya=await n.onListen(r,!0);break;case 1:a.ya=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const e=Tp(o,`Initialization of query '${Us(t.query)}' failed`);return void t.onError(e)}n.queries.set(r,a),a.wa.push(t),t.va(n.onlineState),a.ya&&t.Ca(a.ya)&&Pp(n)}async function Ep(e,t){const n=hi(e),i=t.query;let r=3;const a=n.queries.get(i);if(a){const e=a.wa.indexOf(t);e>=0&&(a.wa.splice(e,1),0===a.wa.length?r=t.ba()?0:1:!a.Sa()&&t.ba()&&(r=2))}switch(r){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function _p(e,t){const n=hi(e);let i=!1;for(const r of t){const e=r.query,t=n.queries.get(e);if(t){for(const e of t.wa)e.Ca(r)&&(i=!0);t.ya=r}}i&&Pp(n)}function Np(e,t,n){const i=hi(e),r=i.queries.get(t);if(r)for(const a of r.wa)a.onError(n);i.queries.delete(t)}function Pp(e){e.Da.forEach(e=>{e.next()})}var Dp,Wp;(Wp=Dp||(Dp={})).Fa="default",Wp.Cache="cache";class Mp{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Bp(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==t;return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}La(e){e=Bp.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Dp.Cache}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,t){this.qa=e,this.byteLength=t}Qa(){return"metadata"in this.qa}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e){this.serializer=e}Qs(e){return jc(this.serializer,e)}$s(e){return e.metadata.exists?Rc(this.serializer,e.document,!1):Jo.newNoDocument(this.Qs(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return yc(e)}}class qp{constructor(e,t){this.$a=e,this.serializer=t,this.Ua=[],this.Ka=[],this.collectionGroups=new Set,this.progress=Up(e)}get queries(){return this.Ua}get documents(){return this.Ka}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Ua.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Ka.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const n=Ni.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.qa.document&&(this.Ka[this.Ka.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){const t=new Map,n=new Op(this.serializer);for(const i of e)if(i.metadata.queries){const e=n.Qs(i.metadata.name);for(const n of i.metadata.queries){const i=(t.get(n)||al()).add(e);t.set(n,i)}}return t}async za(e){const t=await async function(e,t,n,i){const r=hi(e);let a=al(),o=Ys();for(const d of n){const e=t.Qs(d.metadata.name);d.document&&(a=a.add(e));const n=t.$s(d);n.setReadTime(t.Us(d.metadata.readTime)),o=o.insert(e,n)}const s=r.Os.newChangeBuffer({trackRemovals:!0}),l=await rh(r,(c=i,Ps(zs(Ni.fromString(`__bundle__/docs/${c}`)))));var c;return r.persistence.runTransaction("Apply bundle documents","readwrite",e=>nh(e,s,o).next(t=>(s.apply(e),t)).next(t=>r.hi.removeMatchingKeysForTargetId(e,l.targetId).next(()=>r.hi.addMatchingKeys(e,a,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,t.Ls,t.ks)).next(()=>t.Ls)))}(e,new Op(this.serializer),this.Ka,this.$a.id),n=this.Ga(this.documents);for(const i of this.Ua)await dh(e,i,n.get(i.name));return this.progress.taskState="Success",{progress:this.progress,ja:this.collectionGroups,Ja:t}}}function Up(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e){this.key=e}}class Vp{constructor(e){this.key=e}}class Kp{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=al(),this.mutatedKeys=al(),this.Xa=Ks(e),this.eu=new Cp(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new Ip,i=t?t.eu:this.eu;let r=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((e,t)=>{const c=i.get(e),d=Hs(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let p=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(n.track({type:3,doc:d}),p=!0):this.iu(c,d)||(n.track({type:2,doc:d}),p=!0,(s&&this.Xa(d,s)>0||l&&this.Xa(d,l)<0)&&(o=!0)):!c&&d?(n.track({type:0,doc:d}),p=!0):c&&!d&&(n.track({type:1,doc:c}),p=!0,(s||l)&&(o=!0)),p&&(d?(a=a.add(d),r=h?r.add(e):r.delete(e)):(a=a.delete(e),r=r.delete(e)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),r=r.delete(e.key),n.track({type:1,doc:e})}return{eu:a,ru:n,Ds:o,mutatedKeys:r}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const r=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const a=e.ru.pa();a.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ci(20277,{At:e})}};return n(e)-n(t)}(e.type,t.type)||this.Xa(e.doc,t.doc)),this.su(n),i=null!=i&&i;const o=t&&!i?this.ou():[],s=0===this.Za.size&&this.current&&!i?1:0,l=s!==this.Ya;return this.Ya=s,0!==a.length||l?{snapshot:new Bp(this.query,e.eu,r,a,e.mutatedKeys,0===s,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Ip,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=al(),this.eu.forEach(e=>{this.au(e.key)&&(this.Za=this.Za.add(e.key))});const t=[];return e.forEach(e=>{this.Za.has(e)||t.push(new Vp(e))}),this.Za.forEach(n=>{e.has(n)||t.push(new Hp(n))}),t}uu(e){this.Ha=e.qs,this.Za=al();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Bp.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const $p="SyncEngine";class Gp{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Qp{constructor(e){this.key=e,this.lu=!1}}class Yp{constructor(e,t,n,i,r,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new Gs(e=>qs(e),Os),this.Tu=new Map,this.Iu=new Set,this.du=new Ya(Wi.comparator),this.Eu=new Map,this.Au=new Iu,this.Ru={},this.Vu=new Map,this.mu=Zd.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function Jp(e,t,n=!0){const i=Cm(e);let r;const a=i.Pu.get(t);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),r=a.view.cu()):r=await Zp(i,t,n,!0),r}async function Xp(e,t){const n=Cm(e);await Zp(n,t,!0,!1)}async function Zp(e,t,n,i){const r=await rh(e.localStore,Ps(t)),a=r.targetId,o=e.sharedClientState.addLocalQueryTarget(a,n);let s;return i&&(s=await em(e,t,a,"current"===o,r.resumeToken)),e.isPrimaryClient&&n&&Jh(e.remoteStore,r),s}async function em(e,t,n,i,r){e.gu=(t,n,i)=>async function(e,t,n,i){let r=t.view.nu(n);r.Ds&&(r=await oh(e.localStore,t.query,!1).then(({documents:e})=>t.view.nu(e,r)));const a=i&&i.targetChanges.get(t.targetId),o=i&&null!=i.targetMismatches.get(t.targetId),s=t.view.applyChanges(r,e.isPrimaryClient,a,o);return hm(e,t.targetId,s._u),s.snapshot}(e,t,n,i);const a=await oh(e.localStore,t,!0),o=new Kp(t,a.qs),s=o.nu(a.documents),l=nc.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==e.onlineState,r),c=o.applyChanges(s,e.isPrimaryClient,l);hm(e,n,c._u);const d=new Gp(t,n,o);return e.Pu.set(t,d),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function tm(e,t,n){const i=hi(e),r=i.Pu.get(t),a=i.Tu.get(r.targetId);if(a.length>1)return i.Tu.set(r.targetId,a.filter(e=>!Os(e,t))),void i.Pu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await ah(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),n&&Xh(i.remoteStore,r.targetId),dm(i,r.targetId)}).catch(pr)):(dm(i,r.targetId),await ah(i.localStore,r.targetId,!0))}async function nm(e,t){const n=hi(e),i=n.Pu.get(t),r=n.Tu.get(i.targetId);n.isPrimaryClient&&1===r.length&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Xh(n.remoteStore,i.targetId))}async function im(e,t){const n=hi(e);try{const e=await function(e,t){const n=hi(e),i=t.snapshotVersion;let r=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const a=n.Os.newChangeBuffer({trackRemovals:!0});r=n.Fs;const o=[];t.targetChanges.forEach((a,s)=>{const l=r.get(s);if(!l)return;o.push(n.hi.removeMatchingKeys(e,a.removedDocuments,s).next(()=>n.hi.addMatchingKeys(e,a.addedDocuments,s)));let c=l.withSequenceNumber(e.currentSequenceNumber);var d,u,h;null!==t.targetMismatches.get(s)?c=c.withResumeToken(ro.EMPTY_BYTE_STRING,Xi.min()).withLastLimboFreeSnapshotVersion(Xi.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,i)),r=r.insert(s,c),u=c,h=a,(0===(d=l).resumeToken.approximateByteSize()||u.snapshotVersion.toMicroseconds()-d.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.hi.updateTargetData(e,c))});let s=Ys(),l=al();if(t.documentUpdates.forEach(i=>{t.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,i))}),o.push(nh(e,a,t.documentUpdates).next(e=>{s=e.Ls,l=e.ks})),!i.isEqual(Xi.min())){const t=n.hi.getLastRemoteSnapshotVersion(e).next(t=>n.hi.setTargetsMetadata(e,e.currentSequenceNumber,i));o.push(t)}return mr.waitFor(o).next(()=>a.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,s,l)).next(()=>s)}).then(e=>(n.Fs=r,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const i=n.Eu.get(t);i&&(ui(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?i.lu=!0:e.modifiedDocuments.size>0?ui(i.lu,14607):e.removedDocuments.size>0&&(ui(i.lu,42227),i.lu=!1))}),await gm(n,e,t)}catch(i){await pr(i)}}function rm(e,t,n){const i=hi(e);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const e=[];i.Pu.forEach((n,i)=>{const r=i.view.va(t);r.snapshot&&e.push(r.snapshot)}),function(e,t){const n=hi(e);n.onlineState=t;let i=!1;n.queries.forEach((e,n)=>{for(const r of n.wa)r.va(t)&&(i=!0)}),i&&Pp(n)}(i.eventManager,t),e.length&&i.hu.J_(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function am(e,t,n){const i=hi(e);i.sharedClientState.updateQueryState(t,"rejected",n);const r=i.Eu.get(t),a=r&&r.key;if(a){let e=new Ya(Wi.comparator);e=e.insert(a,Jo.newNoDocument(a,Xi.min()));const n=al().add(a),r=new tc(Xi.min(),new Map,new Ya(Ii),e,n);await im(i,r),i.du=i.du.remove(a),i.Eu.delete(t),mm(i)}else await ah(i.localStore,t,!1).then(()=>dm(i,t,n)).catch(pr)}async function om(e,t){const n=hi(e),i=t.batch.batchId;try{const e=await function(e,t){const n=hi(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const i=t.batch.keys(),r=n.Os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,i){const r=n.batch,a=r.keys();let o=mr.resolve();return a.forEach(e=>{o=o.next(()=>i.getEntry(t,e)).next(t=>{const a=n.docVersions.get(e);ui(null!==a,48541),t.version.compareTo(a)<0&&(r.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),i.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,r))}(n,e,t,r).next(()=>r.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=al();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,i))})}(n.localStore,t);cm(n,i,null),lm(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await gm(n,e)}catch(r){await pr(r)}}async function sm(e,t,n){const i=hi(e);try{const e=await function(e,t){const n=hi(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let i;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(ui(null!==t,37113),i=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,i,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i)).next(()=>n.localDocuments.getDocuments(e,i))})}(i.localStore,t);cm(i,t,n),lm(i,t),i.sharedClientState.updateMutationState(t,"rejected",n),await gm(i,e)}catch(r){await pr(r)}}function lm(e,t){(e.Vu.get(t)||[]).forEach(e=>{e.resolve()}),e.Vu.delete(t)}function cm(e,t,n){const i=hi(e);let r=i.Ru[i.currentUser.toKey()];if(r){const e=r.get(t);e&&(n?e.reject(n):e.resolve(),r=r.remove(t)),i.Ru[i.currentUser.toKey()]=r}}function dm(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Tu.get(t))e.Pu.delete(i),n&&e.hu.pu(i,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(t=>{e.Au.containsKey(t)||um(e,t)})}function um(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Xh(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),mm(e))}function hm(e,t,n){for(const i of n)i instanceof Hp?(e.Au.addReference(i.key,t),pm(e,i)):i instanceof Vp?(ai($p,"Document no longer in limbo: "+i.key),e.Au.removeReference(i.key,t),e.Au.containsKey(i.key)||um(e,i.key)):ci(19791,{yu:i})}function pm(e,t){const n=t.key,i=n.path.canonicalString();e.du.get(n)||e.Iu.has(i)||(ai($p,"New document in limbo: "+n),e.Iu.add(i),mm(e))}function mm(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new Wi(Ni.fromString(t)),i=e.mu.next();e.Eu.set(i,new Qp(n)),e.du=e.du.insert(n,i),Jh(e.remoteStore,new Vc(Ps(zs(n.path)),i,"TargetPurposeLimboResolution",Rr.ue))}}async function gm(e,t,n){const i=hi(e),r=[],a=[],o=[];i.Pu.isEmpty()||(i.Pu.forEach((e,s)=>{o.push(i.gu(s,t,n).then(e=>{var t;if((e||n)&&i.isPrimaryClient){const r=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(s.targetId))||void 0===t?void 0:t.current;i.sharedClientState.updateQueryState(s.targetId,r?"current":"not-current")}if(e){r.push(e);const t=Gu.Es(s.targetId,e);a.push(t)}}))}),await Promise.all(o),i.hu.J_(r),await async function(e,t){const n=hi(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>mr.forEach(t,t=>mr.forEach(t.Is,i=>n.persistence.referenceDelegate.addReference(e,t.targetId,i)).next(()=>mr.forEach(t.ds,i=>n.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))}catch(i){if(!kr(i))throw i;ai(Ju,"Failed to update sequence numbers: "+i)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Fs.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Fs=n.Fs.insert(e,r)}}}(i.localStore,a))}async function fm(e,t){const n=hi(e);if(!n.currentUser.isEqual(t)){ai($p,"User change. New user:",t.toKey());const e=await eh(n.localStore,t);n.currentUser=t,r="'waitForPendingWrites' promise is rejected due to a user change.",(i=n).Vu.forEach(e=>{e.forEach(e=>{e.reject(new mi(pi.CANCELLED,r))})}),i.Vu.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await gm(n,e.Bs)}var i,r}function xm(e,t){const n=hi(e),i=n.Eu.get(t);if(i&&i.lu)return al().add(i.key);{let e=al();const i=n.Tu.get(t);if(!i)return e;for(const t of i){const i=n.Pu.get(t);e=e.unionWith(i.view.tu)}return e}}async function ym(e,t){const n=hi(e),i=await oh(n.localStore,t.query,!0),r=t.view.uu(i);return n.isPrimaryClient&&hm(n,t.targetId,r._u),r}async function bm(e,t){const n=hi(e);return lh(n.localStore,t).then(e=>gm(n,e))}async function vm(e,t,n,i){const r=hi(e),a=await function(e,t){const n=hi(e),i=hi(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>i.Xn(e,t).next(t=>t?n.localDocuments.getDocuments(e,t):mr.resolve(null)))}(r.localStore,t);var o,s;null!==a?("pending"===n?await up(r.remoteStore):"acknowledged"===n||"rejected"===n?(cm(r,t,i||null),lm(r,t),o=r.localStore,s=t,hi(hi(o).mutationQueue).rr(s)):ci(6720,"Unknown batchState",{wu:n}),await gm(r,a)):ai($p,"Cannot apply mutation batch with id: "+t)}async function km(e,t,n){const i=hi(e),r=[],a=[];for(const o of t){let e;const t=i.Tu.get(o);if(t&&0!==t.length){e=await rh(i.localStore,Ps(t[0]));for(const e of t){const t=i.Pu.get(e),n=await ym(i,t);n.snapshot&&a.push(n.snapshot)}}else{const t=await sh(i.localStore,o);e=await rh(i.localStore,t),await em(i,wm(t),o,!1,e.resumeToken)}r.push(e)}return i.hu.J_(a),r}function wm(e){return Fs(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function jm(e){return t=hi(e).localStore,hi(hi(t).persistence).Ps();var t}async function Sm(e,t,n,i){const r=hi(e);if(r.fu)return void ai($p,"Ignoring unexpected query state notification.");const a=r.Tu.get(t);if(a&&a.length>0)switch(n){case"current":case"not-current":{const e=await lh(r.localStore,Vs(a[0])),i=tc.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,ro.EMPTY_BYTE_STRING);await gm(r,e,i);break}case"rejected":await ah(r.localStore,t,!0),dm(r,t,i);break;default:ci(64155,n)}}async function Tm(e,t,n){const i=Cm(e);if(i.fu){for(const e of t){if(i.Tu.has(e)&&i.sharedClientState.isActiveQueryTarget(e)){ai($p,"Adding an already active target "+e);continue}const t=await sh(i.localStore,e),n=await rh(i.localStore,t);await em(i,wm(t),n.targetId,!1,n.resumeToken),Jh(i.remoteStore,n)}for(const e of n)i.Tu.has(e)&&await ah(i.localStore,e,!1).then(()=>{Xh(i.remoteStore,e),dm(i,e)}).catch(pr)}}function Cm(e){const t=hi(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=im.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=xm.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=am.bind(null,t),t.hu.J_=_p.bind(null,t.eventManager),t.hu.pu=Np.bind(null,t.eventManager),t}function Im(e){const t=hi(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=om.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=sm.bind(null,t),t}class Bm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return Zu(this.persistence,new Yu,e.initialUser,this.serializer)}Du(e){return new Eu(Nu.Vi,this.serializer)}bu(e){return new Sh}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bm.provider={build:()=>new Bm};class Rm extends Bm{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ui(this.persistence.referenceDelegate instanceof Pu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new lu(n,e.asyncQueue,t)}Du(e){const t=void 0!==this.cacheSizeBytes?Vd.withCacheSize(this.cacheSizeBytes):Vd.DEFAULT;return new Eu(e=>Pu.Vi(e,t),this.serializer)}}class Am extends Bm{constructor(e,t,n){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await Im(this.Mu.syncEngine),await up(this.Mu.remoteStore),await this.persistence.ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return Zu(this.persistence,new Yu,e.initialUser,this.serializer)}Cu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new lu(n,e.asyncQueue,t)}Fu(e,t){const n=new Br(t,this.persistence);return new Ir(e.asyncQueue,n)}Du(e){const t=$u(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Vd.withCacheSize(this.cacheSizeBytes):Vd.DEFAULT;return new Hu(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Ph(),Dh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new Sh}}class Fm extends Am{constructor(e,t){super(e,t,!1),this.Mu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Mu.syncEngine;this.sharedClientState instanceof jh&&(this.sharedClientState.syncEngine={Do:vm.bind(null,t),vo:Sm.bind(null,t),Co:Tm.bind(null,t),Ps:jm.bind(null,t),bo:bm.bind(null,t)},await this.sharedClientState.start()),await this.persistence.ji(async e=>{await async function(e,t){const n=hi(e);if(Cm(n),Im(n),!0===t&&!0!==n.fu){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await km(n,e.toArray());n.fu=!0,await kp(n.remoteStore,!0);for(const i of t)Jh(n.remoteStore,i)}else if(!1===t&&!1!==n.fu){const e=[];let t=Promise.resolve();n.Tu.forEach((i,r)=>{n.sharedClientState.isLocalQueryTarget(r)?e.push(r):t=t.then(()=>(dm(n,r),ah(n.localStore,r,!0))),Xh(n.remoteStore,r)}),await t,await km(n,e),function(e){const t=hi(e);t.Eu.forEach((e,n)=>{Xh(t.remoteStore,n)}),t.Au.jr(),t.Eu=new Map,t.du=new Ya(Wi.comparator)}(n),n.fu=!1,await kp(n.remoteStore,!1)}}(this.Mu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}bu(e){const t=Ph();if(!jh.C(t))throw new mi(pi.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=$u(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new jh(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class zm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>rm(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=fm.bind(null,this.syncEngine),await kp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ap}createDatastore(e){const t=Wh(e.databaseInfo.databaseId),n=(i=e.databaseInfo,new Nh(i));var i;return function(e,t,n,i){return new Vh(e,t,n,i)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,r=e=>rm(this.syncEngine,e,0),a=Ih.C()?new Ih:new Th,new Gh(t,n,i,r,a);var t,n,i,r,a}createSyncEngine(e,t){return function(e,t,n,i,r,a,o){const s=new Yp(e,t,n,i,r,a);return o&&(s.fu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=hi(e);ai($h,"RemoteStore shutting down."),t.Ia.add(5),await Yh(t),t.Ea.shutdown(),t.Aa.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}function Em(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const i={value:e.slice(n,n+t),done:!1};return n+=t,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zm.provider={build:()=>new zm};class _m{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):oi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,t){this.Nu=e,this.serializer=t,this.metadata=new gi,this.buffer=new Uint8Array,this.Bu=new TextDecoder("utf-8"),this.Lu().then(e=>{e&&e.Qa()?this.metadata.resolve(e.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.qa)}`))},e=>this.metadata.reject(e))}close(){return this.Nu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.Lu()}async Lu(){const e=await this.ku();if(null===e)return null;const t=this.Bu.decode(e),n=Number(t);isNaN(n)&&this.qu(`length string (${t}) is not valid number`);const i=await this.Qu(n);return new Lp(JSON.parse(i),e.length+n)}$u(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async ku(){for(;this.$u()<0&&!(await this.Uu()););if(0===this.buffer.length)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Qu(e){for(;this.buffer.length<e;)await this.Uu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Bu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Nu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Uu(){const e=await this.Nu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}
/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let n=this.Su();if(!n||!n.Qa())throw new Error(`The first element of the bundle is not a metadata object, it is\n         ${JSON.stringify(null==n?void 0:n.qa)}`);this.metadata=n;do{n=this.Su(),null!==n&&this.elements.push(n)}while(null!==n)}getMetadata(){return this.metadata}Ku(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;const e=this.ku(),t=this.Qu(e);return new Lp(JSON.parse(t),e)}Qu(e){if(this.cursor+e>this.bundleData.length)throw new mi(pi.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}ku(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if("{"===this.bundleData[t]){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new mi(pi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=hi(e),i={documents:t.map(e=>wc(n.serializer,e))},r=await n.Jo("BatchGetDocuments",n.serializer.databaseId,Ni.emptyPath(),i,t.length),a=new Map;r.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){ui(!!t.found,43571),t.found.name,t.found.updateTime;const n=jc(e,t.found.name),i=yc(t.found.updateTime),r=t.found.createTime?yc(t.found.createTime):Xi.min(),a=new Qo({mapValue:{fields:t.found.fields}});return Jo.newFoundDocument(n,i,r,a)}(e,t):"missing"in t?function(e,t){ui(!!t.missing,3894),ui(!!t.readTime,22933);const n=jc(e,t.missing),i=yc(t.readTime);return Jo.newNoDocument(n,i)}(e,t):ci(7234,{result:t})}(n.serializer,e);a.set(t.key.toString(),t)});const o=[];return t.forEach(e=>{const t=a.get(e.toString());ui(!!t,55234,{key:e}),o.push(t)}),o}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Wl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=Wi.fromPath(t);this.mutations.push(new Ml(n,this.precondition(n)))}),await async function(e,t){const n=hi(e),i={writes:t.map(e=>Ac(n.serializer,e))};await n.Wo("Commit",n.serializer.databaseId,Ni.emptyPath(),i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ci(50498,{Wu:e.constructor.name});t=Xi.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new mi(pi.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Xi.min())?Tl.exists(!1):Tl.updateTime(t):Tl.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Xi.min()))throw new mi(pi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Tl.updateTime(t)}return Tl.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e,t,n,i,r){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=r,this.Gu=n.maxAttempts,this.F_=new Mh(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(async()=>{const e=new Dm(this.datastore),t=this.Ju(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Hu(e)}))}).catch(e=>{this.Hu(e)})})}Ju(e){try{const t=this.updateFunction(e);return!Fr(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!$l(t)}return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm="FirestoreClient";class Lm{constructor(e,t,n,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=ti.UNAUTHENTICATED,this.clientId=Ci.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,async e=>{ai(Mm,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(ai(Mm,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Tp(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Om(e,t){e.asyncQueue.verifyOperationInProgress(),ai(Mm,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let i=n.initialUser;e.setCredentialChangeListener(async e=>{i.isEqual(e)||(await eh(t.localStore,e),i=e)}),t.persistence.setDatabaseDeletedListener(()=>{si("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{ai("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(e=>{si("Terminating Firestore due to IndexedDb database deletion failed",e)})}),e._offlineComponents=t}async function qm(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Um(e);ai(Mm,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>vp(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>vp(t.remoteStore,n)),e._onlineComponents=t}async function Um(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){ai(Mm,"Using user provided OfflineComponentProvider");try{await Om(e,e._uninitializedComponentsProvider._offline)}catch(n){const i=n;if(!("FirebaseError"===(t=i).name?t.code===pi.FAILED_PRECONDITION||t.code===pi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code))throw i;si("Error using user provided cache. Falling back to memory cache: "+i),await Om(e,new Bm)}}else ai(Mm,"Using default OfflineComponentProvider"),await Om(e,new Rm(void 0));var t;return e._offlineComponents}async function Hm(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(ai(Mm,"Using user provided OnlineComponentProvider"),await qm(e,e._uninitializedComponentsProvider._online)):(ai(Mm,"Using default OnlineComponentProvider"),await qm(e,new zm))),e._onlineComponents}function Vm(e){return Um(e).then(e=>e.persistence)}function Km(e){return Um(e).then(e=>e.localStore)}function $m(e){return Hm(e).then(e=>e.remoteStore)}function Gm(e){return Hm(e).then(e=>e.syncEngine)}function Qm(e){return Hm(e).then(e=>e.datastore)}async function Ym(e){const t=await Hm(e),n=t.eventManager;return n.onListen=Jp.bind(null,t.syncEngine),n.onUnlisten=tm.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Xp.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=nm.bind(null,t.syncEngine),n}function Jm(e,t,n={}){const i=new gi;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,i,r){const a=new _m({next:s=>{a.Ou(),t.enqueueAndForget(()=>Ep(e,o));const l=s.docs.has(n);!l&&s.fromCache?r.reject(new mi(pi.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&s.fromCache&&i&&"server"===i.source?r.reject(new mi(pi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(s)},error:e=>r.reject(e)}),o=new Mp(zs(n.path),a,{includeMetadataChanges:!0,ka:!0});return zp(e,o)}(await Ym(e),e.asyncQueue,t,n,i)),i.promise}function Xm(e,t,n={}){const i=new gi;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,i,r){const a=new _m({next:n=>{a.Ou(),t.enqueueAndForget(()=>Ep(e,o)),n.fromCache&&"server"===i.source?r.reject(new mi(pi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(n)},error:e=>r.reject(e)}),o=new Mp(n,a,{includeMetadataChanges:!0,ka:!0});return zp(e,o)}(await Ym(e),e.asyncQueue,t,n,i)),i.promise}function Zm(e,t,n,i){const r=function(e,t){let n;return n="string"==typeof e?Ti().encode(e):e,i=function(e,t){if(e instanceof Uint8Array)return Em(e,t);if(e instanceof ArrayBuffer)return Em(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),new Nm(i,t);var i}(n,Wh(t));e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,n){const i=hi(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=hi(e),i=yc(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.Ti.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(i)>=0)}(e.localStore,r))return await t.close(),n._completeWith({taskState:"Success",documentsLoaded:(i=r).totalDocuments,bytesLoaded:i.totalBytes,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}),Promise.resolve(new Set);n._updateProgress(Up(r));const a=new qp(r,t.serializer);let o=await t.Su();for(;o;){const e=await a.Wa(o);e&&n._updateProgress(e),o=await t.Su()}const s=await a.za(e.localStore);return await gm(e,s.Ja,void 0),await function(e,t){const n=hi(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.Ti.saveBundleMetadata(e,t))}(e.localStore,r),n._completeWith(s.progress),Promise.resolve(s.ja)}catch(i){return si($p,`Loading bundle failed with ${i}`),n._failWith(i),Promise.resolve(new Set)}var i})(i,t,n).then(e=>{i.sharedClientState.notifyBundleLoaded(e)})}(await Gm(e),r,i)})}function eg(e,t){return new Pm(e,t)}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function tg(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const ng=new Map,ig="firestore.googleapis.com",rg=!0;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new mi(pi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ig,this.ssl=rg}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:rg;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Hd;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<au)throw new mi(pi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Li("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tg(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new mi(pi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new mi(pi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new mi(pi.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class og{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ag({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new mi(pi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new mi(pi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ag(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new xi;switch(e.type){case"firstParty":return new ki(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new mi(pi.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=ng.get(e);t&&(ai("ComponentProvider","Removing Datastore"),ng.delete(e),t.terminate())}(this),Promise.resolve()}}function sg(e,t,n,i={}){var r;e=Vi(e,og);const a=He(t),o=e._getSettings(),s=Object.assign(Object.assign({},o),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;a&&(Ve(`https://${l}`),Qe("Firestore",!0)),o.host!==ig&&o.host!==l&&si("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},o),{host:l,ssl:a,emulatorOptions:i});if(!rt(c,s)&&(e._setSettings(c),i.mockUserToken)){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=ti.MOCK_USER;else{t=Ke(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const a=i.mockUserToken.sub||i.mockUserToken.user_id;if(!a)throw new mi(pi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ti(a)}e._authCredentials=new yi(new fi(t,n))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lg(this.firestore,e,this._query)}}class cg{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cg(this.firestore,e,this._key)}toJSON(){return{type:cg._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Gi(t,cg._jsonSchema))return new cg(e,n||null,new Wi(Ni.fromString(t.referencePath)))}}cg._jsonSchemaVersion="firestore/documentReference/1.0",cg._jsonSchema={type:$i("string",cg._jsonSchemaVersion),referencePath:$i("string")};class dg extends lg{constructor(e,t,n){super(e,t,zs(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cg(this.firestore,null,new Wi(e))}withConverter(e){return new dg(this.firestore,e,this._path)}}function ug(e,t,...n){if(e=ut(e),Mi("collection","path",t),e instanceof og){const i=Ni.fromString(t,...n);return qi(i),new dg(e,null,i)}{if(!(e instanceof cg||e instanceof dg))throw new mi(pi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(Ni.fromString(t,...n));return qi(i),new dg(e.firestore,null,i)}}function hg(e,t,...n){if(e=ut(e),1===arguments.length&&(t=Ci.newId()),Mi("doc","path",t),e instanceof og){const i=Ni.fromString(t,...n);return Oi(i),new cg(e,null,new Wi(i))}{if(!(e instanceof cg||e instanceof dg))throw new mi(pi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(Ni.fromString(t,...n));return Oi(i),new cg(e.firestore,e instanceof dg?e.converter:null,new Wi(i))}}function pg(e,t){return e=ut(e),t=ut(t),e instanceof lg&&t instanceof lg&&e.firestore===t.firestore&&Os(e._query,t._query)&&e.converter===t.converter
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const mg="AsyncQueue";class gg{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Mh(this,"async_queue_retry"),this.oc=()=>{const e=Dh();e&&ai(mg,"Visibility state changed to "+e.visibilityState),this.F_.y_()},this._c=e;const t=Dh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Dh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new gi;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(RB){if(!kr(RB))throw RB;ai(mg,"Operation failed with retryable error: "+RB)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(e=>{throw this.tc=e,this.nc=!1,oi("INTERNAL UNHANDLED ERROR: ",fg(e)),e}).then(e=>(this.nc=!1,e))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const i=Sp.createAndSchedule(this,e,t,n,e=>this.lc(e));return this.ec.push(i),i}ac(){this.tc&&ci(47125,{hc:fg(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do{e=this._c,await e}while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function fg(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}function xg(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of t)if(i in n&&"function"==typeof n[i])return!0;return!1}(e,["next","error","complete"])}class yg{constructor(){this._progressObserver={},this._taskCompletionResolver=new gi,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg extends og{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new gg,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gg(e),this._firestoreClient=void 0,await e}}}function vg(e,t){const n="object"==typeof e?e:Rn(),i="string"==typeof e?e:t||yo,r=jn(n,"firestore").getImmediate({identifier:i});if(!r._initialized){const e=Le("firestore");e&&sg(r,...e)}return r}function kg(e){if(e._terminated)throw new mi(pi.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||wg(e),e._firestoreClient}function wg(e){var t,n,i;const r=e._freezeSettings(),a=(o=e._databaseId,s=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",l=e._persistenceKey,new xo(o,s,l,(c=r).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,tg(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator));var o,s,l,c;e._componentsProvider||(null===(n=r.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.localCache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),e._firestoreClient=new Lm(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function jg(e,t,n){if((e=Vi(e,bg))._firestoreClient||e._terminated)throw new mi(pi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new mi(pi.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},wg(e)}function Sg(e,t){const n=kg(e=Vi(e,bg)),i=new yg;return Zm(n,e._databaseId,t,i),i}function Tg(e,t){return function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){const n=hi(e);return n.persistence.runTransaction("Get named query","readonly",e=>n.Ti.getNamedQuery(e,t))}(await Km(e),t))}(kg(e=Vi(e,bg)),t).then(t=>t?new lg(e,null,t.query):null)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class Ig{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bg(ro.fromBase64String(e))}catch(t){throw new mi(pi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Bg(ro.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bg._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Gi(e,Bg._jsonSchema))return Bg.fromBase64String(e.bytes)}}Bg._jsonSchemaVersion="firestore/bytes/1.0",Bg._jsonSchema={type:$i("string",Bg._jsonSchemaVersion),bytes:$i("string")};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Rg{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new mi(pi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Di(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ag{constructor(e){this._methodName=e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new mi(pi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new mi(pi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ii(this._lat,e._lat)||Ii(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fg._jsonSchemaVersion}}static fromJSON(e){if(Gi(e,Fg._jsonSchema))return new Fg(e.latitude,e.longitude)}}Fg._jsonSchemaVersion="firestore/geoPoint/1.0",Fg._jsonSchema={type:$i("string",Fg._jsonSchemaVersion),latitude:$i("number"),longitude:$i("number")};
/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class zg{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:zg._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Gi(e,zg._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new zg(e.vectorValues);throw new mi(pi.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zg._jsonSchemaVersion="firestore/vectorValue/1.0",zg._jsonSchema={type:$i("string",zg._jsonSchemaVersion),vectorValues:$i("object")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Eg=/^__.*__$/;class _g{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new _l(e,this.data,this.fieldMask,t,this.fieldTransforms):new El(e,this.data,t,this.fieldTransforms)}}class Ng{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new _l(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Pg(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ci(40011,{Ec:e})}}class Dg{constructor(e,t,n,i,r,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Ac(),this.fieldTransforms=r||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Dg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return rf(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(0===e.length)throw this.wc("Document fields must not be empty");if(Pg(this.Ec)&&Eg.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class Wg{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Wh(e)}Dc(e,t,n,i=!1){return new Dg({Ec:e,methodName:t,bc:n,path:Di.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mg(e){const t=e._freezeSettings(),n=Wh(e._databaseId);return new Wg(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Lg(e,t,n,i,r,a={}){const o=e.Dc(a.merge||a.mergeFields?2:0,t,n,r);Zg("Data must be an object, but it was:",o,i);const s=Jg(i,o);let l,c;if(a.merge)l=new no(o.fieldMask),c=o.fieldTransforms;else if(a.mergeFields){const e=[];for(const i of a.mergeFields){const r=ef(t,i,n);if(!o.contains(r))throw new mi(pi.INVALID_ARGUMENT,`Field '${r}' is specified in your field mask but missing from your input data.`);af(e,r)||e.push(r)}l=new no(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new _g(new Qo(s),l,c)}class Og extends Ag{_toFieldTransform(e){if(2!==e.Ec)throw 1===e.Ec?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Og}}function qg(e,t,n){return new Dg({Ec:3,bc:t.settings.bc,methodName:e._methodName,mc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Ug extends Ag{_toFieldTransform(e){return new jl(e.path,new gl)}isEqual(e){return e instanceof Ug}}class Hg extends Ag{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=qg(this,e,!0),n=this.vc.map(e=>Yg(e,t)),i=new fl(n);return new jl(e.path,i)}isEqual(e){return e instanceof Hg&&rt(this.vc,e.vc)}}class Vg extends Ag{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=qg(this,e,!0),n=this.vc.map(e=>Yg(e,t)),i=new yl(n);return new jl(e.path,i)}isEqual(e){return e instanceof Vg&&rt(this.vc,e.vc)}}class Kg extends Ag{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){const t=new vl(e.serializer,dl(e.serializer,this.Cc));return new jl(e.path,t)}isEqual(e){return e instanceof Kg&&this.Cc===e.Cc}}function $g(e,t,n,i){const r=e.Dc(1,t,n);Zg("Data must be an object, but it was:",r,i);const a=[],o=Qo.empty();$a(i,(e,i)=>{const s=nf(t,e,n);i=ut(i);const l=r.gc(s);if(i instanceof Og)a.push(s);else{const e=Yg(i,l);null!=e&&(a.push(s),o.set(s,e))}});const s=new no(a);return new Ng(o,s,r.fieldTransforms)}function Gg(e,t,n,i,r,a){const o=e.Dc(1,t,n),s=[ef(t,i,n)],l=[r];if(a.length%2!=0)throw new mi(pi.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<a.length;h+=2)s.push(ef(t,a[h])),l.push(a[h+1]);const c=[],d=Qo.empty();for(let h=s.length-1;h>=0;--h)if(!af(c,s[h])){const e=s[h];let t=l[h];t=ut(t);const n=o.gc(e);if(t instanceof Og)c.push(e);else{const i=Yg(t,n);null!=i&&(c.push(e),d.set(e,i))}}const u=new no(c);return new Ng(d,u,o.fieldTransforms)}function Qg(e,t,n,i=!1){return Yg(n,e.Dc(i?4:3,t))}function Yg(e,t){if(Xg(e=ut(e)))return Zg("Unsupported field value:",t,e),Jg(e,t);if(e instanceof Ag)return function(e,t){if(!Pg(t.Ec))throw t.wc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.wc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&4!==t.Ec)throw t.wc("Nested arrays are not supported");return function(e,t){const n=[];let i=0;for(const r of e){let e=Yg(r,t.yc(i));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),i++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=ut(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return dl(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ji.fromDate(e);return{timestampValue:gc(t.serializer,n)}}if(e instanceof Ji){const n=new Ji(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:gc(t.serializer,n)}}if(e instanceof Fg)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Bg)return{bytesValue:fc(t.serializer,e._byteString)};if(e instanceof cg){const n=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(n))throw t.wc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:bc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof zg)return n=e,i=t,{mapValue:{fields:{[vo]:{stringValue:jo},[So]:{arrayValue:{values:n.toArray().map(e=>{if("number"!=typeof e)throw i.wc("VectorValues must only contain numeric values.");return ll(i.serializer,e)})}}}}};var n,i;throw t.wc(`Unsupported field value: ${Hi(e)}`)}(e,t)}function Jg(e,t){const n={};return Qa(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):$a(e,(e,i)=>{const r=Yg(i,t.Vc(e));null!=r&&(n[e]=r)}),{mapValue:{fields:n}}}function Xg(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ji||e instanceof Fg||e instanceof Bg||e instanceof cg||e instanceof Ag||e instanceof zg)}function Zg(e,t,n){if(!Xg(n)||!Ui(n)){const i=Hi(n);throw"an object"===i?t.wc(e+" a custom object"):t.wc(e+" "+i)}}function ef(e,t,n){if((t=ut(t))instanceof Rg)return t._internalPath;if("string"==typeof t)return nf(e,t);throw rf("Field path arguments must be of type string or ",e,!1,void 0,n)}const tf=new RegExp("[~\\*/\\[\\]]");function nf(e,t,n){if(t.search(tf)>=0)throw rf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Rg(...t.split("."))._internalPath}catch(i){throw rf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function rf(e,t,n,i,r){const a=i&&!i.isEmpty(),o=void 0!==r;let s=`Function ${t}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=". ";let l="";return(a||o)&&(l+=" (found",a&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new mi(pi.INVALID_ARGUMENT,s+e+l)}function af(e,t){return e.some(e=>e.isEqual(t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t,n,i,r){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new cg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new sf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lf("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class sf extends of{data(){return super.data()}}function lf(e,t){return"string"==typeof t?nf(e,t):t instanceof Rg?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new mi(pi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class df{}class uf extends df{}function hf(e,t,...n){let i=[];t instanceof df&&i.push(t),i=i.concat(n),function(e){const t=e.filter(e=>e instanceof gf).length,n=e.filter(e=>e instanceof pf).length;if(t>1||t>0&&n>0)throw new mi(pi.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)e=r._apply(e);return e}class pf extends uf{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new pf(e,t,n)}_apply(e){const t=this._parse(e);return Sf(e._query,t),new lg(e.firestore,e.converter,Ms(e._query,t))}_parse(e){const t=Mg(e.firestore);return function(e,t,n,i,r,a,o){let s;if(r.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new mi(pi.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if("in"===a||"not-in"===a){jf(o,a);const t=[];for(const n of o)t.push(wf(i,e,n));s={arrayValue:{values:t}}}else s=wf(i,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||jf(o,a),s=Qg(n,t,o,"in"===a||"not-in"===a);return rs.create(r,a,s)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function mf(e,t,n){const i=t,r=lf("where",e);return pf._create(r,i,n)}class gf extends df{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new gf(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:as.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const i=t.getFlattenedFilters();for(const r of i)Sf(n,r),n=Ms(n,r)}(e._query,t),new lg(e.firestore,e.converter,Ms(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class ff extends uf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ff(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new mi(pi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new mi(pi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ts(t,n)}(e._query,this._field,this._direction);return new lg(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new As(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function xf(e,t="asc"){const n=t,i=lf("orderBy",e);return ff._create(i,n)}class yf extends uf{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new yf(e,t,n)}_apply(e){return new lg(e.firestore,e.converter,Ls(e._query,this._limit,this._limitType))}}class bf extends uf{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new bf(e,t,n)}_apply(e){const t=kf(e,this.type,this._docOrFields,this._inclusive);return new lg(e.firestore,e.converter,(n=e._query,i=t,new As(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,i,n.endAt)));var n,i}}class vf extends uf{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new vf(e,t,n)}_apply(e){const t=kf(e,this.type,this._docOrFields,this._inclusive);return new lg(e.firestore,e.converter,(n=e._query,i=t,new As(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,i)));var n,i}}function kf(e,t,n,i){if(n[0]=ut(n[0]),n[0]instanceof of)return function(e,t,n,i,r){if(!i)throw new mi(pi.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const a=[];for(const o of Ns(e))if(o.field.isKeyField())a.push(No(t,i.key));else{const e=i.data.field(o.field);if(mo(e))throw new mi(pi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new mi(pi.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}a.push(e)}return new Xo(a,r)}(e._query,e.firestore._databaseId,t,n[0]._document,i);{const r=Mg(e.firestore);return function(e,t,n,i,r,a){const o=e.explicitOrderBy;if(r.length>o.length)throw new mi(pi.INVALID_ARGUMENT,`Too many arguments provided to ${i}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const s=[];for(let l=0;l<r.length;l++){const a=r[l];if(o[l].field.isKeyField()){if("string"!=typeof a)throw new mi(pi.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${i}(), but got a ${typeof a}`);if(!_s(e)&&-1!==a.indexOf("/"))throw new mi(pi.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${i}() must be a plain document ID, but '${a}' contains a slash.`);const n=e.path.child(Ni.fromString(a));if(!Wi.isDocumentKey(n))throw new mi(pi.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${i}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const r=new Wi(n);s.push(No(t,r))}else{const e=Qg(n,i,a);s.push(e)}}return new Xo(s,a)}(e._query,e.firestore._databaseId,r,t,n,i)}}function wf(e,t,n){if("string"==typeof(n=ut(n))){if(""===n)throw new mi(pi.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_s(t)&&-1!==n.indexOf("/"))throw new mi(pi.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=t.path.child(Ni.fromString(n));if(!Wi.isDocumentKey(i))throw new mi(pi.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return No(e,new Wi(i))}if(n instanceof cg)return No(e,n._key);throw new mi(pi.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hi(n)}.`)}function jf(e,t){if(!Array.isArray(e)||0===e.length)throw new mi(pi.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Sf(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new mi(pi.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new mi(pi.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Tf(e,t){if(!(t instanceof pf||t instanceof gf))throw new mi(pi.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Cf{convertValue(e,t="none"){switch(Co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return so(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ci(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return $a(e,(e,i)=>{n[e]=this.convertValue(i,t)}),n}convertVectorValue(e){var t,n,i;const r=null===(i=null===(n=null===(t=e.fields)||void 0===t?void 0:t[So].arrayValue)||void 0===n?void 0:n.values)||void 0===i?void 0:i.map(e=>so(e.doubleValue));return new zg(r)}convertGeoPoint(e){return new Fg(so(e.latitude),so(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=go(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(fo(e));default:return null}}convertTimestamp(e){const t=oo(e);return new Ji(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ni.fromString(e);ui(Hc(n),9688,{name:e});const i=new bo(n.get(1),n.get(3)),r=new Wi(n.popFirst(5));return i.isEqual(t)||oi(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(e,t,n){let i;return i=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,i}class Bf extends Cf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cg(this.firestore,null,t)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(){return new Cg("count")}
/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Af="NOT SUPPORTED";class Ff{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zf extends of{constructor(e,t,n,i,r,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ef(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(lf("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new mi(pi.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=zf._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}zf._jsonSchemaVersion="firestore/documentSnapshot/1.0",zf._jsonSchema={type:$i("string",zf._jsonSchemaVersion),bundleSource:$i("string","DocumentSnapshot"),bundleName:$i("string"),bundle:$i("string")};class Ef extends zf{data(e={}){return super.data(e)}}class _f{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ff(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Ef(this._firestore,this._userDataWriter,n.key,n,new Ff(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new mi(pi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const i=new Ef(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ff(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const i=new Ef(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ff(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let r=-1,a=-1;return 0!==t.type&&(r=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Nf(t.type),doc:i,oldIndex:r,newIndex:a}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new mi(pi.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=_f._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ci.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),i.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Nf(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ci(61501,{type:e})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Pf(e){e=Vi(e,cg);const t=Vi(e.firestore,bg);return Jm(kg(t),e._key).then(n=>Vf(t,e,n))}_f._jsonSchemaVersion="firestore/querySnapshot/1.0",_f._jsonSchema={type:$i("string",_f._jsonSchemaVersion),bundleSource:$i("string","QuerySnapshot"),bundleName:$i("string"),bundle:$i("string")};class Df extends Cf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cg(this.firestore,null,t)}}function Wf(e){e=Vi(e,lg);const t=Vi(e.firestore,bg),n=kg(t),i=new Df(t);return cf(e._query),Xm(n,e._query).then(n=>new _f(t,i,e,n))}function Mf(e,t,n){e=Vi(e,cg);const i=Vi(e.firestore,bg),r=If(e.converter,t,n);return Hf(i,[Lg(Mg(i),"setDoc",e._key,r,null!==e.converter,n).toMutation(e._key,Tl.none())])}function Lf(e,t,n,...i){e=Vi(e,cg);const r=Vi(e.firestore,bg),a=Mg(r);let o;return o="string"==typeof(t=ut(t))||t instanceof Rg?Gg(a,"updateDoc",e._key,t,n,i):$g(a,"updateDoc",e._key,t),Hf(r,[o.toMutation(e._key,Tl.exists(!0))])}function Of(e){return Hf(Vi(e.firestore,bg),[new Wl(e._key,Tl.none())])}function qf(e,t){const n=Vi(e.firestore,bg),i=hg(e),r=If(e.converter,t);return Hf(n,[Lg(Mg(e.firestore),"addDoc",i._key,r,null!==e.converter,{}).toMutation(i._key,Tl.exists(!1))]).then(()=>i)}function Uf(e,...t){var n,i,r;e=ut(e);let a={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof t[o]||xg(t[o])||(a=t[o++]);const s={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(xg(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),t[o+2]=null===(r=e.complete)||void 0===r?void 0:r.bind(e)}let l,c,d;if(e instanceof cg)c=Vi(e.firestore,bg),d=zs(e._key.path),l={next:n=>{t[o]&&t[o](Vf(c,e,n))},error:t[o+1],complete:t[o+2]};else{const n=Vi(e,lg);c=Vi(n.firestore,bg),d=n._query;const i=new Df(c);l={next:e=>{t[o]&&t[o](new _f(c,i,n,e))},error:t[o+1],complete:t[o+2]},cf(e._query)}return function(e,t,n,i){const r=new _m(i),a=new Mp(t,r,n);return e.asyncQueue.enqueueAndForget(async()=>zp(await Ym(e),a)),()=>{r.Ou(),e.asyncQueue.enqueueAndForget(async()=>Ep(await Ym(e),a))}}(kg(c),d,s,l)}function Hf(e,t){return function(e,t){const n=new gi;return e.asyncQueue.enqueueAndForget(async()=>async function(t,n,i){const r=Im(t);try{const e=await function(e,t){const n=hi(e),i=Ji.now(),r=t.reduce((e,t)=>e.add(t.key),al());let a,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let s=Ys(),l=al();return n.Os.getEntries(e,r).next(e=>{s=e,s.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,s)).next(r=>{a=r;const o=[];for(const e of t){const t=Fl(e,a.get(e.key).overlayedDocument);null!=t&&o.push(new _l(e.key,t,Yo(t.value.mapValue),Tl.exists(!0)))}return n.mutationQueue.addMutationBatch(e,i,o,t)}).next(t=>{o=t;const i=t.applyToLocalDocumentSet(a,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,i)})}).then(()=>({batchId:o.batchId,changes:Zs(a)}))}(r.localStore,n);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let i=e.Ru[e.currentUser.toKey()];i||(i=new Ya(Ii)),i=i.insert(t,n),e.Ru[e.currentUser.toKey()]=i}(r,e.batchId,i),await gm(r,e.changes),await up(r.remoteStore)}catch(e){const n=Tp(e,"Failed to persist write");i.reject(n)}}(await Gm(e),t,n)),n.promise}(kg(e),t)}function Vf(e,t,n){const i=n.docs.get(t._key),r=new Df(e);return new zf(e,r,t._key,i,new Ff(n.hasPendingWrites,n.fromCache),t.converter)}function Kf(e,t){const n=Vi(e.firestore,bg),i=kg(n),r=Ga(t,(e,t)=>new Ul(t,e.aggregateType,e._internalFieldPath));return function(e,t,n){const i=new gi;return e.asyncQueue.enqueueAndForget(async()=>{try{const r=await Qm(e);i.resolve(async function(e,t,n){var i;const r=hi(e),{request:a,ft:o,parent:s}=_c(r.serializer,Ds(t),n);r.connection.Qo||delete a.parent;const l=(await r.Jo("RunAggregationQuery",r.serializer.databaseId,s,a,1)).filter(e=>!!e.result);ui(1===l.length,64727);const c=null===(i=l[0].result)||void 0===i?void 0:i.aggregateFields;return Object.keys(c).reduce((e,t)=>(e[o[t]]=c[t],e),{})}(r,t,n))}catch(r){i.reject(r)}}),i.promise}(i,e._query,r).then(t=>function(e,t,n){const i=new Df(e);return new Ig(t,i,n)}(n,e,t))}class $f{constructor(e){this.kind="memory",this._onlineComponentProvider=zm.provider,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new Rm(void 0)}}toJSON(){return{kind:this.kind}}}class Gf{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=Zf(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Qf{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Bm.provider}toJSON(){return{kind:this.kind}}}class Yf{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Rm(e)}}toJSON(){return{kind:this.kind}}}class Jf{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=zm.provider,this._offlineComponentProvider={build:t=>new Am(t,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Xf{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=zm.provider,this._offlineComponentProvider={build:t=>new Fm(t,null==e?void 0:e.cacheSizeBytes)}}}function Zf(e){return new Jf(null==e?void 0:e.forceOwnership)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ex={maxAttempts:5};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Mg(e)}set(e,t,n){this._verifyNotCommitted();const i=nx(e,this._firestore),r=If(i.converter,t,n),a=Lg(this._dataReader,"WriteBatch.set",i._key,r,null!==i.converter,n);return this._mutations.push(a.toMutation(i._key,Tl.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const r=nx(e,this._firestore);let a;return a="string"==typeof(t=ut(t))||t instanceof Rg?Gg(this._dataReader,"WriteBatch.update",r._key,t,n,i):$g(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(a.toMutation(r._key,Tl.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=nx(e,this._firestore);return this._mutations=this._mutations.concat(new Wl(t._key,Tl.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new mi(pi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function nx(e,t){if((e=ut(e)).firestore!==t)throw new mi(pi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Mg(e)}get(e){const t=nx(e,this._firestore),n=new Bf(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return ci(24041);const i=e[0];if(i.isFoundDocument())return new of(this._firestore,n,i.key,i,t.converter);if(i.isNoDocument())return new of(this._firestore,n,t._key,null,t.converter);throw ci(18433,{doc:i})})}set(e,t,n){const i=nx(e,this._firestore),r=If(i.converter,t,n),a=Lg(this._dataReader,"Transaction.set",i._key,r,null!==i.converter,n);return this._transaction.set(i._key,a),this}update(e,t,n,...i){const r=nx(e,this._firestore);let a;return a="string"==typeof(t=ut(t))||t instanceof Rg?Gg(this._dataReader,"Transaction.update",r._key,t,n,i):$g(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,a),this}delete(e){const t=nx(e,this._firestore);return this._transaction.delete(t._key),this}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx extends ix{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=nx(e,this._firestore),n=new Df(this._firestore);return super.get(e).then(e=>new zf(this._firestore,n,t._key,e._document,new Ff(!1,!1),t.converter))}}function ax(){return new Ug("serverTimestamp")}function ox(e,t){if("string"!=typeof e[t])throw new mi(pi.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function lx(e,t){(function(e,t){return e.asyncQueue.enqueue(async()=>{return n=await Km(e),i=t,void(hi(n).Cs.Rs=i);var n,i})})(kg(e._firestore),t).then(e=>ai(`setting persistent cache index auto creation isEnabled=${t} succeeded`)).catch(e=>si(`setting persistent cache index auto creation isEnabled=${t} failed`,e))}const cx=new WeakMap;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(){this.Fc=new Map}static get instance(){return ux||(ux=new dx,function(e){if(Ql)throw new Error("a TestingHooksSpi instance is already set");Ql=e}(ux)),ux}ct(e){this.Fc.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.Fc;return n.set(t,e),()=>n.delete(t)}}let ux=null;!function(e,t=!0){ni=In,wn(new ht("firestore",(e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),a=new bg(new bi(e.getProvider("auth-internal")),new ji(r,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new mi(pi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bo(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),An(Zn,ei,e),An(Zn,ei,"esm2017")}();const hx=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Cf,AggregateField:Cg,AggregateQuerySnapshot:Ig,Bytes:Bg,CACHE_SIZE_UNLIMITED:-1,CollectionReference:dg,DocumentReference:cg,DocumentSnapshot:zf,FieldPath:Rg,FieldValue:Ag,Firestore:bg,FirestoreError:mi,GeoPoint:Fg,LoadBundleTask:yg,PersistentCacheIndexManager:sx,Query:lg,QueryCompositeFilterConstraint:gf,QueryConstraint:uf,QueryDocumentSnapshot:Ef,QueryEndAtConstraint:vf,QueryFieldFilterConstraint:pf,QueryLimitConstraint:yf,QueryOrderByConstraint:ff,QuerySnapshot:_f,QueryStartAtConstraint:bf,SnapshotMetadata:Ff,Timestamp:Ji,Transaction:rx,VectorValue:zg,WriteBatch:tx,_AutoId:Ci,_ByteString:ro,_DatabaseId:bo,_DocumentKey:Wi,_EmptyAppCheckTokenProvider:class{getToken(){return Promise.resolve(new wi(""))}invalidateToken(){}start(e,t){}shutdown(){}},_EmptyAuthCredentialsProvider:xi,_FieldPath:Di,_TestingHooks:
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return dx.instance.onExistenceFilterMismatch(e)}},_cast:Vi,_debugAssert:function(e,t){e||ci(57014,t)},_internalAggregationQueryToProtoRunAggregationQueryRequest:function(e,t){var n;const i=Ga(t,(e,t)=>new Ul(t,e.aggregateType,e._internalFieldPath)),r=null===(n=kg(Vi(e.firestore,bg))._onlineComponents)||void 0===n?void 0:n.datastore.serializer;return void 0===r?null:_c(r,Ds(e._query),i,!0).request},_internalQueryToProtoQueryTarget:function(e){var t;const n=null===(t=kg(Vi(e.firestore,bg))._onlineComponents)||void 0===t?void 0:t.datastore.serializer;return void 0===n?null:Ec(n,Ps(e._query)).Vt},_isBase64Available:function(){return"undefined"!=typeof atob},_logWarn:si,_validateIsNotUsedTogether:Li,addDoc:qf,aggregateFieldEqual:function(e,t){var n,i;return e instanceof Cg&&t instanceof Cg&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(i=t._internalFieldPath)||void 0===i?void 0:i.canonicalString())},aggregateQuerySnapshotEqual:function(e,t){return pg(e.query,t.query)&&rt(e.data(),t.data())},and:function(...e){return e.forEach(e=>Tf("and",e)),gf._create("and",e)},arrayRemove:function(...e){return new Vg("arrayRemove",e)},arrayUnion:function(...e){return new Hg("arrayUnion",e)},average:function(e){return new Cg("avg",ef("average",e))},clearIndexedDbPersistence:function(e){if(e._initialized&&!e._terminated)throw new mi(pi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new gi;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!xr.C())return Promise.resolve();const t=e+Uu;await xr.delete(t)}($u(e._databaseId,e._persistenceKey)),t.resolve()}catch(n){t.reject(n)}}),t.promise},collection:ug,collectionGroup:function(e,t){if(e=Vi(e,og),Mi("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new mi(pi.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new lg(e,null,(n=t,new As(Ni.emptyPath(),n)));var n},connectFirestoreEmulator:sg,count:Rf,deleteAllPersistentCacheIndexes:function(e){(function(e){return e.asyncQueue.enqueue(async()=>function(e){const t=hi(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",e=>n.deleteAllFieldIndexes(e))}(await Km(e)))})(kg(e._firestore)).then(e=>ai("deleting all persistent cache indexes succeeded")).catch(e=>si("deleting all persistent cache indexes failed",e))},deleteDoc:Of,deleteField:
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){return new Og("deleteField")},disableNetwork:function(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await Vm(e),n=await $m(e);return t.setNetworkEnabled(!1),async function(e){const t=hi(e);t.Ia.add(0),await Yh(t),t.Aa.set("Offline")}(n)})}(kg(e=Vi(e,bg)))},disablePersistentCacheIndexAutoCreation:function(e){lx(e,!1)},doc:hg,documentId:function(){return new Rg(Ei)},documentSnapshotFromJSON:function(e,t,n){if(Gi(t,zf._jsonSchema)){if(t.bundle===Af)throw new mi(pi.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const i=Wh(e._databaseId),r=eg(t.bundle,i),a=r.Ku(),o=new qp(r.getMetadata(),i);for(const e of a)o.Wa(e);const s=o.documents;if(1!==s.length)throw new mi(pi.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${s.length} documents.`);const l=Rc(i,s[0].document),c=new Wi(Ni.fromString(t.bundleName));return new zf(e,new Bf(e),c,l,new Ff(!1,!1),n||null)}},enableIndexedDbPersistence:function(e,t){si("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return jg(e,zm.provider,{build:e=>new Am(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()},enableMultiTabIndexedDbPersistence:async function(e){si("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();jg(e,zm.provider,{build:e=>new Fm(e,t.cacheSizeBytes)})},enableNetwork:function(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await Vm(e),n=await $m(e);return t.setNetworkEnabled(!0),function(e){const t=hi(e);return t.Ia.delete(0),Qh(t)}(n)})}(kg(e=Vi(e,bg)))},enablePersistentCacheIndexAutoCreation:function(e){lx(e,!0)},endAt:function(...e){return vf._create("endAt",e,!0)},endBefore:function(...e){return vf._create("endBefore",e,!1)},ensureFirestoreConfigured:kg,executeWrite:Hf,getAggregateFromServer:Kf,getCountFromServer:function(e){return Kf(e,{count:Rf()})},getDoc:Pf,getDocFromCache:function(e){e=Vi(e,cg);const t=Vi(e.firestore,bg),n=kg(t),i=new Df(t);return function(e,t){const n=new gi;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const i=await function(e,t){const n=hi(e);return n.persistence.runTransaction("read document","readonly",e=>n.localDocuments.getDocument(e,t))}(e,t);i.isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new mi(pi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(i){const e=Tp(i,`Failed to get document '${t} from cache`);n.reject(e)}}(await Km(e),t,n)),n.promise}(n,e._key).then(n=>new zf(t,i,e._key,n,new Ff(null!==n&&n.hasLocalMutations,!0),e.converter))},getDocFromServer:function(e){e=Vi(e,cg);const t=Vi(e.firestore,bg);return Jm(kg(t),e._key,{source:"server"}).then(n=>Vf(t,e,n))},getDocs:Wf,getDocsFromCache:function(e){e=Vi(e,lg);const t=Vi(e.firestore,bg),n=kg(t),i=new Df(t);return function(e,t){const n=new gi;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const i=await oh(e,t,!0),r=new Kp(t,i.qs),a=r.nu(i.documents),o=r.applyChanges(a,!1);n.resolve(o.snapshot)}catch(i){const e=Tp(i,`Failed to execute query '${t} against cache`);n.reject(e)}}(await Km(e),t,n)),n.promise}(n,e._query).then(n=>new _f(t,i,e,n))},getDocsFromServer:function(e){e=Vi(e,lg);const t=Vi(e.firestore,bg),n=kg(t),i=new Df(t);return Xm(n,e._query,{source:"server"}).then(n=>new _f(t,i,e,n))},getFirestore:vg,getPersistentCacheIndexManager:function(e){var t;e=Vi(e,bg);const n=cx.get(e);if(n)return n;if("persistent"!==(null===(t=kg(e)._uninitializedComponentsProvider)||void 0===t?void 0:t._offline.kind))return null;const i=new sx(e);return cx.set(e,i),i},increment:function(e){return new Kg("increment",e)},initializeFirestore:function(e,t,n){n||(n=yo);const i=jn(e,"firestore");if(i.isInitialized(n)){const e=i.getImmediate({identifier:n});if(rt(i.getOptions(n),t))return e;throw new mi(pi.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new mi(pi.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<au)throw new mi(pi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return t.host&&He(t.host)&&Ve(t.host),i.initialize({options:t,instanceIdentifier:n})},limit:function(e){return Ki("limit",e),yf._create("limit",e,"F")},limitToLast:function(e){return Ki("limitToLast",e),yf._create("limitToLast",e,"L")},loadBundle:Sg,memoryEagerGarbageCollector:function(){return new Qf},memoryLocalCache:function(e){return new $f(e)},memoryLruGarbageCollector:function(e){return new Yf(null==e?void 0:e.cacheSizeBytes)},namedQuery:Tg,onSnapshot:Uf,onSnapshotResume:function(e,t,...n){const i=ut(e),r=function(e){const t={bundle:"",bundleName:"",bundleSource:""},n=["bundle","bundleName","bundleSource"];for(const i of n){if(!(i in e)){t.error=`snapshotJson missing required field: ${i}`;break}const n=e[i];if("string"!=typeof n){t.error=`snapshotJson field '${i}' must be a string.`;break}if(0===n.length){t.error=`snapshotJson field '${i}' cannot be an empty string.`;break}"bundle"===i?t.bundle=n:"bundleName"===i?t.bundleName=n:"bundleSource"===i&&(t.bundleSource=n)}return t}(t);if(r.error)throw new mi(pi.INVALID_ARGUMENT,r.error);let a,o=0;if("object"!=typeof n[o]||xg(n[o])||(a=n[o++]),"QuerySnapshot"===r.bundleSource){let e=null;if("object"==typeof n[o]&&xg(n[o])){const t=n[o++];e={next:t.next,error:t.error,complete:t.complete}}else e={next:n[o++],error:n[o++],complete:n[o++]};return function(e,t,n,i,r){let a,o=!1;return Sg(e,t.bundle).then(()=>Tg(e,t.bundleName)).then(e=>{e&&!o&&(r&&e.withConverter(r),a=Uf(e,n||{},i))}).catch(e=>(i.error&&i.error(e),()=>{})),()=>{o||(o=!0,a&&a())}}(i,r,a,e,n[o])}if("DocumentSnapshot"===r.bundleSource){let e=null;if("object"==typeof n[o]&&xg(n[o])){const t=n[o++];e={next:t.next,error:t.error,complete:t.complete}}else e={next:n[o++],error:n[o++],complete:n[o++]};return function(e,t,n,i,r){let a,o=!1;return Sg(e,t.bundle).then(()=>{if(!o){const o=new cg(e,r||null,Wi.fromPath(t.bundleName));a=Uf(o,n||{},i)}}).catch(e=>(i.error&&i.error(e),()=>{})),()=>{o||(o=!0,a&&a())}}(i,r,a,e,n[o])}throw new mi(pi.INVALID_ARGUMENT,`unsupported bundle source: ${r.bundleSource}`)},onSnapshotsInSync:function(e,t){return function(e,t){const n=new _m(t);return e.asyncQueue.enqueueAndForget(async()=>{return t=await Ym(e),i=n,hi(t).Da.add(i),void i.next();var t,i}),()=>{n.Ou(),e.asyncQueue.enqueueAndForget(async()=>{return t=await Ym(e),i=n,void hi(t).Da.delete(i);var t,i})}}(kg(e=Vi(e,bg)),xg(t)?t:{next:t})},or:function(...e){return e.forEach(e=>Tf("or",e)),gf._create("or",e)},orderBy:xf,persistentLocalCache:function(e){return new Gf(e)},persistentMultipleTabManager:function(){return new Xf},persistentSingleTabManager:Zf,query:hf,queryEqual:pg,querySnapshotFromJSON:function(e,t,n){if(Gi(t,_f._jsonSchema)){if(t.bundle===Af)throw new mi(pi.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const i=Wh(e._databaseId),r=eg(t.bundle,i),a=r.Ku(),o=new qp(r.getMetadata(),i);for(const e of a)o.Wa(e);if(1!==o.queries.length)throw new mi(pi.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${o.queries.length} queries.`);const s=ed(o.queries[0].bundledQuery),l=o.documents;let c=new Cp;l.map(e=>{const t=Rc(i,e.document);c=c.add(t)});const d=Bp.fromInitialDocuments(s,c,al(),!1,!1),u=new lg(e,n||null,s);return new _f(e,new Bf(e),u,d)}},refEqual:function(e,t){return e=ut(e),t=ut(t),(e instanceof cg||e instanceof dg)&&(t instanceof cg||t instanceof dg)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},runTransaction:function(e,t,n){e=Vi(e,bg);const i=Object.assign(Object.assign({},ex),n);return function(e){if(e.maxAttempts<1)throw new mi(pi.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(e,t,n){const i=new gi;return e.asyncQueue.enqueueAndForget(async()=>{const r=await Qm(e);new Wm(e.asyncQueue,r,n,t,i).zu()}),i.promise}(kg(e),n=>t(new rx(e,n)),i)},serverTimestamp:ax,setDoc:Mf,setIndexConfiguration:
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e,t){const n=kg(e=Vi(e,bg));return n._uninitializedComponentsProvider&&"memory"!==n._uninitializedComponentsProvider._offline.kind?function(e,t){return e.asyncQueue.enqueue(async()=>async function(e,t){const n=hi(e),i=n.indexManager,r=[];return n.persistence.runTransaction("Configure indexes","readwrite",e=>i.getFieldIndexes(e).next(n=>
/**
      * @license
      * Copyright 2017 Google LLC
      *
      * Licensed under the Apache License, Version 2.0 (the "License");
      * you may not use this file except in compliance with the License.
      * You may obtain a copy of the License at
      *
      *   http://www.apache.org/licenses/LICENSE-2.0
      *
      * Unless required by applicable law or agreed to in writing, software
      * distributed under the License is distributed on an "AS IS" BASIS,
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      * See the License for the specific language governing permissions and
      * limitations under the License.
      */function(e,t,n,i,r){e=[...e],t=[...t],e.sort(n),t.sort(n);const a=e.length,o=t.length;let s=0,l=0;for(;s<o&&l<a;){const a=n(e[l],t[s]);a<0?r(e[l++]):a>0?i(t[s++]):(s++,l++)}for(;s<o;)i(t[s++]);for(;l<a;)r(e[l++])}(n,t,ir,t=>{r.push(i.addFieldIndex(e,t))},t=>{r.push(i.deleteFieldIndex(e,t))})).next(()=>mr.waitFor(r)))}(await Km(e),t))}(n,function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(t){throw new mi(pi.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==t?void 0:t.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const i of t.indexes){const e=ox(i,"collectionGroup"),t=[];if(Array.isArray(i.fields))for(const n of i.fields){const e=nf("setIndexConfiguration",ox(n,"fieldPath"));"CONTAINS"===n.arrayConfig?t.push(new rr(e,2)):"ASCENDING"===n.order?t.push(new rr(e,0)):"DESCENDING"===n.order&&t.push(new rr(e,1))}n.push(new er(er.UNKNOWN_ID,e,t,or.empty()))}return n}(t)):(si("Cannot enable indexes when persistence is disabled"),Promise.resolve())},setLogLevel:function(e){ii.setLogLevel(e)},snapshotEqual:function(e,t){return e instanceof zf&&t instanceof zf?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof _f&&t instanceof _f&&e._firestore===t._firestore&&pg(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},startAfter:function(...e){return bf._create("startAfter",e,!1)},startAt:function(...e){return bf._create("startAt",e,!0)},sum:function(e){return new Cg("sum",ef("sum",e))},terminate:function(e){return function(e,t,n=fn){jn(e,t).clearInstance(n)}(e.app,"firestore",e._databaseId.database),e._delete()},updateDoc:Lf,vector:function(e){return new zg(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */,waitForPendingWrites:function(e){return function(e){const t=new gi;return e.asyncQueue.enqueueAndForget(async()=>async function(t,n){const i=hi(t);ip(i.remoteStore)||ai($p,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=hi(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}(i.localStore);if(e===Ar)return void n.resolve();const t=i.Vu.get(e)||[];t.push(n),i.Vu.set(e,t)}catch(e){const i=Tp(e,"Initialization of waitForPendingWrites() operation failed");n.reject(i)}}(await Gm(e),t)),t.promise}(kg(e=Vi(e,bg)))},where:mf,writeBatch:function(e){return kg(e=Vi(e,bg)),new tx(e,t=>Hf(e,t))}},Symbol.toStringTag,{value:"Module"}));function px(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function mx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}"function"==typeof SuppressedError&&SuppressedError;const gx=mx,fx=new nt("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),xx=new wt("@firebase/auth");function yx(e,...t){xx.logLevel<=ft.ERROR&&xx.error(`Auth (${In}): ${e}`,...t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(e,...t){throw jx(e,...t)}function vx(e,...t){return jx(e,...t)}function kx(e,t,n){const i=Object.assign(Object.assign({},gx()),{[t]:n});return new nt("auth","Firebase",i).create(t,{appName:e.name})}function wx(e){return kx(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jx(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return fx.create(e,...t)}function Sx(e,t,...n){if(!e)throw jx(t,...n)}function Tx(e){const t="INTERNAL ASSERTION FAILED: "+e;throw yx(t),new Error(t)}function Cx(e,t){e||Tx(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ix(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Bx(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==Bx()&&"https:"!==Bx()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ax{constructor(e,t){this.shortDelay=e,this.longDelay=t,Cx(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ye())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return Rx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(e,t){Cx(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Tx("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Tx("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Tx("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},_x=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Nx=new Ax(3e4,6e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Dx(e,t,n,i,r={}){return Wx(e,r,async()=>{let r={},a={};i&&("GET"===t?a=i:r={body:JSON.stringify(i)});const o=ot(Object.assign({key:e.config.apiKey},a)).slice(1),s=await e._getAdditionalHeaders();s["Content-Type"]="application/json",e.languageCode&&(s["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:s},r);return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&He(e.emulatorConfig.host)&&(l.credentials="include"),zx.fetch()(await Lx(e,e.config.apiHost,n,o),l)})}async function Wx(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Ex),t);try{const t=new qx(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await r.json();if("needConfirmation"in a)throw Ux(e,"account-exists-with-different-credential",a);if(r.ok&&!("errorMessage"in a))return a;{const t=r.ok?a.errorMessage:a.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Ux(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw Ux(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw Ux(e,"user-disabled",a);const s=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw kx(e,s,o);bx(e,s)}}catch(RB){if(RB instanceof tt)throw RB;bx(e,"network-request-failed",{message:String(RB)})}}async function Mx(e,t,n,i,r={}){const a=await Dx(e,t,n,i,r);return"mfaPendingCredential"in a&&bx(e,"multi-factor-auth-required",{_serverResponse:a}),a}async function Lx(e,t,n,i){const r=`${t}${n}?${i}`,a=e,o=a.config.emulator?Fx(e.config,r):`${e.config.apiScheme}://${r}`;if(_x.includes(n)&&(await a._persistenceManagerAvailable,"COOKIE"===a._getPersistenceType())){return a._getPersistence()._getFinalTarget(o).toString()}return o}function Ox(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class qx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(vx(this.auth,"network-request-failed")),Nx.get())})}}function Ux(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=vx(e,t,i);return r.customData._tokenResponse=n,r}function Hx(e){return void 0!==e&&void 0!==e.enterprise}class Vx{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ox(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Kx(e,t){return Dx(e,"POST","/v1/accounts:lookup",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $x(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(RB){}}async function Gx(e,t=!1){const n=ut(e),i=await n.getIdToken(t),r=Yx(i);Sx(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const a="object"==typeof r.firebase?r.firebase:void 0,o=null==a?void 0:a.sign_in_provider;return{claims:r,token:i,authTime:$x(Qx(r.auth_time)),issuedAtTime:$x(Qx(r.iat)),expirationTime:$x(Qx(r.exp)),signInProvider:o||null,signInSecondFactor:(null==a?void 0:a.sign_in_second_factor)||null}}function Qx(e){return 1e3*Number(e)}function Yx(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return yx("JWT malformed, contained fewer than 3 sections"),null;try{const e=Pe(n);return e?JSON.parse(e):(yx("Failed to decode base64 JWT payload"),null)}catch(RB){return yx("Caught error parsing JWT payload as JSON",null==RB?void 0:RB.toString()),null}}function Jx(e){const t=Yx(e);return Sx(t,"internal-error"),Sx(void 0!==t.exp,"internal-error"),Sx(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xx(e,t,n=!1){if(n)return t;try{return await t}catch(RB){throw RB instanceof tt&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(RB)&&e.auth.currentUser===e&&await e.auth.signOut(),RB}}class Zx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(RB){return void("auth/network-request-failed"===(null==RB?void 0:RB.code)&&this.schedule(!0))}this.schedule()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$x(this.lastLoginAt),this.creationTime=$x(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ty(e){var t;const n=e.auth,i=await e.getIdToken(),r=await Xx(e,Kx(n,{idToken:i}));Sx(null==r?void 0:r.users.length,n,"internal-error");const a=r.users[0];e._notifyReloadListener(a);const o=(null===(t=a.providerUserInfo)||void 0===t?void 0:t.length)?iy(a.providerUserInfo):[],s=(l=e.providerData,c=o,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const d=e.isAnonymous,u=!(e.email&&a.passwordHash||(null==s?void 0:s.length)),h=!!d&&u,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new ey(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(e,p)}async function ny(e){const t=ut(e);await ty(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function iy(e){return e.map(e=>{var{providerId:t}=e,n=px(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ry{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Sx(e.idToken,"internal-error"),Sx(void 0!==e.idToken,"internal-error"),Sx(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Jx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Sx(0!==e.length,"internal-error");const t=Jx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(Sx(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await Wx(e,{},async()=>{const n=ot({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,a=await Lx(e,i,"/v1/token",`key=${r}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const s={method:"POST",headers:o,body:n};return e.emulatorConfig&&He(e.emulatorConfig.host)&&(s.credentials="include"),zx.fetch()(a,s)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,a=new ry;return n&&(Sx("string"==typeof n,"internal-error",{appName:e}),a.refreshToken=n),i&&(Sx("string"==typeof i,"internal-error",{appName:e}),a.accessToken=i),r&&(Sx("number"==typeof r,"internal-error",{appName:e}),a.expirationTime=r),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ry,this.toJSON())}_performRefresh(){return Tx("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ay(e,t){Sx("string"==typeof e||void 0===e,"internal-error",{appName:t})}class oy{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=px(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Zx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ey(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Xx(this,this.stsTokenManager.getToken(this.auth,e));return Sx(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Gx(this,e)}reload(){return ny(this)}_assign(e){this!==e&&(Sx(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new oy(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Sx(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ty(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Sn(this.auth.app))return Promise.reject(wx(this.auth));const e=await this.getIdToken();return await Xx(this,
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(e,t){return Dx(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,a,o,s,l,c;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,u=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(a=t.photoURL)&&void 0!==a?a:void 0,m=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(s=t._redirectEventId)&&void 0!==s?s:void 0,f=null!==(l=t.createdAt)&&void 0!==l?l:void 0,x=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:v,providerData:k,stsTokenManager:w}=t;Sx(y&&w,e,"internal-error");const j=ry.fromJSON(this.name,w);Sx("string"==typeof y,e,"internal-error"),ay(d,e.name),ay(u,e.name),Sx("boolean"==typeof b,e,"internal-error"),Sx("boolean"==typeof v,e,"internal-error"),ay(h,e.name),ay(p,e.name),ay(m,e.name),ay(g,e.name),ay(f,e.name),ay(x,e.name);const S=new oy({uid:y,auth:e,email:u,emailVerified:b,displayName:d,isAnonymous:v,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:j,createdAt:f,lastLoginAt:x});return k&&Array.isArray(k)&&(S.providerData=k.map(e=>Object.assign({},e))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,t,n=!1){const i=new ry;i.updateFromServerResponse(t);const r=new oy({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ty(r),r}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];Sx(void 0!==i.localId,"internal-error");const r=void 0!==i.providerUserInfo?iy(i.providerUserInfo):[],a=!(i.email&&i.passwordHash||(null==r?void 0:r.length)),o=new ry;o.updateFromIdToken(n);const s=new oy({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new ey(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||(null==r?void 0:r.length))};return Object.assign(s,l),s}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy=new Map;function ly(e){Cx(e instanceof Function,"Expected a class definition");let t=sy.get(e);return t?(Cx(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,sy.set(e,t),t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}cy.type="NONE";const dy=cy;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(e,t,n){return`firebase:${e}:${t}:${n}`}class hy{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=uy(this.userKey,i.apiKey,r),this.fullPersistenceKey=uy("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await Kx(this.auth,{idToken:e}).catch(()=>{});return t?oy._fromGetAccountInfoResponse(this.auth,t,e):null}return oy._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new hy(ly(dy),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||ly(dy);const a=uy(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(a);if(t){let n;if("string"==typeof t){const i=await Kx(e,{idToken:t}).catch(()=>{});if(!i)break;n=await oy._fromGetAccountInfoResponse(e,i,t)}else n=oy._fromJSON(e,t);c!==r&&(o=n),r=c;break}}catch(l){}const s=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&s.length?(r=s[0],o&&await r._set(a,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(a)}catch(l){}})),new hy(r,e,n)):new hy(r,e,n)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(xy(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(my(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(by(t))return"Blackberry";if(vy(t))return"Webos";if(gy(t))return"Safari";if((t.includes("chrome/")||fy(t))&&!t.includes("edge/"))return"Chrome";if(yy(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function my(e=Ye()){return/firefox\//i.test(e)}function gy(e=Ye()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function fy(e=Ye()){return/crios\//i.test(e)}function xy(e=Ye()){return/iemobile/i.test(e)}function yy(e=Ye()){return/android/i.test(e)}function by(e=Ye()){return/blackberry/i.test(e)}function vy(e=Ye()){return/webos/i.test(e)}function ky(e=Ye()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function wy(){return function(){const e=Ye();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function jy(e=Ye()){return ky(e)||yy(e)||vy(e)||by(e)||/windows phone/i.test(e)||xy(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sy(e,t=[]){let n;switch(e){case"Browser":n=py(Ye());break;case"Worker":n=`${py(Ye())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${In}/${i}`}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,i)=>{try{n(e(t))}catch(RB){i(RB)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(RB){t.reverse();for(const i of t)try{i()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==RB?void 0:RB.message})}}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e){var t,n,i,r;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=a.minPasswordLength)&&void 0!==t?t:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,a,o;const s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=null===(t=s.meetsMinPasswordLength)||void 0===t||t),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(i=s.containsLowercaseLetter)||void 0===i||i),s.isValid&&(s.isValid=null===(r=s.containsUppercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(a=s.containsNumericCharacter)||void 0===a||a),s.isValid&&(s.isValid=null===(o=s.containsNonAlphanumericCharacter)||void 0===o||o),s}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ry(this),this.idTokenSubscription=new Ry(this),this.beforeStateQueue=new Ty(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ly(t)),this._initializationPromise=this.queue(async()=>{var n,i,r;if(!this._deleted&&(this.persistenceManager=await hy.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(i=this._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(RB){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Kx(this,{idToken:e}),n=await oy._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Sn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,a=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==a||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(RB){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(RB))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Sx(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(RB){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ty(e)}catch(RB){if("auth/network-request-failed"!==(null==RB?void 0:RB.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Sn(this.app))return Promise.reject(wx(this));const t=e?ut(e):null;return t&&Sx(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Sx(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Sn(this.app)?Promise.reject(wx(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Sn(this.app)?Promise.reject(wx(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ly(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return Dx(e,"GET","/v2/passwordPolicy",Px(e,t))}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(this),t=new Cy(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new nt("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Dx(e,"POST","/v2/accounts:revokeToken",Px(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ly(e)||this._popupRedirectResolver;Sx(t,this,"argument-error"),this.redirectPersistenceManager=await hy.create(this,[ly(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Sx(o,this,"internal-error"),o.then(()=>{a||r(this.currentUser)}),"function"==typeof t){const r=e.addObserver(t,n,i);return()=>{a=!0,r()}}{const n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Sx(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Sy(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(Sn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){xx.logLevel<=ft.WARN&&xx.warn(`Auth (${In}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function By(e){return ut(e)}class Ry{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new ct(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Sx(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ay={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Fy(e){return Ay.loadJS(e)}class zy{constructor(){this.enterprise=new Ey}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ey{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const _y="NO_RECAPTCHA";class Ny{constructor(e){this.type="recaptcha-enterprise",this.auth=By(e)}async verify(e="verify",t=!1){async function n(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{(async function(e,t){return Dx(e,"GET","/v2/recaptchaConfig",Px(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(i=>{if(void 0!==i.recaptchaKey){const n=new Vx(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})}function i(t,n,i){const r=window.grecaptcha;Hx(r)?r.enterprise.ready(()=>{r.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(_y)})}):i(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new zy).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{n(this.auth).then(n=>{if(!t&&Hx(window.grecaptcha))i(n,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ay.recaptchaEnterpriseScript;0!==t.length&&(t+=n),Fy(t).then(()=>{i(n,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Py(e,t,n,i=!1,r=!1){const a=new Ny(e);let o;if(r)o=_y;else try{o=await a.verify(n)}catch(l){o=await a.verify(n,!0)}const s=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return i?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Dy(e,t,n,i,r){var a;if(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await Py(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch(async r=>{if("auth/missing-recaptcha-token"===r.code){const r=await Py(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wy(e,t){const n=jn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(rt(n.getOptions(),null!=t?t:{}))return e;bx(e,"already-initialized")}return n.initialize({options:t})}function My(e,t,n){const i=By(e);Sx(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=Ly(t),{host:a,port:o}=function(e){const t=Ly(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Oy(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Oy(t)}}}(t),s=null===o?"":`:${o}`,l={url:`${r}//${a}${s}/`},c=Object.freeze({host:a,port:o,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!i._canInitEmulator)return Sx(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),void Sx(rt(l,i.config.emulator)&&rt(c,i.emulatorConfig),i,"emulator-config-failed");i.config.emulator=l,i.emulatorConfig=c,i.settings.appVerificationDisabledForTesting=!0,He(a)?(Ve(`${r}//${a}${s}`),Qe("Auth",!0)):function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&console.info;"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function Ly(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Oy(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class qy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tx("not implemented")}_getIdTokenResponse(e){return Tx("not implemented")}_linkToIdToken(e,t){return Tx("not implemented")}_getReauthenticationResolver(e){return Tx("not implemented")}}async function Uy(e,t){return Dx(e,"POST","/v1/accounts:signUp",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hy(e,t){return Mx(e,"POST","/v1/accounts:signInWithPassword",Px(e,t))}async function Vy(e,t){return async function(e,t){return Dx(e,"POST","/v1/accounts:sendOobCode",Px(e,t))}(e,t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ky extends qy{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ky(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ky(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Dy(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Hy);case"emailLink":return async function(e,t){return Mx(e,"POST","/v1/accounts:signInWithEmailLink",Px(e,t))}(e,{email:this._email,oobCode:this._password});default:bx(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Dy(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Uy);case"emailLink":return async function(e,t){return Mx(e,"POST","/v1/accounts:signInWithEmailLink",Px(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:bx(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $y(e,t){return Mx(e,"POST","/v1/accounts:signInWithIdp",Px(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy extends qy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Gy(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):bx("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=px(t,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Gy(n,i);return a.idToken=r.idToken||void 0,a.accessToken=r.accessToken||void 0,a.secret=r.secret,a.nonce=r.nonce,a.pendingToken=r.pendingToken||null,a}_getIdTokenResponse(e){return $y(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,$y(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$y(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ot(t)}return e}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e){var t,n,i,r,a,o;const s=st(lt(e)),l=null!==(t=s.apiKey)&&void 0!==t?t:null,c=null!==(n=s.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=s.mode)&&void 0!==i?i:null);Sx(l&&c&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=c,this.continueUrl=null!==(r=s.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(a=s.lang)&&void 0!==a?a:null,this.tenantId=null!==(o=s.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=st(lt(e)).link,n=t?st(lt(t)).deep_link_id:null,i=st(lt(e)).deep_link_id;return(i?st(lt(i)).link:null)||i||n||t||e}(e);try{return new Qy(t)}catch(n){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(){this.providerId=Yy.PROVIDER_ID}static credential(e,t){return Ky._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Qy.parseLink(t);return Sx(n,"argument-error"),Ky._fromEmailAndCode(e,n.code,n.tenantId)}}Yy.PROVIDER_ID="password",Yy.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Yy.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Jy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy extends Jy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zy extends Xy{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return Sx("providerId"in t&&"signInMethod"in t,"argument-error"),Gy._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Sx(e.idToken||e.accessToken,"argument-error"),Gy._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Zy.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Zy.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:a,providerId:o}=e;if(!(n||i||t||r))return null;if(!o)return null;try{return new Zy(o)._credential({idToken:t,accessToken:n,nonce:a,pendingToken:r})}catch(RB){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb extends Xy{constructor(){super("facebook.com")}static credential(e){return Gy._fromParams({providerId:eb.PROVIDER_ID,signInMethod:eb.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eb.credentialFromTaggedObject(e)}static credentialFromError(e){return eb.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return eb.credential(e.oauthAccessToken)}catch(t){return null}}}eb.FACEBOOK_SIGN_IN_METHOD="facebook.com",eb.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class tb extends Xy{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Gy._fromParams({providerId:tb.PROVIDER_ID,signInMethod:tb.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return tb.credentialFromTaggedObject(e)}static credentialFromError(e){return tb.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return tb.credential(t,n)}catch(i){return null}}}tb.GOOGLE_SIGN_IN_METHOD="google.com",tb.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class nb extends Xy{constructor(){super("github.com")}static credential(e){return Gy._fromParams({providerId:nb.PROVIDER_ID,signInMethod:nb.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nb.credentialFromTaggedObject(e)}static credentialFromError(e){return nb.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return nb.credential(e.oauthAccessToken)}catch(t){return null}}}nb.GITHUB_SIGN_IN_METHOD="github.com",nb.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ib extends Xy{constructor(){super("twitter.com")}static credential(e,t){return Gy._fromParams({providerId:ib.PROVIDER_ID,signInMethod:ib.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ib.credentialFromTaggedObject(e)}static credentialFromError(e){return ib.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return ib.credential(t,n)}catch(i){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function rb(e,t){return Mx(e,"POST","/v1/accounts:signUp",Px(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ib.TWITTER_SIGN_IN_METHOD="twitter.com",ib.PROVIDER_ID="twitter.com";class ab{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await oy._fromIdTokenResponse(e,n,i),a=ob(n);return new ab({user:r,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=ob(n);return new ab({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function ob(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb extends tt{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,sb.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new sb(e,t,n,i)}}function lb(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw sb._fromErrorAndOperation(e,n,t,i);throw n})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function cb(e,t,n=!1){if(Sn(e.app))return Promise.reject(wx(e));const i="signIn",r=await lb(e,i,t),a=await ab._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(a.user),a}async function db(e,t){return cb(By(e),t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ub(e){const t=By(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function hb(e,t,n){const i=By(e),r={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};await Dy(i,r,"getOobCode",Vy)}async function pb(e,t,n){if(Sn(e.app))return Promise.reject(wx(e));const i=By(e),r=Dy(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",rb),a=await r.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&ub(e),t}),o=await ab._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(o.user),o}function mb(e,t,n){return Sn(e.app)?Promise.reject(wx(e)):db(ut(e),Yy.credential(t,n)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&ub(e),t})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function gb(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const i=ut(e),r={idToken:await i.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},a=await Xx(i,async function(e,t){return Dx(e,"POST","/v1/accounts:update",t)}(i.auth,r));i.displayName=a.displayName||null,i.photoURL=a.photoUrl||null;const o=i.providerData.find(({providerId:e})=>"password"===e);o&&(o.displayName=i.displayName,o.photoURL=i.photoURL),await i._updateTokensIfNecessary(a)}function fb(e,t,n,i){return ut(e).onIdTokenChanged(t,n,i)}function xb(e,t,n){return ut(e).beforeAuthStateChanged(t,n)}function yb(e,t,n,i){return ut(e).onAuthStateChanged(t,n,i)}function bb(e){return ut(e).signOut()}const vb="__sak";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vb,"1"),this.storage.removeItem(vb),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb extends kb{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jy(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);wy()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}wb.type="LOCAL";const jb=wb;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb extends kb{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Sb.type="SESSION";const Tb=Sb;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Cb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Cb(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,a=this.handlersMap[i];if(!(null==a?void 0:a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async e=>e(t.origin,r)),s=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:s})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ib(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cb.receivers=[];class Bb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,a;return new Promise((o,s)=>{const l=Ib("",20);i.port1.start();const c=setTimeout(()=>{s(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),r=setTimeout(()=>{s(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(c),clearTimeout(r),s(new Error("invalid_response"))}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ab(){return void 0!==Rb().WorkerGlobalScope&&"function"==typeof Rb().importScripts}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Fb="firebaseLocalStorageDb",zb="firebaseLocalStorage",Eb="fbase_key";class _b{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Nb(e,t){return e.transaction([zb],t?"readwrite":"readonly").objectStore(zb)}function Pb(){const e=indexedDB.open(Fb,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(zb,{keyPath:Eb})}catch(RB){n(RB)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(zb)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Fb);return new _b(e).toPromise()}(),t(await Pb()))})})}async function Db(e,t,n){const i=Nb(e,!0).put({[Eb]:t,value:n});return new _b(i).toPromise()}function Wb(e,t){const n=Nb(e,!0).delete(t);return new _b(n).toPromise()}class Mb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Pb()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(RB){if(t++>3)throw RB;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ab()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cb._getInstance(Ab()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Bb(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Pb();return await Db(e,vb,"1"),await Wb(e,vb),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Db(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Nb(e,!1).get(t),i=await new _b(n).toPromise();return void 0===i?null:i.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Wb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Nb(e,!1).getAll();return new _b(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Mb.type="LOCAL";const Lb=Mb;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ob(e,t){return t?ly(t):(Sx(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Ax(3e4,6e4);class qb extends qy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $y(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $y(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $y(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ub(e){return cb(e.auth,new qb(e),e.bypassAuthState)}function Hb(e){const{auth:t,user:n}=e;return Sx(n,t,"internal-error"),
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(e,t,n=!1){const{auth:i}=e;if(Sn(i.app))return Promise.reject(wx(i));const r="reauthenticate";try{const a=await Xx(e,lb(i,r,t,e),n);Sx(a.idToken,i,"internal-error");const o=Yx(a.idToken);Sx(o,i,"internal-error");const{sub:s}=o;return Sx(e.uid===s,i,"user-mismatch"),ab._forOperation(e,r,a)}catch(RB){throw"auth/user-not-found"===(null==RB?void 0:RB.code)&&bx(i,"user-mismatch"),RB}}(n,new qb(e),e.bypassAuthState)}async function Vb(e){const{auth:t,user:n}=e;return Sx(n,t,"internal-error"),async function(e,t,n=!1){const i=await Xx(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ab._forOperation(e,"link",i)}(n,new qb(e),e.bypassAuthState)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(RB){this.reject(RB)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:a,type:o}=e;if(a)return void this.reject(a);const s={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(s))}catch(RB){this.reject(RB)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ub;case"linkViaPopup":case"linkViaRedirect":return Vb;case"reauthViaPopup":case"reauthViaRedirect":return Hb;default:bx(this.auth,"internal-error")}}resolve(e){Cx(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cx(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b=new Ax(2e3,1e4);async function Gb(e,t,n){if(Sn(e.app))return Promise.reject(vx(e,"operation-not-supported-in-this-environment"));const i=By(e);!function(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&bx(e,"argument-error"),kx(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,Jy);const r=Ob(i,n);return new Qb(i,"signInViaPopup",t,r).executeNotNull()}class Qb extends Kb{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Qb.currentPopupAction&&Qb.currentPopupAction.cancel(),Qb.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Sx(e,this.auth,"internal-error"),e}async onExecution(){Cx(1===this.filter.length,"Popup operations only handle one event");const e=Ib();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(vx(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(vx(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qb.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vx(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,$b.get())};e()}}Qb.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Yb="pendingRedirect",Jb=new Map;class Xb extends Kb{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Jb.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return uy(Yb,e.config.apiKey,e.name)}(t),i=function(e){return ly(e._redirectPersistence)}(e);if(!(await i._isAvailable()))return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(RB){e=()=>Promise.reject(RB)}Jb.set(this.auth._key(),e)}return this.bypassAuthState||Jb.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Zb(e,t){Jb.set(e._key(),t)}async function ev(e,t,n=!1){if(Sn(e.app))return Promise.reject(wx(e));const i=By(e),r=Ob(i,t),a=new Xb(i,r,n),o=await a.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return iv(e);default:return!1}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!iv(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(vx(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(nv(e))}saveEventToCache(e){this.cachedEventUids.add(nv(e)),this.lastProcessedEventTime=Date.now()}}function nv(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function iv({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const rv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,av=/^https?/;async function ov(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Dx(e,"GET","/v1/projects",t)}(e);for(const i of t)try{if(sv(i))return}catch(n){}bx(e,"unauthorized-domain")}function sv(e){const t=Ix(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!av.test(n))return!1;if(rv.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv=new Ax(3e4,6e4);function cv(){const e=Rb().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function dv(e){return new Promise((t,n)=>{var i,r,a;function o(){cv(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{cv(),n(vx(e,"network-request-failed"))},timeout:lv.get()})}if(null===(r=null===(i=Rb().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=Rb().gapi)||void 0===a?void 0:a.load)){const t=`__${"iframefcb"}${Math.floor(1e6*Math.random())}`;return Rb()[t]=()=>{gapi.load?o():n(vx(e,"network-request-failed"))},Fy(`${Ay.gapiScript}?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw uv=null,e})}let uv=null;
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const hv=new Ax(5e3,15e3),pv={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mv=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gv(e){const t=e.config;Sx(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Fx(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:In},r=mv.get(e.config.apiHost);r&&(i.eid=r);const a=e._getFrameworks();return a.length&&(i.fw=a.join(",")),`${n}?${ot(i).slice(1)}`}async function fv(e){const t=await function(e){return uv=uv||dv(e),uv}(e),n=Rb().gapi;return Sx(n,e,"internal-error"),t.open({where:document.body,url:gv(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pv,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=vx(e,"network-request-failed"),a=Rb().setTimeout(()=>{i(r)},hv.get());function o(){Rb().clearTimeout(a),n(t)}t.ping(o).then(o,()=>{i(r)})}))}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class yv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(RB){}}}function bv(e,t,n,i=500,r=600){const a=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let s="";const l=Object.assign(Object.assign({},xv),{width:i.toString(),height:r.toString(),top:a,left:o}),c=Ye().toLowerCase();n&&(s=fy(c)?"_blank":n),my(c)&&(t=t||"http://localhost",l.scrollbars="yes");const d=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Ye()){var t;return ky(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==s)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t||"",s),new yv(null);const u=window.open(t||"",s,d);Sx(u,e,"popup-blocked");try{u.focus()}catch(RB){}return new yv(u)}const vv="__/auth/handler",kv="emulator/auth/handler",wv=encodeURIComponent("fac");async function jv(e,t,n,i,r,a){Sx(e.config.authDomain,e,"auth-domain-config-required"),Sx(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:In,eventId:r};if(t instanceof Jy){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))o[e]=t}if(t instanceof Xy){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const s=o;for(const d of Object.keys(s))void 0===s[d]&&delete s[d];const l=await e._getAppCheckToken(),c=l?`#${wv}=${encodeURIComponent(l)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${vv}`;return Fx(e,kv)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)}?${ot(s).slice(1)}${c}`}const Sv="webStorageSupport";const Tv=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tb,this._completeRedirectFn=ev,this._overrideRedirectResult=Zb}async _openPopup(e,t,n,i){var r;Cx(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()");return bv(e,await jv(e,t,n,Ix(),i),Ib())}async _openRedirect(e,t,n,i){await this._originValidation(e);return function(e){Rb().location.href=e}(await jv(e,t,n,Ix(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Cx(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await fv(e),n=new tv(e);return t.register("authEvent",t=>{Sx(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Sv,{type:Sv},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Sv];void 0!==r&&t(!!r),bx(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ov(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jy()||gy()||ky()}};var Cv="@firebase/auth",Iv="1.10.8";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Bv{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Sx(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Rv=qe("authIdTokenMaxAge")||300;let Av=null;function Fv(e=Rn()){const t=jn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=Wy(e,{popupRedirectResolver:Tv,persistence:[Lb,jb,Tb]}),i=qe("authTokenSyncURL");if(i&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=(r=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Rv)return;const i=null==t?void 0:t.token;Av!==i&&(Av=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});xb(n,t,()=>t(n.currentUser)),fb(n,e=>t(e))}}var r;const a=Me("auth");return a&&My(n,`http://${a}`),n}var zv;Ay={loadJS:e=>new Promise((t,n)=>{const i=document.createElement("script");var r,a;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=vx("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(a=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==a?a:document).appendChild(i)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},zv="Browser",wn(new ht("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Sx(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const s={apiKey:a,authDomain:o,clientPlatform:zv,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Sy(zv)},l=new Iy(n,i,r,s);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(ly);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),wn(new ht("auth-internal",e=>{const t=By(e.getProvider("auth").getImmediate());return new Bv(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),An(Cv,Iv,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(zv)),An(Cv,Iv,"esm2017");const Ev=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Qy,AuthCredential:qy,EmailAuthCredential:Ky,EmailAuthProvider:Yy,FacebookAuthProvider:eb,GithubAuthProvider:nb,GoogleAuthProvider:tb,OAuthCredential:Gy,OAuthProvider:Zy,TwitterAuthProvider:ib,beforeAuthStateChanged:xb,browserLocalPersistence:jb,browserPopupRedirectResolver:Tv,browserSessionPersistence:Tb,connectAuthEmulator:My,createUserWithEmailAndPassword:pb,getAuth:Fv,getIdTokenResult:Gx,getRedirectResult:async function(e,t){return await By(e)._initializationPromise,ev(e,t,!1)},inMemoryPersistence:dy,indexedDBLocalPersistence:Lb,initializeAuth:Wy,onAuthStateChanged:yb,onIdTokenChanged:fb,prodErrorMap:gx,reload:ny,sendPasswordResetEmail:hb,signInWithCredential:db,signInWithEmailAndPassword:mb,signInWithPopup:Gb,signOut:bb,updateProfile:gb},Symbol.toStringTag,{value:"Module"})),_v="firebasestorage.googleapis.com",Nv="storageBucket";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Pv extends tt{constructor(e,t,n=0){super(Ov(e),`Firebase Storage: ${t} (${Ov(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Pv.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ov(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var Dv,Wv,Mv,Lv;function Ov(e){return"storage/"+e}function qv(){return new Pv(Dv.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Uv(){return new Pv(Dv.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Hv(){return new Pv(Dv.CANCELED,"User canceled the upload/download.")}function Vv(){return new Pv(Dv.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Kv(e){return new Pv(Dv.INVALID_ARGUMENT,e)}function $v(){return new Pv(Dv.APP_DELETED,"The Firebase app was deleted.")}function Gv(e,t){return new Pv(Dv.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Qv(e){throw new Pv(Dv.INTERNAL_ERROR,"Internal error: "+e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(Wv=Dv||(Dv={})).UNKNOWN="unknown",Wv.OBJECT_NOT_FOUND="object-not-found",Wv.BUCKET_NOT_FOUND="bucket-not-found",Wv.PROJECT_NOT_FOUND="project-not-found",Wv.QUOTA_EXCEEDED="quota-exceeded",Wv.UNAUTHENTICATED="unauthenticated",Wv.UNAUTHORIZED="unauthorized",Wv.UNAUTHORIZED_APP="unauthorized-app",Wv.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",Wv.INVALID_CHECKSUM="invalid-checksum",Wv.CANCELED="canceled",Wv.INVALID_EVENT_NAME="invalid-event-name",Wv.INVALID_URL="invalid-url",Wv.INVALID_DEFAULT_BUCKET="invalid-default-bucket",Wv.NO_DEFAULT_BUCKET="no-default-bucket",Wv.CANNOT_SLICE_BLOB="cannot-slice-blob",Wv.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",Wv.NO_DOWNLOAD_URL="no-download-url",Wv.INVALID_ARGUMENT="invalid-argument",Wv.INVALID_ARGUMENT_COUNT="invalid-argument-count",Wv.APP_DELETED="app-deleted",Wv.INVALID_ROOT_OPERATION="invalid-root-operation",Wv.INVALID_FORMAT="invalid-format",Wv.INTERNAL_ERROR="internal-error",Wv.UNSUPPORTED_ENVIRONMENT="unsupported-environment";class Yv{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Yv.makeFromUrl(e,t)}catch(RB){return new Yv(e,"")}if(""===n.path)return n;throw i=e,new Pv(Dv.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.");var i}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";const r=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),s=[{regex:r,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp(`^https?://${t===_v?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:a}];for(let l=0;l<s.length;l++){const t=s[l],i=t.regex.exec(e);if(i){const e=i[t.indices.bucket];let r=i[t.indices.path];r||(r=""),n=new Yv(e,r),t.postModify(n);break}}if(null==n)throw function(e){return new Pv(Dv.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class Jv{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(e){return"string"==typeof e||e instanceof String}function Zv(e){return ek()&&e instanceof Blob}function ek(){return"undefined"!=typeof Blob}function tk(e,t,n,i){if(i<t)throw Kv(`Invalid value for '${e}'. Expected ${t} or greater.`);if(i>n)throw Kv(`Invalid value for '${e}'. Expected ${n} or less.`)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(e,t,n){let i=t;return null==n&&(i=`https://${t}`),`${n}://${i}/v0${e}`}function ik(e){const t=encodeURIComponent;let n="?";for(const i in e)if(e.hasOwnProperty(i)){n=n+(t(i)+"="+t(e[i]))+"&"}return n=n.slice(0,-1),n}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function rk(e,t){const n=e>=500&&e<600,i=-1!==[408,429].indexOf(e),r=-1!==t.indexOf(e);return n||i||r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(Lv=Mv||(Mv={}))[Lv.NO_ERROR=0]="NO_ERROR",Lv[Lv.NETWORK_ERROR=1]="NETWORK_ERROR",Lv[Lv.ABORT=2]="ABORT";class ak{constructor(e,t,n,i,r,a,o,s,l,c,d,u=!0,h=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=s,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=d,this.retry=u,this.isUsingEmulator=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new ok(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const i=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const t=n.getErrorCode()===Mv.NO_ERROR,r=n.getStatus();if(!t||rk(r,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Mv.ABORT;return void e(!1,new ok(!1,null,t))}const a=-1!==this.successCodes_.indexOf(r);e(!0,new ok(a,n))})},t=(e,t)=>{const n=this.resolve_,i=this.reject_,r=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(r,r.getResponse());!
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){return void 0!==e}(e)?n():n(e)}catch(RB){i(RB)}else if(null!==r){const e=qv();e.serverResponse=r.getErrorText(),this.errorCallback_?i(this.errorCallback_(r,e)):i(e)}else if(t.canceled){i(this.appDelete_?$v():Hv())}else{i(Uv())}};this.canceled_?t(0,new ok(!1,null,!0)):this.backoffId_=function(e,t,n){let i=1,r=null,a=null,o=!1,s=0;function l(){return 2===s}let c=!1;function d(...e){c||(c=!0,t.apply(null,e))}function u(t){r=setTimeout(()=>{r=null,e(p,l())},t)}function h(){a&&clearTimeout(a)}function p(e,...t){if(c)return void h();if(e)return h(),void d.call(null,e,...t);if(l()||o)return h(),void d.call(null,e,...t);let n;i<64&&(i*=2),1===s?(s=2,n=0):n=1e3*(i+Math.random()),u(n)}let m=!1;function g(e){m||(m=!0,h(),c||(null!==r?(e||(s=2),clearTimeout(r),u(0)):e||(s=1)))}return u(0),a=setTimeout(()=>{o=!0,g(!0)},n),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ok{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function sk(...e){const t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(ek())return new Blob(e);throw new Pv(Dv.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function lk(e){if("undefined"==typeof atob)throw t="base-64",new Pv(Dv.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ck="raw",dk="base64",uk="base64url",hk="data_url";class pk{constructor(e,t){this.data=e,this.contentType=t||null}}function mk(e,t){switch(e){case ck:return new pk(gk(t));case dk:case uk:return new pk(fk(e,t));case hk:return new pk(function(e){const t=new xk(e);return t.base64?fk(dk,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(RB){throw Gv(hk,"Malformed data URL.")}return gk(t)}(t.rest)}(t),new xk(t).contentType)}throw qv()}function gk(e){const t=[];for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);if(i<=127)t.push(i);else if(i<=2047)t.push(192|i>>6,128|63&i);else if(55296==(64512&i)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){i=65536|(1023&i)<<10|1023&e.charCodeAt(++n),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)}else t.push(239,191,189)}else 56320==(64512&i)?t.push(239,191,189):t.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(t)}function fk(e,t){switch(e){case dk:{const n=-1!==t.indexOf("-"),i=-1!==t.indexOf("_");if(n||i){throw Gv(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case uk:{const n=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(n||i){throw Gv(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=lk(t)}catch(RB){if(RB.message.includes("polyfill"))throw RB;throw Gv(e,"Invalid character found")}const i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}class xk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Gv(hk,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class yk{constructor(e,t){let n=0,i="";Zv(e)?(this.data_=e,n=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Zv(this.data_)){const a=this.data_,o=(i=e,r=t,(n=a).webkitSlice?n.webkitSlice(i,r):n.mozSlice?n.mozSlice(i,r):n.slice?n.slice(i,r):null);return null===o?null:new yk(o)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new yk(n,!0)}var n,i,r}static getBlob(...e){if(ek()){const t=e.map(e=>e instanceof yk?e.data_:e);return new yk(sk.apply(null,t))}{const t=e.map(e=>Xv(e)?mk(ck,e).data:e.data_);let n=0;t.forEach(e=>{n+=e.byteLength});const i=new Uint8Array(n);let r=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)i[r++]=e[t]}),new yk(i,!0)}}uploadData(){return this.data_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bk(e){let t;try{t=JSON.parse(e)}catch(RB){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(e,t){return t}class wk{constructor(e,t,n,i){this.server=e,this.local=t||e,this.writable=!!n,this.xform=i||kk}}let jk=null;function Sk(){if(jk)return jk;const e=[];e.push(new wk("bucket")),e.push(new wk("generation")),e.push(new wk("metageneration")),e.push(new wk("name","fullPath",!0));const t=new wk("name");t.xform=function(e,t){return function(e){return!Xv(e)||e.length<2?e:vk(e)}(t)},e.push(t);const n=new wk("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new wk("timeCreated")),e.push(new wk("updated")),e.push(new wk("md5Hash",null,!0)),e.push(new wk("cacheControl",null,!0)),e.push(new wk("contentDisposition",null,!0)),e.push(new wk("contentEncoding",null,!0)),e.push(new wk("contentLanguage",null,!0)),e.push(new wk("contentType",null,!0)),e.push(new wk("metadata","customMetadata",!0)),jk=e,jk}function Tk(e,t,n){const i={type:"file"},r=n.length;for(let a=0;a<r;a++){const e=n[a];i[e.local]=e.xform(i,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,i=e.fullPath,r=new Yv(n,i);return t._makeStorageReference(r)}})}(i,e),i}function Ck(e,t,n){const i=bk(t);if(null===i)return null;return Tk(e,i,n)}function Ik(e,t){const n={},i=t.length;for(let r=0;r<i;r++){const i=t[r];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}class Bk{constructor(e,t,n,i){this.url=e,this.method=t,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(e){if(!e)throw qv()}function Ak(e,t){return function(n,i){const r=Ck(e,i,t);return Rk(null!==r),r}}function Fk(e,t){return function(n,i){const r=Ck(e,i,t);return Rk(null!==r),function(e,t,n,i){const r=bk(t);if(null===r)return null;if(!Xv(r.downloadTokens))return null;const a=r.downloadTokens;if(0===a.length)return null;const o=encodeURIComponent;return a.split(",").map(t=>{const r=e.bucket,a=e.fullPath;return nk("/b/"+o(r)+"/o/"+o(a),n,i)+ik({alt:"media",token:t})})[0]}(r,i,e.host,e._protocol)}}function zk(e){return function(t,n){let i;var r,a;return 401===t.getStatus()?i=t.getErrorText().includes("Firebase App Check token is invalid")?new Pv(Dv.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Pv(Dv.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(a=e.bucket,i=new Pv(Dv.QUOTA_EXCEEDED,"Quota for bucket '"+a+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(r=e.path,i=new Pv(Dv.UNAUTHORIZED,"User does not have permission to access '"+r+"'.")):i=n,i.status=t.getStatus(),i.serverResponse=n.serverResponse,i}}function Ek(e){const t=zk(e);return function(n,i){let r=t(n,i);var a;return 404===n.getStatus()&&(a=e.path,r=new Pv(Dv.OBJECT_NOT_FOUND,"Object '"+a+"' does not exist.")),r.serverResponse=i.serverResponse,r}}function _k(e,t,n){const i=Object.assign({},n);return i.fullPath=e.path,i.size=t.size(),i.contentType||(i.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),i}class Nk{constructor(e,t,n,i){this.current=e,this.total=t,this.finalized=!!n,this.metadata=i||null}}function Pk(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(RB){Rk(!1)}return Rk(!!n&&-1!==(t||["active"]).indexOf(n)),n}const Dk=262144;function Wk(e,t,n,i,r,a,o,s){const l=new Nk(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw new Pv(Dv.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const c=l.total-l.current;let d=c;r>0&&(d=Math.min(d,r));const u=l.current,h=u+d;let p="";p=0===d?"finalize":c===d?"upload, finalize":"upload";const m={"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":`${l.current}`},g=i.slice(u,h);if(null===g)throw Vv();const f=t.maxUploadRetryTime,x=new Bk(n,"POST",function(e,n){const r=Pk(e,["active","final"]),o=l.current+d,s=i.size();let c;return c="final"===r?Ak(t,a)(e,n):null,new Nk(o,s,"final"===r,c)},f);return x.headers=m,x.body=g.uploadData(),x.progressCallback=s||null,x.errorHandler=zk(e),x}const Mk="running",Lk="paused",Ok="success",qk="canceled",Uk="error";function Hk(e){switch(e){case"running":case"pausing":case"canceling":return Mk;case"paused":return Lk;case"success":return Ok;case"canceled":return qk;default:return Uk}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(e,t,n){const i=function(e){return"function"==typeof e}(e)||null!=t||null!=n;if(i)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(e){return(...t)=>{Promise.resolve().then(()=>e(...t))}}class $k{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Mv.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Mv.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Mv.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,i,r){if(this.sent_)throw Qv("cannot .send() more than once");if(He(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const a in r)r.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,r[a].toString());return void 0!==i?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Qv("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Qv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(RB){return-1}}getResponse(){if(!this.sent_)throw Qv("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Qv("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Gk extends $k{initXhr(){this.xhr_.responseType="text"}}function Qk(){return new Gk}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=Sk(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(Dv.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(rk(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=Uv()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(Dv.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const n=function(e,t,n,i,r){const a=t.bucketOnlyServerUrl(),o=_k(t,i,r),s={name:o.fullPath},l=nk(a,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},d=Ik(o,n),u=e.maxUploadRetryTime,h=new Bk(l,"POST",function(e){let t;Pk(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(RB){Rk(!1)}return Rk(Xv(t)),t},u);return h.urlParams=s,h.headers=c,h.body=d,h.errorHandler=zk(t),h}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(n,Qk,e,t);this._request=i,i.getPromise().then(e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,n)=>{const i=function(e,t,n,i){const r=e.maxUploadRetryTime,a=new Bk(n,"POST",function(e){const t=Pk(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(RB){Rk(!1)}n||Rk(!1);const r=Number(n);return Rk(!isNaN(r)),new Nk(r,i.size(),"final"===t)},r);return a.headers={"X-Goog-Upload-Command":"query"},a.errorHandler=zk(t),a}(this._ref.storage,this._ref._location,e,this._blob),r=this._ref.storage._makeRequest(i,Qk,t,n);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Dk*this._chunkMultiplier,t=new Nk(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((i,r)=>{let a;try{a=Wk(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(RB){return this._error=RB,void this._transition("error")}const o=this._ref.storage._makeRequest(a,Qk,i,r,!1);this._request=o,o.getPromise().then(e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){2*(Dk*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const n=function(e,t,n){const i=nk(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,a=new Bk(i,"GET",Ak(e,n),r);return a.errorHandler=Ek(t),a}(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(n,Qk,e,t);this._request=i,i.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const n=function(e,t,n,i,r){const a=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},s=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+s;const l=_k(t,i,r),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Ik(l,n)+"\r\n--"+s+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",d="\r\n--"+s+"--",u=yk.getBlob(c,i,d);if(null===u)throw Vv();const h={name:l.fullPath},p=nk(a,e.host,e._protocol),m=e.maxUploadRetryTime,g=new Bk(p,"POST",Ak(e,n),m);return g.urlParams=h,g.headers=o,g.body=u.uploadData(),g.errorHandler=zk(t),g}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(n,Qk,e,t);this._request=i,i.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Hv(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Hk(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,i){const r=new Vk(t||void 0,n||void 0,i||void 0);return this._addObserver(r),()=>{this._removeObserver(r)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Hk(this._state)){case Ok:Kk(this._resolve.bind(null,this.snapshot))();break;case qk:case Uk:Kk(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Hk(this._state)){case Mk:case Lk:e.next&&Kk(e.next.bind(e,this.snapshot))();break;case Ok:e.complete&&Kk(e.complete.bind(e))();break;default:e.error&&Kk(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,t){this._service=e,this._location=t instanceof Yv?t:Yv.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Jk(e,t)}get root(){const e=new Yv(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vk(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Yv(this._location.bucket,e);return new Jk(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Pv(Dv.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Xk(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const i=nk(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,a=new Bk(i,"GET",Fk(e,n),r);return a.errorHandler=Ek(t),a}(e.storage,e._location,Sk());return e.storage.makeRequestWithTokens(t,Qk).then(e=>{if(null===e)throw new Pv(Dv.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function Zk(e,t){if(e instanceof nw){const n=e;if(null==n._bucket)throw new Pv(Dv.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Nv+"' property when initializing the app?");const i=new Jk(n,n._bucket);return null!=t?Zk(i,t):i}return void 0!==t?function(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),i=new Yv(e._location.bucket,n);return new Jk(e.storage,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t):e}function ew(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof nw)return new Jk(e,t);throw Kv("To use ref(service, url), the first argument must be a Storage instance.")}return Zk(e,t)}function tw(e,t){const n=null==t?void 0:t[Nv];return null==n?null:Yv.makeFromBucketSpec(n,e)}class nw{constructor(e,t,n,i,r,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=r,this._isUsingEmulator=a,this._bucket=null,this._host=_v,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Yv.makeFromBucketSpec(i,this._host):tw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Yv.makeFromBucketSpec(this._url,e):this._bucket=tw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){tk("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){tk("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(Sn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Jk(this,e)}_makeRequest(e,t,n,i,r=!0){if(this._deleted)return new Jv($v());{const a=function(e,t,n,i,r,a,o=!0,s=!1){const l=ik(e.urlParams),c=e.url+l,d=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(d,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(d,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(d,a),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(d,i),new ak(c,e.method,d,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r,o,s)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,this._appId,n,i,t,this._firebaseVersion,r,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const iw="@firebase/storage",rw="0.13.14",aw="storage";function ow(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new Yk(e,new yk(t),n)}(e=ut(e),t,n)}function sw(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return new nw(n,i,r,t,In)}wn(new ht(aw,sw,"PUBLIC").setMultipleInstances(!0)),An(iw,rw,""),An(iw,rw,"esm2017");const lw=Bn({apiKey:"AIzaSyDi9hdqloCIg_8sfjjyERqnfAr-pW3BeNY",authDomain:"restarter-app.firebaseapp.com",projectId:"restarter-app",storageBucket:"restarter-app.firebasestorage.app",messagingSenderId:"393816322828",appId:"1:393816322828:web:32a9ed91fe95ab9cdd8f29",measurementId:"G-CX4DYFJ5B4"}),cw=vg(lw),dw=Fv(lw),uw=function(e=Rn(),t){const n=jn(e=ut(e),aw).getImmediate({identifier:t}),i=Le("storage");return i&&function(e,t,n,i={}){!function(e,t,n,i={}){e.host=`${t}:${n}`;const r=He(t);r&&(Ve(`https://${e.host}/b`),Qe("Storage",!0)),e._isUsingEmulator=!0,e._protocol=r?"https":"http";const{mockUserToken:a}=i;a&&(e._overrideAuthToken="string"==typeof a?a:Ke(a,e.app.options.projectId))}(e,t,n,i)}(n,...i),n}(lw),hw=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"th",label:"ภาษาไทย"},{code:"vi",label:"Tiếng Việt"},{code:"ms",label:"Bahasa Melayu"},{code:"la",label:"Latīna"}],pw=e.createContext(null),mw=()=>{const t=e.useContext(pw);if(!t)throw new Error("useLanguage must be used within a LanguageProvider");return t},gw=({children:t})=>{const[n,i]=e.useState(()=>{try{const e=localStorage.getItem("lang");if(e&&hw.some(t=>t.code===e))return e}catch(e){}return"zh-TW"});e.useEffect(()=>{try{const e=localStorage.getItem("lang");if(e&&hw.some(t=>t.code===e))return;const t={en:"en","en-US":"en","en-GB":"en","zh-TW":"zh-TW","zh-HK":"zh-TW","zh-Hant":"zh-TW","zh-CN":"zh-CN","zh-Hans":"zh-CN",ja:"ja",ko:"ko",vi:"vi",th:"th",ms:"ms",la:"la"},r=navigator.language||navigator.languages&&navigator.languages[0]||"";let a="en";t[r]?a=t[r]:t[r.split("-")[0]]&&(a=t[r.split("-")[0]]),a!==n&&(i(a),localStorage.setItem("lang",a))}catch(e){}},[]);const r={lang:n,setLang:e=>{try{i(e),localStorage.setItem("lang",e)}catch(t){}},LANGS:hw};return f.jsx(pw.Provider,{value:r,children:t})},fw=({className:e="",style:t={}})=>{const{lang:n,setLang:i,LANGS:r}=mw(),a={padding:"3px 6px",borderRadius:4,fontWeight:600,fontSize:11,border:"1px solid #6B5BFF",color:"#6B5BFF",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",minWidth:void 0!==t.minWidth?t.minWidth:50,...t};return f.jsx("select",{value:n,onChange:e=>i(e.target.value),className:e,style:a,children:r.map(e=>f.jsx("option",{value:e.code,children:e.label},e.code))})},xw=({isOpen:e,onClose:t,title:n,message:i,requiredPlan:r="basic"})=>{const a=le(),o=window.innerWidth<=768;if(!e)return null;return f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:f.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:o?20:32,maxWidth:400,width:"90%",maxHeight:"80vh",overflowY:"auto",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[f.jsx("div",{style:{fontSize:o?36:48,marginBottom:o?12:16,color:"#6B5BFF"},children:"🚀"}),f.jsx("h2",{style:{fontSize:o?20:24,fontWeight:700,color:"#333",marginBottom:o?8:12},children:n}),f.jsx("p",{style:{fontSize:o?14:16,color:"#666",marginBottom:o?16:20,lineHeight:1.6},children:i}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:o?12:16,marginBottom:o?16:24,border:"1px solid #e0e8ff"},children:[f.jsx("div",{style:{fontSize:o?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:o?6:8},children:"💡 升級小提醒"}),f.jsxs("div",{style:{fontSize:o?11:13,color:"#666",lineHeight:1.4},children:["• 升級後立即生效，無需等待",f.jsx("br",{}),"• 可隨時取消，權益保留至本期結束",f.jsx("br",{}),"• 支援多種付款方式，安全便捷"]})]}),r&&f.jsx("div",{style:{background:"#fff",borderRadius:10,padding:o?10:14,marginBottom:o?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:f.jsxs("span",{style:{fontSize:o?12:14,color:"#6B5BFF",fontWeight:700},children:["✨ 建議方案：",{basic:"基礎版 (NT$ 149/月)",advanced:"進階版 (NT$ 249/月)",professional:"專業版 (NT$ 349/月)",unlimited:"無限版 (NT$ 499/月)"}[r]," 或更高"]})}),f.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{t(),a("/plans")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),f.jsx("button",{onClick:t,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9ff",e.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})},yw=({isOpen:e,onClose:t,currentPlan:n,remainingDays:i,usedTokens:r,totalTokens:a})=>{const o=le();if(!e)return null;const s={basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"};return f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:f.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[f.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"Token 已用完，需要續購嗎？"}),f.jsxs("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:["您的 ",s[n]," 方案 Token 已用完，但還有 ",i," 天到期。"]}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[f.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"📊 本月使用狀況"}),f.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 已使用：",Math.round(r/1e3),"K / ",Math.round(a/1e3),"K tokens",f.jsx("br",{}),"• 剩餘天數：",i," 天",f.jsx("br",{}),"• 當前方案：",s[n]]})]}),f.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[f.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:700,marginBottom:12},children:"💡 續購方案"}),f.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:1.5,marginBottom:16},children:[f.jsx("strong",{children:"立即續購："}),"重新獲得 ",{basic:"50K",advanced:"100K",professional:"200K",unlimited:"500K"}[n]," tokens，",f.jsx("br",{}),"並從今天開始重新計算 ",i," 天使用期"]}),f.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#6B5BFF"},children:{basic:"NT$ 149",advanced:"NT$ 249",professional:"NT$ 349",unlimited:"NT$ 499"}[n]})]}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #ffeaa7"},children:[f.jsx("div",{style:{fontSize:14,color:"#856404",fontWeight:600,marginBottom:8},children:"✨ 續購好處"}),f.jsxs("div",{style:{fontSize:13,color:"#856404",lineHeight:1.4},children:["• 立即恢復語音功能使用",f.jsx("br",{}),"• 時間從今天重新計算，更划算",f.jsx("br",{}),"• 文字功能不受影響，可繼續使用"]})]}),f.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{t(),o("/plans")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"⚡ 立即續購"}),f.jsx("button",{onClick:t,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9ff",e.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),f.jsx("div",{style:{marginTop:16},children:f.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},bw={baseURL:"https://restarter-backend-6e9s.onrender.com/api",wsURL:"wss://restarter-backend-6e9s.onrender.com"},vw=bw.baseURL,kw=bw.wsURL,ww=e=>`${vw}${e}`,jw=({className:t="",showDetails:n=!1})=>{const{lang:i}=mw(),[r,a]=e.useState(null),[o,s]=e.useState(!0),[l,c]=e.useState(null);e.useEffect(()=>{d()},[i]);const d=async()=>{try{s(!0),c(null);const e="Taipei",t=await fetch(ww(`/weather/current?city=${e}`));if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json();if(n.weather){const e=u(n.weather,i);a(e)}else c(n.error||"無法獲取天氣資訊")}catch(e){c("天氣服務暫時無法使用")}finally{s(!1)}},u=(e,t)=>{var n,i,r;const a={"zh-TW":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],"zh-CN":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ja:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ko:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],th:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],vi:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"],ms:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],la:["Dies Solis","Dies Lunae","Dies Martis","Dies Mercurii","Dies Iovis","Dies Veneris","Dies Saturni"]},o=(null==(n={"zh-TW":{"clear sky":"晴天","few clouds":"少雲","scattered clouds":"多雲","broken clouds":"陰天","shower rain":"陣雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"煙霧",dust:"沙塵",sand:"沙塵",ash:"火山灰",squall:"狂風",tornado:"龍捲風",sunny:"晴天","partly cloudy":"多雲時晴",cloudy:"陰天",overcast:"陰天",mist:"霧",fog:"霧","patchy rain possible":"可能有陣雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夾雪","patchy freezing drizzle possible":"可能有凍雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴風雪","freezing fog":"凍霧","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"凍雨","heavy freezing drizzle":"強凍雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"間歇性中雨","moderate rain":"中雨","heavy rain at times":"間歇性大雨","heavy rain":"大雨","light freezing rain":"輕凍雨","moderate or heavy freezing rain":"中到強凍雨","light sleet":"輕雨夾雪","moderate or heavy sleet":"中到強雨夾雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨陣","moderate or heavy rain shower":"中到強雨陣","torrential rain shower":"暴雨陣","light sleet showers":"小雨夾雪陣","moderate or heavy sleet showers":"中到強雨夾雪陣","light snow showers":"小雪陣","moderate or heavy snow showers":"中到強雪陣","light showers of ice pellets":"輕冰雹陣","moderate or heavy showers of ice pellets":"中到強冰雹陣","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到強雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到強雪伴雷","局部多云":"局部多云"},"zh-CN":{"clear sky":"晴天","few clouds":"少云","scattered clouds":"多云","broken clouds":"阴天","shower rain":"阵雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"烟雾",dust:"沙尘",sand:"沙尘",ash:"火山灰",squall:"狂风",tornado:"龙卷风",sunny:"晴天","partly cloudy":"多云时晴",cloudy:"阴天",overcast:"阴天",mist:"雾",fog:"雾","patchy rain possible":"可能有阵雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夹雪","patchy freezing drizzle possible":"可能有冻雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴风雪","freezing fog":"冻雾","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"冻雨","heavy freezing drizzle":"强冻雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"间歇性中雨","moderate rain":"中雨","heavy rain at times":"间歇性大雨","heavy rain":"大雨","light freezing rain":"轻冻雨","moderate or heavy freezing rain":"中到强冻雨","light sleet":"轻雨夹雪","moderate or heavy sleet":"中到强雨夹雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨阵","moderate or heavy rain shower":"中到强雨阵","torrential rain shower":"暴雨阵","light sleet showers":"小雨夹雪阵","moderate or heavy sleet showers":"中到强雨夹雪阵","light snow showers":"小雪阵","moderate or heavy snow showers":"中到强雪阵","light showers of ice pellets":"轻冰雹阵","moderate or heavy showers of ice pellets":"中到强冰雹阵","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到强雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到强雪伴雷","局部多云":"Partly Cloudy"},en:{"clear sky":"Clear","few clouds":"Partly Cloudy","scattered clouds":"Cloudy","broken clouds":"Overcast","shower rain":"Showers",rain:"Rain",thunderstorm:"Thunderstorm",snow:"Snow",haze:"Haze",smoke:"Smoke",dust:"Dust",sand:"Sand",ash:"Ash",squall:"Squall",tornado:"Tornado",sunny:"Sunny","partly cloudy":"Partly Cloudy",cloudy:"Cloudy",overcast:"Overcast",mist:"Mist",fog:"Fog","patchy rain possible":"Patchy Rain","patchy snow possible":"Patchy Snow","patchy sleet possible":"Patchy Sleet","patchy freezing drizzle possible":"Patchy Freezing Drizzle","thundery outbreaks possible":"Thundery Outbreaks","blowing snow":"Blowing Snow",blizzard:"Blizzard","freezing fog":"Freezing Fog","patchy light drizzle":"Patchy Light Drizzle","light drizzle":"Light Drizzle","freezing drizzle":"Freezing Drizzle","heavy freezing drizzle":"Heavy Freezing Drizzle","patchy light rain":"Patchy Light Rain","light rain":"Light Rain","moderate rain at times":"Moderate Rain","moderate rain":"Moderate Rain","heavy rain at times":"Heavy Rain","heavy rain":"Heavy Rain","light freezing rain":"Light Freezing Rain","moderate or heavy freezing rain":"Moderate or Heavy Freezing Rain","light sleet":"Light Sleet","moderate or heavy sleet":"Moderate or Heavy Sleet","patchy light snow":"Patchy Light Snow","light snow":"Light Snow","patchy moderate snow":"Patchy Moderate Snow","moderate snow":"Moderate Snow","patchy heavy snow":"Patchy Heavy Snow","heavy snow":"Heavy Snow","ice pellets":"Ice Pellets","light rain shower":"Light Rain Shower","moderate or heavy rain shower":"Moderate or Heavy Rain Shower","torrential rain shower":"Torrential Rain Shower","light sleet showers":"Light Sleet Showers","moderate or heavy sleet showers":"Moderate or Heavy Sleet Showers","light snow showers":"Light Snow Showers","moderate or heavy snow showers":"Moderate or Heavy Snow Showers","light showers of ice pellets":"Light Ice Pellet Showers","moderate or heavy showers of ice pellets":"Moderate or Heavy Ice Pellet Showers","patchy light rain with thunder":"Patchy Light Rain with Thunder","moderate or heavy rain with thunder":"Moderate or Heavy Rain with Thunder","patchy light snow with thunder":"Patchy Light Snow with Thunder","moderate or heavy snow with thunder":"Moderate or Heavy Snow with Thunder","局部多云":"Partly Cloudy"},ja:{"clear sky":"晴天","few clouds":"晴れ時々曇り","scattered clouds":"曇り","broken clouds":"曇り","shower rain":"にわか雨",rain:"雨",thunderstorm:"雷雨",snow:"雪",haze:"もや",smoke:"煙",dust:"砂塵",sand:"砂塵",ash:"火山灰",squall:"突風",tornado:"竜巻",sunny:"晴天","partly cloudy":"晴れ時々曇り",cloudy:"曇り",overcast:"曇り",mist:"霧",fog:"霧","patchy rain possible":"にわか雨の可能性","patchy snow possible":"にわか雪の可能性","patchy sleet possible":"にわかみぞれの可能性","patchy freezing drizzle possible":"にわか凍る霧雨の可能性","thundery outbreaks possible":"雷雨の可能性","blowing snow":"吹雪",blizzard:"猛吹雪","freezing fog":"凍る霧","patchy light drizzle":"にわか小雨","light drizzle":"小雨","freezing drizzle":"凍る霧雨","heavy freezing drizzle":"強い凍る霧雨","patchy light rain":"にわか小雨","light rain":"小雨","moderate rain at times":"時々中雨","moderate rain":"中雨","heavy rain at times":"時々大雨","heavy rain":"大雨","light freezing rain":"軽い凍る雨","moderate or heavy freezing rain":"中程度または強い凍る雨","light sleet":"軽いみぞれ","moderate or heavy sleet":"中程度または強いみぞれ","patchy light snow":"にわか小雪","light snow":"小雪","patchy moderate snow":"にわか中雪","moderate snow":"中雪","patchy heavy snow":"にわか大雪","heavy snow":"大雪","ice pellets":"氷の粒","light rain shower":"小雨のシャワー","moderate or heavy rain shower":"中程度または強い雨のシャワー","torrential rain shower":"豪雨のシャワー","light sleet showers":"軽いみぞれのシャワー","moderate or heavy sleet showers":"中程度または強いみぞれのシャワー","light snow showers":"小雪のシャワー","moderate or heavy snow showers":"中程度または強い雪のシャワー","light showers of ice pellets":"軽い氷の粒のシャワー","moderate or heavy showers of ice pellets":"中程度または強い氷の粒のシャワー","patchy light rain with thunder":"にわか小雨と雷","moderate or heavy rain with thunder":"中程度または強い雨と雷","patchy light snow with thunder":"にわか小雪と雷","moderate or heavy snow with thunder":"中程度または強い雪と雷","局部多云":"晴れ時々曇り"},ko:{"clear sky":"맑음","few clouds":"구름 조금","scattered clouds":"구름 많음","broken clouds":"흐림","shower rain":"소나기",rain:"비",thunderstorm:"천둥번개",snow:"눈",haze:"연무",smoke:"연기",dust:"먼지",sand:"모래",ash:"화산재",squall:"돌풍",tornado:"토네이도",sunny:"맑음","partly cloudy":"구름 조금",cloudy:"흐림",overcast:"흐림",mist:"안개",fog:"안개","patchy rain possible":"소나기 가능","patchy snow possible":"눈 가능","patchy sleet possible":"진눈깨비 가능","patchy freezing drizzle possible":"얼음비 가능","thundery outbreaks possible":"천둥번개 가능","blowing snow":"눈보라",blizzard:"폭설","freezing fog":"얼음안개","patchy light drizzle":"가벼운 이슬비","light drizzle":"이슬비","freezing drizzle":"얼음비","heavy freezing drizzle":"강한 얼음비","patchy light rain":"가벼운 비","light rain":"가벼운 비","moderate rain at times":"중간 비","moderate rain":"중간 비","heavy rain at times":"강한 비","heavy rain":"강한 비","light freezing rain":"가벼운 얼음비","moderate or heavy freezing rain":"중간 또는 강한 얼음비","light sleet":"가벼운 진눈깨비","moderate or heavy sleet":"중간 또는 강한 진눈깨비","patchy light snow":"가벼운 눈","light snow":"가벼운 눈","patchy moderate snow":"중간 눈","moderate snow":"중간 눈","patchy heavy snow":"강한 눈","heavy snow":"강한 눈","ice pellets":"얼음알갱이","light rain shower":"가벼운 소나기","moderate or heavy rain shower":"중간 또는 강한 소나기","torrential rain shower":"폭우","light sleet showers":"가벼운 진눈깨비 소나기","moderate or heavy sleet showers":"중간 또는 강한 진눈깨비 소나기","light snow showers":"가벼운 눈 소나기","moderate or heavy snow showers":"중간 또는 강한 눈 소나기","light showers of ice pellets":"가벼운 얼음알갱이 소나기","moderate or heavy showers of ice pellets":"중간 또는 강한 얼음알갱이 소나기","patchy light rain with thunder":"가벼운 비와 천둥","moderate or heavy rain with thunder":"중간 또는 강한 비와 천둥","patchy light snow with thunder":"가벼운 눈과 천둥","moderate or heavy snow with thunder":"중간 또는 강한 눈과 천둥","局部多云":"구름 조금"},th:{"clear sky":"ท้องฟ้าแจ่มใส","few clouds":"มีเมฆบางส่วน","scattered clouds":"มีเมฆมาก","broken clouds":"เมฆมาก","shower rain":"ฝนตกเป็นช่วง",rain:"ฝนตก",thunderstorm:"พายุฝนฟ้าคะนอง",snow:"หิมะตก",haze:"หมอกควัน",smoke:"ควัน",dust:"ฝุ่น",sand:"ทราย",ash:"เถ้าถ่าน",squall:"ลมกระโชก",tornado:"พายุทอร์นาโด",sunny:"ท้องฟ้าแจ่มใส","partly cloudy":"มีเมฆบางส่วน",cloudy:"เมฆมาก",overcast:"เมฆมาก",mist:"หมอก",fog:"หมอก","patchy rain possible":"อาจมีฝนตกเป็นช่วง","patchy snow possible":"อาจมีหิมะตกเป็นช่วง","patchy sleet possible":"อาจมีหิมะปนฝนเป็นช่วง","patchy freezing drizzle possible":"อาจมีน้ำค้างแข็งเป็นช่วง","thundery outbreaks possible":"อาจมีพายุฝนฟ้าคะนอง","blowing snow":"หิมะปลิว",blizzard:"พายุหิมะ","freezing fog":"หมอกแข็ง","patchy light drizzle":"น้ำค้างเบาเป็นช่วง","light drizzle":"น้ำค้างเบา","freezing drizzle":"น้ำค้างแข็ง","heavy freezing drizzle":"น้ำค้างแข็งแรง","patchy light rain":"ฝนเบาเป็นช่วง","light rain":"ฝนเบา","moderate rain at times":"ฝนปานกลางเป็นครั้งคราว","moderate rain":"ฝนปานกลาง","heavy rain at times":"ฝนแรงเป็นครั้งคราว","heavy rain":"ฝนแรง","light freezing rain":"ฝนแข็งเบา","moderate or heavy freezing rain":"ฝนแข็งปานกลางหรือแรง","light sleet":"หิมะปนฝนเบา","moderate or heavy sleet":"หิมะปนฝนปานกลางหรือแรง","patchy light snow":"หิมะเบาเป็นช่วง","light snow":"หิมะเบา","patchy moderate snow":"หิมะปานกลางเป็นช่วง","moderate snow":"หิมะปานกลาง","patchy heavy snow":"หิมะแรงเป็นช่วง","heavy snow":"หิมะแรง","ice pellets":"ลูกเห็บ","light rain shower":"ฝนเบาสั้นๆ","moderate or heavy rain shower":"ฝนปานกลางหรือแรงสั้นๆ","torrential rain shower":"ฝนแรงสั้นๆ","light sleet showers":"หิมะปนฝนเบาสั้นๆ","moderate or heavy sleet showers":"หิมะปนฝนปานกลางหรือแรงสั้นๆ","light snow showers":"หิมะเบาสั้นๆ","moderate or heavy snow showers":"หิมะปานกลางหรือแรงสั้นๆ","light showers of ice pellets":"ลูกเห็บเบาสั้นๆ","moderate or heavy showers of ice pellets":"ลูกเห็บปานกลางหรือแรงสั้นๆ","patchy light rain with thunder":"ฝนเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy rain with thunder":"ฝนปานกลางหรือแรงพร้อมฟ้าผ่า","patchy light snow with thunder":"หิมะเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy snow with thunder":"หิมะปานกลางหรือแรงพร้อมฟ้าผ่า","局部多云":"มีเมฆบางส่วน"},vi:{"clear sky":"Trời quang","few clouds":"Ít mây","scattered clouds":"Nhiều mây","broken clouds":"U ám","shower rain":"Mưa rào",rain:"Mưa",thunderstorm:"Giông bão",snow:"Tuyết",haze:"Sương mù nhẹ",smoke:"Khói",dust:"Bụi",sand:"Cát",ash:"Tro núi lửa",squall:"Gió mạnh",tornado:"Lốc xoáy",sunny:"Trời nắng","partly cloudy":"Ít mây",cloudy:"Nhiều mây",overcast:"U ám",mist:"Sương mù",fog:"Sương mù","patchy rain possible":"Có thể mưa rào","patchy snow possible":"Có thể có tuyết","patchy sleet possible":"Có thể có mưa tuyết","patchy freezing drizzle possible":"Có thể có mưa đá","thundery outbreaks possible":"Có thể có giông bão","blowing snow":"Tuyết bay",blizzard:"Bão tuyết","freezing fog":"Sương mù đóng băng","patchy light drizzle":"Mưa phùn nhẹ","light drizzle":"Mưa phùn nhẹ","freezing drizzle":"Mưa đá","heavy freezing drizzle":"Mưa đá mạnh","patchy light rain":"Mưa nhẹ","light rain":"Mưa nhẹ","moderate rain at times":"Mưa vừa","moderate rain":"Mưa vừa","heavy rain at times":"Mưa to","heavy rain":"Mưa to","light freezing rain":"Mưa đá nhẹ","moderate or heavy freezing rain":"Mưa đá vừa hoặc mạnh","light sleet":"Mưa tuyết nhẹ","moderate or heavy sleet":"Mưa tuyết vừa hoặc mạnh","patchy light snow":"Tuyết nhẹ","light snow":"Tuyết nhẹ","patchy moderate snow":"Tuyết vừa","moderate snow":"Tuyết vừa","patchy heavy snow":"Tuyết to","heavy snow":"Tuyết to","ice pellets":"Mưa đá","light rain shower":"Mưa rào nhẹ","moderate or heavy rain shower":"Mưa rào vừa hoặc mạnh","torrential rain shower":"Mưa rào to","light sleet showers":"Mưa tuyết nhẹ","moderate or heavy sleet showers":"Mưa tuyết vừa hoặc mạnh","light snow showers":"Tuyết nhẹ","moderate or heavy snow showers":"Tuyết vừa hoặc mạnh","light showers of ice pellets":"Mưa đá nhẹ","moderate or heavy showers of ice pellets":"Mưa đá vừa hoặc mạnh","patchy light rain with thunder":"Mưa nhẹ có sấm","moderate or heavy rain with thunder":"Mưa vừa hoặc mạnh có sấm","patchy light snow with thunder":"Tuyết nhẹ có sấm","moderate or heavy snow with thunder":"Tuyết vừa hoặc mạnh có sấm","局部多云":"Ít mây"},ms:{"clear sky":"Cerah","few clouds":"Sedikit berawan","scattered clouds":"Berawan","broken clouds":"Mendung","shower rain":"Hujan renyai",rain:"Hujan",thunderstorm:"Ribut petir",snow:"Salji",haze:"Jerebu",smoke:"Asap",dust:"Debu",sand:"Pasir",ash:"Abu gunung berapi",squall:"Angin kencang",tornado:"Puting beliung",sunny:"Cerah","partly cloudy":"Sedikit berawan",cloudy:"Berawan",overcast:"Mendung",mist:"Kabut",fog:"Kabut","patchy rain possible":"Hujan renyai mungkin","patchy snow possible":"Salji mungkin","patchy sleet possible":"Hujan salji mungkin","patchy freezing drizzle possible":"Hujan beku mungkin","thundery outbreaks possible":"Ribut petir mungkin","blowing snow":"Salji berterbangan",blizzard:"Ribut salji","freezing fog":"Kabut beku","patchy light drizzle":"Hujan renyai ringan","light drizzle":"Hujan renyai ringan","freezing drizzle":"Hujan beku","heavy freezing drizzle":"Hujan beku lebat","patchy light rain":"Hujan ringan","light rain":"Hujan ringan","moderate rain at times":"Hujan sederhana","moderate rain":"Hujan sederhana","heavy rain at times":"Hujan lebat","heavy rain":"Hujan lebat","light freezing rain":"Hujan beku ringan","moderate or heavy freezing rain":"Hujan beku sederhana atau lebat","light sleet":"Hujan salji ringan","moderate or heavy sleet":"Hujan salji sederhana atau lebat","patchy light snow":"Salji ringan","light snow":"Salji ringan","patchy moderate snow":"Salji sederhana","moderate snow":"Salji sederhana","patchy heavy snow":"Salji lebat","heavy snow":"Salji lebat","ice pellets":"Hujan batu","light rain shower":"Hujan ringan","moderate or heavy rain shower":"Hujan sederhana atau lebat","torrential rain shower":"Hujan lebat","light sleet showers":"Hujan salji ringan","moderate or heavy sleet showers":"Hujan salji sederhana atau lebat","light snow showers":"Salji ringan","moderate or heavy snow showers":"Salji sederhana atau lebat","light showers of ice pellets":"Hujan batu ringan","moderate or heavy showers of ice pellets":"Hujan batu sederhana atau lebat","patchy light rain with thunder":"Hujan ringan dengan petir","moderate or heavy rain with thunder":"Hujan sederhana atau lebat dengan petir","patchy light snow with thunder":"Salji ringan dengan petir","moderate or heavy snow with thunder":"Salji sederhana atau lebat dengan petir","局部多云":"Sedikit berawan"},la:{"clear sky":"Serenum","few clouds":"Nubibus paucis","scattered clouds":"Nubibus dispersis","broken clouds":"Nubibus fractis","shower rain":"Imbre",rain:"Pluvia",thunderstorm:"Tempestas",snow:"Nix",haze:"Caligo",smoke:"Fumus",dust:"Pulvis",sand:"Arena",ash:"Cinis",squall:"Procella",tornado:"Turbo",sunny:"Serenum","partly cloudy":"Nubibus paucis",cloudy:"Nubibus",overcast:"Nubibus densis",mist:"Nebula",fog:"Nebula","patchy rain possible":"Imbre possibilis","patchy snow possible":"Nix possibilis","patchy sleet possible":"Nix pluvia possibilis","patchy freezing drizzle possible":"Gelida pluvia possibilis","thundery outbreaks possible":"Tempestas possibilis","blowing snow":"Nix ventosa",blizzard:"Procella nivis","freezing fog":"Gelida nebula","patchy light drizzle":"Levis pluvia","light drizzle":"Levis pluvia","freezing drizzle":"Gelida pluvia","heavy freezing drizzle":"Gravis gelida pluvia","patchy light rain":"Levis pluvia","light rain":"Levis pluvia","moderate rain at times":"Moderata pluvia","moderate rain":"Moderata pluvia","heavy rain at times":"Gravis pluvia","heavy rain":"Gravis pluvia","light freezing rain":"Levis gelida pluvia","moderate or heavy freezing rain":"Moderata vel gravis gelida pluvia","light sleet":"Levis nix pluvia","moderate or heavy sleet":"Moderata vel gravis nix pluvia","patchy light snow":"Levis nix","light snow":"Levis nix","patchy moderate snow":"Moderata nix","moderate snow":"Moderata nix","patchy heavy snow":"Gravis nix","heavy snow":"Gravis nix","ice pellets":"Glacies grana","light rain shower":"Levis pluvia","moderate or heavy rain shower":"Moderata vel gravis pluvia","torrential rain shower":"Torrens pluvia","light sleet showers":"Levis nix pluvia","moderate or heavy sleet showers":"Moderata vel gravis nix pluvia","light snow showers":"Levis nix","moderate or heavy snow showers":"Moderata vel gravis nix","light showers of ice pellets":"Levis glacies grana","moderate or heavy showers of ice pellets":"Moderata vel gravis glacies grana","patchy light rain with thunder":"Levis pluvia cum tonitru","moderate or heavy rain with thunder":"Moderata vel gravis pluvia cum tonitru","patchy light snow with thunder":"Levis nix cum tonitru","moderate or heavy snow with thunder":"Moderata vel gravis nix cum tonitru","局部多云":"Nubibus paucis"}}[t])?void 0:n[e.description.toLowerCase()])||e.description,s=(null==(i={"zh-TW":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃園市",Hsinchu:"新竹市",Chiayi:"嘉義市",Keelung:"基隆市",Hualien:"花蓮縣",Taitung:"台東縣",Pingtung:"屏東縣",Yilan:"宜蘭縣",Nantou:"南投縣",Yunlin:"雲林縣",Changhua:"彰化縣",Miaoli:"苗栗縣"},"zh-CN":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃园市",Hsinchu:"新竹市",Chiayi:"嘉义市",Keelung:"基隆市",Hualien:"花莲县",Taitung:"台东县",Pingtung:"屏东县",Yilan:"宜兰县",Nantou:"南投县",Yunlin:"云林县",Changhua:"彰化县",Miaoli:"苗栗县"},en:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},ja:{Taipei:"台北",Taichung:"台中",Tainan:"台南",Kaohsiung:"高雄","New Taipei":"新北",Taoyuan:"桃園",Hsinchu:"新竹",Chiayi:"嘉義",Keelung:"基隆",Hualien:"花蓮",Taitung:"台東",Pingtung:"屏東",Yilan:"宜蘭",Nantou:"南投",Yunlin:"雲林",Changhua:"彰化",Miaoli:"苗栗"},ko:{Taipei:"타이페이",Taichung:"타이중",Tainan:"타이난",Kaohsiung:"가오슝","New Taipei":"신베이",Taoyuan:"타오위안",Hsinchu:"신주",Chiayi:"자이",Keelung:"지룽",Hualien:"화롄",Taitung:"타이둥",Pingtung:"핑둥",Yilan:"이란",Nantou:"난터우",Yunlin:"윈린",Changhua:"창화",Miaoli:"먀오리"},th:{Taipei:"ไทเป",Taichung:"ไทจง",Tainan:"ไทหนาน",Kaohsiung:"เกาสง","New Taipei":"ซินเป่ย์",Taoyuan:"เถาหยวน",Hsinchu:"ซินจู๋",Chiayi:"เจียอี้",Keelung:"จีหลง",Hualien:"ฮวาเหลียน",Taitung:"ไถตง",Pingtung:"ผิงตง",Yilan:"อี๋หลาน",Nantou:"หนานโถว",Yunlin:"ยฺหวินหลิน",Changhua:"จางฮัว",Miaoli:"เหมียวลี่"},vi:{Taipei:"Đài Bắc",Taichung:"Đài Trung",Tainan:"Đài Nam",Kaohsiung:"Cao Hùng","New Taipei":"Tân Bắc",Taoyuan:"Đào Viên",Hsinchu:"Tân Trúc",Chiayi:"Gia Nghĩa",Keelung:"Cơ Long",Hualien:"Hoa Liên",Taitung:"Đài Đông",Pingtung:"Bình Đông",Yilan:"Nghi Lan",Nantou:"Nam Đầu",Yunlin:"Vân Lâm",Changhua:"Chương Hóa",Miaoli:"Miêu Lật"},ms:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},la:{Taipei:"Taipeium",Taichung:"Taichungum",Tainan:"Tainanum",Kaohsiung:"Kaohsiungum","New Taipei":"Novum Taipeium",Taoyuan:"Taoyuanum",Hsinchu:"Hsinchuum",Chiayi:"Chiayium",Keelung:"Keelungum",Hualien:"Hualienum",Taitung:"Taitungum",Pingtung:"Pingtungum",Yilan:"Yilanum",Nantou:"Nantouum",Yunlin:"Yunlinum",Changhua:"Changhuaum",Miaoli:"Miaolium"}}[t])?void 0:i[e.city])||e.city,l=(null==(r=a[t])?void 0:r[(new Date).getDay()])||a.en[(new Date).getDay()];return{...e,description:o,city:s,weekday:l}};if(o)return f.jsx("div",{className:`weather-widget ${t}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:f.jsx("div",{style:{fontSize:"12px",color:"#666",textAlign:"center"},children:"載入中..."})});if(l)return f.jsx("div",{className:`weather-widget ${t}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:f.jsx("div",{style:{fontSize:"12px",color:"#ff6b6b",textAlign:"center"},children:l})});if(!r)return null;const h=u(r,i);return f.jsx("div",{className:`weather-widget ${t}`,onClick:()=>{const e=(null==r?void 0:r.city)||"Taipei",t=`https://www.google.com/search?q=weather+${encodeURIComponent(e)}`;window.open(t,"_blank")},style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)",e.currentTarget.style.transform="translateY(0)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{fontSize:"16px"},children:"☀️"}),f.jsxs("div",{style:{fontSize:"14px",fontWeight:600,color:"#6B5BFF"},children:[h.temp,"°C"]}),f.jsx("div",{style:{fontSize:"10px",color:"#666"},children:h.description})]}),f.jsx("div",{style:{fontSize:"12px",color:"#666"},children:h.city}),f.jsx("div",{style:{fontSize:"12px",color:"#666"},children:h.weekday})]})})},Sw={"zh-TW":{slogan:["找回信任的起點，重新出發不孤單！"],desc:"Restarter™ 一個重啟人生的平台，這裡沒有標籤，只有理解。\n從「社會融入評估」開始，AI 將陪你走進十個關卡：情緒解鎖、心聲釋放、挑戰任務、交友連結……每一站都為了幫助你找回信任與方向。\n情緒來了不需要壓抑——專屬的情緒發洩遊戲區讓你不傷人更能盡情釋放壓力。\n你不是被定型的人，而是有勇氣重新選擇的人。\n在這裡，你可以放心說出自己的故事與情緒，找到解方，為自己活出下一章。",wall:"你可以放心說出自己的故事與心情，這裡有理解與同行。",friend:"心靈連結坊",voice:"即時語音輸入",ai:"AI 風格回覆",tts:"擬真語音輸出",chat:"即時心聊",emotion:"情緒圖像實驗室",welcomeRegister:"歡迎註冊"},"zh-CN":{slogan:["找回信任的起点，重新出发不孤单！"],desc:"Restarter™ 一个重启人生的平台，这里没有标签，只有理解。\n从「社会融入评估」开始，AI 将陪你走进十个关卡：情绪解锁、心声释放、挑战任务、交友连结……每一站都为了帮助你找回信任与方向。\n情绪来了不需要压抑——专属的情绪发泄游戏区让你不伤人更能尽情释放压力。\n你不是被定型的人，而是有勇气重新选择的人。\n在这里，你可以放心说出自己的故事与情绪，找到解方，为自己活出下一章。",wall:"你可以放心说出自己的故事与心情，这里有理解与同行。",friend:"心灵连接坊",voice:"即时语音输入",ai:"AI 风格回复",tts:"拟真语音输出",chat:"即时心聊",emotion:"情绪图像实验室",welcomeRegister:"欢迎注册"},en:{slogan:["Regain trust and start anew, you are never alone!"],desc:'Restarter™ is a platform for restarting your life. Here, there are no labels, only understanding.\nStarting with "Social Integration Assessment", AI will accompany you through ten levels: emotional unlocking, voice release, challenging tasks, friend connections... every stop is to help you find trust and direction.\nWhen emotions come, there is no need to suppress them—a dedicated emotional release game zone allows you to fully release stress without harming others.\nYou are not a fixed person, but someone with the courage to choose again.\nHere, you can confidently tell your stories and emotions, find solutions, and live out your next chapter.',wall:"You can safely share your story and feelings here, where you will find understanding and companionship.",friend:"Soul Connection Workshop",voice:"Voice Input",ai:"AI Style Reply",tts:"Realistic TTS",chat:"Instant Heart Chat",emotion:"Emotion Visual Lab",welcomeRegister:"Welcome Register"},ja:{slogan:["信頼を取り戻し、新たな一歩を踏み出そう！"],desc:"Restarter™は人生を再出発するためのプラットフォームです。ここにはラベルはなく、理解だけがあります。\n「社会的統合評価」から始まり、AIがあなたと一緒に10のレベルを進みます：感情の解放、心の声の解放、挑戦的なタスク、友達とのつながり... 各ステップはあなたが信頼と方向性を見つけるのを助けるためです。\n感情が湧いてきた時、それを抑える必要はありません——専用の感情解放ゲームゾーンで、他の人を傷つけることなくストレスを完全に解放できます。\nあなたは固定された人ではなく、再び選択する勇気を持つ人です。\nここでは、自分の物語と感情を安心して話し、解決策を見つけ、次の章を生きることができます。",wall:"ここでは安心して自分のストーリーや気持ちを話せます。理解と共感がここにあります。",friend:"心のつながりワークショップ",voice:"音声入力",ai:"AIスタイル返信",tts:"リアルTTS",chat:"即座の心のチャット",emotion:"感情ビジュアルラボ",welcomeRegister:"登録へようこそ"},ko:{slogan:["신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!"],desc:"Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에는 낙인이 없고, 오직 이해만이 있습니다.\n「사회적 통합 평가」부터 시작하여 AI가 당신과 함께 10개의 레벨을 진행합니다: 감정 해방, 마음의 소리 해방, 도전적인 임무, 친구 연결... 각 정류장은 당신이 신뢰와 방향을 찾는 것을 돕기 위한 것입니다.\n감정이 올 때 그것을 억누를 필요가 없습니다——전용 감정 해방 게임 존에서 다른 사람을 다치게 하지 않고 스트레스를 완전히 해방할 수 있습니다.\n당신은 고정된 사람이 아니라 다시 선택할 용기를 가진 사람입니다.\n여기서는 자신의 이야기와 감정을 안심하고 말하고, 해결책을 찾아 다음 장을 살아갈 수 있습니다.",wall:"여기서는 자신의 이야기와 감정을 안심하고 말할 수 있습니다. 이곳에는 이해와 동행이 있습니다.",friend:"영혼 연결 워크숍",voice:"음성 입력",ai:"AI 스타일 답장",tts:"현실적인 TTS",chat:"즉시 마음 채팅",emotion:"감정 비주얼 랩",welcomeRegister:"가입 환영"},th:{slogan:["เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!"],desc:"Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่ไม่มีป้ายกำกับ มีแต่ความเข้าใจ\nเริ่มต้นจาก「การประเมินการผสมผสานทางสังคม」AI จะอยู่เคียงข้างคุณผ่าน 10 ระดับ: การปลดล็อคอารมณ์ การปลดปล่อยเสียงในใจ งานท้าทาย การเชื่อมต่อเพื่อน... ทุกจุดหยุดเพื่อช่วยให้คุณค้นพบความไว้วางใจและทิศทาง\nเมื่ออารมณ์มา ไม่จำเป็นต้องกดดัน——โซนเกมปลดปล่อยอารมณ์เฉพาะช่วยให้คุณปลดปล่อยความเครียดได้อย่างเต็มที่โดยไม่ทำร้ายผู้อื่น\nคุณไม่ใช่คนที่ถูกกำหนดไว้ แต่เป็นคนที่มีความกล้าหาญที่จะเลือกใหม่\nที่นี่ คุณสามารถบอกเล่าเรื่องราวและอารมณ์ของตัวเองได้อย่างสบายใจ หาแนวทางแก้ไข และใช้ชีวิตบทถัดไป",wall:"คุณสามารถพูดเรื่องราวและความรู้สึกของคุณได้อย่างสบายใจ ที่นี่มีความเข้าใจและเพื่อนร่วมทาง",friend:"เวิร์กช็อปการเชื่อมต่อจิตวิญญาณ",voice:"ป้อนข้อมูลด้วยเสียง",ai:"ตอบกลับสไตล์ AI",tts:"TTS ที่สมจริง",chat:"แชทใจทันที",emotion:"ห้องทดลองภาพอารมณ์",welcomeRegister:"ยินดีต้อนรับการลงทะเบียน"},vi:{slogan:["Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!"],desc:"Restarter™ là nền tảng để làm lại cuộc đời. Ở đây không có nhãn mác, chỉ có sự thấu hiểu.\nBắt đầu từ「Đánh giá Hòa nhập Xã hội」, AI sẽ đồng hành cùng bạn qua 10 cấp độ: mở khóa cảm xúc, giải phóng tiếng nói nội tâm, nhiệm vụ thách thức, kết nối bạn bè... mỗi điểm dừng để giúp bạn tìm lại niềm tin và định hướng.\nKhi cảm xúc đến, không cần phải kìm nén——khu vực trò chơi giải phóng cảm xúc chuyên biệt cho phép bạn giải phóng căng thẳng hoàn toàn mà không làm tổn thương người khác.\nBạn không phải là người bị định hình, mà là người có dũng khí để lựa chọn lại.\nỞ đây, bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình, tìm ra giải pháp, và sống chương tiếp theo của cuộc đời.",wall:"Bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình tại đây, nơi có sự thấu hiểu và đồng hành.",friend:"Hội Thảo Kết Nối Tâm Hồn",voice:"Nhập liệu bằng giọng nói",ai:"Trả lời theo phong cách AI",tts:"TTS thực tế",chat:"Trò Chuyện Từ Trái Tim Ngay Lập Tức",emotion:"Phòng thí nghiệm hình ảnh cảm xúc",welcomeRegister:"Chào mừng đăng ký"},ms:{slogan:["Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!"],desc:"Restarter™ ialah platform untuk memulakan semula kehidupan. Di sini tiada label, hanya pemahaman.\nBermula dari「Penilaian Integrasi Sosial」, AI akan menemani anda melalui 10 peringkat: membuka kunci emosi, melepaskan suara hati, tugas mencabar, sambungan rakan... setiap perhentian untuk membantu anda mencari kepercayaan dan arah tuju.\nApabila emosi datang, tidak perlu menekan——zon permainan pelepasan emosi khusus membolehkan anda melepaskan tekanan sepenuhnya tanpa mencederakan orang lain.\nAnda bukan orang yang ditetapkan, tetapi seseorang yang mempunyai keberanian untuk memilih semula.\nDi sini, anda boleh berkongsi kisah dan emosi anda dengan tenang, mencari penyelesaian, dan hidup bab seterusnya.",wall:"Anda boleh berkongsi kisah dan perasaan anda dengan tenang di sini, di mana ada pemahaman dan teman seperjalanan.",friend:"Bengkel Sambungan Jiwa",voice:"Input Suara",ai:"Balasan Gaya AI",tts:"TTS Realistik",chat:"Sembang Hati Segera",emotion:"Makmal Visual Emosi",welcomeRegister:"Selamat Datang Daftar"},la:{slogan:["Fidem recupera et iterum incipe, numquam solus es!"],desc:"Restarter™ est suggestum ad vitam iterum incipiendam. Hic nullae notae sunt, tantum intellectus.\nIncipiendo ab「Aestimatio Integrationis Socialis」, AI tecum per decem gradus ambulabit: solutio affectuum, emissio vocis cordis, negotia provocantia, nexus amicorum... omnis statio ad te adiuvandum fidem et directionem inveniendam.\nCum affectus veniunt, non necesse est eos supprimere——zona ludi emissionis affectuum dedicata te sinit tensionem plene emittere sine aliis laedendis.\nTu non es homo fixus, sed qui audaciam habet iterum eligendi.\nHic, tuto fabulas tuas et affectus narrare potes, solutiones invenire, et proximum caput vivere.",wall:"Hic tuto fabulas tuas et sensus tuos narrare potes: hic intellectus et comitatus invenies.",friend:"Officina Nexus Animi",voice:"Vox Input",ai:"AI Stylus Responsio",tts:"Verus TTS",chat:"Colloquium Cordis Instantaneum",emotion:"Emotion Visual Lab",welcomeRegister:"Benevenite Registrare"}},Tw={"zh-TW":"🧑‍🤝‍🧑","zh-CN":"🧑‍🤝‍🧑",en:"🧑‍🤝‍🧑",ja:"🧑‍🤝‍🧑",ko:"🧑‍🤝‍🧑",th:"🧑‍🤝‍🧑",vi:"🧑‍🤝‍🧑",ms:"🧑‍🤝‍🧑",la:"🧑‍🤝‍🧑"},Cw={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"资料删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보처리방침",terms:"약관/성명",deletion:"데이터 삭제 안내"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/แถลงการณ์",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Pernyataan",deletion:"Penjelasan Penghapusan Data"},la:{privacy:"Consilium Privacy",terms:"Termini/Declaratio",deletion:"Norma Deletionis Datae"}},Iw={"zh-TW":"訂閱方案","zh-CN":"订阅方案",en:"Subscription Plans",ja:"サブスクリプションプラン",ko:"구독 플랜",th:"แผนการสมัครสมาชิก",vi:"Gói Đăng Ký",ms:"Pelan Langganan",la:"Plana Subscriptionis"};function Bw(){const t=le(),{lang:n,setLang:i}=mw(),r=Sw[n],a=e.useRef(null),o=e.useRef(null),[s,l]=e.useState(0),c=Fv(lw),[d,u]=e.useState(c.currentUser),[h,p]=e.useState(!1),[m,g]=e.useState(!1),[x,y]=e.useState(!1),[b,v]=e.useState(!1),[k,w]=e.useState(!1),[j,S]=e.useState({title:"",message:"",requiredPlan:"basic"}),{isTestMode:T}=CB(),[C,I]=e.useState(!1),[B,R]=e.useState({currentPlan:"basic",remainingDays:0,usedTokens:0,totalTokens:0}),[A,F]=e.useState(()=>"undefined"!=typeof window&&window.innerWidth<=768);e.useEffect(()=>{const e=()=>F(window.innerWidth<=768);e(),window.addEventListener("resize",e);const t=setTimeout(()=>{const e=document.querySelector("footer");e&&(e.style.transition="none",setTimeout(()=>{e.style.transition="top 0.3s ease"},50))},500);return()=>{window.removeEventListener("resize",e),clearTimeout(t)}},[]);const z=[{key:"echo-box",icon:"🎤",title:{"zh-TW":"心語日記","zh-CN":"心语日记",ja:"心の言葉日記",en:"Heartfelt Diary",ko:"마음의 말 일기",th:"ไดอารี่คำพูดจากใจ",vi:"Nhật Ký Từ Trái Tim",ms:"Diari Kata-kata Hati",la:"Diarium Verborum Cordis"},desc:{"zh-TW":"語音與文字情緒輸出，個人情緒的私密紀錄","zh-CN":"语音与文字情绪输出，个人情绪的私密记录",ja:"音声とテキストによる感情の出力、個人の感情のプライベートな記録",en:"Voice and text emotional output, private record of personal emotions",ko:"음성과 텍스트 감정 출력, 개인 감정의 사적인 기록",th:"การส่งออกอารมณ์ด้วยเสียงและข้อความ บันทึกส่วนตัวของอารมณ์ส่วนบุคคล",vi:"Đầu ra cảm xúc bằng giọng nói và văn bản, ghi chép riêng tư về cảm xúc cá nhân",ms:"Output emosi suara dan teks, rekod peribadi emosi peribadi",la:"Output emotio vocis et textus, recordatio privata emotionum personalium"},path:"/echo-box"},{key:"restart-wall",icon:"🧱",title:{"zh-TW":"共鳴分享牆","zh-CN":"共鸣分享墙",ja:"共鳴シェアリングウォール",en:"Resonance Sharing Wall",ko:"공명 공유 벽",th:"กำแพงแบ่งปันการสะท้อน",vi:"Tường Chia Sẻ Cộng Hưởng",ms:"Dinding Perkongsian Resonans",la:"Murus Communicationis Resonantiae"},desc:{"zh-TW":"匿名分享情緒故事，促進社群共鳴與互動","zh-CN":"匿名分享情绪故事，促进社群共鸣与互动",ja:"匿名で感情ストーリーを共有し、コミュニティの共鳴とインタラクションを促進",en:"Anonymously share emotional stories, promote community resonance and interaction",ko:"익명으로 감정 이야기를 공유하고, 커뮤니티 공명과 상호작용을 촉진",th:"แบ่งปันเรื่องราวอารมณ์แบบไม่ระบุตัวตน ส่งเสริมการสะท้อนและปฏิสัมพันธ์ของชุมชน",vi:"Chia sẻ câu chuyện cảm xúc ẩn danh, thúc đẩy cộng hưởng và tương tác cộng đồng",ms:"Kongsi cerita emosi secara anonim, galakkan resonans dan interaksi komuniti",la:"Fabulas affectuum anonyme partiri, resonantiam communitatis et interactionem promovere"},path:"/wall"},{key:"my-story",icon:"📖",title:{"zh-TW":"成長足跡","zh-CN":"成长足迹",ja:"成長の足跡",en:"Growth Footprints",ko:"성장의 발자국",th:"รอยเท้าแห่งการเติบโต",vi:"Dấu Chân Trưởng Thành",ms:"Jejak Pertumbuhan",la:"Vestigia Incrementi"},desc:{"zh-TW":"個人成長與目標進度的記錄與回顧","zh-CN":"个人成长与目标进度的记录与回顾",ja:"個人の成長と目標進捗の記録と振り返り",en:"Record and review personal growth and goal progress",ko:"개인 성장과 목표 진행 상황의 기록과 회고",th:"บันทึกและทบทวนการเติบโตส่วนบุคคลและความคืบหน้าของเป้าหมาย",vi:"Ghi lại và xem xét sự phát triển cá nhân và tiến độ mục tiêu",ms:"Rekod dan semak semula pertumbuhan peribadi dan kemajuan matlamat",la:"Recorda et recense incrementum personale et progressum propositi"},path:"/my-story"},{key:"journal",icon:"🌳",title:{"zh-TW":"每日心禮","zh-CN":"每日心礼",ja:"毎日の心の贈り物",en:"Daily Heart Gift",ko:"매일의 마음 선물",th:"ของขวัญใจประจำวัน",vi:"Món Quà Từ Trái Tim Hàng Ngày",ms:"Hadiah Hati Harian",la:"Donum Cordis Diurnum"},desc:{"zh-TW":"每日隨機心情提示與正向鼓勵","zh-CN":"每日随机心情提示与正向鼓励",ja:"毎日のランダムな気分のヒントとポジティブな励まし",en:"Daily random mood prompts and positive encouragement",ko:"매일 랜덤한 기분 힌트와 긍정적인 격려",th:"คำแนะนำอารมณ์แบบสุ่มประจำวันและการให้กำลังใจเชิงบวก",vi:"Gợi ý tâm trạng ngẫu nhiên hàng ngày và khuyến khích tích cực",ms:"Petunjuk mood rawak harian dan galakan positif",la:"Promptus animi cotidiani casuales et hortatio positiva"},path:"/journal"},{key:"missions",icon:"🎯",title:{"zh-TW":"自我挑戰","zh-CN":"自我挑战",en:"Self-Challenge",ja:"自己挑戦",ko:"자기 도전",th:"ท้าทายตัวเอง",vi:"Thử thách bản thân",ms:"Cabaran Diri",la:"Provocatio Sui"},desc:{"zh-TW":"個人成長挑戰任務，激勵持續自我突破","zh-CN":"个人成长挑战任务，激励持续自我突破",en:"Personal growth challenge missions, inspire continuous self-breakthrough",ja:"個人成長挑戦ミッション、継続的な自己突破を鼓舞",ko:"개인 성장 도전 임무, 지속적인 자기 돌파를 격려",th:"งานท้าทายการเติบโตส่วนบุคคล กระตุ้นการทะลุผ่านตัวเองอย่างต่อเนื่อง",vi:"Nhiệm vụ thử thách phát triển cá nhân, truyền cảm hứng đột phá bản thân liên tục",ms:"Misi cabaran pertumbuhan peribadi, inspirasi penembusan diri berterusan",la:"Missiones provocationis incrementi personalis, inspirationem continuam sui transgressionis"},path:"/restart-missions"},{key:"storywall",icon:"📖",title:{"zh-TW":"身份故事鏈","zh-CN":"身份故事链",ja:"アイデンティティストーリーチェーン",en:"Identity Story Chain",ko:"정체성 스토리 체인",th:"ห่วงโซ่เรื่องราวอัตลักษณ์",vi:"Chuỗi Câu Chuyện Bản Sắc",ms:"Rantai Cerita Identiti",la:"Catena Fabularum Identitatis"},desc:{"zh-TW":"深度故事創作與自我認同的探索","zh-CN":"深度故事创作与自我认同的探索",ja:"深いストーリー創作と自己同一性の探求",en:"Deep story creation and exploration of self-identity",ko:"깊이 있는 이야기 창작과 자기 정체성 탐구",th:"การสร้างสรรค์เรื่องราวเชิงลึกและการสำรวจอัตลักษณ์ของตนเอง",vi:"Sáng tạo câu chuyện sâu sắc và khám phá bản sắc cá nhân",ms:"Penciptaan cerita mendalam dan penerokaan identiti diri",la:"Creatio fabularum profunda et exploratio identitatis sui"},path:"/storywall"},{key:"skillbox",icon:"🛠️",title:{"zh-TW":"社會模擬所","zh-CN":"社会模拟所",ja:"社会シミュレーション研究所",en:"Social Simulation Institute",ko:"사회 시뮬레이션 연구소",th:"สถาบันจำลองสังคม",vi:"Viện Mô Phỏng Xã Hội",ms:"Institut Simulasi Sosial",la:"Institutum Simulationis Socialis"},desc:{"zh-TW":"AI模擬真實社會情境，練習人際互動技巧","zh-CN":"AI模拟真实社会情境，练习人际互动技巧",en:"AI simulates real social situations, practice interpersonal interaction skills",ja:"AIが実際の社会的状況をシミュレートし、対人交流スキルを練習",ko:"AI가 실제 사회 상황을 시뮬레이션하고, 대인 상호작용 기술을 연습",th:"AI จำลองสถานการณ์สังคมจริง ฝึกฝนทักษะการปฏิสัมพันธ์ระหว่างบุคคล",vi:"AI mô phỏng tình huống xã hội thực tế, thực hành kỹ năng tương tác giữa các cá nhân",ms:"AI mensimulasikan situasi sosial sebenar, latih kemahiran interaksi interpersonal",la:"AI simulat situationes sociales reales, exerce artes interactionis interpersonal"},path:"/skillbox"},{key:"emotionRelease",icon:"🎮",title:{"zh-TW":"壓力釋放室","zh-CN":"压力释放室",ja:"ストレス解放室",en:"Stress Release Room",ko:"스트레스 해방실",th:"ห้องปลดปล่อยความเครียด",vi:"Phòng Giải Tỏa Áp Lực",ms:"Bilik Pelepasan Tekanan",la:"Cubiculum Liberationis Tensionis"},desc:{"zh-TW":"簡單遊戲幫助快速舒緩壓力與情緒","zh-CN":"简单游戏帮助快速舒缓压力与情绪",en:"Simple games help quickly relieve stress and emotions",ja:"シンプルなゲームがストレスと感情を素早く和らげる",ko:"간단한 게임이 스트레스와 감정을 빠르게 완화하는 데 도움",th:"เกมง่ายๆ ช่วยบรรเทาความเครียดและอารมณ์ได้อย่างรวดเร็ว",vi:"Trò chơi đơn giản giúp nhanh chóng giảm bớt căng thẳng và cảm xúc",ms:"Permainan mudah membantu melegakan tekanan dan emosi dengan cepat",la:"Ludi simplices adiuvant tensionem et affectus celeriter alleviare"},path:"/emotion-release"}];e.useLayoutEffect(()=>{if(a.current&&o.current){const e=a.current.getBoundingClientRect().top,t=o.current.getBoundingClientRect().top,n=a.current.getBoundingClientRect().height,i=o.current.getBoundingClientRect().height;l(e+n-(t+i))}},[n]),e.useEffect(()=>{const e=yb(c,e=>{u(e),p(!0)});return()=>e()},[c]);const E=e.useRef(null);e.useEffect(()=>{if(!m)return;const e=e=>{E.current&&!E.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[m]);const _=e.useRef(null);e.useEffect(()=>{if(!x)return;const e=e=>{_.current&&!_.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[x]);const N=e=>{t("/chat")},P={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Keluar",la:"Exire"},D={"zh-TW":"共創實驗室","zh-CN":"共创实验室",en:"Co-creation Lab",ja:"共創ラボ",ko:"공동창작실험실",th:"ห้องทดลองการสร้างสรรค์ร่วมกัน",vi:"Phòng Thí Nghiệm Đồng Sáng Tạo",ms:"Makmal Penciptaan Bersama",la:"Laboratorium Co-creationis"},W={"zh-TW":{title:"請先註冊/登入才能使用此功能",btn:"前往註冊/登入",close:"關閉"},"zh-CN":{title:"请先注册/登录才能使用此功能",btn:"前往注册/登录",close:"关闭"},en:{title:"Please register/login to use this feature",btn:"Go to Register/Login",close:"Close"},ja:{title:"ご利用には登録/ログインが必要です",btn:"登録/ログインへ",close:"閉じる"},ko:{title:"이 기능을 사용하려면 가입/로그인 해주세요",btn:"가입/로그인으로 이동",close:"닫기"},th:{title:"กรุณาสมัคร/เข้าสู่ระบบก่อนใช้ฟีเจอร์นี้",btn:"ไปที่สมัคร/เข้าสู่ระบบ",close:"ปิด"},vi:{title:"Vui lòng đăng ký/đăng nhập để sử dụng chức năng này",btn:"Đến đăng ký/đăng nhập",close:"Đóng"},ms:{title:"Sila daftar/log masuk untuk menggunakan ciri ini",btn:"Pergi ke Daftar/Log Masuk",close:"Tutup"},la:{title:"Quaeso registra/aperi ut hoc munus utaris",btn:"Ad registra/login",close:"Claude"}}[n],M=async(e,t)=>{if(d)if(T)e();else{if(t)try{const e=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d.uid,feature:t})});if(!e.ok)throw new Error("權限檢查失敗");const n=await e.json();if(!n.allowed)return void(n.canRenew?(R({currentPlan:n.currentPlan,remainingDays:n.remainingDays,usedTokens:n.usedTokens,totalTokens:n.totalTokens}),I(!0)):(S({title:"功能需要升級",message:n.reason||"此功能需要升級訂閱才能使用",requiredPlan:n.requiredPlan||"basic"}),w(!0)))}catch(n){}e()}else v(!0)};return h?f.jsxs("div",{style:{position:"relative",minHeight:"100vh"},children:[A?f.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[f.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:f.jsx("img",{src:"/ctx-logo.png",alt:"logo",style:{width:72,height:72,cursor:"pointer"},onClick:()=>t("/")})}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[d?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:d.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),f.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:d.displayName||d.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(c)},style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px",borderRadius:4,fontWeight:600,border:"1px solid #ff6347",color:"#ff6347",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},children:P[n]})]}):f.jsx("button",{className:"topbar-btn",onClick:()=>t("/register"),style:{background:"#fff",color:"#1976d2",border:"1px solid #1976d2",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:"zh-TW"===n?"註冊":"zh-CN"===n?"注册":"en"===n?"Register":"ja"===n?"登録":"ko"===n?"가입":"th"===n?"สมัคร":"vi"===n?"Đăng ký":"ms"===n?"Daftar":"Registrare"}),f.jsx(fw,{style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px"}}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:_,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:12,padding:"8px 10px",minWidth:44,height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>y(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#5a4fd9",e.currentTarget.style.borderColor="#5a4fd9"},onMouseOut:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.borderColor="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),x&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:180,maxWidth:220,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===n||"zh-CN"===n?"法律文件":"en"===n?"Legal Documents":"ja"===n?"法的文書":"ko"===n?"법적 문서":"th"===n?"เอกสารทางกฎหมาย":"vi"===n?"Tài liệu pháp lý":"ms"===n?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:Cw,titleKey:"privacy",path:"/privacy-policy"},{key:"terms",title:Cw,titleKey:"terms",path:"/terms"},{key:"data",title:Cw,titleKey:"deletion",path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>{var i;return f.jsx("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"11px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{t(e.path),y(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.titleKey?(null==(i=e.title[n])?void 0:i[e.titleKey])||e.title["zh-TW"][e.titleKey]:e.title[n]||e.title["zh-TW"]},e.key)})]})]})]})]}):f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>t("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":"zh-TW"===n||"zh-CN"===n?"了解 Restarter 平台":"en"===n?"Learn about Restarter platform":"ja"===n?"Restarter プラットフォームについて":"ko"===n?"Restarter 플랫폼에 대해 알아보기":"th"===n?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":"vi"===n?"Tìm hiểu về nền tảng Restarter":"ms"===n?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:"zh-TW"===n?"🧬 Restarter™｜我們是誰":"zh-CN"===n?"🧬 Restarter™｜我们是谁":"en"===n?"🧬 Restarter™｜Who We Are":"ja"===n?"🧬 Restarter™｜私たちについて":"ko"===n?"🧬 Restarter™｜우리는 누구인가":"th"===n?"🧬 Restarter™｜เราเป็นใคร":"vi"===n?"🧬 Restarter™｜Chúng tôi là ai":"ms"===n?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>t("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":"zh-TW"===n?"提供意見和建議":"zh-CN"===n?"提供意见和建议":"en"===n?"Provide feedback and suggestions":"ja"===n?"ご意見やご提案を提供":"ko"===n?"의견과 제안 제공":"th"===n?"ให้ข้อเสนอแนะและคำแนะนำ":"vi"===n?"Cung cấp phản hồiและ đề xuất":"ms"===n?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:"zh-TW"===n?"💬 意見箱｜我們想聽你說":"zh-CN"===n?"💬 意见箱｜我们想听你说":"en"===n?"💬 Feedback｜We Want to Hear You":"ja"===n?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===n?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===n?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===n?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===n?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),d?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:d.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:d.displayName||d.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(c)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:P[n]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>t("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===n?"註冊/登入":"zh-CN"===n?"注册/登录":"en"===n?"Register / Login":"ja"===n?"登録/ログイン":"ko"===n?"가입/로그인":"th"===n?"สมัคร/เข้าสู่ระบบ":"vi"===n?"Đăng ký/Đăng nhập":"ms"===n?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:E,children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>g(e=>!e),children:["zh-TW"===n?"繁中":"zh-CN"===n?"简中":"en"===n?"English":"ja"===n?"日本語":"ko"===n?"한국어":"th"===n?"ไทย":"vi"===n?"Tiếng Việt":"ms"===n?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),m&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===n?"#6B5BFF":"#232946",fontWeight:e===n?700:500,background:e===n?"#f3f0ff":"#fff"},onClick:()=>{i(e),g(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:_,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>y(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),x&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===n||"zh-CN"===n?"法律文件":"en"===n?"Legal Documents":"ja"===n?"法的文書":"ko"===n?"법적 문서":"th"===n?"เอกสารทางกฎหมาย":"vi"===n?"Tài liệu pháp lý":"ms"===n?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:Cw,titleKey:"privacy",path:"/privacy-policy"},{key:"terms",title:Cw,titleKey:"terms",path:"/terms"},{key:"data",title:Cw,titleKey:"deletion",path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>{var i;return f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{t(e.path),y(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.titleKey?(null==(i=e.title[n])?void 0:i[e.titleKey])||e.title["zh-TW"][e.titleKey]:e.title[n]||e.title["zh-TW"]},e.key)})]})]})]}),A?f.jsxs("div",{style:{width:"100vw",minHeight:"100vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:100},children:[f.jsx("div",{style:{width:"100%",padding:"0 16px",marginBottom:16},children:f.jsx(jw,{})}),f.jsxs("div",{style:{width:"100%",padding:"20px 16px",textAlign:"center"},children:[f.jsx("div",{style:{marginBottom:16},children:f.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:16,lineHeight:1.2,letterSpacing:.3,textShadow:"1px 2px 8px #fff",whiteSpace:"nowrap"},children:"zh-TW"===n?"找回信任的起點，重新出發不孤單！":"zh-CN"===n?"找回信任的起点，重新出发不孤单！":"en"===n?"Regain trust and start anew, you are never alone!":"ja"===n?"信頼を取り戻し、新たな一歩を踏み出そう！":"ko"===n?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":"th"===n?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":"vi"===n?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":"ms"===n?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),f.jsxs("h1",{style:{fontSize:24,fontWeight:900,color:"#fff",marginBottom:12,textShadow:"0 2px 8px #232946"},children:[f.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),f.jsx("div",{style:{marginBottom:10},children:f.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:14,lineHeight:1.4,whiteSpace:"pre-line"},children:Sw[n].desc})})]}),f.jsxs("div",{style:{width:"100%",padding:"0 16px",marginBottom:16,display:"flex",flexDirection:"row",gap:"12px",justifyContent:"center"},children:[f.jsx("img",{src:"/herogirl.png",style:{width:"50%",maxWidth:150,height:"auto",objectFit:"contain",borderRadius:"16px",boxShadow:"none"}}),f.jsx("img",{src:"/Robotgirl.png",style:{width:"50%",maxWidth:150,height:"auto",objectFit:"contain",borderRadius:"16px",boxShadow:"none"}})]}),f.jsxs("div",{style:{width:"100%",padding:"0 16px",marginBottom:"16px",position:"relative"},children:[f.jsxs("button",{onClick:()=>M(()=>t("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",width:"100%",justifyContent:"center",position:"relative"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="1")},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="0")},children:[f.jsx("span",{style:{fontSize:"18px"},children:"📊"}),"zh-TW"===n?"社會融入度評估":"zh-CN"===n?"社会融入度评估":"ja"===n?"社会統合度評価":"en"===n?"Social Integration Assessment":"ko"===n?"사회 통합도 평가":"th"===n?"การประเมินการผสมผสานทางสังคม":"vi"===n?"Đánh Giá Hòa Nhập Xã Hội":"ms"===n?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),f.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none",maxWidth:"200px",marginBottom:"8px"},children:"zh-TW"===n?"評估個人社會融入度，獲得專業建議和改善方向":"zh-CN"===n?"评估个人社会融入度，获得专业建议和改善方向":"ja"===n?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":"en"===n?"Assess personal social integration, get professional advice and improvement direction":"ko"===n?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":"th"===n?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":"vi"===n?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":"ms"===n?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),f.jsxs("div",{style:{width:"100%",padding:"0 16px",display:"flex",flexDirection:"column",gap:12},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[f.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>M(()=>t("/friend")),children:[f.jsx("span",{style:{fontSize:20},children:Tw[n]}),f.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.friend})]}),f.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>M(()=>N(),"aiChat"),children:[f.jsx("span",{style:{fontSize:20},children:"💬"}),f.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.chat})]})]}),f.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(0,2).map(e=>f.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>M(()=>t(e.path)),children:[f.jsx("span",{style:{fontSize:20},children:e.icon}),f.jsx("span",{style:{fontSize:12,textAlign:"center"},children:e.title[n]})]},e.key))}),f.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(2,4).map(e=>f.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>M(()=>t(e.path)),children:[f.jsx("span",{style:{fontSize:20},children:e.icon}),f.jsx("span",{style:{fontSize:12,textAlign:"center"},children:e.title[n]})]},e.key))}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[z.slice(4).map(e=>f.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>M(()=>t(e.path)),children:[f.jsx("span",{style:{fontSize:20},children:e.icon}),f.jsx("span",{style:{fontSize:12,textAlign:"center"},children:e.title[n]})]},e.key)),f.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>M(()=>t("/HelpLab")),children:[f.jsx("span",{style:{fontSize:20},children:"🧪"}),f.jsx("span",{style:{fontSize:12,textAlign:"center"},children:D[n]})]})]})]}),f.jsx("div",{style:{width:"100%",padding:"20px 16px",display:"flex",flexDirection:"column",gap:12,boxSizing:"border-box"},children:f.jsx("span",{href:"/plans",style:{width:"100%",padding:"12px",borderRadius:10,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:14,textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer",textAlign:"center",display:"block",boxSizing:"border-box"},children:Iw[n]})})]}):f.jsxs("div",{style:{width:"100vw",minHeight:"160vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},children:[f.jsxs("div",{className:"home-left-col left-relative",style:{flex:1,minWidth:320,maxWidth:600,display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",padding:"120px 0 0 0",zIndex:2},children:[f.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>t("/")})}),f.jsxs("div",{className:"column-content",style:{justifyContent:"center",alignItems:"center",height:"100%",paddingTop:"vi"===n?"200px":"ms"===n?"220px":"la"===n?"240px":"en"===n?"180px":"80px"},children:[f.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto 16px auto",textAlign:"center",wordBreak:"break-word",whiteSpace:"normal",marginLeft:"0px"},children:f.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:20,lineHeight:1.2,letterSpacing:.5,textShadow:"2px 4px 12px #fff, 0 2px 8px #23294688",display:"inline-block",whiteSpace:"nowrap"},children:"zh-TW"===n?"找回信任的起點，重新出發不孤單！":"zh-CN"===n?"找回信任的起点，重新出发不孤单！":"en"===n?"Regain trust and start anew, you are never alone!":"ja"===n?"信頼を取り戻し、新たな一歩を踏み出そう！":"ko"===n?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":"th"===n?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":"vi"===n?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":"ms"===n?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),f.jsxs("h1",{className:"main-title",style:{position:"relative",left:"0px",fontSize:36,fontWeight:900,color:"#fff",marginBottom:18,textShadow:"0 2px 12px #232946, 0 4px 24px #0008"},children:[f.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),f.jsx("div",{style:{width:"100%",textAlign:"center",margin:"0 auto",marginBottom:16,marginTop:"0px"},children:f.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:16,lineHeight:1.5,letterSpacing:.5,whiteSpace:"pre-line"},children:Sw[n].desc})}),f.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:"24px",position:"relative"},children:[f.jsxs("button",{onClick:()=>M(()=>t("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"16px 32px",color:"white",cursor:"pointer",fontSize:"18px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"12px",position:"relative"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="1")},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="0")},children:[f.jsx("span",{style:{fontSize:"24px"},children:"📊"}),"zh-TW"===n?"社會融入度評估":"zh-CN"===n?"社会融入度评估":"ja"===n?"社会統合度評価":"en"===n?"Social Integration Assessment":"ko"===n?"사회 통합도 평가":"th"===n?"การประเมินการผสมผสานทางสังคม":"vi"===n?"Đánh Giá Hòa Nhập Xã Hội":"ms"===n?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),f.jsx("div",{style:{position:"absolute",top:"-50px",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"8px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none"},children:"zh-TW"===n?"評估個人社會融入度，獲得專業建議和改善方向":"zh-CN"===n?"评估个人社会融入度，获得专业建议和改善方向":"ja"===n?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":"en"===n?"Assess personal social integration, get professional advice and improvement direction":"ko"===n?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":"th"===n?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":"vi"===n?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":"ms"===n?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:18,marginBottom:60,justifyContent:"center",width:"100%"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:[f.jsxs("div",{style:{position:"relative"},children:[f.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",transition:"all 0.3s ease"},onClick:()=>M(()=>t("/friend"),"userInteraction"),onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="1")},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="0")},role:"button",children:[f.jsx("span",{style:{fontSize:32},children:Tw[n]}),f.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.friend})]}),f.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"12px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none",maxWidth:"300px",marginBottom:"8px"},children:"進入交友區做深度社交，建立真實且支持性的連結。"})]}),z.slice(0,2).map(e=>f.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>M(()=>t(e.path)),"aria-label":e.desc[n],role:"button",children:[f.jsx("span",{style:{fontSize:32,transform:"🎤"===e.icon?"translateY(8px)":"none"},children:e.icon}),f.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e.title[n]})]},e.key))]}),f.jsx("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:z.slice(2,5).map(e=>f.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>M(()=>t(e.path)),"aria-label":e.desc[n],role:"button",children:[f.jsx("span",{style:{fontSize:32},children:e.icon}),f.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e.title[n]})]},e.key))}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center",marginTop:10},children:[z.slice(5,6).map(e=>f.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>M(()=>t(e.path)),"aria-label":e.desc[n],role:"button",children:[f.jsx("span",{style:{fontSize:32},children:e.icon}),f.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e.title[n]})]},e.key)),f.jsxs("div",{style:{position:"relative"},children:[f.jsxs("button",{className:"feature-btn mutual-help-btn",style:{fontSize:18,padding:"16px 16px",minWidth:180,maxWidth:240,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,boxShadow:"0 2px 12px #ffb74d55",transition:"all 0.3s ease"},onClick:()=>M(()=>t("/HelpLab")),onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(255, 183, 77, 0.4)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="1")},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 2px 12px #ffb74d55";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="0")},role:"button",children:[f.jsx("span",{style:{fontSize:32},children:"🧪"}),f.jsx("span",{style:{fontWeight:900,color:"#1976d2",textAlign:"center",lineHeight:1.2},children:D[n]})]}),f.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"12px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none",maxWidth:"200px",marginBottom:"8px"},children:{"zh-TW":"彼此協作與互助，推動共創與合作任務","zh-CN":"用户协作与互助，推动共创与合作任务",en:"User collaboration and mutual assistance, promote co-creation and cooperative tasks",ja:"ユーザー協力と相互支援、共創と協力タスクを推進",ko:"사용자 협력과 상호 지원, 공동 창작과 협력 작업 촉진",th:"การทำงานร่วมกันของผู้ใช้และการช่วยเหลือซึ่งกันและกัน ส่งเสริมการสร้างสรรค์ร่วมกันและงานร่วมมือ",vi:"Sự hợp tác và hỗ trợ lẫn nhau của người dùng, thúc đẩy đồng sáng tạo và nhiệm vụ hợp tác",ms:"Kerjasama pengguna dan bantuan bersama, galakkan penciptaan bersama dan tugas kerjasama",la:"Collaboratio usorum et auxilium mutuum, promovere co-creationem et opera cooperativa"}[n]})]}),f.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>M(()=>t("/emotion-release")),"aria-label":"zh-TW"===n?"簡單遊戲幫助快速舒緩壓力與情緒":"zh-CN"===n?"简单游戏帮助快速舒缓压力与情绪":"en"===n?"Simple games help quickly relieve stress and emotions":"ja"===n?"シンプルなゲームがストレスと感情を素早く和らげる":"ko"===n?"간단한 게임이 스트레스와 감정을 빠르게 완화하는 데 도움":"th"===n?"เกมง่ายๆ ช่วยบรรเทาความเครียดและอารมณ์ได้อย่างรวดเร็ว":"vi"===n?"Trò chơi đơn giản giúp nhanh chóng giảm bớt căng thẳng và cảm xúc":"ms"===n?"Permainan mudah membantu melegakan tekanan dan emosi dengan cepat":"Ludi simplices adiuvant tensionem et affectus celeriter alleviare",role:"button",children:[f.jsx("span",{style:{fontSize:32},children:"🎮"}),f.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:"zh-TW"===n?"壓力釋放室":"zh-CN"===n?"压力释放室":"ja"===n?"ストレス解放室":"en"===n?"Stress Release Room":"ko"===n?"스트레스 해방실":"th"===n?"ห้องปลดปล่อยความเครียด":"vi"===n?"Phòng Giải Tỏa Áp Lực":"ms"===n?"Bilik Pelepasan Tekanan":"Cubiculum Liberationis Tensionis"})]})]})]})]})]}),f.jsxs("div",{className:"home-right-col",style:{flex:1,minWidth:320,maxWidth:520,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:120,zIndex:2},children:[f.jsx("div",{style:{display:"flex",gap:18,marginBottom:18,justifyContent:"center",width:"100%"},children:f.jsx("span",{href:"/plans",style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 28px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer"},children:Iw[n]})}),f.jsx("div",{style:{marginBottom:18,width:"100%",maxWidth:300},children:f.jsx(jw,{})}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:"20px",width:"100%",alignItems:"center",justifyContent:"center",marginTop:"-100px",height:"calc(100vh - 120px)",maxHeight:600,minHeight:400},children:[f.jsx("img",{src:"/herogirl.png",className:"home-mic-img",style:{marginBottom:0,height:"100%",width:"50%",objectFit:"contain",borderRadius:"0",boxShadow:"none",border:"none"}}),f.jsx("img",{src:"/Robotgirl.png",className:"home-mic-img",style:{marginBottom:0,height:"100%",width:"50%",objectFit:"contain",borderRadius:"0",boxShadow:"none",border:"none"}})]}),f.jsxs("div",{style:{position:"relative"},children:[f.jsxs("button",{ref:o,className:"feature-btn home-chat-btn",style:{height:80,marginTop:0,marginBottom:0,position:"relative",top:"-40px",gap:8,padding:"16px 16px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>M(()=>N(),"aiChat"),onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="1")},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const t=e.currentTarget.nextElementSibling;t&&(t.style.opacity="0")},role:"button",children:[f.jsx("span",{role:"img",style:{fontSize:32},children:"💬"}),f.jsx("span",{className:"home-chat-btn-text",style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.chat})]}),f.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"12px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none",maxWidth:"200px",marginBottom:"8px"},children:"即時語音/文字聊天，情感交流與支持。"})]}),f.jsxs("button",{className:"feature-btn",style:{height:80,marginTop:10,marginBottom:0,position:"relative",top:"-40px",gap:8,padding:"16px 16px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>M(()=>t("/skillbox")),"aria-label":"zh-TW"===n?"進入社會模擬所，練習對話技巧，應對各種挑戰":"zh-CN"===n?"进入社会模拟所，练习对话技巧，应对各种挑战":"en"===n?"Enter SkillBox to practice conversation skills and handle various challenges":"ja"===n?"SkillBoxに入って会話スキルを練習し、様々な挑戦に対処":"ko"===n?"SkillBox에 들어가 대화 기술을 연습하고 다양한 도전에 대처":"th"===n?"เข้าสู่ SkillBox เพื่อฝึกทักษะการสนทนาและรับมือกับความท้าทายต่างๆ":"vi"===n?"Vào SkillBox để luyện tập kỹ năng hội thoại và xử lý các thách thức khác nhau":"ms"===n?"Masuk ke SkillBox untuk berlatih kemahiran perbualan dan menangani pelbagai cabaran":"Intra in SkillBox ad exercenda colloquia et varias difficultates tractandas",role:"button",children:[f.jsx("span",{style:{fontSize:32},children:"🛠️"}),f.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:"zh-TW"===n?"社會模擬所":"zh-CN"===n?"社会模拟所":"SkillBox"})]})]})]}),b&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[f.jsx("button",{type:"button",onClick:()=>v(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),f.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:W.title}),f.jsx("button",{onClick:()=>t("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"12px 0",fontWeight:700,fontSize:17,cursor:"pointer",margin:"12px 0"},children:W.btn}),f.jsx("button",{onClick:()=>v(!1),style:{background:"#eee",color:"#666",border:"none",borderRadius:14,padding:"10px 0",fontWeight:700,fontSize:16,cursor:"pointer"},children:W.close})]})}),f.jsx(xw,{isOpen:k,onClose:()=>w(!1),title:j.title,message:j.message,requiredPlan:j.requiredPlan}),f.jsx(yw,{isOpen:C,onClose:()=>I(!1),currentPlan:B.currentPlan,remainingDays:B.remainingDays,usedTokens:B.usedTokens,totalTokens:B.totalTokens}),f.jsx("style",{children:"\n        .feature-btn, .home-chat-btn, .topbar-btn {\n          transition: background 0.18s, color 0.18s, box-shadow 0.18s;\n          cursor: pointer;\n        }\n        /* 移除懸停效果以避免畫面停滯和耗電 */\n        .feature-btn, .home-chat-btn {\n          background: #fff;\n          border-radius: 12px;\n          border: 2px solid #6B5BFF;\n          color: #6B5BFF;\n          font-weight: 700;\n          font-size: 16px;\n          padding: 8px 16px;\n          backdrop-filter: blur(10px);\n        }\n        .home-chat-btn-text {\n          font-size: 18px;\n          margin-left: 2px;\n        }\n        .topbar-btn {\n          background: #6c63ff;\n          border-radius: 8px;\n          border: none;\n          color: #fff;\n          font-weight: 700;\n          font-size: 16px;\n          padding: 8px 18px;\n        }\n        .fixed-logo-box {\n          position: fixed;\n          top: 16px;\n          left: 42px;\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          z-index: 10000;\n        }\n        .fixed-logo-img {\n          width: 54px;\n          height: 54px;\n        }\n        .fixed-logo-slogan {\n          font-size: 20px;\n          font-weight: 700;\n          color: #fff;\n          text-shadow: 0 2px 8px #232946, 0 4px 18px #0008;\n        }\n      "})]}):f.jsx("div",{style:{textAlign:"center",marginTop:"30vh",fontSize:24},children:"載入中..."})}function Rw(){const[t,n]=e.useState(null),[i,r]=e.useState(!1),a=Fv(),o=async()=>{const e=a.currentUser;if(!e)return null;try{r(!0);const t=await fetch(`/api/subscription/status/${e.uid}`);if(t.ok){const e=await t.json();return n(e),e}}catch(t){}finally{r(!1)}return null};return e.useEffect(()=>{a.currentUser&&o()},[a.currentUser]),{subscriptionStatus:t,loading:i,checkPermission:async e=>{const t=a.currentUser;let n=null==t?void 0:t.uid;if(!n){const e=localStorage.getItem("testUser");if(!e)return{allowed:!1,reason:"請先登入"};n=JSON.parse(e).uid}try{const t=await fetch(`/api/subscription/details/${n}`);let i=null;t.ok&&(i=await t.json());const r="true"===localStorage.getItem("testMode");if(r){return{allowed:!0,reason:void 0,featureName:{aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"}[e]||e,isFreeUser:!0,isTestMode:!0,currentPlan:"test"}}const a=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":r?"true":"false"},body:JSON.stringify({userId:n,feature:e})});if(a.ok){const t=await a.json(),n={aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"},r=i&&i.isActive&&i.startDate&&new Date(i.startDate).getTime()>Date.now()-864e5;return{...t,featureName:n[e]||e,isFreeUser:"free"===t.currentPlan||!t.currentPlan,isNewSubscription:r,subscriptionData:i}}return{allowed:!1,reason:"權限檢查失敗",featureName:e,isFreeUser:!0}}catch(i){return{allowed:!1,reason:"網路錯誤",featureName:e,isFreeUser:!0}}},recordUsage:async(e,t=0)=>{const n=a.currentUser;let i=null==n?void 0:n.uid;if(!i){const e=localStorage.getItem("testUser");if(!e)return;i=JSON.parse(e).uid}const r="true"===localStorage.getItem("testMode");try{await fetch("/api/subscription/record-usage",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":r?"true":"false"},body:JSON.stringify({userId:i,feature:e,cost:t})})}catch(o){}},fetchSubscriptionStatus:o}}const Aw={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},Fw={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"数据删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"利用規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보보호정책",terms:"약관/성명",deletion:"데이터 삭제 설명"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/คำแถลง",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Penyata",deletion:"Penerangan Pemadaman Data"},la:{privacy:"Consilium de Privata",terms:"Termini/Declaratio",deletion:"Explicatio Deletionis Datae"}};function zw({className:t,style:n}){const i=le(),[r,a]=e.useState(null),{lang:o}=mw(),[s,l]=e.useState(!1),c=e.useRef(null);return e.useEffect(()=>{const e=yb(dw,e=>{a(e)});return()=>e()},[]),e.useEffect(()=>{const e=e=>{c.current&&!c.current.contains(e.target)&&l(!1)};return s&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]),f.jsxs("div",{className:t,style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001",...n},children:[f.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:f.jsx("img",{src:"/ctx-logo.png",alt:"logo",style:{width:72,height:72,cursor:"pointer"},onClick:()=>i("/")})}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:r.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),f.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:r.displayName||r.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(dw)},style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px",borderRadius:4,fontWeight:600,border:"1px solid #ff6347",color:"#ff6347",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},children:Aw[o]})]}):f.jsx("button",{className:"topbar-btn",onClick:()=>i("/register"),style:{background:"#fff",color:"#1976d2",border:"1px solid #1976d2",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:"zh-TW"===o?"註冊":"zh-CN"===o?"注册":"en"===o?"Register":"ja"===o?"登録":"ko"===o?"가입":"th"===o?"สมัคร":"vi"===o?"Đăng ký":"ms"===o?"Daftar":"Registrare"}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:c,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:12,padding:"8px 10px",minWidth:44,height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>l(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#5a4fd9",e.currentTarget.style.borderColor="#5a4fd9"},onMouseOut:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.borderColor="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),s&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:180,maxWidth:220,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===o||"zh-CN"===o?"法律文件":"en"===o?"Legal Documents":"ja"===o?"法的文書":"ko"===o?"법적 문서":"th"===o?"เอกสารทางกฎหมาย":"vi"===o?"Tài liệu pháp lý":"ms"===o?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:Fw,titleKey:"privacy",path:"/privacy-policy"},{key:"terms",title:Fw,titleKey:"terms",path:"/terms"},{key:"data",title:Fw,titleKey:"deletion",path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>{var t;return f.jsx("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"11px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{i(e.path),l(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.titleKey?(null==(t=e.title[o])?void 0:t[e.titleKey])||e.title["zh-TW"][e.titleKey]:e.title[o]||e.title["zh-TW"]},e.key)})]})]})]})]})}const Ew={"zh-TW":{back:"返回",logout:"登出",title:"🧱 情緒牆 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在這裡，每個人都能找到情感上的歸屬感和支援。分享你的心情，或為他人提供溫暖的支援留言，讓我們一起建立溫暖的社群。",inbox:"💌 我的留言箱",placeholder:"說出你的心聲...(200字內)",send:window.innerWidth<=768?"送出":"發送",sending:"發送中...",noMessages:"還沒有留言，快來發表你的心聲吧！",commentsTitle:"支援留言：",noComments:"還沒有人留言支援",modalTitle:"這是他的心情貼文：",modalAction:"給他支援留言：",nicknamePlaceholder:"你的暱稱",commentPlaceholder:"支援內容...",submitComment:"送出支援",supportMessage:"💝 給予支援",supportDesc:"看到別人的情感分享，給予溫暖的支援和鼓勵",recording:"錄音中",pressToStop:"按下停止",readyToRecord:"準備開始錄音",recordInstruction:"點擊「開始錄音」後，系統將開始錄製您的語音留言。",recordTimeLimit:"錄音時間限制為1分鐘",cancel:"取消",startRecording:"開始錄音",voice:"語音"},"zh-CN":{back:"返回",logout:"登出",title:"🧱 情绪墙 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在这里，每个人都能找到情感上的归属感和支援。分享你的心情，或为他人提供温暖的支援留言，让我们一起建立温暖的社群。",inbox:"💌 我的留言箱",placeholder:"说出你的心声...",send:"发送",sending:"发送中...",noMessages:"还没有留言，快来发表你的心声吧！",commentsTitle:"支援留言：",noComments:"还没有人留言支援",modalTitle:"这是他的心情贴文：",modalAction:"给他支援留言：",nicknamePlaceholder:"你的昵称",commentPlaceholder:"支援内容...",submitComment:"送出支援",supportMessage:"💝 给予支援",supportDesc:"看到别人的情感分享，给予温暖的支援和鼓励",recording:"录音中",pressToStop:"按下停止",readyToRecord:"准备开始录音",recordInstruction:"点击「开始录音」后，系统将开始录制您的语音留言。",recordTimeLimit:"录音时间限制为1分钟",cancel:"取消",startRecording:"开始录音",voice:"语音"},en:{back:"Back",logout:"Logout",title:"🧱 Emotion Wall Restart Wall",subtitle:"Social Emotional Support Platform",subtitleDesc:"Here, everyone can find emotional belonging and support. Share your feelings, or provide warm support messages to others. Let's build a caring community together.",inbox:"💌 My Inbox",placeholder:"Say what you feel...",send:"Send",sending:"Sending...",noMessages:"No messages yet. Come and share your feelings!",commentsTitle:"Support Messages:",noComments:"No support messages yet",modalTitle:"Here's their post:",modalAction:"Leave support message:",nicknamePlaceholder:"Your Nickname",commentPlaceholder:"Support content...",submitComment:"Send Support",supportMessage:"💝 Give Support",supportDesc:"See others' emotional sharing and give warm support and encouragement",recording:"Recording",pressToStop:"Press to Stop",readyToRecord:"Ready to Start Recording",recordInstruction:'After clicking "Start Recording", the system will begin recording your voice message.',recordTimeLimit:"Recording time limit is 1 minute",cancel:"Cancel",startRecording:"Start Recording",voice:"Voice"},ja:{back:"戻る",logout:"ログアウト",title:"🧱 感情の壁 Restart Wall",subtitle:"ソーシャル感情サポートプラットフォーム",subtitleDesc:"ここでは、誰もが感情的な帰属意識とサポートを見つけることができます。あなたの気持ちを共有したり、他の人に温かい支援メッセージを提供したりして、一緒に思いやりのあるコミュニティを築きましょう。",inbox:"💌 私の受信箱",placeholder:"あなたの気持ちを話して...",send:"送信",sending:"送信中...",noMessages:"まだメッセージはありません。あなたの気持ちを投稿しに来てください！",commentsTitle:"支援メッセージ：",noComments:"まだ支援メッセージはありません",modalTitle:"彼の投稿です：",modalAction:"彼に支援メッセージを送る：",nicknamePlaceholder:"あなたのニックネーム",commentPlaceholder:"支援内容...",submitComment:"支援を送信",supportMessage:"💝 支援を送る",supportDesc:"他の人の感情的な共有を見て、温かい支援と励ましを提供する",recording:"録音中",pressToStop:"押して停止",readyToRecord:"録音の準備",recordInstruction:"「録音開始」をクリックすると、システムが音声メッセージの録音を開始します。",recordTimeLimit:"録音時間は1分に制限されています",cancel:"キャンセル",startRecording:"録音開始",voice:"音声"},ko:{back:"돌아가기",logout:"로그아웃",title:"🧱 감정의 벽 Restart Wall",subtitle:"소셜 감정 지원 플랫폼",subtitleDesc:"여기서 모든 사람이 감정적 소속감과 지원을 찾을 수 있습니다. 당신의 감정을 공유하거나 다른 사람에게 따뜻한 지원 메시지를 제공하여 함께 돌봄의 커뮤니티를 만들어봅시다.",inbox:"💌 내 메시지함",placeholder:"당신의 마음을 말해보세요...",send:"전송",sending:"전송 중...",noMessages:"아직 메시지가 없습니다. 와서 당신의 마음을 표현하세요!",commentsTitle:"지원 메시지:",noComments:"아직 지원 메시지가 없습니다",modalTitle:"그의 게시물입니다:",modalAction:"그에게 지원 메시지 남기기:",nicknamePlaceholder:"닉네임",commentPlaceholder:"지원 내용...",submitComment:"지원 보내기",supportMessage:"💝 지원하기",supportDesc:"다른 사람의 감정적 공유를 보고 따뜻한 지원과 격려를 제공",recording:"녹음 중",pressToStop:"누르면 중지",readyToRecord:"녹음 준비",recordInstruction:"「녹음 시작」을 클릭하면 시스템이 음성 메시지 녹음을 시작합니다.",recordTimeLimit:"녹음 시간은 1분으로 제한됩니다",cancel:"취소",startRecording:"녹음 시작",voice:"음성"},vi:{back:"Quay lại",logout:"Đăng xuất",title:"🧱 Bức tường Cảm xúc Restart Wall",subtitle:"Nền tảng Hỗ trợ Cảm xúc Xã hội",subtitleDesc:"Ở đây, mọi người đều có thể tìm thấy sự thuộc về và hỗ trợ về mặt cảm xúc. Chia sẻ cảm xúc của bạn, hoặc cung cấp tin nhắn hỗ trợ ấm áp cho người khác. Hãy cùng nhau xây dựng một cộng đồng quan tâm.",inbox:"💌 Hộp thư của tôi",placeholder:"Nói ra cảm xúc của bạn...",send:"Gửi",sending:"Đang gửi...",noMessages:"Chưa có tin nhắn nào. Hãy đến và chia sẻ cảm xúc của bạn!",commentsTitle:"Tin nhắn hỗ trợ:",noComments:"Chưa có tin nhắn hỗ trợ nào",modalTitle:"Đây là bài đăng của họ:",modalAction:"Để lại tin nhắn hỗ trợ:",nicknamePlaceholder:"Biệt danh của bạn",commentPlaceholder:"Nội dung hỗ trợ...",submitComment:"Gửi hỗ trợ",supportMessage:"💝 Gửi hỗ trợ",supportDesc:"Xem chia sẻ cảm xúc của người khác và đưa ra hỗ trợ và khích lệ ấm áp",recording:"Đang ghi âm",pressToStop:"Nhấn để dừng",readyToRecord:"Sẵn sàng ghi âm",recordInstruction:'Sau khi nhấp vào "Bắt đầu ghi âm", hệ thống sẽ bắt đầu ghi âm tin nhắn giọng nói của bạn.',recordTimeLimit:"Thời gian ghi âm giới hạn 1 phút",cancel:"Hủy",startRecording:"Bắt đầu ghi âm",voice:"Giọng nói"},th:{back:"กลับ",logout:"ออกจากระบบ",title:"🧱 กำแพงอารมณ์ Restart Wall",subtitle:"แพลตฟอร์มสนับสนุนอารมณ์ทางสังคม",subtitleDesc:"ที่นี่ ทุกคนสามารถหาความเป็นเจ้าของและความสนับสนุนทางอารมณ์ได้ แบ่งปันความรู้สึกของคุณ หรือให้ข้อความสนับสนุนที่อบอุ่นแก่ผู้อื่น มาเริ่มสร้างชุมชนที่ห่วงใยกันเถอะ",inbox:"💌 กล่องข้อความของฉัน",placeholder:"บอกความรู้สึกของคุณ...",send:"ส่ง",sending:"กำลังส่ง...",noMessages:"ยังไม่มีข้อความ มาแบ่งปันความรู้สึกของคุณสิ!",commentsTitle:"ข้อความสนับสนุน:",noComments:"ยังไม่มีข้อความสนับสนุน",modalTitle:"นี่คือโพสต์ของพวกเขา:",modalAction:"แสดงข้อความสนับสนุน:",nicknamePlaceholder:"ชื่อเล่นของคุณ",commentPlaceholder:"เนื้อหาสนับสนุน...",submitComment:"ส่งการสนับสนุน",supportMessage:"💝 ให้การสนับสนุน",supportDesc:"ดูการแบ่งปันอารมณ์ของผู้อื่นและให้การสนับสนุนและกำลังใจที่อบอุ่น",recording:"กำลังบันทึก",pressToStop:"กดเพื่อหยุด",readyToRecord:"พร้อมบันทึกเสียง",recordInstruction:'หลังจากคลิก "เริ่มบันทึก" ระบบจะเริ่มบันทึกข้อความเสียงของคุณ',recordTimeLimit:"เวลาบันทึกเสียงจำกัด 1 นาที",cancel:"ยกเลิก",startRecording:"เริ่มบันทึก",voice:"เสียง"},la:{back:"Redire",logout:"Exire",title:"🧱 Murus Emotionum Restart Wall",subtitle:"Platea Socialis Sustentationis Emotionalis",subtitleDesc:"Hic, omnes possunt invenire pertinere emotionalem et sustentationem. Communica sensus tuos, vel praebe calidas sustentationis epistulas aliis. Simul aedificemus communitatem curantem.",inbox:"💌 Cista Mea",placeholder:"Dic quod sentis...",send:"Mittere",sending:"Mittens...",noMessages:"Nullae epistulae adhuc. Veni et communica sensus tuos!",commentsTitle:"Epistulae Sustentationis:",noComments:"Nullae epistulae sustentationis adhuc",modalTitle:"Ecce nuntius eorum:",modalAction:"Mitte epistulam sustentationis:",nicknamePlaceholder:"Tuum agnomen",commentPlaceholder:"Contentum sustentationis...",submitComment:"Mitte Sustentationem",supportMessage:"💝 Da Sustentationem",supportDesc:"Vide communicationem emotionalem aliorum et praebe calidam sustentationem et cohortationem",recording:"Recordans",pressToStop:"Preme ad Desinere",readyToRecord:"Paratus ad Recordandum",recordInstruction:'Postquam "Incipe Recordandum" cliccas, systema incipiet recordare nuntium vocis tuae.',recordTimeLimit:"Tempus recordandi limitatur ad 1 minuta",cancel:"Cancella",startRecording:"Incipe Recordandum",voice:"Vox"},ms:{back:"Kembali",logout:"Log Keluar",title:"🧱 Tembok Emosi Restart Wall",subtitle:"Platform Sokongan Emosi Sosial",subtitleDesc:"Di sini, semua orang dapat mencari rasa kepunyaan dan sokongan emosi. Kongsi perasaan anda, atau berikan mesej sokongan yang hangat kepada orang lain. Mari kita bina komuniti yang prihatin bersama.",inbox:"💌 Kotak Mesej Saya",placeholder:"Katakan perasaan anda...",send:"Hantar",sending:"Menghantar...",noMessages:"Belum ada mesej lagi. Datang dan kongsi perasaan anda!",commentsTitle:"Mesej Sokongan:",noComments:"Belum ada mesej sokongan",modalTitle:"Ini adalah siaran mereka:",modalAction:"Tinggalkan mesej sokongan:",nicknamePlaceholder:"Nama samaran anda",commentPlaceholder:"Kandungan sokongan...",submitComment:"Hantar Sokongan",supportMessage:"💝 Beri Sokongan",supportDesc:"Lihat perkongsian emosi orang lain dan berikan sokongan dan galakan yang hangat",recording:"Merakam",pressToStop:"Tekan untuk Berhenti",readyToRecord:"Sedia untuk Merakam",recordInstruction:'Selepas mengklik "Mula Merakam", sistem akan mula merakam mesej suara anda.',recordTimeLimit:"Masa rakaman terhad kepada 1 minit",cancel:"Batal",startRecording:"Mula Merakam",voice:"Suara"}},_w={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"};function Nw(){const t=le(),n=Fv(),i=vg(),[r,a]=e.useState([]),[o,s]=e.useState(""),[l,c]=e.useState(!1),[d,u]=e.useState(null),[h,p]=e.useState(""),[m,g]=e.useState(!1),[x,y]=e.useState(null),[b,v]=e.useState(!1),[k,w]=e.useState(!1),[j,S]=e.useState(0),[T,C]=e.useState(null),[I,B]=e.useState([]),[R,A]=e.useState(!1),[F,z]=e.useState(""),[E,_]=e.useState(0),[N,P]=e.useState(!1),D=e.useRef(null),W=e.useRef([]),M=e.useRef(0),[L,O]=e.useState(null),[q,U]=e.useState(null),[H,V]=e.useState(0),[K,$]=e.useState(null),[G,Q]=e.useState(!1),{lang:Y,setLang:J}=mw(),X=Ew[Y]||Ew["zh-TW"],[Z,ee]=e.useState(null),[te,ne]=e.useState(!1),[ie,re]=e.useState(!1),ae=e.useRef(null),oe=e.useRef(null),{checkPermission:se,recordUsage:ce}=Rw(),[de,ue]=e.useState(!1),[he,pe]=e.useState(null),{isTestMode:me}=CB();e.useEffect(()=>{const e=yb(n,e=>{ee(e)});return()=>e()},[]),e.useEffect(()=>{const e=e=>{ae.current&&!ae.current.contains(e.target)&&ne(!1),oe.current&&!oe.current.contains(e.target)&&re(!1)};return(te||ie)&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[te,ie]);const ge=async e=>{var t,r,a;try{const a=hg(i,"profiles",e),o=await Pf(a);if(o.exists()){const e=o.data();return{name:e.nickname||e.name||"用戶",avatar:e.avatar||"/avatars/Derxl.png",country:e.country||"台灣",gender:e.gender||"未知",age:e.age||25,email:(null==(t=n.currentUser)?void 0:t.email)||"unknown@example.com"}}{const e=n.currentUser;return{name:(null==e?void 0:e.displayName)||(null==(r=null==e?void 0:e.email)?void 0:r.split("@")[0])||"用戶",avatar:(null==e?void 0:e.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(null==e?void 0:e.email)||"unknown@example.com"}}}catch(o){const e=n.currentUser;return{name:(null==e?void 0:e.displayName)||(null==(a=null==e?void 0:e.email)?void 0:a.split("@")[0])||"用戶",avatar:(null==e?void 0:e.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(null==e?void 0:e.email)||"unknown@example.com"}}};e.useEffect(()=>{const e=localStorage.getItem("messages");if(e)try{const t=JSON.parse(e),n=Fv(),i=n.currentUser,r=t.filter(e=>!i||"user123"!==e.user.id&&"user456"!==e.user.id&&"user789"!==e.user.id).filter(e=>!(e.text.includes("[語音留言")&&(!e.duration||e.duration<=0))),o=r.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());a(o),r.length!==t.length&&localStorage.setItem("messages",JSON.stringify(r));const s=n.currentUser;if(s){(async()=>{try{let e=!1;const t=await ge(s.uid),n=r.map(n=>{if(n.comments){const i=n.comments.map(n=>("lkjh123"!==n.nickname&&"as0@gmail.com"!==n.commenterEmail&&n.commenterId&&0!==n.commenterAge&&35!==n.commenterAge&&39!==n.commenterAge||(n.commenterId=s.uid,n.nickname=t.name,n.commenterEmail=t.email,n.commenterAvatar=t.avatar,n.commenterCountry=t.country,n.commenterGender=t.gender,n.commenterAge=t.age,n.createdAt=n.createdAt||(new Date).toISOString(),e=!0),n));return{...n,comments:i}}return n});e&&(a(n),localStorage.setItem("messages",JSON.stringify(n)))}catch(e){}})()}}catch(t){}},[]);const fe=e=>{const t=Fv().currentUser;return t&&e.user.id===t.uid},xe=e=>{const t=Fv().currentUser;return t&&e.commenterId===t.uid},ye=()=>{const e=Fv().currentUser;return e?r.filter(t=>t.user.id===e.uid):[]},be=e=>{if(L===e.id&&q)return q.pause(),O(null),U(null),K&&(clearInterval(K),$(null)),void V(0);if(L===e.id&&!q){const t=new Audio(e.audioUrl),n=e.duration?e.duration-H:0;t.currentTime=n,O(e.id),U(t);const i=setInterval(()=>{V(e=>e<=1?(clearInterval(i),O(null),U(null),$(null),0):e-1)},1e3);return $(i),void t.play().then(()=>{}).catch(t=>{ve(e.text)})}if(q&&(q.pause(),K&&(clearInterval(K),$(null)),V(0)),e.audioUrl){const t=new Audio(e.audioUrl);O(e.id),U(t),V(e.duration||0),t.onerror=t=>{ve(e.text)},t.onended=()=>{O(null),U(null),V(0),K&&(clearInterval(K),$(null))};const n=setInterval(()=>{V(e=>e<=1?(clearInterval(n),O(null),U(null),$(null),0):e-1)},1e3);$(n),t.play().then(()=>{}).catch(t=>{ve(e.text)})}else ve(e.text)},ve=e=>{if("speechSynthesis"in window){const t=new SpeechSynthesisUtterance(e);t.lang="zh-TW",t.rate=.9,t.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(t)}else alert("瀏覽器不支援語音播放功能")},ke=async()=>{if(!o.trim())return;c(!0);const e=n.currentUser;if(!e)return alert("請先登入"),void c(!1);const t=await ge(e.uid),i=[{id:Date.now().toString(),text:o,aiReply:"",toneId:"",createdAt:(new Date).toISOString(),user:{id:e.uid,name:t.name,avatar:t.avatar,country:t.country,region:t.country,email:t.email},comments:[]},...r];a(i),localStorage.setItem("messages",JSON.stringify(i)),s(""),c(!1)};return f.jsxs("div",{className:"modern-bg",style:{background:(window.innerWidth,"#8a8a8a"),backgroundImage:"url(/soil.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[window.innerWidth<=768?f.jsx(zw,{}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>t("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},children:"zh-TW"===Y?"🧬 Restarter™｜我們是誰":"zh-CN"===Y?"🧬 Restarter™｜我们是谁":"en"===Y?"🧬 Restarter™｜Who We Are":"ja"===Y?"🧬 Restarter™｜私たちについて":"ko"===Y?"🧬 Restarter™｜우리는 누구인가":"th"===Y?"🧬 Restarter™｜เราเป็นใคร":"vi"===Y?"🧬 Restarter™｜Chúng tôi là ai":"ms"===Y?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>t("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},children:"zh-TW"===Y?"💬 意見箱｜我們想聽你說":"zh-CN"===Y?"💬 意见箱｜我们想听你说":"en"===Y?"💬 Feedback｜We Want to Hear You":"ja"===Y?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===Y?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===Y?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===Y?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===Y?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),Z?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:Z.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:Z.displayName||Z.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(n)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:_w[Y]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>t("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===Y?"註冊/登入":"zh-CN"===Y?"注册/登录":"en"===Y?"Register / Login":"ja"===Y?"登録/ログイン":"ko"===Y?"가입/로그인":"th"===Y?"สมัคร/เข้าสู่ระบบ":"vi"===Y?"Đăng ký/Đăng nhập":"ms"===Y?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:ae,children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>ne(e=>!e),children:["zh-TW"===Y?"繁中":"zh-CN"===Y?"简中":"en"===Y?"English":"ja"===Y?"日本語":"ko"===Y?"한국어":"th"===Y?"ไทย":"vi"===Y?"Tiếng Việt":"ms"===Y?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),te&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===Y?"#6B5BFF":"#232946",fontWeight:e===Y?700:500,background:e===Y?"#f3f0ff":"#fff"},onClick:()=>{J(e),ne(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:oe,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>re(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),ie&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===Y||"zh-CN"===Y?"法律文件":"en"===Y?"Legal Documents":"ja"===Y?"法的文書":"ko"===Y?"법적 문서":"th"===Y?"เอกสารทางกฎหมาย":"vi"===Y?"Tài liệu pháp lý":"ms"===Y?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:{"zh-TW":"隱私權政策","zh-CN":"隐私权政策",en:"Privacy Policy",ja:"プライバシーポリシー",ko:"개인정보 처리방침",th:"นโยบายความเป็นส่วนตัว",vi:"Chính sách bảo mật",ms:"Dasar Privasi",la:"Politica Privata"},path:"/privacy-policy"},{key:"terms",title:{"zh-TW":"條款/聲明","zh-CN":"条款/声明",en:"Terms & Conditions",ja:"利用規約",ko:"이용약관",th:"ข้อกำหนดและเงื่อนไข",vi:"Điều khoản & Điều kiện",ms:"Terma & Syarat",la:"Termini & Conditiones"},path:"/terms"},{key:"data",title:{"zh-TW":"資料刪除說明","zh-CN":"资料删除说明",en:"Data Deletion",ja:"データ削除",ko:"데이터 삭제",th:"การลบข้อมูล",vi:"Xóa dữ liệu",ms:"Pemadaman Data",la:"Deletio Datorum"},path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{t(e.path),re(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title[Y]||e.title["zh-TW"]},e.key))]})]})]}),f.jsx("div",{style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>t("/")})})]}),f.jsxs("div",{className:"modern-container",style:{maxWidth:window.innerWidth<=768?"100%":600,width:"100%",margin:"0 auto",flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:window.innerWidth<=768?"140px 16px 20px 16px":"0",marginTop:window.innerWidth<=768?"0":"120px",boxSizing:"border-box",minHeight:window.innerWidth<=768?"100vh":"auto",position:"relative",zIndex:1,overflow:"hidden",background:(window.innerWidth,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)"),transform:"translate3d(0, 0, 0)",backfaceVisibility:"hidden",perspective:"1000px",willChange:"auto"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:(window.innerWidth,12),flexDirection:(window.innerWidth,"column"),gap:(window.innerWidth,8),width:"100%",minHeight:(window.innerWidth,"auto"),background:(window.innerWidth,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)")},children:[f.jsx("h2",{className:"modern-title",style:{fontSize:(window.innerWidth,"1.4rem"),margin:0,flex:1,textAlign:"center",color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,display:"flex",alignItems:"center",gap:(window.innerWidth,2),whiteSpace:"nowrap",flexWrap:"wrap",justifyContent:"center",background:(window.innerWidth,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)")},children:X.title}),window.innerWidth<=768&&f.jsx("button",{onClick:()=>{g(!m)},style:{background:m?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:10,padding:"8px 12px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",whiteSpace:"nowrap",width:"120px",minHeight:"32px",cursor:"pointer",zIndex:9999,position:"relative",pointerEvents:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"manipulation"},children:m?"zh-TW"===Y||"zh-CN"===Y?"🌍 所有留言":"en"===Y?"🌍 All Messages":"ja"===Y?"🌍 すべてのメッセージ":"ko"===Y?"🌍 모든 메시지":"vi"===Y?"🌍 Tất cả tin nhắn":"th"===Y?"🌍 ข้อความทั้งหมด":"la"===Y?"🌍 Visi ziņojumi":"ms"===Y?"🌍 Semua mesej":"🌍 所有留言":"zh-TW"===Y||"zh-CN"===Y?"💌 我的留言":"en"===Y?"💌 My Messages":"ja"===Y?"💌 私のメッセージ":"ko"===Y?"💌 내 메시지":"vi"===Y?"💌 Tin nhắn của tôi":"th"===Y?"💌 ข้อความของฉัน":"la"===Y?"💌 Mani ziņojumi":"ms"===Y?"💌 Mesej saya":"💌 我的留言"})]}),f.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(107, 91, 255, 0.1) 0%, rgba(35, 198, 230, 0.1) 100%)",borderRadius:"20px",padding:window.innerWidth<=768?"16px":"24px",marginBottom:"18px",border:"2px solid rgba(107, 91, 255, 0.2)",boxShadow:"0 8px 32px rgba(107, 91, 255, 0.15)",backdropFilter:"blur(10px)",textAlign:"center",marginTop:window.innerWidth<=768?"40px":window.innerWidth<=768?"20px":"10px"},children:[f.jsx("h3",{style:{color:"#fff",fontSize:(window.innerWidth,"1.2rem"),fontWeight:"700",margin:"0 0 12px 0",textShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:X.subtitle}),f.jsx("p",{style:{color:"#000",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",lineHeight:"1.6",margin:"0",opacity:"0.9"},children:"在這裡，分享你真實的情感與心情，或為他人提供溫暖的支援留言，彼此傾聽支持，每個人都能找到情感上的歸屬感和後盾，讓我們一起建立溫暖的社群，共同打造一個有溫度大家庭。"})]}),f.jsx("div",{className:"tone-list",style:{marginBottom:18}}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:12,marginBottom:18,padding:(window.innerWidth,"0 8px"),width:"100%",maxWidth:"600px",margin:"0 auto"},children:[f.jsx("input",{className:"quote-card",style:{width:window.innerWidth<=768?"100%":"calc(100% - 32px)",fontSize:window.innerWidth<=768?16:18,padding:window.innerWidth<=768?"10px 14px":"12px 16px",border:"2px solid rgba(107, 91, 255, 0.5)",outline:"none",background:"#232946",color:"#fff",borderRadius:"12px",marginBottom:"8px",boxSizing:"border-box",margin:window.innerWidth<=768?void 0:"0 auto 8px auto"},maxLength:200,placeholder:X.placeholder,value:o,onChange:e=>s(e.target.value),onKeyDown:e=>"Enter"===e.key&&ke(),disabled:l}),f.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"space-between",width:window.innerWidth<=768?"100%":"calc(100% - 32px)",padding:window.innerWidth<=768?"0 8px":"0 8px 0 16px",margin:window.innerWidth<=768?void 0:"0 auto"},children:[f.jsx("button",{className:"tone-card selected",style:{fontSize:window.innerWidth<=768?14:16,padding:window.innerWidth<=768?"8px 12px":"10px 16px",minWidth:window.innerWidth<=768?"60px":"70px",whiteSpace:"nowrap",flexShrink:0,borderRadius:"8px",background:"linear-gradient(135deg, #6B5BFF 0%, #23c6e6 100%)",color:"#fff",border:"none",cursor:"pointer"},onClick:()=>{ke()},disabled:l,children:l?X.sending:X.send}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[f.jsxs("button",{onClick:async()=>{if(k)return D.current&&"recording"===D.current.state&&D.current.stop(),T&&(clearInterval(T),C(null)),w(!1),v(!1),void S(0);if("true"===localStorage.getItem("testMode"))return void P(!0);const e=await se("aiChat");if(!e.allowed)return pe(e),void ue(!0);P(!0)},style:{background:b?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"12px",padding:window.innerWidth<=768?"10px 16px":"10px 10px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:b?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:b?"pulse 1.5s infinite":"none",minWidth:window.innerWidth<=768?"70px":"56px",whiteSpace:"nowrap",flexShrink:0,marginRight:window.innerWidth<=768?void 0:8},onMouseOver:e=>{b||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:e=>{b||(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[f.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),b?`${X.recording} ${Math.floor(j/60)}:${(j%60).toString().padStart(2,"0")}`:X.voice]}),b&&f.jsx("div",{style:{fontSize:"12px",color:"#f44336",marginTop:"4px",fontWeight:"500"},children:X.pressToStop}),window.innerWidth>768&&f.jsx("button",{onClick:()=>{g(!m)},style:{background:m?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:10,padding:"6px 10px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",whiteSpace:"nowrap",width:"100px",minHeight:"28px",cursor:"pointer",zIndex:9999,position:"relative",pointerEvents:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"manipulation",marginTop:"8px"},children:m?"zh-TW"===Y||"zh-CN"===Y?"🌍 所有留言":"en"===Y?"🌍 All":"ja"===Y?"🌍 すべて":"ko"===Y?"🌍 모든":"vi"===Y?"🌍 Tất cả":"th"===Y?"🌍 ทั้งหมด":"la"===Y?"🌍 Visi":"ms"===Y?"🌍 Semua":"🌍 所有留言":"zh-TW"===Y||"zh-CN"===Y?"💌 我的留言":"en"===Y?"💌 My":"ja"===Y?"💌 私の":"ko"===Y?"💌 내":"vi"===Y?"💌 Tin nhắn":"th"===Y?"💌 ข้อความ":"la"===Y?"💌 Mani":"ms"===Y?"💌 Mesej":"💌 我的留言"})]})]}),f.jsx("div",{className:"quote-list",children:m?f.jsxs("div",{children:[f.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.5rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["💌 ","zh-TW"===Y||"zh-CN"===Y?"我的留言":"en"===Y?"My Messages":"ja"===Y?"私のメッセージ":"ko"===Y?"내 메시지":"vi"===Y?"Tin nhắn của tôi":"th"===Y?"ข้อความของฉัน":"la"===Y?"Mani ziņojumi":"ms"===Y?"Mesej saya":"我的留言"]}),f.jsxs("div",{style:{marginBottom:"24px"},children:[f.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"📝 我發表的留言"}),0===ye().length?f.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有發表過留言"}):ye().map(e=>f.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[f.jsx("img",{src:e.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>u(e)}),f.jsx("button",{onClick:()=>(e=>{if(window.confirm("🤗 親愛的朋友，您真的要刪除這條留言嗎？\n\n💭 我們理解您可能想要重新整理思緒，但刪除後就無法找回囉～\n\n✨ 如果您確定要刪除，我們會溫柔地幫您處理。")){const t=r.filter(t=>t.id!==e);a(t),localStorage.setItem("messages",JSON.stringify(t))}})(e.id),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #ff6b6b 60%, #ff8e8e 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"12px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(255, 107, 107, 0.3)",zIndex:10},children:"刪除"}),f.jsx("div",{className:"quote-text",children:e.text}),e.audioUrl&&f.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsxs("button",{onClick:()=>be(e),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{children:L===e.id?"⏹️":"▶️"}),L===e.id?"停止播放":"播放原音"]}),f.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",e.duration&&e.duration>0?`${Math.floor(e.duration/60)}:${(e.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),f.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(e.createdAt).toLocaleString()}),f.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[f.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:X.commentsTitle}),0===(e.comments||[]).length&&f.jsx("span",{style:{color:"#bbb",marginLeft:8},children:X.noComments}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(e.comments||[]).sort((t,n)=>{const i=t.createdAt?new Date(t.createdAt).getTime():new Date(e.createdAt).getTime();return(n.createdAt?new Date(n.createdAt).getTime():new Date(e.createdAt).getTime())-i}).map((t,n)=>f.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[f.jsx("img",{src:t.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[f.jsx("b",{style:{color:"#6B5BFF"},children:t.nickname}),(fe(e)||xe(t))&&f.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[f.jsxs("div",{children:["📧 ",t.commenterEmail]}),f.jsxs("div",{children:["🌍 ",t.commenterCountry]}),f.jsxs("div",{children:["👤 ",t.commenterGender,"・",t.commenterAge,"歲"]})]}),!fe(e)&&!xe(t)&&f.jsx("div",{style:{fontSize:"12px",color:"#666"},children:f.jsxs("div",{children:["🌍 ",t.commenterCountry]})})]}),f.jsx("div",{children:t.content}),f.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:t.createdAt?new Date(t.createdAt).toLocaleString():new Date(e.createdAt).toLocaleString()}),fe(e)&&!xe(t)&&f.jsx("button",{onClick:()=>alert(`聯繫 ${t.nickname}：\n郵箱：${t.commenterEmail}\n國家：${t.commenterCountry}\n性別：${t.commenterGender}\n年齡：${t.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},n))})]})]},e.id))]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["🌍 ","zh-TW"===Y||"zh-CN"===Y?"全部留言":"en"===Y?"All Messages":"ja"===Y?"すべてのメッセージ":"ko"===Y?"모든 메시지":"vi"===Y?"Tất cả tin nhắn":"th"===Y?"ข้อความทั้งหมด":"la"===Y?"Visi ziņojumi":"ms"===Y?"Semua mesej":"全部留言"]}),0===r.filter(e=>!fe(e)).length&&f.jsx("div",{style:{color:"#000",textAlign:"center",marginTop:32},children:X.noMessages}),f.jsxs("div",{style:{marginTop:"40px",marginBottom:"40px"},children:[f.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1rem",marginBottom:"12px",textAlign:"center"},children:"💝 我給別人的支援留言"}),(()=>{const e=(()=>{const e=Fv().currentUser,t=[];return e?(r.forEach(n=>{var i;null==(i=n.comments)||i.forEach(i=>{var r;if(!i.commenterId){const t=e.displayName||(null==(r=e.email)?void 0:r.split("@")[0])||"用戶",n=e.email;i.nickname!==t&&i.commenterEmail!==n||(i.commenterId=e.uid)}i.commenterId===e.uid&&t.push({message:n,comment:i})})}),t):t})();return 0===e.length?f.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有給別人留過支援留言"}):e.map(({message:e,comment:t},n)=>f.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[f.jsx("img",{src:e.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,border:"2px solid #6B5BFF"}}),f.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["給 ",f.jsx("b",{style:{color:"#6B5BFF"},children:e.user.name})," 的支援留言："]}),f.jsx("div",{className:"quote-text",style:{background:"#f0f8ff",padding:"8px 12px",borderRadius:"8px",border:"1px solid #e6f3ff"},children:t.content}),f.jsx("div",{style:{fontSize:12,color:"#614425",marginTop:6},children:t.createdAt?new Date(t.createdAt).toLocaleString():new Date(e.createdAt).toLocaleString()})]},n))})()]}),r.filter(e=>!fe(e)).map(e=>f.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64},children:[f.jsx("img",{src:e.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>u(e)}),f.jsx("div",{className:"quote-text",children:e.text}),e.audioUrl&&f.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[f.jsxs("button",{onClick:()=>be(e),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{children:L===e.id?"⏹️":"▶️"}),L===e.id?"停止播放":"播放原音"]}),f.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",e.duration&&e.duration>0?`${Math.floor(e.duration/60)}:${(e.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),f.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(e.createdAt).toLocaleString()}),f.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"center"},children:f.jsx("button",{onClick:()=>u(e),style:{background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"20px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:X.supportMessage})}),f.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[f.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:X.commentsTitle}),0===(e.comments||[]).length&&f.jsx("span",{style:{color:"#bbb",marginLeft:8},children:X.noComments}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(e.comments||[]).sort((t,n)=>{const i=t.createdAt?new Date(t.createdAt).getTime():new Date(e.createdAt).getTime();return(n.createdAt?new Date(n.createdAt).getTime():new Date(e.createdAt).getTime())-i}).map((t,n)=>f.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[f.jsx("img",{src:t.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[f.jsx("b",{style:{color:"#6B5BFF"},children:t.nickname}),(fe(e)||xe(t))&&f.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[f.jsxs("div",{children:["📧 ",t.commenterEmail]}),f.jsxs("div",{children:["🌍 ",t.commenterCountry]}),f.jsxs("div",{children:["👤 ",t.commenterGender,"・",t.commenterAge,"歲"]})]}),!fe(e)&&!xe(t)&&f.jsx("div",{style:{fontSize:"12px",color:"#666"},children:f.jsxs("div",{children:["🌍 ",t.commenterCountry]})})]}),f.jsx("div",{children:t.content}),f.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:t.createdAt?new Date(t.createdAt).toLocaleString():new Date(e.createdAt).toLocaleString()}),fe(e)&&!xe(t)&&f.jsx("button",{onClick:()=>alert(`聯繫 ${t.nickname}：\n郵箱：${t.commenterEmail}\n國家：${t.commenterCountry}\n性別：${t.commenterGender}\n年齡：${t.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},n))})]})]},e.id))]})})]})]}),N&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[f.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"🎤"}),f.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333",fontSize:"20px"},children:X.readyToRecord}),f.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666",lineHeight:"1.5"},children:[X.recordInstruction,f.jsx("br",{}),f.jsxs("strong",{style:{color:"#ff6b6b"},children:["⚠️ ",X.recordTimeLimit]})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{P(!1)},style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:X.cancel}),f.jsx("button",{onClick:async()=>{P(!1);try{const e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});B([]),W.current=[],S(0),M.current=0,V(0),t.ondataavailable=e=>{e.data.size>0&&(W.current.push(e.data),B(t=>[...t,e.data]))},t.onstop=()=>{T&&(clearInterval(T),C(null));const t=[...W.current],n=t.length>0?new Blob(t,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),i=Math.max(1,M.current),r=URL.createObjectURL(n);z(r),_(i),A(!0),e.getTracks().forEach(e=>e.stop()),w(!1),v(!1)},t.start(100),D.current=t,w(!0),v(!0);const n=setInterval(()=>{S(e=>{const t=e+1;return M.current=t,t>=60&&(D.current&&"recording"===D.current.state&&D.current.stop(),n&&(clearInterval(n),C(null)),w(!1),v(!1),alert("⏰ 親愛的朋友，錄音時間已達1分鐘限制，已自動停止錄音囉～\n\n💭 我們希望給您足夠的時間表達，但也要照顧其他朋友的使用體驗。")),t})},1e3);C(n)}catch(e){alert("🎤 親愛的朋友，無法訪問麥克風呢～\n\n🔧 請檢查瀏覽器權限設置，允許我們使用麥克風功能。\n\n💡 通常在網址列旁邊有個麥克風圖示，點擊允許即可。")}},style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:X.startRecording})]})]})}),R&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[f.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"語音錄製完成"}),f.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666"},children:["錄音時長: ",E>0?`${Math.floor(E/60)}:${(E%60).toString().padStart(2,"0")}`:"0:00"," (實際錄音: ",Math.max(1,E),"秒)"]}),f.jsxs("button",{onClick:()=>{if(F){const e=Math.max(1,E);if(q)return q.pause(),U(null),void(K&&(clearInterval(K),$(null)));const t=new Audio(F);U(t),V(e),t.onended=()=>{U(null),V(0),K&&(clearInterval(K),$(null))};const n=setInterval(()=>{V(e=>e<=1?(clearInterval(n),U(null),0):e-1)},1e3);$(n),t.play()}},style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto 16px auto"},children:[f.jsx("span",{children:q?"⏹️":"▶️"}),q?"停止播放":"播放錄音"]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[f.jsx("button",{onClick:async()=>{if(F){const e=Math.max(1,E),t=`[語音留言 - ${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}]`;c(!0);const i=n.currentUser;if(!i)return alert("請先登入"),void c(!1);const o=await ge(i.uid),s=[{id:Date.now().toString(),text:t,aiReply:"",toneId:"",createdAt:(new Date).toISOString(),audioUrl:F,duration:e,user:{id:i.uid,name:o.name,avatar:o.avatar,country:o.country,region:o.country,email:o.email},comments:[]},...r];a(s),localStorage.setItem("messages",JSON.stringify(s)),await ce("aiChat",1),z(""),_(0),A(!1),c(!1),g(!0)}},style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"確定"}),f.jsx("button",{onClick:()=>{A(!1),z(""),_(0)},style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"})]})]})}),de&&he&&f.jsx(yw,{isOpen:de,onClose:()=>{ue(!1),pe(null)},currentPlan:he.currentPlan,remainingDays:he.remainingDays,usedTokens:he.usedTokens,totalTokens:he.totalTokens})]})}const Pw={"zh-TW":{title:"心聲釋放 Voice Release",subtitle:"無需放在心裡...對哪些人事物不滿你可盡情說出，天下沒有不能解決的難題",holdToRecord:"按住錄音",webSimulation:"(網頁版使用模擬錄音)",recording:"錄音中...",stopRecording:"停止錄音",todayMood:"今天的心情",reflectionMoment:"反思時刻",addDiary:"添加心聲",editDiary:"編輯心聲",deleteDiary:"刪除心聲",save:"保存",cancel:"取消",backToHome:"← 返回首頁",logout:"登出",noDiaries:"還沒有心聲日記，開始錄音吧！",startSpeaking:"開始說話",submit:"送出",submitVoice:"送出心聲",recordingComplete:"錄音完成",submitToSave:"點擊送出保存心聲",emotion:{happy:"開心",sad:"難過",angry:"生氣",neutral:"平靜",excited:"興奮",calm:"放鬆"}},"zh-CN":{title:"心声释放 Voice Release",subtitle:"无需放在心里...对哪些人事物不满你可尽情说出，天下没有不能解决的难题",holdToRecord:"按住录音",webSimulation:"(网页版使用模拟录音)",recording:"录音中...",stopRecording:"停止录音",todayMood:"今天的心情",reflectionMoment:"反思时刻",addDiary:"添加心声",editDiary:"编辑心声",deleteDiary:"删除心声",save:"保存",cancel:"取消",backToHome:"← 返回首页",logout:"登出",noDiaries:"还没有心声日记，开始录音吧！",startSpeaking:"开始说话",submit:"送出",submitVoice:"送出心声",recordingComplete:"录音完成",submitToSave:"点击送出保存心声",emotion:{happy:"开心",sad:"难过",angry:"生气",neutral:"平静",excited:"兴奋",calm:"放松"}},ja:{title:"心の声を解放 Voice Release",subtitle:"心に留めておく必要はない...どの人や物事への不満も自由に言い、解決できない問題はない",holdToRecord:"録音を押し続ける",webSimulation:"(Web版は模擬録音を使用)",recording:"録音中...",stopRecording:"録音停止",todayMood:"今日の気分",reflectionMoment:"反省の瞬間",addDiary:"心の声を追加",editDiary:"心の声を編集",deleteDiary:"心の声を削除",save:"保存",cancel:"キャンセル",backToHome:"← ホームに戻る",logout:"ログアウト",noDiaries:"まだ心の声の日記がありません。録音を始めましょう！",startSpeaking:"話し始める",submit:"送信",submitVoice:"心の声を送信",recordingComplete:"録音完了",submitToSave:"送信して心の声を保存",emotion:{happy:"嬉しい",sad:"悲しい",angry:"怒り",neutral:"平静",excited:"興奮",calm:"リラックス"}},ko:{title:"마음의 소리 해방 Voice Release",subtitle:"마음속에 담아둘 필요 없이...어떤 사람이나 사물에 대한 불만을 자유롭게 말하고, 해결할 수 없는 문제는 없다",holdToRecord:"녹음하려면 길게 누르세요",webSimulation:"(웹 버전은 시뮬레이션 녹음 사용)",recording:"녹음 중...",stopRecording:"녹음 중지",todayMood:"오늘의 기분",reflectionMoment:"성찰의 순간",addDiary:"마음의 소리 추가",editDiary:"마음의 소리 편집",deleteDiary:"마음의 소리 삭제",save:"저장",cancel:"취소",backToHome:"← 홈으로 돌아가기",logout:"로그아웃",noDiaries:"아직 마음의 소리 일기가 없습니다. 녹음을 시작해보세요!",startSpeaking:"말하기 시작",submit:"제출",submitVoice:"마음의 소리 제출",recordingComplete:"녹음 완료",submitToSave:"제출하여 마음의 소리 저장",emotion:{happy:"행복",sad:"슬픔",angry:"분노",neutral:"평온",excited:"흥분",calm:"차분"}},th:{title:"ปลดปล่อยเสียงในใจ Voice Release",subtitle:"ไม่จำเป็นต้องเก็บไว้ในใจ...คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ ไม่มีปัญหาที่แก้ไขไม่ได้",holdToRecord:"กดค้างเพื่อบันทึก",webSimulation:"(เวอร์ชันเว็บใช้การบันทึกจำลอง)",recording:"กำลังบันทึก...",stopRecording:"หยุดบันทึก",todayMood:"อารมณ์วันนี้",reflectionMoment:"ช่วงเวลาสะท้อนคิด",addDiary:"เพิ่มเสียงในใจ",editDiary:"แก้ไขเสียงในใจ",deleteDiary:"ลบเสียงในใจ",save:"บันทึก",cancel:"ยกเลิก",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",noDiaries:"ยังไม่มีไดอารี่เสียงในใจ เริ่มบันทึกกันเลย!",startSpeaking:"เริ่มพูด",submit:"ส่ง",submitVoice:"ส่งเสียงในใจ",recordingComplete:"บันทึกเสร็จสิ้น",submitToSave:"คลิกส่งเพื่อบันทึกเสียงในใจ",emotion:{happy:"มีความสุข",sad:"เศร้า",angry:"โกรธ",neutral:"สงบ",excited:"ตื่นเต้น",calm:"ผ่อนคลาย"}},vi:{title:"Giải Phóng Tiếng Lòng Voice Release",subtitle:"Không cần giữ trong lòng...bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc nào đó, không có vấn đề nào không thể giải quyết",holdToRecord:"Giữ để ghi âm",webSimulation:"(Phiên bản web sử dụng ghi âm mô phỏng)",recording:"Đang ghi âm...",stopRecording:"Dừng ghi âm",todayMood:"Tâm trạng hôm nay",reflectionMoment:"Khoảnh khắc suy ngẫm",addDiary:"Thêm tiếng lòng",editDiary:"Chỉnh sửa tiếng lòng",deleteDiary:"Xóa tiếng lòng",save:"Lưu",cancel:"Hủy",backToHome:"← Về trang chủ",logout:"Đăng xuất",noDiaries:"Chưa có nhật ký tiếng lòng, hãy bắt đầu ghi âm!",startSpeaking:"Bắt đầu nói",submit:"Gửi",submitVoice:"Gửi tiếng lòng",recordingComplete:"Ghi âm hoàn thành",submitToSave:"Nhấp để gửi và lưu tiếng lòng",emotion:{happy:"Vui vẻ",sad:"Buồn",angry:"Tức giận",neutral:"Bình tĩnh",excited:"Hưng phấn",calm:"Thư giãn"}},ms:{title:"Pelepasan Suara Hati Voice Release",subtitle:"Tidak perlu disimpan dalam hati...anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, tiada masalah yang tidak dapat diselesaikan",holdToRecord:"Tahan untuk Rakam",webSimulation:"(Versi web menggunakan rakaman simulasi)",recording:"Merakam...",stopRecording:"Hentikan Rakaman",todayMood:"Mood Hari Ini",reflectionMoment:"Saat Refleksi",addDiary:"Tambah Suara Hati",editDiary:"Sunting Suara Hati",deleteDiary:"Padam Suara Hati",save:"Simpan",cancel:"Batal",backToHome:"← Kembali ke Rumah",logout:"Log Keluar",noDiaries:"Belum ada diari suara hati, mulakan rakaman!",startSpeaking:"Mula Bercakap",submit:"Hantar",submitVoice:"Hantar Suara Hati",recordingComplete:"Rakaman Selesai",submitToSave:"Klik untuk hantar dan simpan suara hati",emotion:{happy:"Gembira",sad:"Sedih",angry:"Marah",neutral:"Tenang",excited:"Teruja",calm:"Selesa"}},la:{title:"Vox Liberatio Voice Release",subtitle:"Non necesse est in corde servare...liberam dissatisfactionem cum hominibus vel rebus quibusdam profer, nulla quaestio insolubilis est",holdToRecord:"Tene ad Recordandum",webSimulation:"(Versio interretialis simulatione utitur)",recording:"Recordans...",stopRecording:"Recordationem Cessa",todayMood:"Affectus Hodiernus",reflectionMoment:"Momentum Cogitationis",addDiary:"Vox Adde",editDiary:"Vox Edita",deleteDiary:"Vox Dele",save:"Serva",cancel:"Cancella",backToHome:"← Ad Domum Reverte",logout:"Exi",noDiaries:"Nondum diaria vocis cordis, incipiamus recordare!",startSpeaking:"Incipe Loqui",submit:"Submitte",submitVoice:"Vox Submitte",recordingComplete:"Recordatio Perfecta",submitToSave:"Click ut submitte et serva vocem",emotion:{happy:"Laetus",sad:"Tristis",angry:"Iratus",neutral:"Tranquillus",excited:"Excitatus",calm:"Placidus"}},en:{title:"Voice Release",subtitle:"No need to keep it in your heart...you can freely speak out your dissatisfaction with which people or things, there is no problem that cannot be solved",holdToRecord:"Hold to Record",webSimulation:"(Web version uses simulated recording)",recording:"Recording...",stopRecording:"Stop Recording",todayMood:"Today's Mood",reflectionMoment:"Reflection Moment",addDiary:"Add Voice",editDiary:"Edit Voice",deleteDiary:"Delete Voice",save:"Save",cancel:"Cancel",backToHome:"← Back to Home",logout:"Logout",noDiaries:"No heart voice diaries yet, start recording!",startSpeaking:"Start Speaking",submit:"Submit",submitVoice:"Submit Voice",recordingComplete:"Recording Complete",submitToSave:"Click to submit and save voice",emotion:{happy:"Happy",sad:"Sad",angry:"Angry",neutral:"Neutral",excited:"Excited",calm:"Calm"}}},Dw={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"};function Ww(){const t=le(),{lang:n,setLang:i}=mw(),r=Pw[n]||Pw["zh-TW"],[a,o]=e.useState(null),[s,l]=e.useState(!1),[c,d]=e.useState(!1),u=e.useRef(null),h=e.useRef(null),[p,m]=e.useState(!1),[g,x]=e.useState(null),[y,b]=e.useState([]),v=e.useRef([]),[k,w]=e.useState(()=>{const e=localStorage.getItem("voiceDiaries");return e?JSON.parse(e):[{id:1,title:"今天的心情",content:"今天感覺很棒，完成了所有計劃的任務。",date:(new Date).toISOString(),emotion:"happy",expanded:!1},{id:2,title:"反思時刻",content:"需要學會更好地管理時間，提高效率。",date:new Date(Date.now()-864e5).toISOString(),emotion:"neutral",expanded:!1}]}),[j,S]=e.useState(!1),[T,C]=e.useState(!1),[I,B]=e.useState(null),[R,A]=e.useState({title:"",content:"",emotion:"neutral"}),[F,z]=e.useState(0),[E,_]=e.useState(null),[N,P]=e.useState(null),[D,W]=e.useState(!1),[M,L]=e.useState(!1),{checkPermission:O,recordUsage:q}=Rw(),[U,H]=e.useState(!1),[V,K]=e.useState(null),[$,G]=e.useState(null),[Q,Y]=e.useState(null),{isTestMode:J}=CB(),[X,Z]=e.useState(!1),[ee,te]=e.useState(null);e.useEffect(()=>{const e=yb(dw,e=>{o(e)});return()=>e()},[]),e.useEffect(()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&l(!1),h.current&&!h.current.contains(e.target)&&d(!1)};return(s||c)&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[s,c]);const ne=e=>{localStorage.setItem("voiceDiaries",JSON.stringify(e))},ie=e=>{if("speechSynthesis"in window){if(window.speechSynthesis.speaking)return window.speechSynthesis.cancel(),G(null),void Y(null);const t=new SpeechSynthesisUtterance(e);t.lang="zh-TW",t.rate=.9,t.pitch=1,t.onend=()=>{G(null),Y(null)},t.onerror=()=>{G(null),Y(null)},window.speechSynthesis.speak(t)}else alert("瀏覽器不支援語音播放功能"),G(null),Y(null)};e.useEffect(()=>()=>{E&&clearInterval(E)},[E]);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:window.innerWidth<=768?"0":"20px"},children:[f.jsx("style",{children:"\n            @keyframes pulse {\n              0% { transform: scale(1); }\n              50% { transform: scale(1.05); }\n              100% { transform: scale(1); }\n            }\n            @keyframes bounce {\n              0%, 20%, 50%, 80%, 100% { transform: translateY(0); }\n              40% { transform: translateY(-3px); }\n              60% { transform: translateY(-2px); }\n            }\n            @media (max-width: 767px) {\n              .mobile-shared-header {\n                display: block !important;\n              }\n              .desktop-header {\n                display: none !important;\n              }\n            }\n            @media (min-width: 768px) {\n              .mobile-shared-header {\n                display: none !important;\n              }\n              .desktop-header {\n                display: flex !important;\n              }\n            }\n          "}),f.jsx("div",{className:"mobile-shared-header",style:{display:"none"},children:f.jsx(zw,{})}),window.innerWidth>768&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>t("/")})}),f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>t("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},children:"zh-TW"===n?"🧬 Restarter™｜我們是誰":"zh-CN"===n?"🧬 Restarter™｜我们是谁":"en"===n?"🧬 Restarter™｜Who We Are":"ja"===n?"🧬 Restarter™｜私たちについて":"ko"===n?"🧬 Restarter™｜우리는 누구인가":"th"===n?"🧬 Restarter™｜เราเป็นใคร":"vi"===n?"🧬 Restarter™｜Chúng tôi là ai":"ms"===n?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>t("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},children:"zh-TW"===n?"💬 意見箱｜我們想聽你說":"zh-CN"===n?"💬 意见箱｜我们想听你说":"en"===n?"💬 Feedback｜We Want to Hear You":"ja"===n?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===n?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===n?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===n?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===n?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),a?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:a.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:a.displayName||a.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(dw)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:Dw[n]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>t("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===n?"註冊/登入":"zh-CN"===n?"注册/登录":"en"===n?"Register / Login":"ja"===n?"登録/ログイン":"ko"===n?"가입/로그인":"th"===n?"สมัคร/เข้าสู่ระบบ":"vi"===n?"Đăng ký/Đăng nhập":"ms"===n?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:u,children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>l(e=>!e),children:["zh-TW"===n?"繁中":"zh-CN"===n?"简中":"en"===n?"English":"ja"===n?"日本語":"ko"===n?"한국어":"th"===n?"ไทย":"vi"===n?"Tiếng Việt":"ms"===n?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),s&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===n?"#6B5BFF":"#232946",fontWeight:e===n?700:500,background:e===n?"#f3f0ff":"#fff"},onClick:()=>{i(e),l(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:h,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>d(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),c&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===n||"zh-CN"===n?"法律文件":"en"===n?"Legal Documents":"ja"===n?"法的文書":"ko"===n?"법적 문서":"th"===n?"เอกสารทางกฎหมาย":"vi"===n?"Tài liệu pháp lý":"ms"===n?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:{"zh-TW":"隱私權政策","zh-CN":"隐私权政策",en:"Privacy Policy",ja:"プライバシーポリシー",ko:"개인정보 처리방침",th:"นโยบายความเป็นส่วนตัว",vi:"Chính sách bảo mật",ms:"Dasar Privasi",la:"Politica Privata"},path:"/privacy-policy"},{key:"terms",title:{"zh-TW":"條款/聲明","zh-CN":"条款/声明",en:"Terms & Conditions",ja:"利用規約",ko:"이용약관",th:"ข้อกำหนดและเงื่อนไข",vi:"Điều khoản & Điều kiện",ms:"Terma & Syarat",la:"Termini & Conditiones"},path:"/terms"},{key:"data",title:{"zh-TW":"資料刪除說明","zh-CN":"资料删除说明",en:"Data Deletion",ja:"データ削除",ko:"데이터 삭제",th:"การลบข้อมูล",vi:"Xóa dữ liệu",ms:"Pemadaman Data",la:"Deletio Datorum"},path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{t(e.path),d(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title[n]||e.title["zh-TW"]},e.key))]})]})]})]}),f.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",marginTop:window.innerWidth<=768?"100px":"120px",padding:window.innerWidth<=768?"20px":"0"},children:[f.jsxs("div",{style:{textAlign:"center",marginBottom:"30px",color:"white"},children:[f.jsxs("h1",{style:{fontSize:window.innerWidth<=768?"28px":"36px",fontWeight:"900",margin:"0",textShadow:"0 2px 12px #232946, 0 4px 24px #0008"},children:["🎤 ",r.title]}),f.jsx("p",{style:{fontSize:window.innerWidth<=768?"14px":"16px",fontWeight:"400",margin:"12px 0 0 0",color:"rgba(255,255,255,0.9)",textShadow:"0 1px 4px #232946",lineHeight:"1.4"},children:"說出你的心聲，留給未來的自己一份溫柔。"})]}),f.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(64, 64, 64, 0.9), rgba(32, 32, 32, 0.8))",borderRadius:"20px",padding:"40px",textAlign:"center",marginBottom:"30px",boxShadow:"0 8px 32px rgba(128, 128, 128, 0.3)",maxWidth:window.innerWidth<=768?"90%":"60%",margin:"0 auto 30px auto",border:"1px solid rgba(192, 192, 192, 0.3)"},children:[f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"15px"},children:f.jsx("button",{onClick:async()=>{if(p)return g&&"recording"===g.state&&g.stop(),E&&(clearInterval(E),_(null)),m(!1),S(!1),void z(0);const e=await O("aiChat");if(!e.allowed)return J?void L(!0):(e.canRenew,K(e),void H(!0));L(!0)},style:{width:"80px",height:"80px",borderRadius:"50%",background:p?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #ff9800, #ff5722)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:p?"0 0 0 4px #ffe0b2, 0 0 20px rgba(255, 87, 34, 0.5)":"0 4px 16px rgba(255, 152, 0, 0.3)",cursor:"pointer",transition:"all 0.3s ease",border:"none",animation:p?"pulse 1.5s infinite":"none"},onMouseEnter:e=>{p||(e.currentTarget.style.transform="scale(1.1)")},onMouseLeave:e=>{p||(e.currentTarget.style.transform="scale(1)")},children:f.jsx("span",{style:{fontSize:"32px",color:"white",filter:p?"drop-shadow(0 0 6px #ff9800)":""},children:p?"⏹️":"🎤"})})}),f.jsx("div",{style:{color:p?"#ff5722":"#ff9800",fontSize:"16px",fontWeight:"700",marginBottom:"10px",textAlign:"center"},children:p?r.stopRecording:r.startSpeaking}),p&&f.jsxs("div",{style:{color:"#ff5722",fontSize:"14px",fontWeight:"600",textAlign:"center",marginBottom:"10px"},children:["錄音中... ",Math.floor(F/60),":",(F%60).toString().padStart(2,"0")]})]}),f.jsx("p",{style:{color:"#666",fontSize:"14px",marginBottom:"20px"},children:r.holdToRecord}),f.jsxs("button",{onClick:()=>C(!0),style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"12px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",marginTop:"20px"},children:["+ ","zh-TW"===n?"添加文字心聲":"zh-CN"===n?"添加文字心声":"en"===n?"Add Text Voice":"ja"===n?"テキスト心の声を追加":"ko"===n?"텍스트 마음의 소리 추가":"th"===n?"เพิ่มเสียงในใจแบบข้อความ":"vi"===n?"Thêm Tiếng Lòng Văn Bản":"ms"===n?"Tambah Suara Hati Teks":"Adde Vox Textus"]})]}),f.jsxs("div",{style:{marginBottom:"30px"},children:[f.jsxs("h3",{style:{color:"white",fontSize:"20px",marginBottom:"20px",fontWeight:"600"},children:["zh-TW"===n?"心聲日記":"zh-CN"===n?"心声日记":"en"===n?"Voice Diary":"ja"===n?"心の声日記":"ko"===n?"마음의 소리 일기":"th"===n?"ไดอารี่เสียงในใจ":"vi"===n?"Nhật Ký Tiếng Lòng":"ms"===n?"Diari Suara Hati":"Diarium Vocis"," (",k.length,")"]}),0===k.length?f.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:r.noDiaries}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:k.map(e=>{return f.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[f.jsx("button",{onClick:()=>(e=>{const t=k.map(t=>t.id===e?{...t,expanded:!t.expanded}:{...t,expanded:!1});w(t),ne(t)})(e.id),style:{background:"none",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600",color:"#333",textAlign:"left",flex:1},children:e.title}),f.jsx("button",{onClick:()=>(e=>{if($===e.id)return Q&&(Q.pause(),Q.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),G(null),void Y(null);if(Q&&(Q.pause(),Q.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),e.audioUrl){const t=new Audio(e.audioUrl);t.onended=()=>{G(null),Y(null)},t.onerror=t=>{G(null),Y(null),ie(e.content)},t.play().then(()=>{G(e.id),Y(t)}).catch(t=>{G(null),Y(null),ie(e.content)})}else G(e.id),ie(e.content)})(e),style:{background:$===e.id?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #4CAF50, #45a049)",border:"none",borderRadius:"50%",width:"36px",height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.2s"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"},children:f.jsx("span",{style:{fontSize:"16px",color:"white"},children:$===e.id?"⏹️":"▶️"})}),f.jsx("span",{style:{background:(n=e.emotion,{happy:"#4CAF50",sad:"#2196F3",angry:"#F44336",neutral:"#9E9E9E",excited:"#FF9800",calm:"#8BC34A"}[n]||"#9E9E9E"),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:r.emotion[e.emotion]})]}),e.expanded&&f.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(0,0,0,0.05)",borderRadius:"8px"},children:[f.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",marginBottom:"8px"},children:e.content}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"8px"},children:[f.jsx("p",{style:{color:"#999",fontSize:"12px"},children:(t=e.date,new Date(t).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))}),e.duration&&f.jsxs("span",{style:{color:"#667eea",fontSize:"12px",fontWeight:"500",background:"rgba(102, 126, 234, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:["⏱️ ",Math.floor(e.duration/60),":",(e.duration%60).toString().padStart(2,"0")]})]})]})]}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:[f.jsxs("button",{onClick:()=>(e=>{B(e),A({title:e.title,content:e.content,emotion:e.emotion})})(e),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["✏️ ",r.editDiary]}),f.jsxs("button",{onClick:()=>{return t=e.id,te(t),void Z(!0);var t},style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["🗑️ ",r.deleteDiary]})]})]})},e.id);var t,n})})]})]}),T&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[f.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.addDiary}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"zh-TW"===n?"標題":"zh-CN"===n?"标题":"en"===n?"Title":"ja"===n?"タイトル":"ko"===n?"제목":"th"===n?"หัวข้อ":"vi"===n?"Tiêu đề":"ms"===n?"Tajuk":"Titulus"}),f.jsx("input",{type:"text",value:R.title,onChange:e=>A(t=>({...t,title:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"zh-TW"===n?"輸入日記標題 (30字內)":"zh-CN"===n?"输入日记标题 (30字内)":"en"===n?"Enter diary title (30 chars max)":"ja"===n?"日記のタイトルを入力 (30文字以内)":"ko"===n?"일기 제목 입력 (30자 이내)":"th"===n?"ใส่หัวข้อไดอารี่ (ไม่เกิน 30 ตัวอักษร)":"vi"===n?"Nhập tiêu đề nhật ký (tối đa 30 ký tự)":"ms"===n?"Masukkan tajuk diari (maksimum 30 aksara)":"Intra titulum diarii (max 30 litterae)"})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"zh-TW"===n?"內容":"zh-CN"===n?"内容":"en"===n?"Content":"ja"===n?"内容":"ko"===n?"내용":"th"===n?"เนื้อหา":"vi"===n?"Nội dung":"ms"===n?"Kandungan":"Contentus"}),f.jsx("textarea",{value:R.content,onChange:e=>A(t=>({...t,content:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"zh-TW"===n?"輸入日記內容 (200字內)":"zh-CN"===n?"输入日记内容 (200字内)":"en"===n?"Enter diary content (200 chars max)":"ja"===n?"日記の内容を入力 (200文字以内)":"ko"===n?"일기 내용 입력 (200자 이내)":"th"===n?"ใส่เนื้อหาไดอารี่ (ไม่เกิน 200 ตัวอักษร)":"vi"===n?"Nhập nội dung nhật ký (tối đa 200 ký tự)":"ms"===n?"Masukkan kandungan diari (maksimum 200 aksara)":"Intra contentum diarii (max 200 litterae)"})]}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"zh-TW"===n?"情緒":"zh-CN"===n?"情绪":"en"===n?"Emotion":"ja"===n?"感情":"ko"===n?"감정":"th"===n?"อารมณ์":"vi"===n?"Cảm xúc":"ms"===n?"Emosi":"Affectus"}),f.jsxs("select",{value:R.emotion,onChange:e=>A(t=>({...t,emotion:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"happy",children:r.emotion.happy}),f.jsx("option",{value:"sad",children:r.emotion.sad}),f.jsx("option",{value:"angry",children:r.emotion.angry}),f.jsx("option",{value:"neutral",children:r.emotion.neutral}),f.jsx("option",{value:"excited",children:r.emotion.excited}),f.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[f.jsx("button",{onClick:()=>C(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),f.jsx("button",{onClick:()=>{if(R.title.trim()&&R.content.trim()){const e=[{id:Date.now(),title:R.title,content:R.content,date:(new Date).toISOString(),emotion:R.emotion,expanded:!1,duration:0},...k];w(e),ne(e),A({title:"",content:"",emotion:"neutral"}),C(!1)}},style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),I&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[f.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.editDiary}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"zh-TW"===n?"標題":"zh-CN"===n?"标题":"en"===n?"Title":"ja"===n?"タイトル":"ko"===n?"제목":"th"===n?"หัวข้อ":"vi"===n?"Tiêu đề":"ms"===n?"Tajuk":"Titulus"}),f.jsx("input",{type:"text",value:R.title,onChange:e=>A(t=>({...t,title:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"zh-TW"===n?"內容":"zh-CN"===n?"内容":"en"===n?"Content":"ja"===n?"内容":"ko"===n?"내용":"th"===n?"เนื้อหา":"vi"===n?"Nội dung":"ms"===n?"Kandungan":"Contentus"}),f.jsx("textarea",{value:R.content,onChange:e=>A(t=>({...t,content:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"zh-TW"===n?"情緒":"zh-CN"===n?"情绪":"en"===n?"Emotion":"ja"===n?"感情":"ko"===n?"감정":"th"===n?"อารมณ์":"vi"===n?"Cảm xúc":"ms"===n?"Emosi":"Affectus"}),f.jsxs("select",{value:R.emotion,onChange:e=>A(t=>({...t,emotion:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"happy",children:r.emotion.happy}),f.jsx("option",{value:"sad",children:r.emotion.sad}),f.jsx("option",{value:"angry",children:r.emotion.angry}),f.jsx("option",{value:"neutral",children:r.emotion.neutral}),f.jsx("option",{value:"excited",children:r.emotion.excited}),f.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[f.jsx("button",{onClick:()=>B(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),f.jsx("button",{onClick:()=>{if(I&&R.title.trim()&&R.content.trim()){const e=k.map(e=>e.id===I.id?{...e,title:R.title,content:R.content,emotion:R.emotion}:e);w(e),ne(e),B(null),A({title:"",content:"",emotion:"neutral"})}},style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),M&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),f.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),f.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音日記。",f.jsx("br",{}),f.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{L(!1)},style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),f.jsx("button",{onClick:async()=>{L(!1);try{const e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});b([]),v.current=[],z(0),t.ondataavailable=e=>{e.data.size>0&&(v.current.push(e.data),b(t=>[...t,e.data]))},t.onstop=()=>{const t=[...v.current],n=t.length>0?new Blob(t,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),i=Math.max(1,Math.floor(.1*t.length));P({blob:n,duration:i}),W(!0),b([]),v.current=[],e.getTracks().forEach(e=>e.stop())},t.start(100),x(t),m(!0),S(!0);const n=setInterval(()=>{z(e=>{const t=e+1;return t>=60&&(g&&"recording"===g.state&&g.stop(),n&&(clearInterval(n),_(null)),m(!1),S(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),t})},1e3);_(n)}catch(e){alert("無法啟動麥克風，請檢查權限設置")}},style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"開始錄音"})]})]})}),D&&N&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),f.jsx("h3",{style:{marginBottom:"10px",color:"#333",fontSize:"20px",fontWeight:"600"},children:r.recordingComplete}),f.jsx("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px"},children:r.submitToSave}),f.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:f.jsxs("div",{style:{color:"#495057",fontSize:"14px",fontWeight:"500"},children:["錄音時長: ",Math.floor(N.duration/60),":",(N.duration%60).toString().padStart(2,"0")]})}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{P(null),W(!1)},style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:r.cancel}),f.jsx("button",{onClick:()=>{N&&(((e,t)=>{const n=URL.createObjectURL(e),i=["今天心情很好，完成了所有工作。","遇到了一些挑戰，但都克服了。","學會了新的技能，感覺很有成就感。","和朋友聊天很開心，分享了很多想法。","反思今天的行為，發現還有改進空間。"],r=i[Math.floor(Math.random()*i.length)],a=["happy","neutral","calm"][Math.floor(3*Math.random())],o=[{id:Date.now(),title:"心聲日記",content:r,date:(new Date).toISOString(),emotion:a,expanded:!1,audioUrl:n,duration:t},...k];w(o),ne(o),S(!1)})(N.blob,N.duration),P(null),W(!1),q("aiChat",1))},style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:r.submit})]})]})}),X&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"20px",padding:"40px",width:"90%",maxWidth:"450px",textAlign:"center",boxShadow:"0 20px 40px rgba(0,0,0,0.3)",border:"2px solid rgba(255,255,255,0.2)"},children:[f.jsx("div",{style:{fontSize:"64px",marginBottom:"20px",animation:"pulse 2s infinite"},children:"💔"}),f.jsx("h3",{style:{marginBottom:"15px",color:"white",fontSize:"22px",fontWeight:"600",textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:"這個心聲對您來說很重要嗎？"}),f.jsx("p",{style:{marginBottom:"30px",color:"rgba(255,255,255,0.9)",fontSize:"16px",lineHeight:"1.5",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},children:"刪除後將無法恢復，請確認是否真的要刪除？"}),f.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{Z(!1),te(null)},style:{background:"rgba(255,255,255,0.2)",border:"2px solid rgba(255,255,255,0.3)",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease",backdropFilter:"blur(10px)"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255,255,255,0.3)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255,255,255,0.2)",e.currentTarget.style.transform="translateY(0)"},children:"取消"}),f.jsx("button",{onClick:()=>{if(ee){const e=k.filter(e=>e.id!==ee);w(e),ne(e),Z(!1),te(null)}},style:{background:"linear-gradient(45deg, #ff6b6b, #ee5a52)",border:"none",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 8px 20px rgba(255,107,107,0.4)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 12px 25px rgba(255,107,107,0.5)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 8px 20px rgba(255,107,107,0.4)"},children:"確定刪除"})]})]})})]}),U&&V&&f.jsx(yw,{isOpen:U,onClose:()=>{H(!1),K(null)},currentPlan:V.currentPlan,remainingDays:V.remainingDays,usedTokens:V.usedTokens,totalTokens:V.totalTokens})]})}const Mw=({isOpen:e,onClose:t,featureName:n})=>{const i=le(),r=window.innerWidth<=768;if(!e)return null;const a={basic:{price:"NT$ 149",tokens:"50K",features:["語音功能","AI 聊天","語音轉文字","文字轉語音","用戶互動: 100次/月"]}};return f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:f.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:r?16:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[!r&&f.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🚀"}),f.jsxs("h2",{style:{fontSize:r?18:24,fontWeight:700,color:"#333",marginBottom:r?6:12},children:["升級方案，解鎖 ",n]}),f.jsxs("p",{style:{fontSize:r?12:16,color:"#666",marginBottom:r?12:20,lineHeight:1.4},children:["您目前使用的是免費方案，",n," 需要升級才能使用。"]}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:r?12:16,marginBottom:r?16:24,border:"1px solid #e0e8ff"},children:[f.jsx("div",{style:{fontSize:r?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:r?6:8},children:"📊 方案對比"}),f.jsxs("div",{style:{fontSize:r?11:13,color:"#666",lineHeight:1.3},children:["• 免費方案：僅限文字功能",f.jsx("br",{}),"• 付費方案：解鎖語音、AI 聊天等進階功能",f.jsx("br",{}),"• 立即升級：享受完整功能體驗"]})]}),f.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:r?14:20,marginBottom:r?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[f.jsx("div",{style:{fontSize:r?14:16,color:"#6B5BFF",fontWeight:700,marginBottom:r?8:12},children:"💡 推薦方案"}),f.jsxs("div",{style:{fontSize:r?12:14,color:"#666",lineHeight:1.4,marginBottom:r?12:16},children:[f.jsx("strong",{children:"基礎版："}),"最受歡迎的入門方案",f.jsx("br",{}),"包含 ",a.basic.tokens," tokens，",a.basic.features.join("、")]}),f.jsx("div",{style:{fontSize:r?16:18,fontWeight:700,color:"#6B5BFF"},children:a.basic.price})]}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:r?12:16,marginBottom:r?16:24,border:"1px solid #ffeaa7"},children:[f.jsx("div",{style:{fontSize:r?12:14,color:"#856404",fontWeight:600,marginBottom:r?6:8},children:"✨ 升級好處"}),f.jsxs("div",{style:{fontSize:r?11:13,color:"#856404",lineHeight:1.3},children:["• 立即解鎖 ",n,f.jsx("br",{}),"• 享受完整的 AI 體驗",f.jsx("br",{}),"• 無限制使用語音功能",f.jsx("br",{}),"• 優先技術支援"]})]}),f.jsxs("div",{style:{display:"flex",gap:r?8:12,justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{t(),i("/plans")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:r?"12px 20px":"14px 28px",fontSize:r?14:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),f.jsx("button",{onClick:t,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:r?"12px 20px":"14px 28px",fontSize:r?14:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9ff",e.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),f.jsx("div",{style:{marginTop:16},children:f.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},Lw={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},Ow={"zh-TW":{title:"我的故事 My Story",subtitle:"記錄目標，回顧歷程，驗證成果——讓每一步都看得見。",backToHome:"← 返回首頁",logout:"登出",addMilestone:"添加里程碑",editMilestone:"編輯里程碑",deleteMilestone:"刪除里程碑",save:"保存",cancel:"取消",totalDays:"總天數",achievements:"成就",currentStreak:"連續",days:"天",myMilestones:"我的里程碑",noMilestones:"還沒有里程碑，開始記錄你的故事吧！",socialIntegration:"社會融入度評估",socialIntegrationTitle:"社會融入度評估",socialIntegrationDesc:"評估你在社會中的融入程度，包括人際關係、就業狀況、家庭關係等",socialIntegrationQuestions:{q1:"你覺得與他人的關係如何？",q2:"你對目前的工作/學習狀況滿意嗎？",q3:"你與家人的關係如何？",q4:"你對未來有信心嗎？",q5:"你覺得社會對你的接納程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"開始",achievement:"成就",growth:"成長",habit:"習慣",help:"幫助",goal:"目標",social:"社會融入"}},"zh-CN":{title:"我的故事 My Story",subtitle:"记录目标，回顾历程，验证成果——让每一步都看得见。",backToHome:"← 返回首页",logout:"登出",addMilestone:"添加里程碑",editMilestone:"编辑里程碑",deleteMilestone:"删除里程碑",save:"保存",cancel:"取消",totalDays:"总天数",achievements:"成就",currentStreak:"连续",days:"天",myMilestones:"我的里程碑",noMilestones:"还没有里程碑，开始记录你的故事吧！",socialIntegration:"社会融入度评估",socialIntegrationTitle:"社会融入度评估",socialIntegrationDesc:"评估你在社会中的融入程度，包括人际关系、就业状况、家庭关系等",socialIntegrationQuestions:{q1:"你觉得与他人的关系如何？",q2:"你对目前的工作/学习状况满意吗？",q3:"你与家人的关系如何？",q4:"你对未来有信心吗？",q5:"你觉得社会对你的接纳程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"开始",achievement:"成就",growth:"成长",habit:"习惯",help:"帮助",goal:"目标",social:"社会融入"}},en:{title:"My Story",subtitle:"Record goals, review progress, verify results—make every step visible.",backToHome:"← Back to Home",logout:"Logout",addMilestone:"Add Milestone",editMilestone:"Edit Milestone",deleteMilestone:"Delete Milestone",save:"Save",cancel:"Cancel",totalDays:"Total Days",achievements:"Achievements",currentStreak:"Current Streak",days:"days",myMilestones:"My Milestones",noMilestones:"No milestones yet, start recording your story!",socialIntegration:"Social Integration Assessment",socialIntegrationTitle:"Social Integration Assessment",socialIntegrationDesc:"Assess your level of social integration, including relationships, employment status, family relationships, etc.",socialIntegrationQuestions:{q1:"How do you feel about your relationships with others?",q2:"Are you satisfied with your current work/study situation?",q3:"How are your relationships with family?",q4:"Do you have confidence in the future?",q5:"How do you feel about society's acceptance of you?"},socialIntegrationOptions:{excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement"},milestoneTypes:{start:"Start",achievement:"Achievement",growth:"Growth",habit:"Habit",help:"Help",goal:"Goal",social:"Social Integration"}},ja:{title:"マイストーリー",subtitle:"目標を記録し、進歩を振り返り、結果を検証する——すべてのステップを見えるようにする。",backToHome:"← ホームに戻る",logout:"ログアウト",addMilestone:"マイルストーンを追加",editMilestone:"マイルストーンを編集",deleteMilestone:"マイルストーンを削除",save:"保存",cancel:"キャンセル",totalDays:"総日数",achievements:"達成",currentStreak:"連続",days:"日",myMilestones:"マイマイルストーン",noMilestones:"まだマイルストーンがありません。ストーリーを記録し始めましょう！",socialIntegration:"社会的統合度評価",socialIntegrationTitle:"社会的統合度評価",socialIntegrationDesc:"人間関係、就業状況、家族関係などを含む社会的統合度を評価する",socialIntegrationQuestions:{q1:"他者との関係をどう感じていますか？",q2:"現在の仕事/学習状況に満足していますか？",q3:"家族との関係はどうですか？",q4:"将来に自信がありますか？",q5:"社会からの受け入れられ方をどう感じていますか？"},socialIntegrationOptions:{excellent:"非常に良い",good:"良い",fair:"普通",poor:"改善が必要"},milestoneTypes:{start:"開始",achievement:"達成",growth:"成長",habit:"習慣",help:"支援",goal:"目標",social:"社会的統合"}},ko:{title:"내 이야기",subtitle:"목표를 기록하고, 진행 상황을 되돌아보고, 결과를 검증하세요—모든 단계를 보이게 만드세요.",backToHome:"← 홈으로",logout:"로그아웃",addMilestone:"마일스톤 추가",editMilestone:"마일스톤 편집",deleteMilestone:"마일스톤 삭제",save:"저장",cancel:"취소",totalDays:"총 일수",achievements:"성취",currentStreak:"연속",days:"일",myMilestones:"내 마일스톤",noMilestones:"아직 마일스톤이 없습니다. 이야기를 기록하기 시작하세요!",socialIntegration:"사회 통합도 평가",socialIntegrationTitle:"사회 통합도 평가",socialIntegrationDesc:"인간관계, 고용상태, 가족관계 등을 포함한 사회 통합도를 평가하세요",socialIntegrationQuestions:{q1:"다른 사람과의 관계를 어떻게 느끼나요?",q2:"현재의 일/학습 상황에 만족하나요?",q3:"가족과의 관계는 어떠한가요?",q4:"미래에 대한 자신감이 있나요?",q5:"사회로부터의 수용도를 어떻게 느끼나요?"},socialIntegrationOptions:{excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요"},milestoneTypes:{start:"시작",achievement:"성취",growth:"성장",habit:"습관",help:"도움",goal:"목표",social:"사회 통합"}},th:{title:"เรื่องราวของฉัน",subtitle:"บันทึกเป้าหมาย ตรวจสอบความคืบหน้า ตรวจสอบผลลัพธ์—ทำให้ทุกขั้นตอนมองเห็นได้",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",addMilestone:"เพิ่มจุดหมาย",editMilestone:"แก้ไขจุดหมาย",deleteMilestone:"ลบจุดหมาย",save:"บันทึก",cancel:"ยกเลิก",totalDays:"จำนวนวันทั้งหมด",achievements:"ความสำเร็จ",currentStreak:"ต่อเนื่อง",days:"วัน",myMilestones:"จุดหมายของฉัน",noMilestones:"ยังไม่มีจุดหมาย เริ่มบันทึกเรื่องราวของคุณเลย!",socialIntegration:"การประเมินการรวมตัวทางสังคม",socialIntegrationTitle:"การประเมินการรวมตัวทางสังคม",socialIntegrationDesc:"ประเมินระดับการรวมตัวทางสังคมของคุณ รวมถึงความสัมพันธ์ สถานะการจ้างงาน ความสัมพันธ์ในครอบครัว",socialIntegrationQuestions:{q1:"คุณรู้สึกอย่างไรกับความสัมพันธ์กับผู้อื่น?",q2:"คุณพอใจกับสถานการณ์การทำงาน/การเรียนปัจจุบันหรือไม่?",q3:"ความสัมพันธ์กับครอบครัวเป็นอย่างไร?",q4:"คุณมีความมั่นใจในอนาคตหรือไม่?",q5:"คุณรู้สึกอย่างไรกับการยอมรับจากสังคม?"},socialIntegrationOptions:{excellent:"ดีมาก",good:"ดี",fair:"ปานกลาง",poor:"ต้องปรับปรุง"},milestoneTypes:{start:"เริ่มต้น",achievement:"ความสำเร็จ",growth:"การเติบโต",habit:"นิสัย",help:"ความช่วยเหลือ",goal:"เป้าหมาย",social:"การรวมตัวทางสังคม"}},vi:{title:"Câu chuyện của tôi",subtitle:"Ghi lại mục tiêu, xem xét tiến độ, xác minh kết quả—làm cho mọi bước đều nhìn thấy được.",backToHome:"← Về trang chủ",logout:"Đăng xuất",addMilestone:"Thêm cột mốc",editMilestone:"Chỉnh sửa cột mốc",deleteMilestone:"Xóa cột mốc",save:"Lưu",cancel:"Hủy",totalDays:"Tổng số ngày",achievements:"Thành tựu",currentStreak:"Liên tiếp",days:"ngày",myMilestones:"Cột mốc của tôi",noMilestones:"Chưa có cột mốc nào, hãy bắt đầu ghi lại câu chuyện của bạn!",socialIntegration:"Đánh giá hòa nhập xã hội",socialIntegrationTitle:"Đánh giá hòa nhập xã hội",socialIntegrationDesc:"Đánh giá mức độ hòa nhập xã hội của bạn, bao gồm các mối quan hệ, tình trạng việc làm, mối quan hệ gia đình",socialIntegrationQuestions:{q1:"Bạn cảm thấy thế nào về mối quan hệ với người khác?",q2:"Bạn có hài lòng với tình hình công việc/học tập hiện tại không?",q3:"Mối quan hệ với gia đình như thế nào?",q4:"Bạn có tự tin về tương lai không?",q5:"Bạn cảm thấy thế nào về sự chấp nhận từ xã hội?"},socialIntegrationOptions:{excellent:"Rất tốt",good:"Tốt",fair:"Bình thường",poor:"Cần cải thiện"},milestoneTypes:{start:"Bắt đầu",achievement:"Thành tựu",growth:"Phát triển",habit:"Thói quen",help:"Hỗ trợ",goal:"Mục tiêu",social:"Hòa nhập xã hội"}},ms:{title:"Cerita Saya",subtitle:"Rakam matlamat, semak semula kemajuan, sahkan hasil—jadikan setiap langkah kelihatan.",backToHome:"← Kembali ke Laman Utama",logout:"Log keluar",addMilestone:"Tambah Pencapaian",editMilestone:"Edit Pencapaian",deleteMilestone:"Padam Pencapaian",save:"Simpan",cancel:"Batal",totalDays:"Jumlah Hari",achievements:"Pencapaian",currentStreak:"Berturut-turut",days:"hari",myMilestones:"Pencapaian Saya",noMilestones:"Belum ada pencapaian, mulakan rakam cerita anda!",socialIntegration:"Penilaian Integrasi Sosial",socialIntegrationTitle:"Penilaian Integrasi Sosial",socialIntegrationDesc:"Nilai tahap integrasi sosial anda, termasuk hubungan, status pekerjaan, hubungan keluarga",socialIntegrationQuestions:{q1:"Bagaimana perasaan anda tentang hubungan dengan orang lain?",q2:"Adakah anda berpuas hati dengan situasi kerja/pembelajaran semasa?",q3:"Bagaimana hubungan anda dengan keluarga?",q4:"Adakah anda yakin dengan masa hadapan?",q5:"Bagaimana perasaan anda tentang penerimaan masyarakat?"},socialIntegrationOptions:{excellent:"Sangat Baik",good:"Baik",fair:"Sederhana",poor:"Perlu Penambahbaikan"},milestoneTypes:{start:"Mula",achievement:"Pencapaian",growth:"Pertumbuhan",habit:"Tabiat",help:"Bantuan",goal:"Matlamat",social:"Integrasi Sosial"}},la:{title:"Fabula Mea",subtitle:"Proposita inscribe, progressum recense, eventa verifica—gradum quemque visibilem fac.",backToHome:"← Redi ad domum",logout:"Exire",addMilestone:"Addere Lapidem Milliarium",editMilestone:"Lapidem Milliarium Edere",deleteMilestone:"Lapidem Milliarium Delere",save:"Servare",cancel:"Cancellare",totalDays:"Dies Totales",achievements:"Res Gestae",currentStreak:"Series",days:"dies",myMilestones:"Lapides Milliarii Mei",noMilestones:"Nondum lapides milliarii, incipe fabulam tuam inscribere!",socialIntegration:"Aestimatio Integrationis Socialis",socialIntegrationTitle:"Aestimatio Integrationis Socialis",socialIntegrationDesc:"Aestima gradum integrationis socialis tuae, includens relationes, statum operis, relationes familiae",socialIntegrationQuestions:{q1:"Quomodo sentis de relationibus cum aliis?",q2:"Esne contentus cum statu operis/studii praesenti?",q3:"Quomodo sunt relationes tuae cum familia?",q4:"Habesne fiduciam in futuro?",q5:"Quomodo sentis de acceptatione societatis?"},socialIntegrationOptions:{excellent:"Optime",good:"Bene",fair:"Mediocriter",poor:"Emendatione Opus"},milestoneTypes:{start:"Initiare",achievement:"Res Gesta",growth:"Incrementum",habit:"Consuetudo",help:"Auxilium",goal:"Propositum",social:"Integratio Socialis"}}};function qw(){var t,n,i;const r=le(),{lang:a,setLang:o}=mw(),s=Ow[a]||Ow["zh-TW"],[l,c]=e.useState(()=>{const e=localStorage.getItem("userMilestones");return e?JSON.parse(e):[{id:1,title:"開始新的旅程",description:"決定重新開始，為自己設定新的目標",date:new Date(Date.now()-2592e6).toISOString(),type:"start",completed:!0},{id:2,title:"完成第一個小目標",description:"成功完成了一項小任務，感覺很棒",date:new Date(Date.now()-216e7).toISOString(),type:"achievement",completed:!0},{id:3,title:"學會控制情緒",description:"在困難時刻保持冷靜，學會了情緒管理",date:new Date(Date.now()-1728e6).toISOString(),type:"growth",completed:!0},{id:4,title:"建立新的習慣",description:"每天堅持做一些小事情，建立正向習慣",date:new Date(Date.now()-1296e6).toISOString(),type:"habit",completed:!0},{id:5,title:"幫助他人",description:"第一次主動幫助別人，感受到付出的快樂",date:new Date(Date.now()-864e6).toISOString(),type:"help",completed:!0},{id:6,title:"設定更大的目標",description:"為自己設定更具挑戰性的目標",date:new Date(Date.now()+432e6).toISOString(),type:"goal",completed:!1}]}),[d]=e.useState({name:"我的故事",startDate:new Date(Date.now()-2592e6),totalDays:30,achievements:5,currentStreak:7}),[u,h]=e.useState(!1),[p,m]=e.useState(!1),[g,x]=e.useState(!1),y=e.useRef(null),[b,v]=e.useState(!1),[k,w]=e.useState(null),[j,S]=e.useState(null),[T,C]=e.useState({title:"",description:"",type:"achievement"});e.useEffect(()=>{if(!g)return;const e=e=>{y.current&&!y.current.contains(e.target)&&x(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[g]);const[I,B]=e.useState(!1),[R,A]=e.useState(!1),[F,z]=e.useState(0),[E,_]=e.useState(null),[N,P]=e.useState(!1),[D,W]=e.useState(!1),[M,L]=e.useState(null),[O,q]=e.useState(null),[U,H]=e.useState("/avatars/Derxl.png"),[V,K]=e.useState([]),$=e.useRef([]),{checkPermission:G,recordUsage:Q}=Rw(),[Y,J]=e.useState(!1),[X,Z]=e.useState(!1),[ee,te]=e.useState(null);e.useEffect(()=>{(async()=>{try{const e=Fv().currentUser;if(e){const t=hg(vg(),"profiles",e.uid),n=await Pf(t);if(n.exists()){const e=n.data();e.avatar&&H(e.avatar)}}}catch(e){}})()},[]);const ne=e=>{localStorage.setItem("userMilestones",JSON.stringify(e))},[ie,re]=e.useState({q1:"",q2:"",q3:"",q4:"",q5:""}),ae=(e,t)=>{const n=URL.createObjectURL(e),i=["今天完成了一個重要目標，感覺很有成就感。","學會了新的技能，為自己的成長感到驕傲。","克服了困難，證明了自己的能力。","幫助了別人，感受到付出的快樂。","建立了新的習慣，為未來打下基礎。"],r=i[Math.floor(Math.random()*i.length)],a=["achievement","growth","habit","help","goal"][Math.floor(5*Math.random())],o=[{id:Date.now(),title:"語音里程碑",description:r,date:(new Date).toISOString(),type:a,completed:!0,audioUrl:n,duration:t},...l];c(o),ne(o)},oe=e=>({start:"#2196F3",achievement:"#4CAF50",growth:"#9C27B0",habit:"#FF9800",help:"#E91E63",goal:"#F44336",social:"#6B5BFF"}[e]||"#9E9E9E"),se=e=>{if("speechSynthesis"in window){const t=new SpeechSynthesisUtterance(e);t.lang="zh-TW",t.rate=.9,t.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(t)}else alert("瀏覽器不支援語音播放功能")},ce=l.filter(e=>e.completed).length;return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",padding:window.innerWidth<=768?"0":"20px"},children:[window.innerWidth<=768?f.jsx(zw,{}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>r("/")})}),f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>r("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},children:"zh-TW"===a?"🧬 Restarter™｜我們是誰":"zh-CN"===a?"🧬 Restarter™｜我们是谁":"en"===a?"🧬 Restarter™｜Who We Are":"ja"===a?"🧬 Restarter™｜私たちについて":"ko"===a?"🧬 Restarter™｜우리는 누구인가":"th"===a?"🧬 Restarter™｜เราเป็นใคร":"vi"===a?"🧬 Restarter™｜Chúng tôi là ai":"ms"===a?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>r("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},children:"zh-TW"===a?"💬 意見箱｜我們想聽你說":"zh-CN"===a?"💬 意见箱｜我们想听你说":"en"===a?"💬 Feedback｜We Want to Hear You":"ja"===a?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===a?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===a?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===a?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===a?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:(null==(t=Fv().currentUser)?void 0:t.photoURL)||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),f.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:(null==(n=Fv().currentUser)?void 0:n.displayName)||(null==(i=Fv().currentUser)?void 0:i.email)||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{const e=Fv();await e.signOut(),r("/")},style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px",borderRadius:4,fontWeight:600,border:"1px solid #ff6347",color:"#ff6347",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},children:Lw[a]})]})]}),f.jsx(fw,{style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px"}}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:y,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>x(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),g&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===a||"zh-CN"===a?"法律文件":"en"===a?"Legal Documents":"ja"===a?"法的文書":"ko"===a?"법적 문서":"th"===a?"เอกสารทางกฎหมาย":"vi"===a?"Tài liệu pháp lý":"ms"===a?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:"隱私政策",path:"/privacy-policy"},{key:"terms",title:"使用條款",path:"/terms"},{key:"data",title:"資料刪除",path:"/data-deletion"},{key:"ai",title:"AI使用聲明",path:"/ai-statement"},{key:"mental",title:"心理健康免責聲明",path:"/mental-health-disclaimer"},{key:"cookie",title:"Cookie政策",path:"/cookie-policy"},{key:"children",title:"兒童隱私保護",path:"/children-privacy"},{key:"international",title:"國際用戶聲明",path:"/international-users"},{key:"security",title:"安全聲明",path:"/security-statement"},{key:"update",title:"更新通知機制",path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{r(e.path),x(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title},e.key))]})]})]}),f.jsxs("div",{style:{marginTop:"100px",marginBottom:"30px",textAlign:"center"},children:[f.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0,marginBottom:"8px"},children:s.myMilestones}),f.jsx("p",{style:{color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:400,margin:0,textAlign:"center",lineHeight:1.4},children:s.subtitle})]})]}),f.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",marginTop:window.innerWidth<=768?"100px":"0",padding:window.innerWidth<=768?"20px":"0"},children:[f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"24px",marginBottom:"24px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[f.jsxs("div",{style:{width:"70px",height:"70px",borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 12px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",overflow:"hidden"},children:[f.jsx("img",{src:U,alt:"用戶頭像",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"},onError:e=>{const t=e.currentTarget;t.style.display="none";const n=t.nextElementSibling;n&&(n.style.display="flex")}}),f.jsx("span",{style:{fontSize:"35px",color:"#4CAF50",display:"none",position:"absolute"},children:"👤"})]}),f.jsx("h2",{style:{color:"#333",fontSize:"22px",fontWeight:"bold",marginBottom:"6px"},children:"zh-TW"===a||"zh-CN"===a?"里程碑":"en"===a?"Milestone":"ja"===a?"マイルストーン":"ko"===a?"마일스톤":"th"===a?"จุดหมาย":"vi"===a?"Cột mốc":"ms"===a?"Pencapaian":"Lapis Milliarius"}),f.jsxs("p",{style:{color:"#666",fontSize:"13px",marginBottom:"20px"},children:["開始於 ",d.startDate.toLocaleDateString("zh-TW")]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#4CAF50",marginBottom:"3px"},children:d.totalDays}),f.jsx("div",{style:{fontSize:"11px",color:"#666"},children:s.totalDays})]}),f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#FF9800",marginBottom:"3px"},children:ce}),f.jsx("div",{style:{fontSize:"11px",color:"#666"},children:s.achievements})]}),f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#2196F3",marginBottom:"3px"},children:d.currentStreak}),f.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:[s.currentStreak," ",s.days]})]})]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginBottom:"24px",flexWrap:"wrap"},children:[f.jsxs("button",{onClick:()=>h(!0),style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)"},children:[f.jsx("span",{style:{fontSize:"18px"},children:"+"}),s.addMilestone]}),f.jsxs("button",{onClick:async()=>{if(R)return M&&"recording"===M.state&&M.stop(),O&&(clearInterval(O),q(null)),A(!1),B(!1),void z(0);const e=await G("aiChat");e.allowed?W(!0):e.isFreeUser?Z(!0):(e.canRenew,te(e),J(!0))},style:{background:I?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:I?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:I?"pulse 1.5s infinite":"none"},onMouseOver:e=>{I||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:e=>{I||(e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[f.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),I?`${"zh-TW"===a?"錄音中":"zh-CN"===a?"录音中":"en"===a?"Recording":"ja"===a?"録音中":"ko"===a?"녹음 중":"th"===a?"กำลังบันทึก":"vi"===a?"Đang ghi âm":"ms"===a?"Sedang Merakam":"Recording"} ${Math.floor(F/60)}:${(F%60).toString().padStart(2,"0")}`:"zh-TW"===a?"語音輸入":"zh-CN"===a?"语音输入":"en"===a?"Voice Input":"ja"===a?"音声入力":"ko"===a?"음성 입력":"th"===a?"ป้อนเสียง":"vi"===a?"Nhập giọng nói":"ms"===a?"Input Suara":"Input Vox"]})]}),f.jsx("div",{style:{marginBottom:"30px"},children:0===l.length?f.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:s.noMilestones}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:l.map((e,t)=>{return f.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",position:"relative"},children:f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:"40px"},children:[f.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:e.completed?oe(e.type):"#ddd",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:e.completed&&f.jsx("span",{style:{color:"white",fontSize:"12px"},children:"✓"})}),t<l.length-1&&f.jsx("div",{style:{width:"2px",height:"40px",background:"#ddd"}})]}),f.jsxs("div",{style:{flex:1},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[f.jsx("span",{style:{background:oe(e.type),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:s.milestoneTypes[e.type]}),f.jsx("span",{style:{color:"#999",fontSize:"12px"},children:(n=e.date,new Date(n).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}))})]}),f.jsxs("div",{style:{display:"flex",gap:"8px"},children:["語音里程碑"!==e.title&&f.jsx("button",{onClick:()=>(e=>{S(e),C({title:e.title,description:e.description,type:e.type})})(e),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"✏️"}),f.jsx("button",{onClick:()=>(e=>{if(window.confirm("🌟 親愛的朋友，您真的要刪除這個里程碑嗎？\n\n💫 每個里程碑都記錄著您成長的足跡，刪除後就無法找回囉～\n\n✨ 如果您確定要刪除，我們會溫柔地幫您處理。")){const t=l.filter(t=>t.id!==e);c(t),ne(t)}})(e.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"🗑️"})]})]}),f.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:e.completed?"#333":"#666"},children:e.title}),f.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",margin:0,marginBottom:"8px"},children:e.description}),e.audioUrl&&f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px"},children:[f.jsxs("button",{onClick:()=>(e=>{if(e.audioUrl){const t=new Audio(e.audioUrl);t.onerror=t=>{se(e.description)},t.play().then(()=>{}).catch(t=>{se(e.description)})}else se(e.description)})(e),style:{background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",border:"none",borderRadius:"8px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[f.jsx("span",{style:{fontSize:"14px"},children:"▶️"}),"播放原音"]}),e.duration&&f.jsxs("span",{style:{color:"#666",fontSize:"12px",background:"#f5f5f5",padding:"4px 8px",borderRadius:"6px"},children:["錄音時長: ",Math.floor(e.duration/60),":",(e.duration%60).toString().padStart(2,"0")]})]})]})]})},e.id);var n})})})]}),u&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[f.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:s.addMilestone}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),f.jsx("input",{type:"text",value:T.title,onChange:e=>C(t=>({...t,title:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入里程碑標題"})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),f.jsx("textarea",{value:T.description,onChange:e=>C(t=>({...t,description:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入里程碑描述"})]}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),f.jsxs("select",{value:T.type,onChange:e=>C(t=>({...t,type:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"start",children:s.milestoneTypes.start}),f.jsx("option",{value:"achievement",children:s.milestoneTypes.achievement}),f.jsx("option",{value:"growth",children:s.milestoneTypes.growth}),f.jsx("option",{value:"habit",children:s.milestoneTypes.habit}),f.jsx("option",{value:"help",children:s.milestoneTypes.help}),f.jsx("option",{value:"goal",children:s.milestoneTypes.goal}),f.jsx("option",{value:"social",children:s.milestoneTypes.social})]})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[f.jsx("button",{onClick:()=>h(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:s.cancel}),f.jsx("button",{onClick:()=>{if(T.title.trim()&&T.description.trim()){const e=[{id:Date.now(),title:T.title,description:T.description,date:(new Date).toISOString(),type:T.type,completed:!1},...l];c(e),ne(e),C({title:"",description:"",type:"achievement"}),h(!1)}},style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:s.save})]})]})}),N&&E&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[f.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:"語音里程碑"}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsxs("p",{style:{color:"#666",marginBottom:"10px"},children:["錄音時長: ",Math.floor(E.duration/60),":",(E.duration%60).toString().padStart(2,"0")]}),f.jsx("audio",{controls:!0,style:{width:"100%",marginBottom:"20px"},src:URL.createObjectURL(E.blob)})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{_(null),P(!1)},style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"}),f.jsx("button",{onClick:()=>{E&&(ae(E.blob,E.duration),_(null),P(!1),Q("aiChat",1))},style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"送出"})]})]})}),D&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),f.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),f.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音里程碑。",f.jsx("br",{}),f.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{W(!1)},style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),f.jsx("button",{onClick:async()=>{W(!1);try{const e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"});K([]),$.current=[],z(0),t.ondataavailable=e=>{e.data.size>0&&($.current.push(e.data),K(t=>[...t,e.data]))},t.onstop=()=>{const t=[...$.current],n=t.length>0?new Blob(t,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),i=Math.max(1,Math.floor(.1*t.length));_({blob:n,duration:i}),P(!0),K([]),$.current=[],e.getTracks().forEach(e=>e.stop())},t.start(100),L(t),A(!0),B(!0);const n=setInterval(()=>{z(e=>{const t=e+1;return t>=60&&(M&&"recording"===M.state&&M.stop(),n&&(clearInterval(n),q(null)),A(!1),B(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),t})},1e3);q(n)}catch(e){alert("無法啟動麥克風，請檢查權限設置")}},style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)"},children:"開始錄音"})]})]})}),j&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[f.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:s.editMilestone}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),f.jsx("input",{type:"text",value:T.title,onChange:e=>C(t=>({...t,title:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),f.jsxs("div",{style:{marginBottom:"16px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),f.jsx("textarea",{value:T.description,onChange:e=>C(t=>({...t,description:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),f.jsxs("select",{value:T.type,onChange:e=>C(t=>({...t,type:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"start",children:s.milestoneTypes.start}),f.jsx("option",{value:"achievement",children:s.milestoneTypes.achievement}),f.jsx("option",{value:"growth",children:s.milestoneTypes.growth}),f.jsx("option",{value:"habit",children:s.milestoneTypes.habit}),f.jsx("option",{value:"help",children:s.milestoneTypes.help}),f.jsx("option",{value:"goal",children:s.milestoneTypes.goal}),f.jsx("option",{value:"social",children:s.milestoneTypes.social})]})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[f.jsx("button",{onClick:()=>S(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:s.cancel}),f.jsx("button",{onClick:()=>{if(j&&T.title.trim()&&T.description.trim()){const e=l.map(e=>e.id===j.id?{...e,title:T.title,description:T.description,type:T.type}:e);c(e),ne(e),S(null),C({title:"",description:"",type:"achievement"})}},style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:s.save})]})]})}),Y&&ee&&f.jsx(yw,{isOpen:Y,onClose:()=>{J(!1),te(null)},currentPlan:ee.currentPlan,remainingDays:ee.remainingDays,usedTokens:ee.usedTokens,totalTokens:ee.totalTokens}),X&&f.jsx(Mw,{isOpen:X,onClose:()=>Z(!1),featureName:"語音錄製功能"}),p&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[f.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:s.socialIntegrationTitle}),f.jsx("p",{style:{marginBottom:"24px",color:"#666",textAlign:"center",lineHeight:"1.5"},children:s.socialIntegrationDesc}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[f.jsxs("div",{children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:s.socialIntegrationQuestions.q1}),f.jsxs("select",{value:ie.q1,onChange:e=>re(t=>({...t,q1:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"",children:"請選擇..."}),f.jsx("option",{value:"excellent",children:s.socialIntegrationOptions.excellent}),f.jsx("option",{value:"good",children:s.socialIntegrationOptions.good}),f.jsx("option",{value:"fair",children:s.socialIntegrationOptions.fair}),f.jsx("option",{value:"poor",children:s.socialIntegrationOptions.poor})]})]}),f.jsxs("div",{children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:s.socialIntegrationQuestions.q2}),f.jsxs("select",{value:ie.q2,onChange:e=>re(t=>({...t,q2:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"",children:"請選擇..."}),f.jsx("option",{value:"excellent",children:s.socialIntegrationOptions.excellent}),f.jsx("option",{value:"good",children:s.socialIntegrationOptions.good}),f.jsx("option",{value:"fair",children:s.socialIntegrationOptions.fair}),f.jsx("option",{value:"poor",children:s.socialIntegrationOptions.poor})]})]}),f.jsxs("div",{children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:s.socialIntegrationQuestions.q3}),f.jsxs("select",{value:ie.q3,onChange:e=>re(t=>({...t,q3:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"",children:"請選擇..."}),f.jsx("option",{value:"excellent",children:s.socialIntegrationOptions.excellent}),f.jsx("option",{value:"good",children:s.socialIntegrationOptions.good}),f.jsx("option",{value:"fair",children:s.socialIntegrationOptions.fair}),f.jsx("option",{value:"poor",children:s.socialIntegrationOptions.poor})]})]}),f.jsxs("div",{children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:s.socialIntegrationQuestions.q4}),f.jsxs("select",{value:ie.q4,onChange:e=>re(t=>({...t,q4:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"",children:"請選擇..."}),f.jsx("option",{value:"excellent",children:s.socialIntegrationOptions.excellent}),f.jsx("option",{value:"good",children:s.socialIntegrationOptions.good}),f.jsx("option",{value:"fair",children:s.socialIntegrationOptions.fair}),f.jsx("option",{value:"poor",children:s.socialIntegrationOptions.poor})]})]}),f.jsxs("div",{children:[f.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:s.socialIntegrationQuestions.q5}),f.jsxs("select",{value:ie.q5,onChange:e=>re(t=>({...t,q5:e.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[f.jsx("option",{value:"",children:"請選擇..."}),f.jsx("option",{value:"excellent",children:s.socialIntegrationOptions.excellent}),f.jsx("option",{value:"good",children:s.socialIntegrationOptions.good}),f.jsx("option",{value:"fair",children:s.socialIntegrationOptions.fair}),f.jsx("option",{value:"poor",children:s.socialIntegrationOptions.poor})]})]})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"24px"},children:[f.jsx("button",{onClick:()=>m(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:s.cancel}),f.jsx("button",{onClick:()=>{if(!Object.values(ie).every(e=>""!==e))return void alert("請回答所有問題");const e=(e=>{const t={excellent:5,good:4,fair:3,poor:2},n=[t[e.q1]||3,t[e.q2]||3,t[e.q3]||3,t[e.q4]||3,t[e.q5]||3].reduce((e,t)=>e+t,0)/5;return n>=4.5?{score:n,result:"優秀",description:"你的社會融入度非常高，在人際關係、就業狀況、家庭關係等方面都表現出色。",recommendations:["繼續保持現有的良好狀態","可以考慮擔任志工幫助其他更生人","分享你的成功經驗給其他需要幫助的人","參與社區活動擴大影響力"],analysis:"基於你的評估結果，你在各個方面都表現優秀，顯示出良好的社會適應能力和積極的生活態度。建議繼續保持這種狀態，並可以考慮幫助其他需要支持的人。"}:n>=3.5?{score:n,result:"良好",description:"你的社會融入度良好，在大部分方面都有不錯的表現，還有提升空間。",recommendations:["參加更多社交活動擴大交友圈","尋求職業技能培訓提升就業競爭力","與家人多溝通改善家庭關係","制定具體的個人發展計劃"],analysis:"你的社會融入度處於良好水平，顯示出積極的改善趨勢。建議在現有基礎上進一步提升，特別是在就業技能和人際關係方面。"}:n>=2.5?{score:n,result:"一般",description:"你的社會融入度一般，在某些方面需要改善，建議尋求更多支持。",recommendations:["建議尋求專業輔導師協助","參加更生人互助團體","制定具體的改善計劃","逐步建立支持網絡"],analysis:"你的社會融入度處於一般水平，這表明在某些方面還需要改善。建議尋求專業支持，制定具體的改善計劃，並逐步建立支持網絡。"}:{score:n,result:"需要改善",description:"你的社會融入度需要改善，建議尋求專業輔導和支持。",recommendations:["立即聯繫專業輔導師","參加更生人支持計劃","尋求心理諮商服務","建立穩定的生活規律"],analysis:"你的社會融入度需要改善，建議立即尋求專業輔導和支持。這不是失敗，而是需要更多幫助的表現。專業輔導師可以幫助你制定適合的改善計劃。"}})(ie),t={score:e.score,result:e.result,description:e.description,recommendations:e.recommendations,analysis:e.analysis,details:{relationships:ie.q1,employment:ie.q2,family:ie.q3,confidence:ie.q4,acceptance:ie.q5}},n=[{id:Date.now(),title:`${s.socialIntegrationTitle} - ${e.result}`,description:`${e.description} 評估分數: ${e.score.toFixed(1)}/5.0\n\n分析：\n${e.analysis}\n\n建議：\n${e.recommendations.map(e=>`• ${e}`).join("\n")}`,date:(new Date).toISOString(),type:"social",completed:!0},...l];c(n),ne(n),re({q1:"",q2:"",q3:"",q4:"",q5:""}),m(!1),v(!0),w(t)},disabled:!Object.values(ie).every(e=>""!==e),style:{background:Object.values(ie).every(e=>""!==e)?"linear-gradient(45deg, #6B5BFF, #5A4FCF)":"#ccc",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:Object.values(ie).every(e=>""!==e)?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600"},children:"提交評估"})]})]})}),b&&k&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[f.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:"📊 社會融入度評估報告"}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",borderRadius:"12px",padding:"20px",color:"white",marginBottom:"20px",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:k.result}),f.jsxs("div",{style:{fontSize:"18px",marginBottom:"8px"},children:["總分：",k.score.toFixed(1),"/5.0"]}),f.jsx("div",{style:{fontSize:"14px",opacity:.9},children:k.description})]}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"📋 詳細分析"}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[f.jsx("span",{style:{color:"#666"},children:"人際關係"}),f.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:"excellent"===k.details.relationships?"優秀":"good"===k.details.relationships?"良好":"fair"===k.details.relationships?"一般":"需要改善"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[f.jsx("span",{style:{color:"#666"},children:"就業狀況"}),f.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:"excellent"===k.details.employment?"優秀":"good"===k.details.employment?"良好":"fair"===k.details.employment?"一般":"需要改善"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[f.jsx("span",{style:{color:"#666"},children:"家庭關係"}),f.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:"excellent"===k.details.family?"優秀":"good"===k.details.family?"良好":"fair"===k.details.family?"一般":"需要改善"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[f.jsx("span",{style:{color:"#666"},children:"未來信心"}),f.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:"excellent"===k.details.confidence?"優秀":"good"===k.details.confidence?"良好":"fair"===k.details.confidence?"一般":"需要改善"})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[f.jsx("span",{style:{color:"#666"},children:"社會接納"}),f.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:"excellent"===k.details.acceptance?"優秀":"good"===k.details.acceptance?"良好":"fair"===k.details.acceptance?"一般":"需要改善"})]})]})]}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"💡 改善建議"}),f.jsx("div",{style:{background:"#f8f9fa",borderRadius:"8px",padding:"16px"},children:k.recommendations.map((e,t)=>f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px",lineHeight:"1.4"},children:[f.jsx("span",{style:{color:"#6B5BFF",fontWeight:"bold"},children:"•"}),f.jsx("span",{style:{color:"#333"},children:e})]},t))})]}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #FF9800 0%, #F57C00 100%)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[f.jsx("h4",{style:{color:"white",marginBottom:"8px",fontWeight:"600"},children:"🎯 專業輔導建議"}),f.jsx("p",{style:{color:"white",fontSize:"14px",lineHeight:"1.4",margin:0},children:"基於您的評估結果，我們建議您考慮尋求專業輔導師的協助。專業輔導師可以為您提供個性化的改善計劃和持續的支持。"})]}),f.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>v(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:"關閉報告"}),f.jsx("button",{onClick:()=>{v(!1),alert("功能開發中：聯繫專業輔導師")},style:{background:"linear-gradient(45deg, #6B5BFF, #5A4FCF)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"聯繫輔導師"})]})]})})]})}const Uw={male:"/avatars/male.png",female:"/avatars/female.png"};function Hw({avatar:t,videoUrl:n,audioUrl:i,isSpeaking:r,onAvatarChange:a,size:o=160}){const s=e.useRef(null),[l,c]=e.useState(!1);return f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[f.jsxs("div",{style:{position:"relative",width:o,height:o,marginBottom:8},children:[n?f.jsx("video",{src:n,width:o,height:o,autoPlay:!0,muted:!0,loop:!0,style:{borderRadius:"50%",objectFit:"cover"}}):f.jsx("img",{src:"male"===t||"female"===t?Uw[t]:t,width:o,height:o,style:{borderRadius:"50%",objectFit:"cover",filter:r?"brightness(1.1)":"none"},alt:"avatar"}),a&&("male"===t||"female"===t)&&f.jsx("button",{onClick:()=>a("male"===t?"female":"male"),style:{position:"absolute",right:8,bottom:8,background:"#fff",borderRadius:"50%",border:"none",width:36,height:36,cursor:"pointer",fontSize:18},children:"切換"})]}),i&&f.jsx("audio",{ref:s,src:i,onEnded:()=>c(!1)}),i&&f.jsx("button",{onClick:()=>{s.current&&(s.current.currentTime=0,s.current.play(),c(!0))},style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:l,children:l?"播放中...":"播放語音"})]})}function Vw(e,t){return function(){return e.apply(t,arguments)}}const{toString:Kw}=Object.prototype,{getPrototypeOf:$w}=Object,{iterator:Gw,toStringTag:Qw}=Symbol,Yw=(e=>t=>{const n=Kw.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Jw=e=>(e=e.toLowerCase(),t=>Yw(t)===e),Xw=e=>t=>typeof t===e,{isArray:Zw}=Array,ej=Xw("undefined");function tj(e){return null!==e&&!ej(e)&&null!==e.constructor&&!ej(e.constructor)&&rj(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const nj=Jw("ArrayBuffer");const ij=Xw("string"),rj=Xw("function"),aj=Xw("number"),oj=e=>null!==e&&"object"==typeof e,sj=e=>{if("object"!==Yw(e))return!1;const t=$w(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Qw in e||Gw in e)},lj=Jw("Date"),cj=Jw("File"),dj=Jw("Blob"),uj=Jw("FileList"),hj=Jw("URLSearchParams"),[pj,mj,gj,fj]=["ReadableStream","Request","Response","Headers"].map(Jw);function xj(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let i,r;if("object"!=typeof e&&(e=[e]),Zw(e))for(i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else{if(tj(e))return;const r=n?Object.getOwnPropertyNames(e):Object.keys(e),a=r.length;let o;for(i=0;i<a;i++)o=r[i],t.call(null,e[o],o,e)}}function yj(e,t){if(tj(e))return null;t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const bj="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,vj=e=>!ej(e)&&e!==bj;const kj=(e=>t=>e&&t instanceof e)("undefined"!=typeof Uint8Array&&$w(Uint8Array)),wj=Jw("HTMLFormElement"),jj=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Sj=Jw("RegExp"),Tj=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};xj(n,(n,r)=>{let a;!1!==(a=t(n,r,e))&&(i[r]=a||n)}),Object.defineProperties(e,i)};const Cj=Jw("AsyncFunction"),Ij=(Bj="function"==typeof setImmediate,Rj=rj(bj.postMessage),Bj?setImmediate:Rj?(Aj=`axios@${Math.random()}`,Fj=[],bj.addEventListener("message",({source:e,data:t})=>{e===bj&&t===Aj&&Fj.length&&Fj.shift()()},!1),e=>{Fj.push(e),bj.postMessage(Aj,"*")}):e=>setTimeout(e));var Bj,Rj,Aj,Fj;const zj="undefined"!=typeof queueMicrotask?queueMicrotask.bind(bj):"undefined"!=typeof process&&process.nextTick||Ij,Ej={isArray:Zw,isArrayBuffer:nj,isBuffer:tj,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||rj(e.append)&&("formdata"===(t=Yw(e))||"object"===t&&rj(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&nj(e.buffer),t},isString:ij,isNumber:aj,isBoolean:e=>!0===e||!1===e,isObject:oj,isPlainObject:sj,isEmptyObject:e=>{if(!oj(e)||tj(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(RB){return!1}},isReadableStream:pj,isRequest:mj,isResponse:gj,isHeaders:fj,isUndefined:ej,isDate:lj,isFile:cj,isBlob:dj,isRegExp:Sj,isFunction:rj,isStream:e=>oj(e)&&rj(e.pipe),isURLSearchParams:hj,isTypedArray:kj,isFileList:uj,forEach:xj,merge:function e(){const{caseless:t}=vj(this)&&this||{},n={},i=(i,r)=>{const a=t&&yj(n,r)||r;sj(n[a])&&sj(i)?n[a]=e(n[a],i):sj(i)?n[a]=e({},i):Zw(i)?n[a]=i.slice():n[a]=i};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&xj(arguments[r],i);return n},extend:(e,t,n,{allOwnKeys:i}={})=>(xj(t,(t,i)=>{n&&rj(t)?e[i]=Vw(t,n):e[i]=t},{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let r,a,o;const s={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),a=r.length;a-- >0;)o=r[a],i&&!i(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==n&&$w(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Yw,kindOfTest:Jw,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(Zw(e))return e;let t=e.length;if(!aj(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Gw]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:wj,hasOwnProperty:jj,hasOwnProp:jj,reduceDescriptors:Tj,freezeMethods:e=>{Tj(e,(t,n)=>{if(rj(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];rj(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach(e=>{n[e]=!0})};return Zw(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:yj,global:bj,isContextDefined:vj,isSpecCompliantForm:function(e){return!!(e&&rj(e.append)&&"FormData"===e[Qw]&&e[Gw])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(oj(e)){if(t.indexOf(e)>=0)return;if(tj(e))return e;if(!("toJSON"in e)){t[i]=e;const r=Zw(e)?[]:{};return xj(e,(e,t)=>{const a=n(e,i+1);!ej(a)&&(r[t]=a)}),t[i]=void 0,r}}return e};return n(e,0)},isAsyncFn:Cj,isThenable:e=>e&&(oj(e)||rj(e))&&rj(e.then)&&rj(e.catch),setImmediate:Ij,asap:zj,isIterable:e=>null!=e&&rj(e[Gw])};function _j(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Ej.inherits(_j,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ej.toJSONObject(this.config),code:this.code,status:this.status}}});const Nj=_j.prototype,Pj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Pj[e]={value:e}}),Object.defineProperties(_j,Pj),Object.defineProperty(Nj,"isAxiosError",{value:!0}),_j.from=(e,t,n,i,r,a)=>{const o=Object.create(Nj);return Ej.toFlatObject(e,o,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),_j.call(o,e.message,t,n,i,r),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};function Dj(e){return Ej.isPlainObject(e)||Ej.isArray(e)}function Wj(e){return Ej.endsWith(e,"[]")?e.slice(0,-2):e}function Mj(e,t,n){return e?e.concat(t).map(function(e,t){return e=Wj(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const Lj=Ej.toFlatObject(Ej,{},null,function(e){return/^is[A-Z]/.test(e)});function Oj(e,t,n){if(!Ej.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=Ej.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Ej.isUndefined(t[e])})).metaTokens,r=n.visitor||c,a=n.dots,o=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Ej.isSpecCompliantForm(t);if(!Ej.isFunction(r))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(Ej.isDate(e))return e.toISOString();if(Ej.isBoolean(e))return e.toString();if(!s&&Ej.isBlob(e))throw new _j("Blob is not supported. Use a Buffer instead.");return Ej.isArrayBuffer(e)||Ej.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,r){let s=e;if(e&&!r&&"object"==typeof e)if(Ej.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(Ej.isArray(e)&&function(e){return Ej.isArray(e)&&!e.some(Dj)}(e)||(Ej.isFileList(e)||Ej.endsWith(n,"[]"))&&(s=Ej.toArray(e)))return n=Wj(n),s.forEach(function(e,i){!Ej.isUndefined(e)&&null!==e&&t.append(!0===o?Mj([n],i,a):null===o?n:n+"[]",l(e))}),!1;return!!Dj(e)||(t.append(Mj(r,n,a),l(e)),!1)}const d=[],u=Object.assign(Lj,{defaultVisitor:c,convertValue:l,isVisitable:Dj});if(!Ej.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!Ej.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+i.join("."));d.push(n),Ej.forEach(n,function(n,a){!0===(!(Ej.isUndefined(n)||null===n)&&r.call(t,n,Ej.isString(a)?a.trim():a,i,u))&&e(n,i?i.concat(a):[a])}),d.pop()}}(e),t}function qj(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Uj(e,t){this._pairs=[],e&&Oj(e,this,t)}const Hj=Uj.prototype;function Vj(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Kj(e,t,n){if(!t)return e;const i=n&&n.encode||Vj;Ej.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let a;if(a=r?r(t,n):Ej.isURLSearchParams(t)?t.toString():new Uj(t,n).toString(i),a){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}Hj.append=function(e,t){this._pairs.push([e,t])},Hj.toString=function(e){const t=e?function(t){return e.call(this,t,qj)}:qj;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};class $j{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ej.forEach(this.handlers,function(t){null!==t&&e(t)})}}const Gj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Qj={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Uj,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Yj="undefined"!=typeof window&&"undefined"!=typeof document,Jj="object"==typeof navigator&&navigator||void 0,Xj=Yj&&(!Jj||["ReactNative","NativeScript","NS"].indexOf(Jj.product)<0),Zj="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,eS=Yj&&window.location.href||"http://localhost",tS={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Yj,hasStandardBrowserEnv:Xj,hasStandardBrowserWebWorkerEnv:Zj,navigator:Jj,origin:eS},Symbol.toStringTag,{value:"Module"})),...Qj};function nS(e){function t(e,n,i,r){let a=e[r++];if("__proto__"===a)return!0;const o=Number.isFinite(+a),s=r>=e.length;if(a=!a&&Ej.isArray(i)?i.length:a,s)return Ej.hasOwnProp(i,a)?i[a]=[i[a],n]:i[a]=n,!o;i[a]&&Ej.isObject(i[a])||(i[a]=[]);return t(e,n,i[a],r)&&Ej.isArray(i[a])&&(i[a]=function(e){const t={},n=Object.keys(e);let i;const r=n.length;let a;for(i=0;i<r;i++)a=n[i],t[a]=e[a];return t}(i[a])),!o}if(Ej.isFormData(e)&&Ej.isFunction(e.entries)){const n={};return Ej.forEachEntry(e,(e,i)=>{t(function(e){return Ej.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),i,n,0)}),n}return null}const iS={transitional:Gj,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=Ej.isObject(e);r&&Ej.isHTMLForm(e)&&(e=new FormData(e));if(Ej.isFormData(e))return i?JSON.stringify(nS(e)):e;if(Ej.isArrayBuffer(e)||Ej.isBuffer(e)||Ej.isStream(e)||Ej.isFile(e)||Ej.isBlob(e)||Ej.isReadableStream(e))return e;if(Ej.isArrayBufferView(e))return e.buffer;if(Ej.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Oj(e,new tS.classes.URLSearchParams,{visitor:function(e,t,n,i){return tS.isNode&&Ej.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}(e,this.formSerializer).toString();if((a=Ej.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Oj(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),function(e,t,n){if(Ej.isString(e))try{return(t||JSON.parse)(e),Ej.trim(e)}catch(RB){if("SyntaxError"!==RB.name)throw RB}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||iS.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(Ej.isResponse(e)||Ej.isReadableStream(e))return e;if(e&&Ej.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(RB){if(n){if("SyntaxError"===RB.name)throw _j.from(RB,_j.ERR_BAD_RESPONSE,this,null,this.response);throw RB}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:tS.classes.FormData,Blob:tS.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ej.forEach(["delete","get","head","post","put","patch"],e=>{iS.headers[e]={}});const rS=Ej.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),aS=Symbol("internals");function oS(e){return e&&String(e).trim().toLowerCase()}function sS(e){return!1===e||null==e?e:Ej.isArray(e)?e.map(sS):String(e)}function lS(e,t,n,i,r){return Ej.isFunction(i)?i.call(this,t,n):(r&&(t=n),Ej.isString(t)?Ej.isString(i)?-1!==t.indexOf(i):Ej.isRegExp(i)?i.test(t):void 0:void 0)}let cS=class{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=oS(t);if(!r)throw new Error("header name must be a non-empty string");const a=Ej.findKey(i,r);(!a||void 0===i[a]||!0===n||void 0===n&&!1!==i[a])&&(i[a||t]=sS(e))}const a=(e,t)=>Ej.forEach(e,(e,n)=>r(e,n,t));if(Ej.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(Ej.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))a((e=>{const t={};let n,i,r;return e&&e.split("\n").forEach(function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&rS[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t})(e),t);else if(Ej.isObject(e)&&Ej.isIterable(e)){let n,i,r={};for(const t of e){if(!Ej.isArray(t))throw TypeError("Object iterator must return a key-value pair");r[i=t[0]]=(n=r[i])?Ej.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}a(r,t)}else null!=e&&r(t,e,n);return this}get(e,t){if(e=oS(e)){const n=Ej.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(Ej.isFunction(t))return t.call(this,e,n);if(Ej.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=oS(e)){const n=Ej.findKey(this,e);return!(!n||void 0===this[n]||t&&!lS(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=oS(e)){const r=Ej.findKey(n,e);!r||t&&!lS(0,n[r],r,t)||(delete n[r],i=!0)}}return Ej.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const r=t[n];e&&!lS(0,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return Ej.forEach(this,(i,r)=>{const a=Ej.findKey(n,r);if(a)return t[a]=sS(i),void delete t[r];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(r):String(r).trim();o!==r&&delete t[r],t[o]=sS(i),n[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ej.forEach(this,(n,i)=>{null!=n&&!1!==n&&(t[i]=e&&Ej.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(e=>n.set(e)),n}static accessor(e){const t=(this[aS]=this[aS]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=oS(e);t[i]||(!function(e,t){const n=Ej.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})})}(n,e),t[i]=!0)}return Ej.isArray(e)?e.forEach(i):i(e),this}};function dS(e,t){const n=this||iS,i=t||n,r=cS.from(i.headers);let a=i.data;return Ej.forEach(e,function(e){a=e.call(n,a,r.normalize(),t?t.status:void 0)}),r.normalize(),a}function uS(e){return!(!e||!e.__CANCEL__)}function hS(e,t,n){_j.call(this,null==e?"canceled":e,_j.ERR_CANCELED,t,n),this.name="CanceledError"}function pS(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new _j("Request failed with status code "+n.status,[_j.ERR_BAD_REQUEST,_j.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}cS.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ej.reduceDescriptors(cS.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}}),Ej.freezeMethods(cS),Ej.inherits(hS,_j,{__CANCEL__:!0});const mS=(e,t,n=3)=>{let i=0;const r=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,a=0,o=0;return t=void 0!==t?t:1e3,function(s){const l=Date.now(),c=i[o];r||(r=l),n[a]=s,i[a]=l;let d=o,u=0;for(;d!==a;)u+=n[d++],d%=e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),l-r<t)return;const h=c&&l-c;return h?Math.round(1e3*u/h):void 0}}(50,250);return function(e,t){let n,i,r=0,a=1e3/t;const o=(t,a=Date.now())=>{r=a,n=null,i&&(clearTimeout(i),i=null),e(...t)};return[(...e)=>{const t=Date.now(),s=t-r;s>=a?o(e,t):(n=e,i||(i=setTimeout(()=>{i=null,o(n)},a-s)))},()=>n&&o(n)]}(n=>{const a=n.loaded,o=n.lengthComputable?n.total:void 0,s=a-i,l=r(s);i=a;e({loaded:a,total:o,progress:o?a/o:void 0,bytes:s,rate:l||void 0,estimated:l&&o&&a<=o?(o-a)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})},n)},gS=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},fS=e=>(...t)=>Ej.asap(()=>e(...t)),xS=tS.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,tS.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(tS.origin),tS.navigator&&/(msie|trident)/i.test(tS.navigator.userAgent)):()=>!0,yS=tS.hasStandardBrowserEnv?{write(e,t,n,i,r,a){const o=[e+"="+encodeURIComponent(t)];Ej.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Ej.isString(i)&&o.push("path="+i),Ej.isString(r)&&o.push("domain="+r),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function bS(e,t,n){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(i||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const vS=e=>e instanceof cS?{...e}:e;function kS(e,t){t=t||{};const n={};function i(e,t,n,i){return Ej.isPlainObject(e)&&Ej.isPlainObject(t)?Ej.merge.call({caseless:i},e,t):Ej.isPlainObject(t)?Ej.merge({},t):Ej.isArray(t)?t.slice():t}function r(e,t,n,r){return Ej.isUndefined(t)?Ej.isUndefined(e)?void 0:i(void 0,e,0,r):i(e,t,0,r)}function a(e,t){if(!Ej.isUndefined(t))return i(void 0,t)}function o(e,t){return Ej.isUndefined(t)?Ej.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function s(n,r,a){return a in t?i(n,r):a in e?i(void 0,n):void 0}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(e,t,n)=>r(vS(e),vS(t),0,!0)};return Ej.forEach(Object.keys({...e,...t}),function(i){const a=l[i]||r,o=a(e[i],t[i],i);Ej.isUndefined(o)&&a!==s||(n[i]=o)}),n}const wS=e=>{const t=kS({},e);let n,{data:i,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:s,auth:l}=t;if(t.headers=s=cS.from(s),t.url=Kj(bS(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Ej.isFormData(i))if(tS.hasStandardBrowserEnv||tS.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(n=s.getContentType())){const[e,...t]=n?n.split(";").map(e=>e.trim()).filter(Boolean):[];s.setContentType([e||"multipart/form-data",...t].join("; "))}if(tS.hasStandardBrowserEnv&&(r&&Ej.isFunction(r)&&(r=r(t)),r||!1!==r&&xS(t.url))){const e=a&&o&&yS.read(o);e&&s.set(a,e)}return t},jS="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const i=wS(e);let r=i.data;const a=cS.from(i.headers).normalize();let o,s,l,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=i;function m(){c&&c(),d&&d(),i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let g=new XMLHttpRequest;function f(){if(!g)return;const i=cS.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());pS(function(e){t(e),m()},function(e){n(e),m()},{data:u&&"text"!==u&&"json"!==u?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:i,config:e,request:g}),g=null}g.open(i.method.toUpperCase(),i.url,!0),g.timeout=i.timeout,"onloadend"in g?g.onloadend=f:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(f)},g.onabort=function(){g&&(n(new _j("Request aborted",_j.ECONNABORTED,e,g)),g=null)},g.onerror=function(){n(new _j("Network Error",_j.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||Gj;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new _j(t,r.clarifyTimeoutError?_j.ETIMEDOUT:_j.ECONNABORTED,e,g)),g=null},void 0===r&&a.setContentType(null),"setRequestHeader"in g&&Ej.forEach(a.toJSON(),function(e,t){g.setRequestHeader(t,e)}),Ej.isUndefined(i.withCredentials)||(g.withCredentials=!!i.withCredentials),u&&"json"!==u&&(g.responseType=i.responseType),p&&([l,d]=mS(p,!0),g.addEventListener("progress",l)),h&&g.upload&&([s,c]=mS(h),g.upload.addEventListener("progress",s),g.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(o=t=>{g&&(n(!t||t.type?new hS(null,e,g):t),g.abort(),g=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const x=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);x&&-1===tS.protocols.indexOf(x)?n(new _j("Unsupported protocol "+x+":",_j.ERR_BAD_REQUEST,e)):g.send(r||null)})},SS=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const r=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;i.abort(t instanceof _j?t:new hS(t instanceof Error?t.message:t))}};let a=t&&setTimeout(()=>{a=null,r(new _j(`timeout ${t} of ms exceeded`,_j.ETIMEDOUT))},t);const o=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)}),e=null)};e.forEach(e=>e.addEventListener("abort",r));const{signal:s}=i;return s.unsubscribe=()=>Ej.asap(o),s}},TS=function*(e,t){let n=e.byteLength;if(n<t)return void(yield e);let i,r=0;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},CS=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},IS=(e,t,n,i)=>{const r=async function*(e,t){for await(const n of CS(e))yield*TS(n,t)}(e,t);let a,o=0,s=e=>{a||(a=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await r.next();if(t)return s(),void e.close();let a=i.byteLength;if(n){let e=o+=a;n(e)}e.enqueue(new Uint8Array(i))}catch(t){throw s(t),t}},cancel:e=>(s(e),r.return())},{highWaterMark:2})},BS="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,RS=BS&&"function"==typeof ReadableStream,AS=BS&&("function"==typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),FS=(e,...t)=>{try{return!!e(...t)}catch(RB){return!1}},zS=RS&&FS(()=>{let e=!1;const t=new Request(tS.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),ES=RS&&FS(()=>Ej.isReadableStream(new Response("").body)),_S={stream:ES&&(e=>e.body)};var NS;BS&&(NS=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!_S[e]&&(_S[e]=Ej.isFunction(NS[e])?t=>t[e]():(t,n)=>{throw new _j(`Response type '${e}' is not supported`,_j.ERR_NOT_SUPPORT,n)})}));const PS=async(e,t)=>{const n=Ej.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(Ej.isBlob(e))return e.size;if(Ej.isSpecCompliantForm(e)){const t=new Request(tS.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Ej.isArrayBufferView(e)||Ej.isArrayBuffer(e)?e.byteLength:(Ej.isURLSearchParams(e)&&(e+=""),Ej.isString(e)?(await AS(e)).byteLength:void 0)})(t):n},DS={http:null,xhr:jS,fetch:BS&&(async e=>{let{url:t,method:n,data:i,signal:r,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:h}=wS(e);c=c?(c+"").toLowerCase():"text";let p,m=SS([r,a&&a.toAbortSignal()],o);const g=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let f;try{if(l&&zS&&"get"!==n&&"head"!==n&&0!==(f=await PS(d,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(Ej.isFormData(i)&&(e=n.headers.get("content-type"))&&d.setContentType(e),n.body){const[e,t]=gS(f,mS(fS(l)));i=IS(n.body,65536,e,t)}}Ej.isString(u)||(u=u?"include":"omit");const r="credentials"in Request.prototype;p=new Request(t,{...h,signal:m,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:i,duplex:"half",credentials:r?u:void 0});let a=await fetch(p,h);const o=ES&&("stream"===c||"response"===c);if(ES&&(s||o&&g)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=a[t]});const t=Ej.toFiniteNumber(a.headers.get("content-length")),[n,i]=s&&gS(t,mS(fS(s),!0))||[];a=new Response(IS(a.body,65536,n,()=>{i&&i(),g&&g()}),e)}c=c||"text";let x=await _S[Ej.findKey(_S,c)||"text"](a,e);return!o&&g&&g(),await new Promise((t,n)=>{pS(t,n,{data:x,headers:cS.from(a.headers),status:a.status,statusText:a.statusText,config:e,request:p})})}catch(x){if(g&&g(),x&&"TypeError"===x.name&&/Load failed|fetch/i.test(x.message))throw Object.assign(new _j("Network Error",_j.ERR_NETWORK,e,p),{cause:x.cause||x});throw _j.from(x,x&&x.code,e,p)}})};Ej.forEach(DS,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(RB){}Object.defineProperty(e,"adapterName",{value:t})}});const WS=e=>`- ${e}`,MS=e=>Ej.isFunction(e)||null===e||!1===e,LS=e=>{e=Ej.isArray(e)?e:[e];const{length:t}=e;let n,i;const r={};for(let a=0;a<t;a++){let t;if(n=e[a],i=n,!MS(n)&&(i=DS[(t=String(n)).toLowerCase()],void 0===i))throw new _j(`Unknown adapter '${t}'`);if(i)break;r[t||"#"+a]=i}if(!i){const e=Object.entries(r).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));throw new _j("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(WS).join("\n"):" "+WS(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return i};function OS(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new hS(null,e)}function qS(e){OS(e),e.headers=cS.from(e.headers),e.data=dS.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return LS(e.adapter||iS.adapter)(e).then(function(t){return OS(e),t.data=dS.call(e,e.transformResponse,t),t.headers=cS.from(t.headers),t},function(t){return uS(t)||(OS(e),t&&t.response&&(t.response.data=dS.call(e,e.transformResponse,t.response),t.response.headers=cS.from(t.response.headers))),Promise.reject(t)})}const US="1.11.0",HS={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{HS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const VS={};HS.transitional=function(e,t,n){return(i,r,a)=>{if(!1===e)throw new _j(function(e,t){return"[Axios v"+US+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}(r," has been removed"+(t?" in "+t:"")),_j.ERR_DEPRECATED);return t&&!VS[r]&&(VS[r]=!0),!e||e(i,r,a)}},HS.spelling=function(e){return(e,t)=>!0};const KS={assertOptions:function(e,t,n){if("object"!=typeof e)throw new _j("options must be an object",_j.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const a=i[r],o=t[a];if(o){const t=e[a],n=void 0===t||o(t,a,e);if(!0!==n)throw new _j("option "+a+" must be "+n,_j.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new _j("Unknown option "+a,_j.ERR_BAD_OPTION)}},validators:HS},$S=KS.validators;let GS=class{constructor(e){this.defaults=e||{},this.interceptors={request:new $j,response:new $j}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(RB){}}throw n}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=kS(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&KS.assertOptions(n,{silentJSONParsing:$S.transitional($S.boolean),forcedJSONParsing:$S.transitional($S.boolean),clarifyTimeoutError:$S.transitional($S.boolean)},!1),null!=i&&(Ej.isFunction(i)?t.paramsSerializer={serialize:i}:KS.assertOptions(i,{encode:$S.function,serialize:$S.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),KS.assertOptions(t,{baseUrl:$S.spelling("baseURL"),withXsrfToken:$S.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=r&&Ej.merge(r.common,r[t.method]);r&&Ej.forEach(["delete","get","head","post","put","patch","common"],e=>{delete r[e]}),t.headers=cS.concat(a,r);const o=[];let s=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,o.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let d,u=0;if(!s){const e=[qS.bind(this),void 0];for(e.unshift(...o),e.push(...l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=o.length;let h=t;for(u=0;u<d;){const e=o[u++],t=o[u++];try{h=e(h)}catch(p){t.call(this,p);break}}try{c=qS.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return Kj(bS((e=kS(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};Ej.forEach(["delete","get","head","options"],function(e){GS.prototype[e]=function(t,n){return this.request(kS(n||{},{method:e,url:t,data:(n||{}).data}))}}),Ej.forEach(["post","put","patch"],function(e){function t(t){return function(n,i,r){return this.request(kS(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}GS.prototype[e]=t(),GS.prototype[e+"Form"]=t(!0)});const QS={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(QS).forEach(([e,t])=>{QS[t]=e});const YS=function e(t){const n=new GS(t),i=Vw(GS.prototype.request,n);return Ej.extend(i,GS.prototype,n,{allOwnKeys:!0}),Ej.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(kS(t,n))},i}(iS);YS.Axios=GS,YS.CanceledError=hS,YS.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const i=new Promise(e=>{n.subscribe(e),t=e}).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e(function(e,i,r){n.reason||(n.reason=new hS(e,i,r),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let t;return{token:new e(function(e){t=e}),cancel:t}}},YS.isCancel=uS,YS.VERSION=US,YS.toFormData=Oj,YS.AxiosError=_j,YS.Cancel=YS.CanceledError,YS.all=function(e){return Promise.all(e)},YS.spread=function(e){return function(t){return e.apply(null,t)}},YS.isAxiosError=function(e){return Ej.isObject(e)&&!0===e.isAxiosError},YS.mergeConfig=kS,YS.AxiosHeaders=cS,YS.formToJSON=e=>nS(Ej.isHTMLForm(e)?new FormData(e):e),YS.getAdapter=LS,YS.HttpStatusCode=QS,YS.default=YS;const{Axios:JS,AxiosError:XS,CanceledError:ZS,isCancel:eT,CancelToken:tT,VERSION:nT,all:iT,Cancel:rT,isAxiosError:aT,spread:oT,toFormData:sT,AxiosHeaders:lT,HttpStatusCode:cT,formToJSON:dT,getAdapter:uT,mergeConfig:hT}=YS;async function*pT(e,t,n,i){try{const t=Fv().currentUser;if(!t)throw new Error("用戶未登入");let a={"x-test-mode":i?"true":"false"};try{const e=await t.getIdToken();a.Authorization=`Bearer ${e}`}catch(r){}const o=(await YS.post("/api/gpt",{messages:[{sender:"user",text:e}],system_prompt:n,userId:t.uid},{headers:a})).data.reply;if(!o||!o.trim())throw new Error("AI回覆為空，請稍後再試。");{const e=o.split("");for(const t of e)yield t,await new Promise(e=>setTimeout(e,50))}}catch(r){throw r instanceof Error?new Error(`API錯誤：${r.message}`):new Error("抱歉，我現在無法回應，請稍後再試。")}}const mT=["Annie.png","berlex.png","Bray.png","Cayly.png","Derxl.png","El.png","Fenny.png","Gily.png","Henny.png","Jesy.png","Karl.png","michy.png","Mily.png","Neysher.png","sandy.png","Sherl.png","Shu.png","Shyly.png"],gT=mT.map(e=>`/avatars/${e}`);mT.map(e=>e.replace(/\.png$/i,""));const fT={"zh-TW":{friend:"朋友",avatarTitle:"選我做你的朋友",companionPhrase:["🕊️ 守在海這端，","我都聽著呢。"],changeAvatar:"更換我的頭像",aiReplyTemplate:e=>`AI陪聊：我明白你的意思，「${e}」，讓我再多聽你說說...`,aiSystemPrompt:"你是一個溫暖、善解人意的虛擬人，請用鼓勵、正向語氣回應。",speechErrorBrowser:"此瀏覽器不支援語音辨識，請改用 Chrome/Edge。",speechErrorFail:"語音辨識失敗，請再試一次。",speechErrorNoDetect:"沒有偵測到語音，請再試一次。",logout:"登出",inputPlaceholder:"或者，直接輸入文字... (Enter 送出)",welcome:e=>`嗨，${e}，我是你的 AI 朋友，你可以開始跟我說話囉！`,welcomePickAvatar:e=>`嗨，${e}，先幫我選個頭像後我們再輕鬆自在，天南地北痛快聊...`,welcomeChat:(e,t)=>`${e}說：嗨，${t}，今天想聊點什麼呢？`,whoAmI:"你想我是誰？",tapToTalk:"按一下開始語音聊天...",aiReplying:"AI 正在回覆中，輸入新訊息可立即打斷",recognizing:"正在辨識中..."},"zh-CN":{friend:"朋友",avatarTitle:"选我做你的朋友",companionPhrase:["🕊️ 守在海这端，","我都听着呢。"],changeAvatar:"更换我的头像",aiReplyTemplate:e=>`AI陪聊：我明白你的意思，"${e}"，让我再多听你聊聊...`,aiSystemPrompt:"你是一个温暖、善解人意的虚拟人，请用鼓励、正向语气回应。",speechErrorBrowser:"此浏览器不支持语音识别，请改用 Chrome/Edge。",speechErrorFail:"语音识别失败，请再试一次。",speechErrorNoDetect:"没有检测到语音，请再试一次。",logout:"登出",inputPlaceholder:"或者，直接输入文字... (Enter 发送)",welcome:e=>`嗨，${e}，我是你的 AI 朋友，你可以开始跟我说话啰！`,welcomePickAvatar:e=>`嗨，${e}，先帮我选个头像后我们再轻松自在，天南地北畅快聊...`,welcomeChat:(e,t)=>`${e}说：嗨，${t}，今天想聊点什么呢？`,whoAmI:"你想我是谁？",tapToTalk:"点一下开始语音聊天...",aiReplying:"AI 正在回复中，输入新消息可立即打断",recognizing:"正在识别中..."},en:{friend:"Friend",avatarTitle:"Pick Me as Your Friend",companionPhrase:["🕊️ I'm here by the sea,","I'm listening."],changeAvatar:"Change My Avatar",aiReplyTemplate:e=>`AI Chat: I understand what you mean, "${e}", let me hear more from you...`,aiSystemPrompt:"You are a warm, empathetic virtual person. Please respond in an encouraging and positive tone.",speechErrorBrowser:"This browser does not support speech recognition. Please use Chrome/Edge.",speechErrorFail:"Speech recognition failed, please try again.",speechErrorNoDetect:"No speech detected, please try again.",logout:"Logout",inputPlaceholder:"Or, type text directly... (Enter to send)",welcome:e=>`Hi, ${e}, I'm your AI friend. You can start talking to me now!`,welcomePickAvatar:e=>`Hi, ${e}, pick my avatar and let's chat freely!`,welcomeChat:(e,t)=>`${e}: Hi, ${t}, what do you want to talk about today?`,whoAmI:"Who do you want me to be?",tapToTalk:"Tap to start voice chat...",aiReplying:"AI is replying, type a new message to interrupt.",recognizing:"Recognizing..."},ja:{friend:"友達",avatarTitle:"友達に選んでね",companionPhrase:["🕊️ この海辺で待ってるよ、","ずっと聞いているから。"],changeAvatar:"アバターを変更",aiReplyTemplate:e=>`AIチャット：あなたの言うこと、「${e}」、わかります。もっと聞かせてください...`,aiSystemPrompt:"あなたは温かく、共感的なバーチャルパーソンです。励ましとポジティブなトーンで応答してください。",speechErrorBrowser:"このブラウザは音声認識に対応していません。Chrome/Edgeを使用してください。",speechErrorFail:"音声認識に失敗しました。もう一度お試しください。",speechErrorNoDetect:"音声が検出されませんでした。もう一度お試しください。",logout:"ログアウト",inputPlaceholder:"あるいは、直接テキストを入力... (Enterで送信)",welcome:e=>`こんにちは、${e}さん。あなたのAIの友達です。さあ、話しましょう！`,welcomePickAvatar:e=>`やあ、${e}、まずは私のアバターを選んでから、気軽に何でも話そう！`,welcomeChat:(e,t)=>`${e}：やあ、${t}、今日は何を話そうか？`,whoAmI:"私が誰であってほしいですか？",tapToTalk:"タップして音声チャット開始",aiReplying:"AIが返信中です。新しいメッセージを入力するとすぐに中断できます",recognizing:"認識中..."},ko:{friend:"친구",avatarTitle:"나를 친구로 선택해줘",companionPhrase:["🕊️ 바다 이편에서 지키고 있을게,","다 듣고 있어."],changeAvatar:"내 아바타 변경",aiReplyTemplate:e=>`AI 채팅: 무슨 말인지 알겠어, "${e}", 더 얘기해줘...`,aiSystemPrompt:"당신은 따뜻하고 공감 능력이 뛰어난 가상 인간입니다. 격려하고 긍정적인 톤으로 응답해주세요.",speechErrorBrowser:"이 브라우저는 음성 인식을 지원하지 않습니다. Chrome/Edge를 사용해주세요.",speechErrorFail:"음성 인식이 실패했습니다. 다시 시도해주세요.",speechErrorNoDetect:"음성이 감지되지 않았습니다. 다시 시도해주세요.",logout:"로그아웃",inputPlaceholder:"아니면, 직접 텍스트를 입력하세요... (Enter로 전송)",welcome:e=>`안녕, ${e}. 나는 너의 AI 친구야. 이제 나에게 말을 걸 수 있어!`,welcomePickAvatar:e=>`안녕, ${e}. 먼저 내 아바타를 고르고 자유롭게 얘기하자!`,welcomeChat:(e,t)=>`${e}: 안녕, ${t}, 오늘 무슨 얘기하고 싶어?`,whoAmI:"내가 누구였으면 좋겠어?",tapToTalk:"탭하여 음성 채팅 시작...",aiReplying:"AI가 답장 중입니다. 새 메시지를 입력하여 중단할 수 있습니다.",recognizing:"인식 중..."},vi:{friend:"Bạn bè",avatarTitle:"Chọn tôi làm bạn của bạn",companionPhrase:["🕊️ Em ở đây bên bờ biển,","Em đang lắng nghe đây."],changeAvatar:"Thay đổi Avatar của tôi",aiReplyTemplate:e=>`Trò chuyện AI: Tôi hiểu ý bạn, "${e}", hãy cho tôi nghe thêm...`,aiSystemPrompt:"Bạn là một người ảo ấm áp, đồng cảm. Vui lòng trả lời bằng giọng điệu khích lệ và tích cực.",speechErrorBrowser:"Trình duyệt này không hỗ trợ nhận dạng giọng nói. Vui lòng sử dụng Chrome/Edge.",speechErrorFail:"Nhận dạng giọng nói thất bại, vui lòng thử lại.",speechErrorNoDetect:"Không phát hiện thấy giọng nói, vui lòng thử lại.",logout:"Đăng xuất",inputPlaceholder:"Hoặc, nhập văn bản trực tiếp... (Enter để gửi)",welcome:e=>`Chào, ${e}. Tôi là người bạn AI của bạn. Bây giờ bạn có thể bắt đầu nói chuyện với tôi!`,welcomePickAvatar:e=>`Chào, ${e}, hãy chọn avatar của tôi và chúng ta hãy trò chuyện thoải mái!`,welcomeChat:(e,t)=>`${e}: Chào, ${t}, hôm nay bạn muốn nói về điều gì?`,whoAmI:"Bạn muốn tôi là ai?",tapToTalk:"Nhấn để bắt đầu trò chuyện thoại...",aiReplying:"AI đang trả lời, nhập tin nhắn mới để ngắt.",recognizing:"Đang nhận dạng..."},th:{friend:"เพื่อน",avatarTitle:"เลือกฉันเป็นเพื่อนของคุณ",companionPhrase:["🕊️ ฉันอยู่ที่นี่ริมทะเล,","ฉันกำลังฟังอยู่"],changeAvatar:"เปลี่ยนอวตารของฉัน",aiReplyTemplate:e=>`แชท AI: ฉันเข้าใจที่คุณหมายถึง, "${e}", เล่าให้ฉันฟังอีกสิ...`,aiSystemPrompt:"คุณเป็นบุคคลเสมือนที่อบอุ่นและเข้าอกเข้าใจ โปรดตอบกลับด้วยน้ำเสียงที่ให้กำลังใจและเป็นบวก",speechErrorBrowser:"เบราว์เซอร์นี้ไม่รองรับการจำแนกเสียงพูด กรุณาใช้ Chrome/Edge",speechErrorFail:"การจำแนกเสียงพูดล้มเหลว กรุณาลองอีกครั้ง",speechErrorNoDetect:"ไม่พบเสียงพูด กรุณาลองอีกครั้ง",logout:"ออกจากระบบ",inputPlaceholder:"หรือพิมพ์ข้อความโดยตรง... (Enter เพื่อส่ง)",welcome:e=>`สวัสดี, ${e}. ฉันคือเพื่อน AI ของคุณ คุณสามารถเริ่มคุยกับฉันได้เลย!`,welcomePickAvatar:e=>`สวัสดี, ${e}, เลือกอวตารของฉันแล้วมาคุยกันอย่างอิสระ!`,welcomeChat:(e,t)=>`${e}: สวัสดี, ${t}, วันนี้คุณอยากคุยเรื่องอะไร?`,whoAmI:"คุณอยากให้ฉันเป็นใคร?",tapToTalk:"แตะเพื่อเริ่มแชทด้วยเสียง...",aiReplying:"AI กำลังตอบกลับ, พิมพ์ข้อความใหม่เพื่อขัดจังหวะ",recognizing:"กำลังจดจำ..."},la:{friend:"Amicus",avatarTitle:"Elige Me ut Amicum Tuum",companionPhrase:["🕊️ Hic adsum ad mare,","Audio."],changeAvatar:"Muta Imaginem Meam",aiReplyTemplate:e=>`AI Curabitur: Intellego quid velis, "${e}", sine me plura a te audire...`,aiSystemPrompt:"Tu es persona virtualis calida et empathetica. Quaeso responde sono hortanti et positivo.",speechErrorBrowser:"Hic navigator recognitionem vocis non sustinet. Quaeso utere Chrome/Edge.",speechErrorFail:"Recognitio vocis defecit, quaeso iterum conare.",speechErrorNoDetect:"Nulla oratio detecta, quaeso iterum conare.",logout:"Exire",inputPlaceholder:"Aut, textum directe scribe... (Enter mittere)",welcome:e=>`Salve, ${e}. Amicus tuus AI sum. Iam potes mecum loqui!`,welcomePickAvatar:e=>`Salve, ${e}, elige imaginem meam et libere loquamur!`,welcomeChat:(e,t)=>`${e}: Salve, ${t}, de quo hodie loqui vis?`,whoAmI:"Quis vis me esse?",tapToTalk:"Tange ut colloquium vocale incipias...",aiReplying:"AI respondet, scribe novum nuntium ad interrumpendum.",recognizing:"Agnoscens..."},ms:{friend:"Kawan",avatarTitle:"Pilih Saya sebagai Kawan Anda",companionPhrase:["🕊️ Saya di sini di tepi laut,","Saya sedang mendengar."],changeAvatar:"Tukar Avatar Saya",aiReplyTemplate:e=>`Sembang AI: Saya faham maksud awak, "${e}", beritahu saya lagi...`,aiSystemPrompt:"Anda adalah orang maya yang mesra dan empati. Sila balas dengan nada yang menggalakkan dan positif.",speechErrorBrowser:"Pelayar ini tidak menyokong pengecaman pertuturan. Sila gunakan Chrome/Edge.",speechErrorFail:"Pengecaman pertuturan gagal, sila cuba lagi.",speechErrorNoDetect:"Tiada pertuturan dikesan, sila cuba lagi.",logout:"Log keluar",inputPlaceholder:"Atau, taip teks secara terus... (Enter untuk hantar)",welcome:e=>`Hai, ${e}. Saya kawan AI anda. Anda boleh mula bercakap dengan saya sekarang!`,welcomePickAvatar:e=>`Hai, ${e}, pilih avatar saya dan mari berbual dengan bebas!`,welcomeChat:(e,t)=>`${e}: Hai, ${t}, apa yang anda mahu bualkan hari ini?`,whoAmI:"Awak nak saya jadi siapa?",tapToTalk:"Ketik untuk memulakan sembang suara...",aiReplying:"AI sedang membalas, taip mesej baru untuk mengganggu.",recognizing:"Mengecam..."}},xT={"zh-TW":"更換頭像","zh-CN":"更换头像",en:"Change Avatar",ja:"アバターを変更",ko:"아바타 변경",th:"เปลี่ยนภาพประจำตัว",vi:"Đổi avatar",ms:"Tukar Avatar",la:"Muta Imaginem"};function yT(){var t,n,i;const r=le(),[a,o]=e.useState([]),[s,l]=e.useState(""),[c,d]=e.useState(!1),u=e.useRef(null),h=e.useRef(null),p=e.useRef(null),[m,g]=e.useState(!1),[x,y]=e.useState(!1),[b,v]=e.useState(""),[k,w]=e.useState(!1),[j,S]=e.useState(""),[T,C]=e.useState(""),[I,B]=e.useState(!1),[R,A]=e.useState(!1),[F,z]=e.useState(""),[E,_]=e.useState(""),[N,P]=e.useState(!1),[D,W]=e.useState(!1),{lang:M,setLang:L}=mw(),O=fT[M]||fT["zh-TW"],q=e.useRef(null),U=e.useRef(null),H=e.useRef(null),{isTestMode:V}=CB(),[K,$]=e.useState(()=>"undefined"!=typeof window&&window.innerWidth<=768),G=Fv(lw),[Q,Y]=e.useState(G.currentUser),[J,X]=e.useState(!1),Z={"zh-TW":{privacy:"隱私政策",terms:"使用條款",deletion:"資料刪除"},"zh-CN":{privacy:"隐私政策",terms:"使用条款",deletion:"资料删除"},en:{privacy:"Privacy Policy",terms:"Terms of Service",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"利用規約",deletion:"データ削除"},ko:{privacy:"개인정보 처리방침",terms:"이용약관",deletion:"데이터 삭제"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"เงื่อนไขการใช้งาน",deletion:"การลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản sử dụng",deletion:"Xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma Perkhidmatan",deletion:"Pemadaman Data"},la:{privacy:"Politica Privata",terms:"Termini Servitii",deletion:"Deletio Datorum"}};e.useEffect(()=>{const e=()=>$(window.innerWidth<=768);return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e.useEffect(()=>{const e=yb(G,e=>{Y(e),X(!0)});return()=>e()},[G]),e.useEffect(()=>{if(!N)return;const e=e=>{q.current&&!q.current.contains(e.target)&&P(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[N]),e.useEffect(()=>{if(!D)return;const e=e=>{U.current&&!U.current.contains(e.target)&&W(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[D]);const[ee,te]=e.useState(!1),ne=e.useRef(null),[ie,re]=e.useState(!1),{checkPermission:ae,recordUsage:oe}=Rw(),[se,ce]=e.useState(!1),[de,ue]=e.useState(!1),[he,pe]=e.useState(null),me=()=>{const e=Fv().currentUser;return e&&e.displayName||localStorage.getItem("nickname")||O.friend},[ge,fe]=e.useState(me()),[xe,ye]=e.useState(()=>localStorage.getItem("lastUid")),[be,ve]=e.useState(()=>!localStorage.getItem("avatarWelcomed")),[ke,we]=e.useState(()=>!localStorage.getItem("aiAvatar")),[je,Se]=e.useState(""),Te=e.useRef(null);e.useEffect(()=>{localStorage.setItem("lang",M),fe(me());const e=window.SpeechRecognition||window.webkitSpeechRecognition;e?(H.current=new e,H.current.continuous=!0,H.current.interimResults=!0,H.current.lang=M,H.current.onresult=e=>{let t="",n="";for(let i=e.resultIndex;i<e.results.length;++i)e.results[i].isFinal?n+=e.results[i][0].transcript:t+=e.results[i][0].transcript;if(l(E+n+t),n){const e=E+n;_(e=>e+n),(async()=>{const t={id:`user-${Date.now()}`,text:e,sender:"user"};o(e=>[...e,t]),l(""),u.current&&clearTimeout(u.current);const n=`ai-${Date.now()}`;o(e=>[...e,{id:n,text:"",sender:"ai",status:"streaming"}]),d(!0);try{const t=await pT(e,0,O.aiSystemPrompt,V);let i="";for await(const e of t)i+=e,o(e=>e.map(e=>e.id===n?{...e,text:i}:e));o(e=>e.map(e=>e.id===n?{...e,status:"done"}:e))}catch(i){const e=i instanceof Error?i.message:"未知錯誤";o(t=>t.map(t=>t.id===n?{...t,text:`API錯誤：${e}`,status:"done"}:t))}finally{d(!1)}})()}},H.current.onerror=e=>{let t="";switch(e.error){case"no-speech":t=O.speechErrorNoDetect;break;case"audio-capture":case"network":t=O.speechErrorFail;break;default:t=""}z(t),A(!1),y(!1)},H.current.onend=()=>{A(!1)}):z(O.speechErrorBrowser)},[M,O.speechErrorBrowser,O.speechErrorFail,O.speechErrorNoDetect,x,E]),e.useEffect(()=>{H.current&&(H.current.onend=()=>{A(!1),ee&&x&&!ie&&(ne.current=setTimeout(()=>{x&&!ie&&(s.trim()&&(Ie(s),l(""),_("")),setTimeout(()=>{x&&ee&&!ie&&(H.current.start(),A(!0))},500))},100))})},[ee,x,s,ie]),e.useEffect(()=>{var e,t;const n=localStorage.getItem("aiAvatar");n?(v(n),w(!1)):w(!0);const i=null==(e=Fv().currentUser)?void 0:e.uid;i!==xe&&(localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),v(""),ye(i||null),i&&localStorage.setItem("lastUid",i)),Fv().currentUser&&fe((null==(t=Fv().currentUser)?void 0:t.displayName)||O.friend)},[xe,O.friend]),e.useEffect(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[a]);const Ce=e=>{v(e),localStorage.setItem("aiAvatar",e),w(!1),be&&(o([{id:"welcome-1",text:O.welcomeChat(Be(e),ge),sender:"ai"}]),localStorage.setItem("avatarWelcomed","true"),ve(!1))},Ie=async(e=s)=>{if(!e.trim())return;const t=await ae("aiChat");if(!t.allowed){if(V){const t={id:`user-${Date.now()}`,text:e,sender:"user"};o(e=>[...e,t]),l(""),_(""),u.current&&clearTimeout(u.current);const n=`ai-${Date.now()}`;o(e=>[...e,{id:n,text:"",sender:"ai",status:"streaming"}]),d(!0);try{const t=await pT(e,0,O.aiSystemPrompt,V);let i="";for await(const e of t)i+=e,o(e=>e.map(e=>e.id===n?{...e,text:i}:e));o(e=>e.map(e=>e.id===n?{...e,status:"done"}:e))}catch(r){const e=r instanceof Error?r.message:"未知錯誤";o(t=>t.map(t=>t.id===n?{...t,text:`API錯誤：${e}`,status:"done"}:t))}finally{d(!1)}return}return void(t.isFreeUser?ue(!0):(t.canRenew,pe(t),ce(!0)))}const n={id:`user-${Date.now()}`,text:e,sender:"user"};o(e=>[...e,n]),l(""),_(""),u.current&&clearTimeout(u.current);const i=`ai-${Date.now()}`;o(e=>[...e,{id:i,text:"",sender:"ai",status:"streaming"}]),d(!0);try{const t=await pT(e,0,O.aiSystemPrompt,V);let n="";for await(const e of t)n+=e,o(e=>e.map(e=>e.id===i?{...e,text:n}:e));o(e=>e.map(e=>e.id===i?{...e,status:"done"}:e)),B(!0),await oe("aiChat",2)}catch(r){o(e=>e.map(e=>e.id===i?{...e,text:"Oops, something went wrong.",status:"done"}:e))}finally{d(!1),B(!1)}},Be=e=>{if(!e)return"";const t=e.split("/");return t[t.length-1].replace(/\.png$/i,"")},Re=async()=>{if(H.current)if(x||ee||R)H.current.stop(),y(!1),A(!1),te(!1),ne.current&&clearTimeout(ne.current),re(!0);else{const e=await ae("aiChat");if(!e.allowed)return V?(_(""),l(""),H.current.start(),y(!0),A(!0),z(""),te(!0),void re(!1)):void(e.isFreeUser?ue(!0):(e.canRenew,pe(e),ce(!0)));_(""),l(""),H.current.start(),y(!0),A(!0),z(""),te(!0),re(!1),await oe("aiChat",1)}};e.useEffect(()=>{x||ee||re(!1)},[x,ee]);return J?f.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#f0f2f5"},children:[K?f.jsx(zw,{}):f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>r("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":"zh-TW"===M||"zh-CN"===M?"了解 Restarter 平台":"en"===M?"Learn about Restarter platform":"ja"===M?"Restarter プラットフォームについて":"ko"===M?"Restarter 플랫폼에 대해 알아보기":"th"===M?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":"vi"===M?"Tìm hiểu về nền tảng Restarter":"ms"===M?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:"zh-TW"===M?"🧬 Restarter™｜我們是誰":"zh-CN"===M?"🧬 Restarter™｜我们是谁":"en"===M?"🧬 Restarter™｜Who We Are":"ja"===M?"🧬 Restarter™｜私たちについて":"ko"===M?"🧬 Restarter™｜우리는 누구인가":"th"===M?"🧬 Restarter™｜เราเป็นใคร":"vi"===M?"🧬 Restarter™｜Chúng tôi là ai":"ms"===M?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>r("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":"zh-TW"===M?"提供意見和建議":"zh-CN"===M?"提供意见和建议":"en"===M?"Provide feedback and suggestions":"ja"===M?"ご意見やご提案を提供":"ko"===M?"의견과 제안 제공":"th"===M?"ให้ข้อเสนอแนะและคำแนะนำ":"vi"===M?"Cung cấp phản hồiและ đề xuất":"ms"===M?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:"zh-TW"===M?"💬 意見箱｜我們想聽你說":"zh-CN"===M?"💬 意见箱｜我们想听你说":"en"===M?"💬 Feedback｜We Want to Hear You":"ja"===M?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===M?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===M?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===M?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===M?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),Q?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:Q.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:Q.displayName||Q.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(G)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:{"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log Keluar",la:"Exire"}[M]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>r("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===M?"註冊/登入":"zh-CN"===M?"注册/登录":"en"===M?"Register / Login":"ja"===M?"登録/ログイン":"ko"===M?"가입/로그인":"th"===M?"สมัคร/เข้าสู่ระบบ":"vi"===M?"Đăng ký/Đăng nhập":"ms"===M?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:q,children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>P(e=>!e),children:["zh-TW"===M?"繁中":"zh-CN"===M?"简中":"en"===M?"English":"ja"===M?"日本語":"ko"===M?"한국어":"th"===M?"ไทย":"vi"===M?"Tiếng Việt":"ms"===M?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),N&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===M?"#6B5BFF":"#232946",fontWeight:e===M?700:500,background:e===M?"#f3f0ff":"#fff"},onClick:()=>{L(e),P(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:U,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>W(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),D&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===M||"zh-CN"===M?"法律文件":"en"===M?"Legal Documents":"ja"===M?"法的文書":"ko"===M?"법적 문서":"th"===M?"เอกสารทางกฎหมาย":"vi"===M?"Tài liệu pháp lý":"ms"===M?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:Z,titleKey:"privacy",path:"/privacy-policy"},{key:"terms",title:Z,titleKey:"terms",path:"/terms"},{key:"data",title:Z,titleKey:"deletion",path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>{var t;return f.jsx("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"11px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{r(e.path),W(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.titleKey?(null==(t=e.title[M])?void 0:t[e.titleKey])||e.title["zh-TW"][e.titleKey]:e.title[M]||e.title["zh-TW"]},e.key)})]})]})]}),k&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:100},children:f.jsxs("div",{style:{background:"#fff",padding:24,borderRadius:12,textAlign:"center",position:"relative"},children:[f.jsx("button",{onClick:()=>w(!1),style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),f.jsx("h2",{children:O.avatarTitle}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:16,margin:"24px 0"},children:[gT.slice(0,15).map(e=>f.jsx("img",{src:e,alt:Be(e),onClick:()=>Ce(e),style:{width:80,height:80,borderRadius:"50%",cursor:"pointer",objectFit:"cover"}},e)),f.jsx("div",{style:{width:80,height:80,borderRadius:"50%",border:"2px dashed #6B5BFF",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",background:"#f8f8ff",color:"#6B5BFF",fontSize:12,fontWeight:600},onClick:()=>{var e;null==(e=Te.current)||e.click()},children:"上傳心儀頭像"})]}),f.jsx("input",{ref:Te,type:"file",accept:"image/*",style:{display:"none"},onChange:e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];if(n){if(!n.type.startsWith("image/"))return void alert("請選擇圖片文件");if(n.size>5242880)return void alert("圖片大小不能超過 5MB");const e=new FileReader;e.onload=e=>{var t;const n=null==(t=e.target)?void 0:t.result;Se(n),Ce(n)},e.readAsDataURL(n)}}})]})}),!b&&!k&&f.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:24,textAlign:"center"},children:[f.jsx("p",{style:{fontSize:18,marginBottom:24},children:O.welcomePickAvatar(ge)}),f.jsx("button",{onClick:()=>w(!0),style:{padding:"10px 20px",borderRadius:8,background:"#1877f2",color:"#fff",border:"none",fontWeight:700,fontSize:16},children:O.avatarTitle})]}),b&&f.jsx("main",{ref:p,className:"chat-main-container",style:{flex:1,overflowY:"auto",padding:"20px",paddingLeft:"20px",paddingTop:"200px",maxHeight:"calc(100vh - 240px)",scrollBehavior:"smooth",boxSizing:"border-box",display:"flex",flexDirection:"column-reverse"},children:f.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto",minHeight:"100%",display:"flex",flexDirection:"column-reverse"},children:[f.jsx("div",{style:{height:"20px"}}),a.slice().reverse().map(e=>f.jsx("div",{style:{display:"flex",justifyContent:"user"===e.sender?"flex-end":"center",margin:"15px 0",wordWrap:"break-word",width:"100%"},children:f.jsxs("div",{style:{backgroundColor:"user"===e.sender?"#0084ff":"#e4e6eb",color:"user"===e.sender?"#fff":"#000",padding:"10px 14px",borderRadius:18,maxWidth:"60%",wordBreak:"break-word",whiteSpace:"pre-wrap",lineHeight:"1.3",fontSize:"14px"},children:[e.text,"streaming"===e.status&&"..."]})},e.id)),0===a.length&&f.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:40},children:f.jsx("p",{style:{fontSize:18},children:O.welcomeChat(Be(b),ge)})})]})}),b&&f.jsxs("footer",{style:{padding:"10px 20px 10px 20px",backgroundColor:"#fff",borderTop:"1px solid #ddd",position:"relative",minHeight:"160px",boxSizing:"border-box"},children:[f.jsx("div",{style:{maxWidth:800,margin:"0 auto",display:"flex",alignItems:"flex-start",justifyContent:"center"},children:f.jsxs("div",{style:{flex:1,marginLeft:0,marginRight:0},children:[f.jsxs("div",{className:"mobile-avatars-row",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,padding:"0 8px"},children:[f.jsxs("div",{className:"mobile-ai-avatar",style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"hidden"},children:f.jsx("div",{style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",overflow:"hidden",position:"relative"},children:f.jsx("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:f.jsx(Hw,{avatar:b,videoUrl:j,audioUrl:T,isSpeaking:I,size:72})})})}),f.jsx("button",{onClick:()=>w(!0),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"4px 8px",fontWeight:600,fontSize:10,cursor:"pointer",boxShadow:"0 2px 4px rgba(107, 91, 255, 0.3)",whiteSpace:"nowrap"},children:xT[M]})]}),f.jsx("div",{style:{flex:1,textAlign:"center",padding:"0 12px"},children:f.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:"1.4"},children:[f.jsx("span",{style:{fontWeight:700,color:"#ff9800"},children:Be(b)||"Fenny"}),f.jsx("br",{}),f.jsx("span",{style:{color:"#1976d2"},children:"讓我們來聊天..."}),f.jsx("br",{}),f.jsx("span",{style:{color:"#1976d2"},children:(null==(t=Fv().currentUser)?void 0:t.displayName)||(null==(n=Fv().currentUser)?void 0:n.email)||"用戶"}),f.jsx("br",{}),f.jsx("span",{style:{color:"#666"},children:"聊什麼都可以喔 😊"})]})}),f.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"visible"},children:f.jsx("img",{src:(null==(i=Fv().currentUser)?void 0:i.photoURL)||"/ctx-logo.png",alt:"user",style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",objectFit:"cover",border:"none",verticalAlign:"bottom"}})})]}),f.jsx("div",{style:{display:"flex",alignItems:"flex-end",height:80},children:f.jsx("input",{ref:h,type:"text",value:s,onChange:e=>l(e.target.value),onKeyPress:e=>"Enter"===e.key&&Ie(),placeholder:c?O.aiReplying:O.inputPlaceholder,style:{width:"100%",padding:12,borderRadius:18,border:"1px solid #ccc"},disabled:c||R})}),f.jsxs("div",{className:"chat-action-row-mobile",style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[f.jsx("button",{onClick:()=>Ie(),disabled:c||!s,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:c||!s?"not-allowed":"pointer"},children:"送出"}),f.jsx("button",{onClick:Re,disabled:c,style:{padding:16,borderRadius:"50%",border:"none",background:x||ee||R?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:x||ee||R?"停止":"🎤"})]}),f.jsxs("div",{className:"chat-action-row-desktop",style:{width:"100%",display:"none",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[f.jsx("button",{onClick:()=>Ie(),disabled:c||!s,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:c||!s?"not-allowed":"pointer"},children:"送出"}),f.jsx("button",{onClick:Re,disabled:c,style:{padding:16,borderRadius:"50%",border:"none",background:x||ee||R?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:x||ee||R?"停止":"🎤"})]}),f.jsxs("div",{style:{height:40,display:"flex",alignItems:"center",justifyContent:"center"},children:[F&&f.jsx("p",{style:{color:"red",margin:0},children:F}),!F&&!s&&!R&&!c&&!x&&!ee&&f.jsx("p",{style:{color:"#888",margin:0,cursor:"pointer"},onClick:Re,children:O.tapToTalk}),!F&&R&&f.jsx("p",{style:{color:"#888",margin:0},children:O.recognizing}),!F&&(s||c||x||ee)&&f.jsx("p",{style:{color:"transparent",margin:0},children:"佔位"})]})]})}),f.jsx("div",{style:{textAlign:"center",marginTop:10,fontSize:12,color:"#aaa"},children:f.jsxs("p",{children:[O.companionPhrase[0],O.companionPhrase[1]]})})]}),se&&he&&f.jsx(yw,{isOpen:se,onClose:()=>{ce(!1),pe(null)},currentPlan:he.currentPlan,remainingDays:he.remainingDays,usedTokens:he.usedTokens,totalTokens:he.totalTokens}),de&&f.jsx(Mw,{isOpen:de,onClose:()=>ue(!1),featureName:"AI 聊天"})]}):f.jsx("div",{style:{textAlign:"center",marginTop:"30vh",fontSize:24},children:"載入中..."})}const bT={},vT=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));i=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in bT)return;bT[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${i}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,n&&r.setAttribute("nonce",n),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},kT=Fv(lw),wT={"zh-TW":{heroLeftTop:"救贖不是罪，",heroLeftMain:"只是走錯太久。",heroLeftSub:"",heroLeftYellow:"野花昂首盡綻放！",heroRightTop:"我要重新開始...",heroRightMain:"每一次的經歷，都是獨一無二的篇章",heroRightSub:"而不是成長的絆腳石。",heroRightYellow:"從灰燼中重生！",title:"Restarter™ 註冊",email:"電子郵件 *必填",password:"密碼(至少6位，含英文及數字)*必填",nickname:"暱稱*必填",age:"年齡*選填",selectAge:"請選擇年齡區間*必選",country:"國家(地區)*必選",city:"城市(可選)",interest:"興趣*選填",eventType:"經歷事件**選填",whatToImprove:"想改善什麼*選填",uploadAvatar:"上傳頭像",male:"男",female:"女",genderRequired:"(必選)",register:"🚀 註冊",registering:"註冊中...",errorAvatar:"請上傳頭像",errorGender:"請選擇性別",errorEmailFormat:"電子郵件格式無效",errorPasswordFormat:"密碼必須至少8個字符，且包含字母和數字",errorNicknameFormat:"暱稱必須是6-16個字符",errorAgeFormat:"年齡必須在18到99歲之間",errorCountry:"請選擇國家/地區",errorRegion:"請輸入城市",errorInterest:"請選擇興趣",errorEventType:"請選擇事件類型",errorImprovement:"請選擇想改善的項目",formTopSlogan:"你來了，就值得被歡迎！",login:"登入",terms:"條款/聲明",privacy:"隱私權政策",deletion:"資料刪除說明",googleLogin:"使用 Google 登入",appleLogin:"使用 Apple 登入"},"zh-CN":{heroLeftTop:"救赎不是罪，",heroLeftMain:"只是走错太久。",heroLeftSub:"",heroLeftYellow:"野花昂首尽绽放！",heroRightTop:"我要重新开始...",heroRightMain:"每一次的经历，都是独一无二的篇章",heroRightSub:"而不是成长的绊脚石。",heroRightYellow:"从灰烬中重生！",title:"Restarter™ 注册",email:"电子邮件 *必填",password:"密码 (至少8位，含英文及数字) *必填",nickname:"昵称 (6-16字) *必填",age:"年龄*选填",selectAge:"请选择年龄区间*必选",country:"国家(地区)*必选",city:"城市(可选)",interest:"兴趣*选填",eventType:"经历事件**选填",whatToImprove:"想改善什么*选填",uploadAvatar:"上传头像",male:"男",female:"女",genderRequired:"(必选)",register:"🚀 注册",registering:"注册中...",errorAvatar:"请上传头像",errorGender:"请选择性别",errorEmailFormat:"电子邮件格式无效",errorPasswordFormat:"密码必须至少8个字符，且包含字母和数字",errorNicknameFormat:"昵称必须是6-16个字符",errorAgeFormat:"年龄必须在18到99岁之间",errorCountry:"请选择国家/地区",errorRegion:"请输入城市",errorInterest:"请选择兴趣",errorEventType:"请选择事件类型",errorImprovement:"请选择想改善的项目",formTopSlogan:"你來了，就值得被歡迎！",login:"登录",terms:"条款/声明",privacy:"隐私政策",deletion:"数据删除说明",googleLogin:"使用 Google 登录",appleLogin:"使用 Apple 登录"},en:{heroLeftTop:"Redemption is not a crime,",heroLeftMain:"just went down the wrong path for too long.",heroLeftSub:"",heroLeftYellow:"Wildflowers bloom bravely!",heroRightTop:"I want a new start...",heroRightMain:"Every experience is a unique chapter,",heroRightSub:"not a barrier to growth.",heroRightYellow:"Rise from the ashes!",title:"Restarter™ Registration",email:"Email *required",password:"Password (min 8 chars, letter & number) *required",nickname:"Nickname (6-16 chars) *required",age:"Age*optional",selectAge:"Select age range",country:"Country (Region)*optional",city:"City (optional)",interest:"Interest*optional",eventType:"History Event**optional",whatToImprove:"What to improve*optional",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"It's not wrong to rise up!",login:"Login",terms:"Terms/Statement",privacy:"Privacy Policy",deletion:"Data Deletion",googleLogin:"Sign in with Google",appleLogin:"Sign in with Apple"},ja:{heroLeftTop:"贖いは罪ではない、",heroLeftMain:"ただ道に迷った時間が長すぎただけだ。",heroLeftSub:"",heroLeftYellow:"野の花も堂々と咲く！",heroRightTop:"私は新しく始めたい...",heroRightMain:"一つ一つの経験が、ユニークな章であり、",heroRightSub:"成長の障害ではない。",heroRightYellow:"灰の中から蘇れ！",title:"Restarter™ 登録",email:"メールアドレス *必須",password:"パスワード (8文字以上、英数字を含む) *必須",nickname:"ニックネーム (6-16文字) *必須",age:"年齢*任意",selectAge:"年齢層を選択",country:"国/地域*任意",city:"都市(任意)",interest:"興味*任意",eventType:"経験した出来事**任意",whatToImprove:"改善したいこと*任意",uploadAvatar:"アバターをアップロード",male:"男性",female:"女性",genderRequired:"(*必須)",register:"🚀 登録",registering:"登録中...",errorAvatar:"アバターをアップロードしてください。",errorGender:"性別を選択してください。",errorEmailFormat:"無効なメール形式です。",errorPasswordFormat:"パスワードは8文字以上で、文字と数字の両方を含める必要があります。",errorNicknameFormat:"ニックネームは6～16文字である必要があります。",errorAgeFormat:"年齢は18歳から99歳の間でなければなりません。",errorCountry:"国を選択してください。",errorRegion:"都市を入力してください。",errorInterest:"興味を選択してください。",errorEventType:"イベントタイプを選択してください。",errorImprovement:"改善したい項目を選択してください。",formTopSlogan:"立ち上がることは間違いじゃない！",login:"ログイン",terms:"規約/声明",privacy:"プライバシーポリシー",deletion:"データ削除について",googleLogin:"Googleでログイン",appleLogin:"Appleでログイン"},ko:{heroLeftTop:"구원은 죄가 아니며,",heroLeftMain:"그저 너무 오랫동안 길을 잃었을 뿐이다.",heroLeftSub:"",heroLeftYellow:"들꽃은 용감하게 핀다!",heroRightTop:"새로운 시작을 원해...",heroRightMain:"모든 경험은 독특한 장이며,",heroRightSub:"성장의 장벽이 아니다.",heroRightYellow:"잿더미에서 일어나라!",title:"Restarter™ 회원가입",email:"이메일 *필수",password:"비밀번호 (최소 8자, 영문/숫자 포함) *필수",nickname:"닉네임 (6-16자) *필수",age:"나이*선택",selectAge:"연령대 선택",country:"국가/지역*선택",city:"도시(선택 사항)",interest:"관심사*선택",eventType:"경험한 사건**선택",whatToImprove:"개선하고 싶은 점*선택",uploadAvatar:"아바타 업로드",male:"남성",female:"여성",genderRequired:"(*필수)",register:"🚀 가입하기",registering:"가입 중...",errorAvatar:"아바타를 업로드해주세요.",errorGender:"성별을 선택해주세요.",errorEmailFormat:"유효하지 않은 이메일 형식입니다.",errorPasswordFormat:"비밀번호는 최소 8자 이상이며, 문자와 숫자를 모두 포함해야 합니다.",errorNicknameFormat:"닉네임은 6-16자여야 합니다.",errorAgeFormat:"나이는 18세에서 99세 사이여야 합니다.",errorCountry:"국가를 선택해주세요.",errorRegion:"도시를 입력해주세요.",errorInterest:"관심사를 선택해주세요.",errorEventType:"사건 유형을 선택해주세요.",errorImprovement:"개선할 항목을 선택해주세요.",formTopSlogan:"일어서는 것은 잘못이 아니야!",login:"로그인",terms:"약관/성명서",privacy:"개인정보처리방침",deletion:"데이터 삭제 안내",googleLogin:"Google로 로그인",appleLogin:"Apple로 로그인"},th:{heroLeftTop:"การไถ่บาปไม่ใช่ความผิด",heroLeftMain:"เพียงแค่หลงทางมานานเกินไป",heroLeftSub:"",heroLeftYellow:"ดอกไม้ป่าบานอย่างกล้าหาญ!",heroRightTop:"ฉันต้องการเริ่มต้นใหม่...",heroRightMain:"ทุกประสบการณ์คือบทที่พิเศษ",heroRightSub:"ไม่ใช่อุปสรรคต่อการเติบโต",heroRightYellow:"ลุกขึ้นจากเถ้าถ่าน!",title:"Restarter™ ลงทะเบียน",email:"อีเมล *จำเป็น",password:"รหัสผ่าน (ขั้นต่ำ 8 ตัวอักษร, ประกอบด้วยตัวอักษรและตัวเลข) *จำเป็น",nickname:"ชื่อเล่น (6-16 ตัวอักษร) *จำเป็น",age:"อายุ*ไม่บังคับ",selectAge:"เลือกช่วงอายุ",country:"ประเทศ/ภูมิภาค*ไม่บังคับ",city:"เมือง (ไม่บังคับ)",interest:"ความสนใจ*ไม่บังคับ",eventType:"เหตุการณ์ที่ผ่านมา**ไม่บังคับ",whatToImprove:"สิ่งที่ต้องการปรับปรุง*ไม่บังคับ",uploadAvatar:"อัปโหลดรูปภาพ",male:"ชาย",female:"หญิง",genderRequired:"(*จำเป็น)",register:"🚀 ลงทะเบียน",registering:"กำลังลงทะเบียน...",errorAvatar:"กรุณาอัปโหลดรูปโปรไฟล์",errorGender:"กรุณาเลือกเพศ",errorEmailFormat:"รูปแบบอีเมลไม่ถูกต้อง",errorPasswordFormat:"รหัสผ่านต้องมีความยาวอย่างน้อย 8 ตัวอักษรและมีทั้งตัวอักษรและตัวเลข",errorNicknameFormat:"ชื่อเล่นต้องมีความยาว 6-16 ตัวอักษร",errorAgeFormat:"อายุต้องอยู่ระหว่าง 18 ถึง 99 ปี",errorCountry:"กรุณาเลือกประเทศ",errorRegion:"กรุณากรอกเมือง",errorInterest:"กรุณาเลือกความสนใจ",errorEventType:"กรุณาเลือกประเภทเหตุการณ์",errorImprovement:"กรุณาเลือกรายการที่ต้องการปรับปรุง",formTopSlogan:"การลุกขึ้นสู้ไม่ใช่เรื่องผิด!",login:"เข้าสู่ระบบ",terms:"ข้อกำหนด/คำชี้แจง",privacy:"นโยบายความเป็นส่วนตัว",deletion:"นโยบายการลบข้อมูล",googleLogin:"เข้าสู่ระบบด้วย Google",appleLogin:"เข้าสู่ระบบด้วย Apple"},vi:{heroLeftTop:"Sự chuộc lỗi không phải là tội ác,",heroLeftMain:"chỉ là đi sai đường quá lâu.",heroLeftSub:"",heroLeftYellow:"Hoa dại nở rộ dũng cảm!",heroRightTop:"Tôi muốn một khởi đầu mới...",heroRightMain:"Mỗi trải nghiệm là một chương độc đáo,",heroRightSub:"Không phải là rào cản cho sự phát triển.",heroRightYellow:"Vươn lên từ đống tro tàn!",title:"Đăng ký Restarter™",email:"Email *bắt buộc",password:"Mật khẩu (tối thiểu 8 ký tự, gồm chữ và số) *bắt buộc",nickname:"Biệt danh (6-16 ký tự) *bắt buộc",age:"Tuổi*không bắt buộc",selectAge:"Chọn độ tuổi",country:"Quốc gia/Khu vực*không bắt buộc",city:"Thành phố (tùy chọn)",interest:"Sở thích*không bắt buộc",eventType:"Sự kiện đã trải qua**không bắt buộc",whatToImprove:"Điều muốn cải thiện*không bắt buộc",uploadAvatar:"Tải lên hình đại diện",male:"Nam",female:"Nữ",genderRequired:"(*bắt buộc)",register:"🚀 Đăng ký",registering:"Đang đăng ký...",errorAvatar:"Vui lòng tải lên ảnh đại diện.",errorGender:"Vui lòng chọn giới tính.",errorEmailFormat:"Định dạng email không hợp lệ.",errorPasswordFormat:"Mật khẩu phải dài ít nhất 8 ký tự và chứa cả chữ cái và số.",errorNicknameFormat:"Biệt danh phải dài từ 6-16 ký tự.",errorAgeFormat:"Tuổi phải từ 18 đến 99.",errorCountry:"Vui lòng chọn một quốc gia.",errorRegion:"Vui lòng nhập thành phố.",errorInterest:"Vui lòng chọn một sở thích.",errorEventType:"Vui lòng chọn một loại sự kiện.",errorImprovement:"Vui lòng chọn một mục để cải thiện.",formTopSlogan:"Vươn lên không phải là sai!",login:"Đăng nhập",terms:"Điều khoản/Tuyên bố",privacy:"Chính sách bảo mật",deletion:"Chính sách xóa dữ liệu",googleLogin:"Đăng nhập bằng Google",appleLogin:"Đăng nhập bằng Apple"},ms:{heroLeftTop:"Penebusan bukanlah jenayah,",heroLeftMain:"hanya tersalah jalan terlalu lama.",heroLeftSub:"",heroLeftYellow:"Bunga liar mekar dengan berani!",heroRightTop:"Saya mahu permulaan yang baru...",heroRightMain:"Setiap pengalaman adalah satu bab yang unik,",heroRightSub:"bukan penghalang kepada pertumbuhan.",heroRightYellow:"Bangkit dari abu!",title:"Pendaftaran Restarter™",email:"E-mel *diperlukan",password:"Kata laluan (min 8 aksara, huruf & nombor) *diperlukan",nickname:"Nama samaran (6-16 aksara) *diperlukan",age:"Umur*pilihan",selectAge:"Pilih julat umur",country:"Negara/Wilayah*pilihan",city:"Bandar (pilihan)",interest:"Minat*pilihan",eventType:"Peristiwa Bersejarah**pilihan",whatToImprove:"Apa yang ingin diperbaiki*pilihan",uploadAvatar:"Muat naik gambar profil",male:"Lelaki",female:"Perempuan",genderRequired:"(*diperlukan)",register:"🚀 Daftar",registering:"Mendaftar...",errorAvatar:"Sila muat naik avatar.",errorGender:"Sila pilih jantina.",errorEmailFormat:"Format e-mel tidak sah.",errorPasswordFormat:"Kata laluan mesti sekurang-kurangnya 8 aksara dan mengandungi kedua-dua huruf dan nombor.",errorNicknameFormat:"Nama samaran mestilah 6-16 aksara.",errorAgeFormat:"Umur mestilah antara 18 dan 99.",errorCountry:"Sila pilih negara.",errorRegion:"Sila masukkan bandar.",errorInterest:"Sila pilih minat.",errorEventType:"Sila pilih jenis acara.",errorImprovement:"Sila pilih item untuk diperbaiki.",formTopSlogan:"Bukan salah untuk bangkit!",login:"Log masuk",terms:"Terma/Penyata",privacy:"Dasar Privasi",deletion:"Dasar Pemadaman Data",googleLogin:"Log masuk dengan Google",appleLogin:"Log masuk dengan Apple"},la:{heroLeftTop:"Redemptio non est crimen,",heroLeftMain:"modo errasse diu.",heroLeftSub:"",heroLeftYellow:"Flores feri fortiter efflorescunt!",heroRightTop:"Novum initium volo...",heroRightMain:"Omnis experientia unicum capitulum est,",heroRightSub:"non impedimentum incrementi.",heroRightYellow:"Resurge ex cineribus!",title:"Restarter™ Inscriptio",email:"Email *requiritur",password:"Password (min 8 chars, letter & number) *requiritur",nickname:"Nickname (6-16 chars) *requiritur",age:"Aetas*optio",selectAge:"Selecta aetatis spatium",country:"Patria (Regio)*optio",city:"Urbs (optio)",interest:"Studium*optio",eventType:"Eventus Historiae**optio",whatToImprove:"Quid emendare vis*optio",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"Surgere non est peccatum!",login:"Inire",terms:"Termini/Declaratio",privacy:"Consilium Privacy",deletion:"Norma Deletionis Datae",googleLogin:"Intra cum Google",appleLogin:"Intra cum Apple"}},jT={"zh-TW":"請先補齊個人資料","zh-CN":"请先补齐个人资料",en:"Please complete your profile first",ja:"まずプロフィールを完成させてください",ko:"먼저 프로필을 완성해 주세요",th:"กรุณากรอกข้อมูลส่วนตัวให้ครบก่อน",vi:"Vui lòng hoàn thiện hồ sơ cá nhân trước",ms:"Sila lengkapkan profil anda terlebih dahulu",la:"Quaeso prius profile tuum comple"},ST={"zh-TW":"每一位更生人，都是世界的一員！","zh-CN":"每一位更生人，都是世界的一员！",en:"Every Restarter is still one of us.",ja:"すべての更生者は世界の一員です！",ko:"모든 Restarter는 우리 중 한 명입니다!",th:"ทุกคนที่ถูกกำพฤติกรรมก็ยังเป็นหนึ่งของเรา!",vi:"Mỗi người được định hình đều là một thành viên của chúng tôi!",ms:"Setiap Restarter masih satu di antara kita!",la:"Omnis Restarter adhuc unus ex nobis est."},TT={"zh-TW":"Restarter™ 是更生者的 副駕 / 合作人。","zh-CN":"Restarter™ 是更生者的 副驾 / 合作人。",en:"Restarter™ is a co-pilot/partner for Restarters.",ja:"Restarter™ は更生者の副操縦士・パートナーです。",ko:"Restarter™는 재생자의 부승무 또는 파트너입니다.",th:"Restarter™ เป็นคู่ควบคุมหรือพาร์ทเนอร์สำหรับ Restarters.",vi:"Restarter™ là phi công phụ hoặc đối tác cho Restarters.",ms:"Restarter™ adalah kopilot/pasukan untuk Restarters.",la:"Restarter™ est co-pilotus/socius pro Restarters."},CT={"zh-TW":"Restarter™ 是更生者的情緒管家 / 生產助手","zh-CN":"Restarter™ 是更生者的情绪管家 / 生产助手",en:"Restarter™ is an emotional steward/productivity assistant for Restarters.",ja:"Restarter™ は更生者の感情マネージャー・生産アシスタントです。",ko:"Restarter™는 재생자의 감정 관리자 및 생산 보조자입니다.",th:"Restarter™ เป็นผู้ดูแลอารมณ์และผู้ช่วยในการผลิตสำหรับ Restarters.",vi:"Restarter™ là người quản lý cảm xúc và người trợ giúp sản xuất cho Restarters.",ms:"Restarter™ adalah pengurus emosi / pembantu produktiviti untuk Restarters.",la:"Restarter™ est motus oeconomus/producentis adiutor pro Restarters."},IT={"zh-TW":["經濟","運動","閱讀","電影","旅遊","交友","唱歌","電商","做生意","電腦","AI","寵物","學技能","一個人安靜","其他"],"zh-CN":["经济","运动","阅读","电影","旅游","交友","唱歌","电商","做生意","电脑","AI","宠物","学技能","一个人安静","其他"],en:["Economy","Sports","Reading","Movie","Travel","Friendship","Singing","E-commerce","Business","Computer","AI","Pets","Learning Skills","Quiet time alone","Other"],ja:["経済","スポーツ","読書","映画","旅行","友達","カラオケ","EC","ビジネス","パソコン","AI","ペット","スキル学習","一人で静かに過ごす","その他"],ko:["경제","스포츠","독서","영화","여행","친구 사귀기","노래 부르기","전자상거래","사업","컴퓨터","AI","애완동물","기술 배우기","혼자 조용히 있기","기타"],th:["เศรษฐกิจ","กีฬา","การอ่าน","ภาพยนตร์","การเดินทาง","มิตรภาพ","การร้องเพลง","อีคอมเมิร์ซ","ธุรกิจ","คอมพิวเตอร์","AI","สัตว์เลี้ยง","การเรียนรู้ทักษะ","เวลาเงียบๆคนเดียว","อื่นๆ"],vi:["Kinh tế","Thể thao","Đọc sách","Phim ảnh","Du lịch","Tình bạn","Ca hát","Thương mại điện tử","Kinh doanh","Máy tính","AI","Thú cưng","Học kỹ năng","Ở một mình yên tĩnh","Khác"],ms:["Ekonomi","Sukan","Membaca","Filem","Melancong","Persahabatan","Menyanyi","E-dagang","Perniagaan","Komputer","AI","Haiwan Peliharaan","Belajar Kemahiran","Masa sunyi bersendirian","Lain-lain"],la:["Oeconomia","Ludi","Lectio","Pellicula","Iter","Amicitia","Cantus","E-commercium","Negotium","Computatrum","AI","Animalia Domestica","Discere Artes","Tempus quietum solus","Aliud"]},BT={"zh-TW":["台灣","中國大陸","日本","韓國","馬來西亞","新加坡","印尼","越南","菲律賓","英國","法國","德國","美國","加拿大","非洲","歐洲","南美洲","中東","其他"],"zh-CN":["台湾","中国大陆","日本","韩国","马来西亚","新加坡","印尼","越南","菲律宾","英国","法国","德国","美国","加拿大","非洲","欧洲","南美洲","中东","其他"],en:["Taiwan","China","Japan","Korea","Malaysia","Singapore","Indonesia","Vietnam","Philippines","UK","France","Germany","USA","Canada","Africa","Europe","South America","Middle East","Other"],ja:["台湾","中国","日本","韓国","マレーシア","シンガポール","インドネシア","ベトナム","フィリピン","イギリス","フランス","ドイツ","アメリカ","カナダ","アフリカ","ヨーロッパ","南アメリカ","中東","その他"],ko:["대만","중국","일본","한국","말레이시아","싱가포르","인도네시아","베트남","필리핀","영국","프랑스","독일","미국","캐나다","아프리카","유럽","남아메리카","중동","기타"],th:["ไต้หวัน","จีน","ญี่ปุ่น","เกาหลี","มาเลเซีย","สิงคโปร์","อินโดนีเซีย","เวียดนาม","ฟิลิปปินส์","สหราชอาณาจักร","ฝรั่งเศส","เยอรมนี","สหรัฐอเมริกา","แคนาดา","แอฟริกา","ยุโรป","อเมริกาใต้","ตะวันออกกลาง","อื่นๆ"],vi:["Đài Loan","Trung Quốc","Nhật Bản","Hàn Quốc","Malaysia","Singapore","Indonesia","Việt Nam","Philippines","Anh","Pháp","Đức","Mỹ","Canada","Châu Phi","Châu Âu","Nam Mỹ","Trung Đông","Khác"],ms:["Taiwan","China","Jepun","Korea","Malaysia","Singapura","Indonesia","Vietnam","Filipina","UK","Perancis","Jerman","AS","Kanada","Afrika","Eropah","Amerika Selatan","Timur Tengah","Lain-lain"],la:["Taivania","Sina","Iaponia","Corea","Malaisia","Singapura","Indonesia","Vietnamia","Philippinae","UK","Gallia","Germania","USA","Canada","Africa","Europa","America Meridionalis","Oriens Medius","Aliud"]},RT=["經濟事件","毒品濫用","暴力事件","家暴加害","家暴受害","幫派背景","詐欺相關","竊盜前科","性別/身體創傷","未成年犯罪","長期失業 / 社會邊緣","其他"],AT={"zh-TW":["人際","鬥志","習慣","工作","情緒","自律","其他"],"zh-CN":["人际","斗志","习惯","工作","情绪","自律","其他"],en:["Interpersonal","Motivation","Habits","Work","Emotions","Self-discipline","Other"],ja:["人間関係","闘志","習慣","仕事","感情","自己規律","その他"],ko:["대인관계","투지","습관","업무","감정","자기관리","기타"],th:["ความสัมพันธ์ระหว่างบุคคล","แรงจูงใจ","นิสัย","การงาน","อารมณ์","การมีวินัยในตนเอง","อื่นๆ"],vi:["Quan hệ giữa các cá nhân","Ý chí chiến đấu","Thói quen","Công việc","Cảm xúc","Kỷ luật tự giác","Khác"],ms:["Antara peribadi","Semangat juang","Tabiat","Kerja","Emosi","Disiplin diri","Lain-lain"],la:["Interpersonalis","Animus","Consuetudines","Opus","Affectus","Disciplina sui","Aliud"]},FT=["18-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70+"];function zT(e){if(!e)return null;const t=e.match(/^(Restarter™)(.*)$/);return t?f.jsxs("span",{children:[f.jsx("span",{style:{color:"#fff",fontWeight:700},children:"Restarter™"}),f.jsx("span",{style:{color:"#ffd700",fontWeight:700},children:t[2]})]}):e}function ET({t:t,setShowLogin:n,navigate:i,setShowReset:r}){const[a,o]=e.useState(""),[s,l]=e.useState(""),[c,d]=e.useState("");return f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:200},children:f.jsxs("div",{style:{background:"white",padding:32,borderRadius:16,width:"90%",maxWidth:400,position:"relative",boxShadow:"0 8px 32px #0000004d"},children:[f.jsx("button",{onClick:()=>n(!1),style:{position:"absolute",top:8,right:12,background:"none",border:"none",fontSize:28,cursor:"pointer",color:"#888"},children:"×"}),f.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:24},children:t.login}),c&&f.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:c}),f.jsxs("form",{onSubmit:async e=>{e.preventDefault(),d("");try{const e=await mb(kT,a,s);await e.user.reload(),n(!1),i("/")}catch(t){"auth/user-not-found"===t.code||"auth/wrong-password"===t.code||"auth/invalid-credential"===t.code?d("帳號或密碼錯誤，請重新確認"):"auth/user-disabled"===t.code?d("此帳號已被停用，請聯絡客服"):d(t.message||"登入失敗，請稍後再試")}},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[f.jsx("input",{type:"email",autoComplete:"off",placeholder:t.email,value:a,onChange:e=>o(e.target.value),className:"reg-input",required:!0}),f.jsx("input",{type:"password",autoComplete:"off",placeholder:t.password,value:s,onChange:e=>l(e.target.value),className:"reg-input",required:!0})]}),f.jsx("button",{type:"submit",style:{width:"100%",marginTop:24,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",borderRadius:8,padding:"14px 0",fontSize:18,fontWeight:700,cursor:"pointer"},children:t.login}),f.jsx("div",{style:{textAlign:"right",marginTop:8},children:f.jsx("span",{href:"#",style:{color:"#6B5BFF",fontSize:14,textDecoration:"underline",cursor:"pointer"},onClick:e=>{e.preventDefault(),r(!0)},children:"忘記密碼？"})})]})]})})}const _T={border:"none",borderRadius:28,padding:0,fontSize:16,fontWeight:800,cursor:"pointer",boxShadow:"0 2px 12px #a777e355",display:"flex",alignItems:"center",justifyContent:"center",gap:8,width:"100%",height:"40px"},NT={width:18,height:18,marginRight:6,verticalAlign:"middle"};function PT(){const t=le(),n=oe(),i=new URLSearchParams(n.search),{lang:r,setLang:a}=mw();e.useEffect(()=>{localStorage.setItem("lang",r)},[r]),e.useEffect(()=>{vT(async()=>{const{getAuth:e}=await Promise.resolve().then(()=>Ev);return{getAuth:e}},void 0).then(({getAuth:e})=>{e().currentUser&&t("/")})},[t]),e.useEffect(()=>{(async()=>{try{const{getRedirectResult:e}=await vT(async()=>{const{getRedirectResult:e}=await Promise.resolve().then(()=>Ev);return{getRedirectResult:e}},void 0),n=await e(kT);if(n){await n.user.reload();const e=await Pf(hg(cw,"users",n.user.uid));e.exists()&&e.data()&&e.data().completed?t("/"):t("/CompleteProfile")}}catch(e){}})()},[t]);const o="1"===i.get("needProfile"),s=wT[r],[l,c]=e.useState(""),[d,u]=e.useState(""),[h,p]=e.useState(""),[m,g]=e.useState(""),[x,y]=e.useState(""),[b,v]=e.useState(""),[k,w]=e.useState(""),[j,S]=e.useState(null),[T,C]=e.useState(""),[I,B]=e.useState(""),[R,A]=e.useState(!1),[F,z]=e.useState(""),[E,_]=e.useState(""),[N,P]=e.useState(!1),[D,W]=e.useState(0),[M,L]=e.useState("idle"),[O,q]=e.useState(""),U=e.useRef(null),H=e.useRef(null);e.useEffect(()=>{if(!R)return;const e=setInterval(()=>{W(e=>(e+1)%4)},400);return()=>clearInterval(e)},[R]);const[V,K]=e.useState(!1),[$,G]=e.useState(!1),[Q,Y]=e.useState(!1),[J,X]=e.useState(!1),[Z,ee]=e.useState(""),[te,ne]=e.useState(!1),[ie,re]=e.useState(!1),ae=async()=>{var e,n,i;A(!0);let r=setTimeout(()=>K(!0),1500);try{const e=await pb(kT,l,d);await gb(e.user,{displayName:h});let n="";if(j){const t=ow((a=uw,o=`avatars/${e.user.uid}/${j.name}`,ew(a=ut(a),o)),j);let i=null;await Promise.race([new Promise((e,r)=>{t.on("state_changed",null,e=>{i=e,r(e)},async()=>{var i;n=await(i=t.snapshot.ref,Xk(i=ut(i))),e()})}),new Promise((e,t)=>setTimeout(()=>{i=new Error("頭像上傳逾時，請檢查網路或稍後再試"),t(i)},1e4))]).catch(e=>{throw i||e}),await gb(e.user,{photoURL:n})}await Mf(hg(cw,"profiles",e.user.uid),{nickname:h,email:l,avatar:n,gender:k,country:m,region:x,age:b,interest:F,improvement:E,createdAt:new Date,updatedAt:new Date}),localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),A(!1),clearTimeout(r),K(!1),t("/")}catch(s){(null==(e=null==s?void 0:s.message)?void 0:e.includes("Failed to fetch"))||(null==(n=null==s?void 0:s.message)?void 0:n.includes("NetworkError"))||(null==(i=null==s?void 0:s.message)?void 0:i.includes("ECONNREFUSED"))?B("伺服器連線失敗，請稍後再試或聯絡管理員"):B((null==s?void 0:s.message)||"註冊失敗，請稍後再試"),A(!1),clearTimeout(r),K(!1)}var a,o};n.pathname;const[se,ce]=e.useState(!1),[de,ue]=e.useState(""),[he,pe]=e.useState("");return f.jsxs("div",{style:{minHeight:"100vh",background:"#fff",position:"relative"},children:[o&&f.jsx("div",{style:{position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",fontSize:22,color:"#374151",fontWeight:600,textAlign:"center"},children:jT[r]||jT["zh-TW"]}),f.jsx("div",{style:{position:"relative"},children:f.jsxs("div",{style:{minHeight:"100vh",background:"url('/city-blur.jpg') center/cover no-repeat",position:"relative",display:"flex",flexDirection:"column"},children:[window.innerWidth<=768?f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:16,left:16,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",height:"36px"},onMouseEnter:e=>{e.currentTarget.style.background="#667eea",e.currentTarget.style.color="#fff",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255,255,255,0.9)",e.currentTarget.style.color="#667eea",e.currentTarget.style.transform="translateY(0)"},children:["← ","zh-TW"===r||"zh-CN"===r?"返回":"en"===r?"Back":"ja"===r?"戻る":"ko"===r?"돌아가기":"vi"===r?"Quay Lại":"th"===r?"กลับ":"la"===r?"Regredi":"ms"===r?"Kembali":"Back"]}),f.jsx("div",{style:{position:"fixed",top:16,right:16,zIndex:1e3},children:f.jsx(fw,{style:{background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",width:"60px",minWidth:"60px",maxWidth:"60px",height:"36px",cursor:"pointer"}})}),f.jsx("div",{style:{position:"fixed",top:60,left:"50%",transform:"translateX(-50%)",zIndex:100},children:f.jsx("span",{style:{fontWeight:900,fontSize:18,color:"#ffd700",letterSpacing:1,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",lineHeight:"1.2",marginLeft:"8px"},children:ST[r]})})]}):f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:24,left:24,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onMouseEnter:e=>{e.currentTarget.style.background="#667eea",e.currentTarget.style.color="#fff",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255,255,255,0.9)",e.currentTarget.style.color="#667eea",e.currentTarget.style.transform="translateY(0)"},children:"zh-TW"===r||"zh-CN"===r?"返回":"en"===r?"Back":"ja"===r?"戻る":"ko"===r?"돌아가기":"vi"===r?"Quay Lại":"th"===r?"กลับ":"la"===r?"Regredi":"ms"===r?"Kembali":"Back"}),f.jsx("div",{style:{position:"fixed",top:24,left:"50%",transform:"translateX(-50%)",zIndex:100},children:f.jsx("span",{style:{fontWeight:900,fontSize:24,color:"#ffd700",letterSpacing:2,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",marginLeft:"12px"},children:ST[r]})}),f.jsxs("select",{value:window.lang||"zh-TW",onChange:e=>{const t=e.target.value;window.lang=t,localStorage.setItem("lang",t),window.location.reload()},style:{position:"fixed",top:24,right:120,zIndex:10001,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",width:"80px",minWidth:"80px",maxWidth:"80px",outline:"none"},onMouseEnter:e=>{e.currentTarget.style.background="#667eea",e.currentTarget.style.color="#fff",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255,255,255,0.9)",e.currentTarget.style.color="#667eea",e.currentTarget.style.transform="translateY(0)"},children:[f.jsx("option",{value:"zh-TW",children:"繁中"}),f.jsx("option",{value:"zh-CN",children:"简中"}),f.jsx("option",{value:"en",children:"English"}),f.jsx("option",{value:"ja",children:"日本語"}),f.jsx("option",{value:"ko",children:"한국어"}),f.jsx("option",{value:"vi",children:"Tiếng Việt"}),f.jsx("option",{value:"th",children:"ไทย"}),f.jsx("option",{value:"la",children:"Latin"}),f.jsx("option",{value:"ms",children:"Bahasa Melayu"})]})]}),f.jsxs("div",{style:{display:"flex",flex:1,minHeight:"100vh",alignItems:"stretch",justifyContent:"center",width:"100%",marginTop:window.innerWidth<=768?120:60,flexDirection:window.innerWidth<=768?"column":"row"},children:[f.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[f.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:f.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:zT(TT[r])})}),f.jsx("img",{src:"/left-hero.png",alt:"left hero",style:{width:300,maxWidth:"98%",objectFit:"contain"}}),f.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[f.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:[s.heroLeftTop,f.jsx("br",{}),s.heroLeftMain,f.jsx("br",{}),s.heroLeftSub]}),f.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:s.heroLeftYellow})]})]}),N&&f.jsx(ET,{t:s,setShowLogin:P,navigate:t,setShowReset:ce}),f.jsx("div",{style:{flex:window.innerWidth<=768?"1":"0 1 500px",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"10px":"20px 0",width:window.innerWidth<=768?"100%":"auto"},children:f.jsxs("form",{onSubmit:async e=>{e.preventDefault(),B(""),K(!1);let t=setTimeout(()=>K(!0),1500);try{if(!j)return void B(s.errorAvatar);if(!k)return void B(s.errorGender);if(!function(e){return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)}(l))return void B(s.errorEmailFormat);if(!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(d))return void B(s.errorPasswordFormat);if(!(n=h)||""===n.trim())return void B(s.errorNicknameFormat);if(!b)return void B(s.errorAgeFormat);if(!m)return void B(s.errorCountry);Y(!0);const e={nickname:h,password:d,gender:k,country:m,region:x,age:b,interest:F,improvement:E},i=await fetch(ww("/email-verification/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,registrationData:e})}),r=await i.json();if(!r.success)throw new Error(r.error||"生成驗證碼失敗");ne(!0),X(!0),G(!1),ee(""),Y(!1),clearTimeout(t),K(!1),B("")}catch(i){B(i.message||"註冊失敗，請稍後再試"),Y(!1),clearTimeout(t),K(!1)}var n},style:{background:"#ffffffcc",borderRadius:20,padding:window.innerWidth<=768?"20px 16px":"24px 32px",width:"100%",maxWidth:window.innerWidth<=768?"100%":500,boxShadow:"0 8px 32px #0000004d",position:"relative",boxSizing:"border-box",margin:window.innerWidth<=768?"0 10px":"0"},children:[f.jsx("img",{src:"/ctx-logo.png",alt:"Logo",style:{width:window.innerWidth<=768?60:100,height:window.innerWidth<=768?60:100,position:"absolute",top:5,left:5,zIndex:0,opacity:1}}),f.jsxs("div",{style:{position:"relative",zIndex:1},children:[f.jsx("div",{style:{width:"100%",textAlign:"center",fontWeight:900,fontSize:window.innerWidth<=768?20:26,color:"#ffd700",marginBottom:8,textShadow:"0 2px 4px #00000055"},children:s.formTopSlogan}),f.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:16,fontSize:window.innerWidth<=768?24:28,fontWeight:800},children:s.title}),I&&f.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:I}),J&&f.jsxs("div",{style:{background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",color:"white",padding:"16px",borderRadius:"12px",marginBottom:"1rem",textAlign:"center",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:[f.jsx("div",{style:{fontSize:"20px",marginBottom:"8px"},children:"📧"}),f.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"請輸入驗證碼"}),f.jsxs("div",{style:{fontSize:"14px",marginBottom:"12px"},children:["驗證碼已發送到 ",l]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[f.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:Z,onChange:e=>ee(e.target.value),placeholder:"請輸入 6 位數驗證碼",disabled:R,style:{width:"150px",padding:"8px 12px",borderRadius:"6px",border:"none",fontSize:"16px",textAlign:"center",opacity:R?.6:1,cursor:R?"not-allowed":"text"},maxLength:6}),f.jsx("button",{type:"button",onClick:async()=>{if(Z){A(!0),B("");try{const e=await fetch(ww("/email-verification/verify-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,code:Z})}),t=await e.json();t.success?await ae():(A(!1),B(t.error||"驗證失敗"))}catch(e){A(!1),B(e.message||"驗證失敗，請稍後再試")}}else B("請輸入驗證碼")},disabled:!Z||6!==Z.length||R,style:{background:R?"#6b7280":Z&&6===Z.length?"#10b981":"#6b7280",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",cursor:Z&&6===Z.length&&!R?"pointer":"not-allowed",transition:"all 0.2s ease",transform:(Z&&Z.length,"scale(1)"),boxShadow:Z&&6===Z.length&&!R?"0 2px 8px rgba(16, 185, 129, 0.3)":"none"},onMouseEnter:e=>{Z&&6===Z.length&&!R&&(e.currentTarget.style.background="#059669",e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.4)")},onMouseLeave:e=>{Z&&6===Z.length&&!R&&(e.currentTarget.style.background="#10b981",e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 8px rgba(16, 185, 129, 0.3)")},onMouseDown:e=>{Z&&6===Z.length&&!R&&(e.currentTarget.style.transform="scale(0.95)")},onMouseUp:e=>{Z&&6===Z.length&&!R&&(e.currentTarget.style.transform="scale(1.05)")},children:R?"驗證中...":"驗證並註冊"})]}),f.jsx("button",{type:"button",onClick:async()=>{re(!0),B("");try{const e={nickname:h,password:d,gender:k,country:m,region:x,age:b,interest:F,improvement:E},t=await fetch(ww("/email-verification/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,registrationData:e})}),n=await t.json();n.success?(ee(""),B("已重新發送驗證碼，請輸入新的驗證碼"),X(!0),G(!1)):B(n.error||"重發驗證碼失敗")}catch(e){B("重發驗證碼失敗，請稍後再試")}finally{re(!1)}},disabled:ie,style:{background:ie?"#6b7280":"#3b82f6",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",cursor:ie?"not-allowed":"pointer",transition:"all 0.2s ease",transform:"scale(1)",boxShadow:ie?"none":"0 2px 8px rgba(59, 130, 246, 0.3)"},onMouseEnter:e=>{ie||(e.currentTarget.style.background="#2563eb",e.currentTarget.style.transform="scale(1.05)",e.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.4)")},onMouseLeave:e=>{ie||(e.currentTarget.style.background="#3b82f6",e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 2px 8px rgba(59, 130, 246, 0.3)")},onMouseDown:e=>{ie||(e.currentTarget.style.transform="scale(0.95)")},onMouseUp:e=>{ie||(e.currentTarget.style.transform="scale(1.05)")},children:ie?"重發中...":"重發驗證碼"})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",width:"100%",minWidth:0},children:[f.jsx("input",{type:"text",style:{display:"none"},autoComplete:"username"}),f.jsx("input",{type:"password",style:{display:"none"},autoComplete:"current-password"}),f.jsx("input",{type:"email",autoComplete:"new-password",placeholder:s.email,value:l,onChange:e=>c(e.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),f.jsx("input",{type:"password",autoComplete:"new-password",placeholder:s.password,value:d,onChange:e=>u(e.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),f.jsx("input",{type:"text",autoComplete:"off",placeholder:s.nickname,value:h,onChange:e=>{p(e.target.value),L("idle"),q("")},onBlur:async function(){var e,t;if(!(null==(t=null==(e=U.current)?void 0:e.value)?void 0:t.trim()))return L("invalid"),q("請輸入暱稱"),void setTimeout(()=>{var e;null==(e=U.current)||e.focus()},100);L("ok"),q("你的名稱非常好👍"),setTimeout(()=>{var e;null==(e=H.current)||e.focus()},200)},className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:"#888"},required:!0,ref:U}),O&&f.jsx("div",{style:{gridColumn:"1 / -1",color:"ok"===M?"#1a7f1a":"invalid"===M||"exists"===M?"red":"#333",fontSize:14,marginTop:-8,marginBottom:4},children:O}),f.jsxs("select",{value:b,onChange:e=>v(e.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:b?"#333":"#888",background:"#fff"},required:!0,children:[f.jsx("option",{value:"",style:{color:"#888"},children:s.selectAge}),FT.map(e=>f.jsx("option",{value:e,children:e},e))]}),f.jsxs("select",{value:m,onChange:e=>g(e.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:m?"#333":"#888",background:"#fff"},required:!0,children:[f.jsx("option",{value:"",style:{color:"#888"},children:s.country}),(BT[r]||[]).map(e=>f.jsx("option",{value:e,children:e},e))]}),f.jsx("input",{type:"text",placeholder:s.city,value:x,onChange:e=>y(e.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"}}),f.jsxs("select",{value:F,onChange:e=>z(e.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:F?"#333":"#888",background:"#fff"},children:[f.jsx("option",{value:"",style:{color:"#888"},children:s.interest}),(IT[r]||[]).map(e=>f.jsx("option",{value:e,children:e},e))]}),f.jsxs("select",{value:E,onChange:e=>_(e.target.value),className:"reg-input",style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:E?"#333":"#888",background:"#fff"},children:[f.jsx("option",{value:"",style:{color:"#888"},children:s.whatToImprove}),(AT[r]||[]).map(e=>f.jsx("option",{value:e,children:e},e))]}),f.jsx("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:8},children:f.jsxs("label",{htmlFor:"avatar-upload",style:{cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[f.jsx("div",{style:{width:64,height:64,borderRadius:"50%",overflow:"hidden",background:"#eee",border:"2px solid #b6b6f6",marginBottom:4},children:T?f.jsx("img",{src:T,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):f.jsx("span",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:32},children:"+"})}),f.jsx("span",{style:{color:"#6B5BFF",fontWeight:700,fontSize:15},children:s.uploadAvatar}),f.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:e=>{if(e.target.files&&e.target.files[0]){S(e.target.files[0]);const t=new FileReader;t.onload=e=>{var t;return C(null==(t=e.target)?void 0:t.result)},t.readAsDataURL(e.target.files[0])}}})]})}),f.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:18,justifyContent:"center",marginBottom:8},children:[f.jsx("span",{style:{fontWeight:600,color:"#6B5BFF",fontSize:15},children:s.genderRequired}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[f.jsx("input",{type:"radio",name:"gender",value:"male",checked:"male"===k,onChange:()=>w("male"),required:!0}),f.jsx("span",{children:s.male})]}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[f.jsx("input",{type:"radio",name:"gender",value:"female",checked:"female"===k,onChange:()=>w("female"),required:!0}),f.jsx("span",{children:s.female})]})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:8,margin:"16px 0 8px 0"},children:[$?f.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[f.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[f.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"4px"},children:"📧 確認郵件已發送到您的 email"}),f.jsx("p",{style:{color:"#666",fontSize:"14px"},children:"請檢查您的收件匣並點擊確認連結完成註冊"})]}),f.jsxs("div",{style:{background:"#f8f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #e0e7ff",textAlign:"center"},children:[f.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"8px"},children:"📬 請查看您的 email"}),f.jsxs("p",{style:{color:"#666",fontSize:"14px",marginBottom:"12px"},children:["我們已發送確認郵件到：",f.jsx("strong",{children:l})]}),f.jsx("p",{style:{color:"#666",fontSize:"12px"},children:"點擊郵件中的「✅ 確認註冊」按鈕即可完成註冊"})]}),f.jsx("button",{type:"button",onClick:()=>{G(!1),B("")},style:{..._T,background:"#f5f5f5",color:"#666",border:"1px solid #ddd",width:"120px"},children:"🔄 重新發送"})]}):f.jsxs("button",{type:"submit",disabled:R||Q,style:{..._T,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",opacity:R||Q?.6:1,cursor:R||Q?"not-allowed":"pointer"},children:[R?f.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:[s.registering,".".repeat(D+1)]}):Q?f.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:"註冊中..."}):f.jsx("span",{style:{marginRight:10},children:"🚀"}),!R&&!Q&&s.register]}),f.jsxs("button",{type:"button",onClick:()=>P(!0),disabled:R,style:{..._T,background:"linear-gradient(90deg, #89f7fe, #66a6ff)",color:"white",opacity:R?.6:1,cursor:R?"not-allowed":"pointer"},children:[f.jsx("span",{style:{marginRight:10},children:"🔑"}),s.login]}),f.jsxs("button",{type:"button",onClick:async()=>{const e=new tb;try{A(!0),K(!1);let n=setTimeout(()=>K(!0),1500);let i;if(!(window.innerWidth<=768))return i=await Gb(kT,e),clearTimeout(n),K(!1),A(!1),void t("/");i=await Gb(kT,e),clearTimeout(n),K(!1),A(!1),t("/")}catch(n){A(!1),K(!1);let e="Google 登入失敗："+n.message;"auth/popup-closed-by-user"===n.code?e="登入視窗被關閉，請重新嘗試":"auth/popup-blocked"===n.code?e="登入視窗被瀏覽器阻擋，請允許彈出視窗後重新嘗試":"auth/network-request-failed"===n.code?e="網路連線失敗，請檢查網路後重新嘗試":"auth/too-many-requests"===n.code&&(e="登入嘗試過於頻繁，請稍後再試"),alert(e)}},disabled:R,style:{..._T,background:"#fff",color:"#333",opacity:R?.6:1,cursor:R?"not-allowed":"pointer"},children:[f.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",style:NT}),s.googleLogin]}),f.jsxs("button",{type:"button",onClick:async()=>{const e=new Zy("apple.com");try{const n=(await Gb(kT,e)).user;await n.reload();const i=await Pf(hg(cw,"users",n.uid));i.exists()&&i.data()&&i.data().completed?t("/"):t("/CompleteProfile")}catch(n){let e="Apple 登入失敗："+n.message;"auth/popup-closed-by-user"===n.code?e="登入視窗被關閉，請重新嘗試":"auth/popup-blocked"===n.code?e="登入視窗被瀏覽器阻擋，請允許彈出視窗後重新嘗試":"auth/network-request-failed"===n.code?e="網路連線失敗，請檢查網路後重新嘗試":"auth/too-many-requests"===n.code&&(e="登入嘗試過於頻繁，請稍後再試"),alert(e)}},disabled:R,style:{..._T,background:"#000",color:"#fff",opacity:R?.6:1,cursor:R?"not-allowed":"pointer"},children:[f.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg",alt:"Apple",style:{...NT,filter:"invert(1)"}}),s.appleLogin]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:24,gap:8,flexDirection:"row",textAlign:"center",fontSize:12,flexWrap:"nowrap",overflow:"hidden"},children:[f.jsx("span",{onClick:()=>t("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap",padding:"4px 8px",cursor:"pointer"},children:s.privacy||"隱私權政策"}),f.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),f.jsx("button",{type:"button",onClick:()=>t("/terms"),style:{background:"none",border:"none",color:"#666",textDecoration:"underline",cursor:"pointer",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:s.terms}),f.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),f.jsx("span",{onClick:()=>t("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap",padding:"4px 8px",cursor:"pointer"},children:s.deletion||"資料刪除說明"})]})]})]})}),f.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[f.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:f.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:zT(CT[r])})}),f.jsx("img",{src:"/right-hero.png",alt:"right hero",style:{width:280,maxWidth:"98%",objectFit:"contain"}}),f.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[f.jsx("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:s.heroRightMain}),f.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:s.heroRightYellow})]})]})]}),f.jsx("div",{style:{position:"fixed",bottom:10,left:36,color:"#fff",textShadow:"0 1px 2px #000",fontSize:14,zIndex:10},children:"CTX Goodlife Copyright 2025"})]})}),se&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[f.jsx("button",{type:"button",onClick:()=>ce(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),f.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:"重設密碼"}),f.jsx("input",{type:"email",value:de,onChange:e=>ue(e.target.value),placeholder:"請輸入註冊時的 email",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15}}),f.jsx("button",{onClick:async()=>{pe("");try{await hb(kT,de),pe("已寄出密碼重設信，請到信箱收信！")}catch{pe("發送失敗，請確認 email 是否正確")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"發送重設信"}),he&&f.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:he})]})}),V&&f.jsx("div",{style:{color:"#ff9800",textAlign:"center",marginTop:8,fontWeight:600},children:"網路較慢，請耐心等候..."})]})}const DT={"zh-TW":{back:"← 返回上一頁",title:"我的連結",chat:"進入聊天",task:"共修任務",noLink:"目前沒有已建立的連結",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"我的连接",chat:"进入聊天",task:"共修任务",noLink:"目前没有已建立的连接",goal:"目标："},en:{back:"← Back",title:"My Links",chat:"Chat",task:"Co-Task",noLink:"No links established",goal:"Goal: "},ja:{back:"← 前のページへ",title:"私のリンク",chat:"チャットへ",task:"共修タスク",noLink:"まだリンクがありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"내 링크",chat:"채팅하기",task:"공동 작업",noLink:"아직 연결된 링크가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"ลิงก์ของฉัน",chat:"แชท",task:"งานร่วมกัน",noLink:"ยังไม่มีลิงก์ที่สร้างขึ้น",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Liên kết của tôi",chat:"Trò chuyện",task:"Nhiệm vụ chung",noLink:"Chưa có liên kết nào",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Pautan Saya",chat:"Sembang",task:"Tugas Bersama",noLink:"Belum ada pautan yang dibuat",goal:"Matlamat: "},la:{back:"← Redire",title:"Nexus Mei",chat:"Colloquium",task:"Munus Commune",noLink:"Nullae nexus constitutae",goal:"Propositum: "}},WT={"zh-TW":{connected:"已配對",pending:"等待對方回覆",rejected:"已拒絕"},"zh-CN":{connected:"已配对",pending:"等待对方回复",rejected:"已拒绝"},en:{connected:"Connected",pending:"Pending",rejected:"Rejected"},ja:{connected:"マッチ済み",pending:"返事待ち",rejected:"拒否されました"},ko:{connected:"연결됨",pending:"대기 중",rejected:"거절됨"},th:{connected:"เชื่อมต่อแล้ว",pending:"รอการตอบกลับ",rejected:"ถูกปฏิเสธ"},vi:{connected:"Đã kết nối",pending:"Đang chờ",rejected:"Đã bị từ chối"},ms:{connected:"Telah dihubungkan",pending:"Menunggu",rejected:"Ditolak"},la:{connected:"Coniunctus",pending:"Exspectans",rejected:"Reiectus"}},MT={"zh-TW":"解除連結","zh-CN":"解除连接",en:"Remove",ja:"リンク解除",ko:"연결 해제",th:"ยกเลิกการเชื่อมต่อ",vi:"Hủy liên kết",ms:"Buang Pautan",la:"Remove"},LT={"zh-TW":"取消邀請","zh-CN":"取消邀请",en:"Cancel Invite",ja:"招待をキャンセル",ko:"초대 취소",th:"ยกเลิกคำเชิญ",vi:"Hủy lời mời",ms:"Batal Jemputan",la:"Invitationem Remove"};function OT(t){const n=le(),{lang:i,setLang:r}=mw(),[a,o]=e.useState([]),[s,l]=e.useState(null),[c,d]=e.useState(!0),[u,h]=e.useState(null),[p,m]=e.useState(null),g=i;e.useEffect(()=>{const e=yb(dw,async e=>{e?(l(e),await x(e.uid)):n("/")});return()=>e()},[n]);const x=async e=>{try{d(!0);const t=ug(cw,"links"),n=hf(t,mf("user1Id","==",e)),i=hf(t,mf("user2Id","==",e)),[r,a]=await Promise.all([Wf(n),Wf(i)]),s=[];r.forEach(e=>{const t=e.data();s.push({id:e.id,...t})}),a.forEach(e=>{const t=e.data();s.push({id:e.id,user1Id:t.user2Id,user1Name:t.user2Name,user2Id:t.user1Id,user2Name:t.user1Name,role:t.role,goal:t.goal,status:t.status,createdAt:t.createdAt})}),o(s),d(!1)}catch(t){d(!1)}};return c?f.jsx("div",{style:t.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):f.jsxs("div",{style:t.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!t.embedded&&f.jsx("button",{onClick:()=>n("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:DT[g].back}),!t.embedded&&f.jsx(fw,{}),f.jsxs("div",{style:{maxWidth:500,margin:t.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:t.embedded?"none":"0 2px 8px #0001",padding:32},children:[f.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:DT[g].title}),0===a.length&&f.jsx("div",{style:{color:"#888"},children:DT[g].noLink}),a.map(e=>f.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16,opacity:"rejected"===e.status?.5:1},children:[f.jsxs("div",{style:{fontWeight:600},children:[e.user2Name,"（",e.role,"）"]}),f.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[DT[g].goal,e.goal]}),f.jsx("div",{style:{color:"connected"===e.status?"#23c6e6":"pending"===e.status?"#e6b800":"#e4572e",fontWeight:700,marginBottom:8},children:WT[g][e.status]}),f.jsxs("div",{style:{display:"flex",gap:12},children:["connected"===e.status&&f.jsx("button",{onClick:()=>n("/chatroom"),style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:DT[g].chat}),"connected"===e.status&&f.jsx("button",{onClick:()=>h(e.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:MT[g]}),"pending"===e.status&&f.jsx("button",{onClick:()=>m(e.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:LT[g]})]})]},e.id))]}),u&&f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[f.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:MT[g]}),f.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[f.jsx("button",{onClick:()=>h(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),f.jsx("button",{onClick:()=>(async e=>{try{await Of(hg(cw,"links",e)),h(null),alert(MT[g]+" 成功！")}catch(t){alert("操作失敗")}})(u),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:MT[g]})]})]})}),p&&f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[f.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:LT[g]}),f.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[f.jsx("button",{onClick:()=>m(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),f.jsx("button",{onClick:()=>(async e=>{try{await Of(hg(cw,"links",e)),m(null),alert(LT[g]+" 成功！")}catch(t){alert("操作失敗")}})(p),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:LT[g]})]})]})})]})}const qT={"zh-TW":{back:"← 返回上一頁",title:"邀請通知",accept:"接受",reject:"拒絕",noInvite:"目前沒有新的邀請",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"邀请通知",accept:"接受",reject:"拒绝",noInvite:"目前没有新的邀请",goal:"目标："},en:{back:"← Back",title:"Invitations",accept:"Accept",reject:"Reject",noInvite:"No new invitations",goal:"Goal: "},ja:{back:"← 前のページへ",title:"招待通知",accept:"承認",reject:"拒否",noInvite:"新しい招待はありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"초대 알림",accept:"수락",reject:"거절",noInvite:"새 초대가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"การแจ้งเตือนคำเชิญ",accept:"ยอมรับ",reject:"ปฏิเสธ",noInvite:"ไม่มีคำเชิญใหม่",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Thông báo mời",accept:"Chấp nhận",reject:"Từ chối",noInvite:"Không có lời mời mới",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Notis Jemputan",accept:"Terima",reject:"Tolak",noInvite:"Tiada jemputan baru",goal:"Matlamat: "},la:{back:"← Redire",title:"Notitia Invitationis",accept:"Accipe",reject:"Reici",noInvite:"Nullae invitationes novae",goal:"Propositum: "}};function UT(t){const[n,i]=e.useState([]),{lang:r,setLang:a}=mw(),[o,s]=e.useState(null),[l,c]=e.useState(!0),[d,u]=e.useState(null),h=le();e.useEffect(()=>{let e;const t=yb(dw,async t=>{t?(s(t),e=await p(t.uid)):h("/")});return()=>{t(),e&&e()}},[h]);const p=async e=>{try{c(!0);const t=hf(ug(cw,"invites"),mf("toUserId","==",e),mf("status","==","pending"));return Uf(t,e=>{const t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})}),i(t),c(!1)})}catch(t){return void c(!1)}},m=async(e,t)=>{if(o)try{const i=hg(cw,"invites",e);if(t){await Lf(i,{status:"accepted"});const t=n.find(t=>t.id===e);t&&await qf(ug(cw,"links"),{user1Id:t.fromUserId,user1Name:t.fromUserName,user2Id:t.toUserId,user2Name:t.toUserName,role:t.role,goal:t.goal,status:"connected",createdAt:new Date}),u(qT[r].accept+" 成功！"),setTimeout(()=>u(null),2e3)}else await Lf(i,{status:"rejected"}),u(qT[r].reject+" 成功！"),setTimeout(()=>u(null),2e3)}catch(i){alert("操作失敗")}};return l?f.jsx("div",{style:t.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):l||0!==n.length?f.jsxs("div",{style:t.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[d&&f.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:d}),!t.embedded&&f.jsx("button",{onClick:()=>h("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:qT[r].back}),f.jsx(fw,{}),f.jsxs("div",{style:{maxWidth:500,margin:t.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:t.embedded?"none":"0 2px 8px #0001",padding:32},children:[f.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:qT[r].title}),n.map(e=>f.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16},children:[f.jsxs("div",{style:{fontWeight:600},children:[e.fromUserName," 邀請你成為 ",e.role]}),f.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[qT[r].goal,e.goal]}),f.jsx("button",{onClick:()=>m(e.id,!0),style:{marginRight:12,background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:qT[r].accept}),f.jsx("button",{onClick:()=>m(e.id,!1),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:qT[r].reject})]},e.id))]})]}):f.jsxs("div",{style:t.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!t.embedded&&f.jsx("button",{onClick:()=>h("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:qT[r].back}),f.jsx(fw,{}),f.jsxs("div",{style:{maxWidth:500,margin:t.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:t.embedded?"none":"0 2px 8px #0001",padding:32},children:[f.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:qT[r].title}),f.jsx("div",{style:{color:"#888",textAlign:"center",fontSize:18},children:qT[r].noInvite})]})]})}const HT={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"【破繭重生】夥伴計畫","zh-CN":"【破茧重生】伙伴计划",ja:"【再出発】パートナー計画",en:"Project Butterfly",ko:"【새출발】 파트너 계획",th:"【เกิดใหม่】แผนพันธมิตร",vi:"【Tái sinh】Kế hoạch đối tác",ms:"【Lahir Semula】Rancangan Rakan Kongsi",la:"【Renascitur】Propositum Socius"},editProfile:{"zh-TW":"編輯我的檔案","zh-CN":"编辑我的档案",ja:"プロフィール編集",en:"Edit My Profile",ko:"내 프로필 편집",th:"แก้ไขโปรไฟล์ของฉัน",vi:"Chỉnh sửa hồ sơ của tôi",ms:"Sunting Profil Saya",la:"Meum Profilum Muta"},partnerRoleTitle:{"zh-TW":"我想尋找的夥伴角色","zh-CN":"我想寻找的伙伴角色",ja:"探している仲間",en:"I'm looking for a",ko:"찾고 있는 파트너 역할",th:"บทบาทพันธมิตรที่ฉันมองหา",vi:"Vai trò đối tác tôi đang tìm",ms:"Peranan Rakan Kongsi Yang Saya Cari",la:"Partem Socii Quam Quæro"},peer:{"zh-TW":"同行者","zh-CN":"同行者",ja:"同じ道の仲間",en:"Peer",ko:"동행자",th:"เพื่อนร่วมทาง",vi:"Bạn đồng hành",ms:"Rakan Sebaya",la:"Par"},mentor:{"zh-TW":"生命導師","zh-CN":"生命导师",ja:"人生の師",en:"Mentor",ko:"인생 멘토",th:"ที่ปรึกษาชีวิต",vi:"Người hướng dẫn",ms:"Mentor Kehidupan",la:"Mentor"},skillPartner:{"zh-TW":"技能夥伴","zh-CN":"技能伙伴",ja:"スキル仲間",en:"Skill Partner",ko:"기술 파트너",th:"พันธมิตรด้านทักษะ",vi:"Đối tác kỹ năng",ms:"Rakan Kemahiran",la:"Socius Peritiae"},mainGoalTitle:{"zh-TW":"我的主要目標","zh-CN":"我的主要目标",ja:"私の主な目標",en:"My Main Goal",ko:"나의 주요 목표",th:"เป้าหมายหลักของฉัน",vi:"Mục tiêu chính của tôi",ms:"Matlamat Utama Saya",la:"Meum Propositum Principale"},allGoals:{"zh-TW":"所有目標","zh-CN":"所有目标",ja:"すべての目標",en:"All Goals",ko:"모든 목표",th:"เป้าหมายทั้งหมด",vi:"Tất cả mục tiêu",ms:"Semua Matlamat",la:"Omnia Proposita"},goalLabel:{"zh-TW":"目標","zh-CN":"目标",ja:"目標",en:"Goal",ko:"목표",th:"เป้าหมาย",vi:"Mục tiêu",ms:"Matlamat",la:"Propositum"},goalOptions:{jobSeeking:{"zh-TW":"尋找工作","zh-CN":"寻找工作",en:"Job Seeking",ja:"仕事探し",ko:"구직",th:"หางาน",vi:"Tìm việc",ms:"Mencari Kerja",la:"Quaerere Opus"},learnNewSkills:{"zh-TW":"學習新技能","zh-CN":"学习新技能",en:"Learn New Skills",ja:"新しいスキルを学ぶ",ko:"새로운 기술 배우기",th:"เรียนรู้ทักษะใหม่",vi:"Học kỹ năng mới",ms:"Belajar Kemahiran Baru",la:"Disce Novas Artes"},emotionalSupport:{"zh-TW":"情緒支持","zh-CN":"情绪支持",en:"Emotional Support",ja:"心のサポート",ko:"정서적 지원",th:"การสนับสนุนทางอารมณ์",vi:"Hỗ trợ tinh thần",ms:"Sokongan Emosi",la:"Auxilium Emotionale"},networking:{"zh-TW":"建立人脈","zh-CN":"建立人脉",en:"Networking",ja:"人脈作り",ko:"네트워킹",th:"สร้างเครือข่าย",vi:"Xây dựng mạng lưới",ms:"Rangkaian",la:"Nexus Creare"},startupPrep:{"zh-TW":"創業準備","zh-CN":"创业准备",en:"Startup Prep",ja:"起業準備",ko:"창업 준비",th:"เตรียมตัวเริ่มต้นธุรกิจ",vi:"Chuẩn bị khởi nghiệp",ms:"Persediaan Permulaan",la:"Praeparatio Negotii"}},pass:{"zh-TW":"跳過","zh-CN":"跳过",ja:"スキップ",en:"Pass",ko:"건너뛰기",th:"ข้าม",vi:"Bỏ qua",ms:"Langkau",la:"Transilire"},like:{"zh-TW":"建立連結","zh-CN":"建立连结",ja:"繋がる",en:"Connect",ko:"연결하기",th:"เชื่อมต่อ",vi:"Kết nối",ms:"Berhubung",la:"Coniungere"},noMoreUsers:{"zh-TW":"目前沒有更多夥伴了，請稍後再試。","zh-CN":"目前没有更多伙伴了，请稍后再试。",ja:"現在、他の仲間はいません。後でもう一度お試しください。",en:"No more partners for now. Please try again later.",ko:"지금은 더 이상 파트너가 없습니다. 나중에 다시 시도해주세요.",th:"ไม่มีพันธมิตรเพิ่มเติมในขณะนี้ กรุณาลองใหม่อีกครั้งในภายหลัง",vi:"Hiện tại không có đối tác nào khác. Vui lòng thử lại sau.",ms:"Tiada lagi rakan kongsi buat masa ini. Sila cuba lagi nanti.",la:"Nulli socii nunc. Quaeso, postea iterum conare."},profileModal:{nameLabel:{"zh-TW":"暱稱 / Name","zh-CN":"昵称 / Name",en:"Name",ja:"ニックネーム",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Panggilan",la:"Nomen"},bioLabel:{"zh-TW":"簡介 / Bio","zh-CN":"简介 / Bio",en:"Bio",ja:"自己紹介",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Descriptio"},goalLabel:{"zh-TW":"主要目標 / Main Goal","zh-CN":"主要目标 / Main Goal",en:"Main Goal",ja:"主な目標",ko:"주요 목표",th:"เป้าหมายหลัก",vi:"Mục tiêu chính",ms:"Matlamat Utama",la:"Propositum Principale"},skillsLabel:{"zh-TW":"技能 / Skills","zh-CN":"技能 / Skills",en:"Skills",ja:"スキル",ko:"기술",th:"ทักษะ",vi:"Kỹ năng",ms:"Kemahiran",la:"Artes"},selectDefault:{"zh-TW":"請選擇","zh-CN":"请选择",en:"Please select",ja:"選択してください",ko:"선택하세요",th:"กรุณาเลือก",vi:"Vui lòng chọn",ms:"Sila pilih",la:"Quaeso selige"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy bỏ",ms:"Batal",la:"Abrogare"},saveButton:{"zh-TW":"儲存","zh-CN":"保存",en:"Save",ja:"保存",ko:"저장",th:"บันทึก",vi:"Lưu",ms:"Simpan",la:"Servare"},avatarLabel:{"zh-TW":"頭像 / Avatar","zh-CN":"头像 / Avatar",en:"Avatar",ja:"アバター",ko:"아바타",th:"รูปประจำตัว",vi:"Ảnh đại diện",ms:"Avatar",la:"Imago"},uploading:{"zh-TW":"上傳中...","zh-CN":"上传中...",en:"Uploading...",ja:"アップロード中...",ko:"업로드 중...",th:"กำลังอัปโหลด...",vi:"Đang tải lên...",ms:"Memuat naik...",la:"Imponens..."}},chatroom:{"zh-TW":"聊天室","zh-CN":"聊天室",en:"Chat Room",ja:"チャットルーム",ko:"채팅방",th:"ห้องแชท",vi:"Phòng chat",ms:"Bilik Sembang",la:"Cella Colloquii"},invites:{"zh-TW":"邀請通知","zh-CN":"邀请通知",en:"Invitations",ja:"招待通知",ko:"초대 알림",th:"การแจ้งเตือนคำเชิญ",vi:"Thông báo mời",ms:"Notis Jemputan",la:"Notitia Invitationis"},mylinks:{"zh-TW":"我的連結","zh-CN":"我的连接",en:"My Links",ja:"私のリンク",ko:"내 링크",th:"ลิงก์ของฉัน",vi:"Liên kết của tôi",ms:"Pautan Saya",la:"Nexus Mei"},returnFriendStories:{"zh-TW":"返回好友故事","zh-CN":"返回好友故事",en:"Return to Friend Stories",ja:"友達のストーリーに戻る",ko:"친구 이야기로 돌아가기",th:"กลับไปที่เรื่องราวของเพื่อน",vi:"Quay lại câu chuyện bạn bè",ms:"Kembali ke Cerita Rakan",la:"Redi ad Fabulas Amicorum"},hello:{"zh-TW":"你好，","zh-CN":"你好，",ja:"こんにちは、",en:"Hello,",ko:"안녕하세요,",th:"สวัสดี,",vi:"Xin chào,",ms:"Hai,",la:"Salve,"},partnerTitle:{"zh-TW":"尋求夥伴同行","zh-CN":"寻找伙伴同行",ja:"仲間を探す",en:"Find a Partner",ko:"동행자 찾기",th:"ค้นหาคู่หู",vi:"Tìm bạn đồng hành",ms:"Cari Rakan Kongsi",la:"Socius Quaerere"},partnerSubtitle:{"zh-TW":"請選擇你的目標夥伴","zh-CN":"请选择你的目标伙伴",ja:"目標パートナーを選択してください",en:"Please select your target partner",ko:"목표 파트너를 선택하세요",th:"โปรดเลือกพันธมิตรเป้าหมาย",vi:"Vui lòng chọn đối tác mục tiêu",ms:"Sila pilih rakan kongsi sasaran anda",la:"Quaeso selige socium propositum tuum"},noPartnerYet:{"zh-TW":"🦋你的夥伴很快就會出現喔，請耐心等待...","zh-CN":"🦋你的伙伴很快就會出现哦，请耐心等待...",ja:"🦋あなたのパートナーはすぐに現れます。お待ちください。",en:"🦋 Your partner will appear soon. Please be patient.",ko:"🦋 당신의 파트너가 곧 나타날 것입니다. 조금만 기다려주세요.",th:"🦋พันธมิตรของคุณจะปรากฏในขณะนี้ โปรดอดทนต่อไป",vi:"🦋 Bạn đồng hành của bạn sẽ xuất hiện sớm. Vui lòng đợi để chờ đợi...",ms:"🦋 Rakan kongsi anda akan muncul segera. Sila tunggu dengan sabar...",la:"🦋 Socius tuus apparebit. Quaeso, patientia attendas..."}},VT={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"};function KT(){const t=le(),[n,r]=e.useState(null),{lang:a,setLang:o}=mw(),[s,l]=e.useState([]),[c,d]=e.useState([]),[u,h]=e.useState(0),[p,m]=e.useState("peer"),[g,x]=e.useState(""),[y,b]=e.useState(!1),[v,k]=e.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[w,j]=e.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[S,T]=e.useState(""),[C,I]=e.useState(null),[B,R]=e.useState(null),[A,F]=e.useState(!0),[z,E]=e.useState("main"),[_,N]=e.useState("none"),[P,D]=e.useState(null),[W,M]=e.useState(!1);e.useRef(u);const L=e.useRef(null);e.useEffect(()=>{if(!W)return;const e=e=>{L.current&&!L.current.contains(e.target)&&M(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[W]),e.useEffect(()=>{const e=yb(dw,async e=>{if(e){r(e);const t=hg(cw,"profiles",e.uid),n=await Pf(t);if(n.exists()){const e=n.data();k({name:e.nickname||e.name||"新用戶",bio:e.bio,goal:e.goal,skills:e.skills,avatar:e.avatar,customSkill:e.customSkill||"",country:e.country||"",gender:e.gender||""})}else{const n={name:e.displayName||"新用戶",bio:"",goal:"",skills:"",avatar:e.photoURL||"/avatars/Derxl.png",customSkill:"",country:"",gender:""};k(n),await Mf(t,n)}await O(e.uid)}else t("/")});return()=>e()},[dw,cw,t]);const O=async e=>{try{F(!0);const t=hf(ug(cw,"profiles"),mf("__name__","!=",e)),n=await Wf(t),i=[];n.forEach(e=>{const t=e.data();i.push({id:e.id,name:t.name||"Unknown",goal:t.goal||"learnNewSkills",role:t.role||"peer",bio:t.bio||{"zh-TW":"No bio available","zh-CN":"暂无简介",en:"No bio available",ja:"自己紹介なし",ko:"소개 없음",th:"ไม่มีประวัติ",vi:"Không có tiểu sử",ms:"Tiada bio",la:"Nulla descriptio"},avatar:t.avatar||"/avatars/Derxl.png",skills:t.skills||"",createdAt:t.createdAt,country:t.country||"",gender:t.gender||""})}),l(i),d(i)}catch(t){}finally{F(!1)}};e.useMemo(()=>Array(c.length).fill(0).map(e=>i.createRef()),[c.length]),e.useEffect(()=>{if(s.length>0){const e=s.filter(e=>{const t=e.role===p,n=!g||e.goal===g;return t&&n});d(e),h(e.length-1)}},[p,g,s]),e.useEffect(()=>{y&&(j(v),T(v.avatar),R(null),I(null))},[y,v]),c[u];const q=["jobSeeking","learnNewSkills","emotionalSupport","networking","startupPrep"];return e.useEffect(()=>{if(!localStorage.getItem("lang")){const e=navigator.language;let t="zh-TW";e.startsWith("zh-CN")?t="zh-CN":e.startsWith("zh-TW")?t="zh-TW":e.startsWith("ja")?t="ja":e.startsWith("ko")?t="ko":e.startsWith("th")?t="th":e.startsWith("vi")?t="vi":e.startsWith("ms")?t="ms":e.startsWith("la")?t="la":e.startsWith("en")&&(t="en"),o(t),localStorage.setItem("lang",t)}},[o]),e.useEffect(()=>{if("in"===_){const e=document.getElementById("user-card");e&&e.animate([{transform:"translateX(-120%) scale(0.4)",opacity:0},{transform:"translateX(0) scale(1)",opacity:1}],{duration:400}),setTimeout(()=>N("none"),400)}},[_]),f.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"relative"},children:[window.innerWidth<=768?f.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",background:"url('/green_hut.png') center center / cover no-repeat fixed"},children:[f.jsx(zw,{}),f.jsxs("div",{style:{marginTop:60,padding:"16px",flex:1,overflowY:"auto"},children:[f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[f.jsx("div",{style:{fontSize:24},children:"🦋"}),f.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#6B5BFF"},children:HT.hello?HT.hello[a]:"你好，"}),f.jsx("img",{src:v.avatar,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),f.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#333"},children:v.name})]}),f.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"16px",marginBottom:16,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[f.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF",textAlign:"center",marginBottom:8},children:HT.partnerTitle?HT.partnerTitle[a]:"尋求夥伴同行"}),f.jsx("div",{style:{fontSize:12,color:"#888",textAlign:"center",marginBottom:12},children:HT.partnerSubtitle?HT.partnerSubtitle[a]:"請選擇你的夥伴目標"}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:q.map(e=>f.jsx("button",{onClick:()=>{x(e),E("main")},style:{flex:"1 1 calc(50% - 4px)",padding:"8px 4px",borderRadius:8,border:g===e?"2px solid #23c6e6":"1px solid #eee",background:g===e?"#e6f7ff":"#fff",color:g===e?"#23c6e6":"#333",fontWeight:600,fontSize:12,cursor:"pointer",boxShadow:g===e?"0 2px 8px #23c6e622":"0 1px 4px #0001"},children:HT.goalOptions[e][a]},e))})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[f.jsx("button",{onClick:()=>t("/chatroom"),style:{padding:"8px",borderRadius:8,border:"chat"===z?"2px solid #8ec6f7":"1px solid #eee",background:"chat"===z?"#e6f7ff":"#fff",color:"chat"===z?"#23c6e6":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:HT.chatroom[a]}),f.jsx("button",{onClick:()=>E("invites"),style:{padding:"8px",borderRadius:8,border:"invites"===z?"2px solid #6B5BFF":"1px solid #eee",background:"invites"===z?"#f5f4ff":"#fff",color:"invites"===z?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:HT.invites[a]}),f.jsx("button",{onClick:()=>E("links"),style:{padding:"8px",borderRadius:8,border:"links"===z?"2px solid #6B5BFF":"1px solid #eee",background:"links"===z?"#f5f4ff":"#fff",color:"links"===z?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:HT.mylinks[a]}),f.jsxs("span",{href:"/storywall",style:{padding:"8px",borderRadius:8,border:"1px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:600,fontSize:14,cursor:"pointer",textAlign:"center",textDecoration:"none",display:"block"},children:[HT.returnFriendStories[a]," 🦋"]})]})]}),f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",minHeight:400},children:["main"===z&&f.jsx(f.Fragment,{children:(()=>{var e,t;const n=c.filter(e=>!g||e.goal===g);if(0===n.length)return f.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:16,marginTop:40,fontWeight:700},children:(null==(e=HT.noPartnerYet)?void 0:e[a])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const i=n[u>=0&&u<n.length?u:0];return i?f.jsxs("div",{id:"user-card",style:{textAlign:"center",transition:"box-shadow 0.2s, transform 0.4s",transform:"in"===_?"translateX(-120%) scale(0.4)":"out"===_?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{"in"===_&&N("none")},children:[f.jsx("img",{src:i.avatar,alt:"avatar",style:{width:80,height:80,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:12}}),f.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",marginBottom:8},children:i.name}),f.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["國家/地區：",i.country||"未填寫"]}),f.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["性別：",i.gender||"未填寫"]}),f.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["目標：",(null==(t=HT.goalOptions[i.goal])?void 0:t[a])||i.goal]}),f.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:16},children:["技能：",i.skills||"未填寫"]})]}):null})()}),"chat"===z&&f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",minHeight:"50vh",padding:"20px 0"},children:[f.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[f.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"好友列表"}),f.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"請先加好友,才能開始聊天"})]}),f.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[f.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"聊天訊息框"}),f.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"還沒有朋友,去交友區加好友吧!"})]})]}),"links"===z&&f.jsx(OT,{embedded:!0}),"invites"===z&&f.jsx(UT,{embedded:!0})]}),f.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24},children:f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>t("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),f.jsx("span",{onClick:()=>t("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>t("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},children:"zh-TW"===a?"🧬 Restarter™｜我們是誰":"zh-CN"===a?"🧬 Restarter™｜我们是谁":"en"===a?"🧬 Restarter™｜Who We Are":"ja"===a?"🧬 Restarter™｜私たちについて":"ko"===a?"🧬 Restarter™｜우리는 누구인가":"th"===a?"🧬 Restarter™｜เราเป็นใคร":"vi"===a?"🧬 Restarter™｜Chúng tôi là ai":"ms"===a?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>t("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},children:"zh-TW"===a?"💬 意見箱｜我們想聽你說":"zh-CN"===a?"💬 意见箱｜我们想听你说":"en"===a?"💬 Feedback｜We Want to Hear You":"ja"===a?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===a?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===a?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===a?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===a?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),n?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:n.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:n.displayName||n.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(dw)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:VT[a]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>t("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===a?"註冊/登入":"zh-CN"===a?"注册/登录":"en"===a?"Register / Login":"ja"===a?"登録/ログイン":"ko"===a?"가입/로그인":"th"===a?"สมัคร/เข้าสู่ระบบ":"vi"===a?"Đăng ký/Đăng nhập":"ms"===a?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:L,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>M(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),W&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===a||"zh-CN"===a?"法律文件":"en"===a?"Legal Documents":"ja"===a?"法的文書":"ko"===a?"법적 문서":"th"===a?"เอกสารทางกฎหมาย":"vi"===a?"Tài liệu pháp lý":"ms"===a?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:{"zh-TW":"隱私權政策","zh-CN":"隐私权政策",en:"Privacy Policy",ja:"プライバシーポリシー",ko:"개인정보 처리방침",th:"นโยบายความเป็นส่วนตัว",vi:"Chính sách bảo mật",ms:"Dasar Privasi",la:"Politica Privata"},path:"/privacy-policy"},{key:"terms",title:{"zh-TW":"條款/聲明","zh-CN":"条款/声明",en:"Terms & Conditions",ja:"利用規約",ko:"이용약관",th:"ข้อกำหนดและเงื่อนไข",vi:"Điều khoản & Điều kiện",ms:"Terma & Syarat",la:"Termini & Conditiones"},path:"/terms"},{key:"data",title:{"zh-TW":"資料刪除說明","zh-CN":"资料删除说明",en:"Data Deletion",ja:"データ削除",ko:"데이터 삭제",th:"การลบข้อมูล",vi:"Xóa dữ liệu",ms:"Pemadaman Data",la:"Deletio Datorum"},path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{t(e.path),M(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title[a]||e.title["zh-TW"]},e.key))]})]})]}),f.jsx("div",{style:{position:"fixed",left:0,top:0,width:340,height:"100vh",background:"rgba(255,255,255,0.95)",borderRight:"1px solid #eee",overflowY:"auto",zIndex:2,padding:"24px 16px"},children:f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"20px",marginBottom:24,boxShadow:"0 2px 12px #6B5BFF22"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:16},children:[f.jsx("div",{style:{fontSize:32},children:"🦋"}),f.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF"},children:HT.hello?HT.hello[a]:"你好，"}),f.jsx("img",{src:v.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF"}}),f.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#333"},children:v.name})]}),f.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"20px",marginBottom:24,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[f.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:12},children:HT.partnerTitle?HT.partnerTitle[a]:"尋求夥伴同行"}),f.jsx("div",{style:{fontSize:14,color:"#888",textAlign:"center",marginBottom:20},children:HT.partnerSubtitle?HT.partnerSubtitle[a]:"請選擇你的夥伴目標"}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:q.map(e=>f.jsx("button",{onClick:()=>{x(e),E("main")},style:{width:"100%",padding:"12px 16px",borderRadius:10,border:g===e?"2px solid #23c6e6":"1.5px solid #eee",background:g===e?"#e6f7ff":"#fff",color:g===e?"#23c6e6":"#333",fontWeight:700,fontSize:15,cursor:"pointer",boxShadow:g===e?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s",outline:"none",borderLeft:g===e?"6px solid #23c6e6":"6px solid transparent",marginBottom:0},children:HT.goalOptions[e][a]},e))})]}),f.jsx("button",{onClick:()=>t("/chatroom"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"chat"===z?"2px solid #8ec6f7":"1.5px solid #eee",background:"chat"===z?"#e6f7ff":"#fff",color:"chat"===z?"#23c6e6":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"chat"===z?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s"},children:HT.chatroom[a]}),f.jsx("button",{onClick:()=>E("invites"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"invites"===z?"2px solid #6B5BFF":"1.5px solid #eee",background:"invites"===z?"#f5f4ff":"#fff",color:"invites"===z?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"invites"===z?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:HT.invites[a]}),f.jsx("button",{onClick:()=>E("links"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"links"===z?"2px solid #6B5BFF":"1.5px solid #eee",background:"links"===z?"#f5f4ff":"#fff",color:"links"===z?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"links"===z?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:HT.mylinks[a]}),f.jsxs("span",{href:"/storywall",style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"1.5px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #23c6e622",textAlign:"center",textDecoration:"none",display:"block",transition:"all 0.2s"},children:[HT.returnFriendStories[a]," 🦋"]})]})}),f.jsx("div",{style:{position:"fixed",left:340,top:60,width:"calc(100vw - 340px)",height:"calc(100vh - 60px)",overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"center",background:"url('/green_hut.png') center center / cover no-repeat fixed",zIndex:1,pointerEvents:"auto",paddingLeft:0},children:f.jsxs("div",{style:{width:"100%",maxWidth:900,marginTop:60},children:["main"===z&&f.jsx(f.Fragment,{children:(()=>{var e,t;const i=c.filter(e=>!g||e.goal===g);if(0===i.length)return f.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:18,marginTop:40,fontWeight:700},children:(null==(e=HT.noPartnerYet)?void 0:e[a])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const r=i[u>=0&&u<i.length?u:0];return r?f.jsxs("div",{id:"user-card",style:{width:340,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:32,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",minHeight:380,transition:"box-shadow 0.2s, transform 0.4s",transform:"in"===_?"translateX(-120%) scale(0.4)":"out"===_?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{"in"===_&&N("none")},children:[f.jsx("img",{src:r.avatar,alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:16}}),f.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:8},children:r.name}),f.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["國家/地區：",r.country||"未填寫"]}),f.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["性別：",r.gender||"未填寫"]}),f.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["目標：",(null==(t=HT.goalOptions[r.goal])?void 0:t[a])||r.goal]}),f.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:12},children:["技能：",r.skills||"未填寫"]}),f.jsxs("div",{style:{display:"flex",gap:16,marginTop:24},children:[f.jsx("button",{onClick:()=>{const e=document.getElementById("user-card");e&&(N("out"),e.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{h(e=>(N("in"),(e-1+i.length)%i.length))},400)},style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001",transition:"all 0.2s"},children:"跳過"}),f.jsx("button",{onClick:()=>(async(e,t)=>{if(n)try{const i={fromUserId:n.uid,fromUserName:v.name,fromUserAvatar:v.avatar,fromUserCountry:v.country||"",fromUserGender:v.gender||"",fromUserEmail:n.email||"",fromUserNickname:v.name||"",toUserId:e,toUserName:t.name,role:t.role,goal:t.goal,status:"pending",createdAt:ax()};await qf(ug(cw,"invites"),i),D(HT.like[a]+" 成功！"),setTimeout(()=>D(null),2e3)}catch(i){alert("發送邀請失敗")}})(r.id,r),style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #6B5BFF22",transition:"all 0.2s"},children:"建立連結"})]})]}):null})()}),"chat"===z&&f.jsx("div",{children:"聊天室功能開發中"}),"links"===z&&f.jsx(OT,{embedded:!0}),"invites"===z&&f.jsx(UT,{embedded:!0})]})})]}),P&&f.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#1976d2",color:"#fff",padding:"14px 32px",borderRadius:16,fontSize:18,fontWeight:700,zIndex:9999,boxShadow:"0 2px 16px #1976d288",letterSpacing:1,textAlign:"center",opacity:.97},children:P})]})}function $T(){const e=localStorage.getItem("userId")||"",t=function(){try{return JSON.parse(localStorage.getItem("messages")||"[]")}catch{return[]}}(),n={"zh-TW":{title:"我的留言箱",noMessages:"目前沒有收到任何留言",messageFrom:"留言：",aboutPost:"針對你的貼文：「"},"zh-CN":{title:"我的留言箱",noMessages:"目前没有收到任何留言",messageFrom:"留言：",aboutPost:"针对你的贴文：「"},en:{title:"My Inbox",noMessages:"No messages received yet",messageFrom:"message:",aboutPost:'About your post: "'},ja:{title:"メッセージボックス",noMessages:"まだメッセージがありません",messageFrom:"メッセージ：",aboutPost:"あなたの投稿について：「"},ko:{title:"내 메시지함",noMessages:"아직 받은 메시지가 없습니다",messageFrom:"메시지:",aboutPost:'당신의 게시물에 대해: "'},vi:{title:"Hộp thư của tôi",noMessages:"Chưa có tin nhắn nào",messageFrom:"tin nhắn:",aboutPost:'Về bài đăng của bạn: "'},th:{title:"กล่องข้อความของฉัน",noMessages:"ยังไม่มีข้อความ",messageFrom:"ข้อความ:",aboutPost:'เกี่ยวกับโพสต์ของคุณ: "'},la:{title:"Mea Inbox",noMessages:"Nondum epistulae receptae",messageFrom:"epistula:",aboutPost:'De tuo post: "'},ms:{title:"Peti Surat Saya",noMessages:"Belum ada mesej diterima",messageFrom:"mesej:",aboutPost:'Mengenai siaran anda: "'}},i=n[localStorage.getItem("lang")||"zh-TW"]||n.en,r=t.flatMap(t=>(t.comments||[]).filter(t=>t.toUserId===e).map(e=>({...e,post:t.text,from:t.user.name})));return f.jsx("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{className:"modern-container",style:{maxWidth:600,width:"100%",margin:"0 auto",padding:32},children:[f.jsx("h2",{style:{textAlign:"center",color:"#6B5BFF",fontWeight:900,marginBottom:24},children:i.title}),0===r.length&&f.jsx("div",{style:{color:"#bbb",textAlign:"center"},children:i.noMessages}),r.map((e,t)=>f.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:16,boxShadow:"0 2px 8px #6B5BFF11",marginBottom:16},children:[f.jsxs("div",{style:{color:"#6B5BFF",fontWeight:700},children:[e.from," ",i.messageFrom]}),f.jsx("div",{style:{color:"#232946",margin:"8px 0"},children:e.content}),f.jsxs("div",{style:{color:"#6B4F27",fontSize:14},children:[i.aboutPost,e.post,"」"]})]},t))]})})}const GT={"zh-TW":{title:"AI 風格回覆",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"AI 风格回复",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"AI-Styled Reply",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"AI風返信",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"AI 스타일 응답",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Trả lời theo phong cách AI",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การตอบกลับสไตล์ AI",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Responsum Stilo AI",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Balasan Gaya AI",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function QT(){const[e,t]=i.useState(!1),[n,r]=i.useState(()=>localStorage.getItem("lang")||"zh-TW"),a=GT[n]||GT["zh-TW"];i.useEffect(()=>{localStorage.setItem("lang",n)},[n]);return f.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[f.jsx(fw,{}),f.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:a.title}),f.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:a.comingSoon}),f.jsx("button",{onClick:()=>{t(!0),setTimeout(()=>t(!1),3e3)},style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:e,children:e?a.playing:a.playAudio})]})]})}const YT=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],JT={"zh-TW":{title:"擬真語音輸出",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"拟真语音输出",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"Realistic TTS",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"リアルな音声出力",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"사실적인 음성 출력",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Đầu ra giọng nói thực tế",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การส่งออกเสียงที่สมจริง",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Sermo Verus Output",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Output Suara Realistik",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function XT(){const[e,t]=i.useState(!1),[n,r]=i.useState("zh-TW"),a=JT[n]||JT["zh-TW"];i.useEffect(()=>{const e=localStorage.getItem("lang");e&&YT.find(t=>t.code===e)&&r(e)},[]),i.useEffect(()=>{localStorage.setItem("lang",n)},[n]);return f.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[f.jsx("div",{style:{position:"absolute",top:24,right:36,zIndex:100},children:f.jsx(fw,{})}),f.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:a.title}),f.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:a.comingSoon}),f.jsx("button",{onClick:()=>{t(!0),setTimeout(()=>t(!1),2e3)},style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:e,children:e?a.playing:a.playAudio})]})]})}const ZT=({onTestModeChange:t})=>{const[n,i]=e.useState(!1);e.useEffect(()=>{const e="true"===localStorage.getItem("testMode");i(e),t(e)},[t]);return f.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[f.jsx("button",{onClick:()=>{const e=!n;i(e),localStorage.setItem("testMode",e.toString()),t(e)},style:{background:n?"#ff6b6b":"#4ecdc4",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.3s ease",minWidth:"80px"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.05)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"},children:n?"測試模式 ON":"測試模式 OFF"}),n&&f.jsx("div",{style:{background:"rgba(255, 107, 107, 0.9)",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",textAlign:"center",maxWidth:"120px",lineHeight:"1.2"},children:"語音功能已解鎖"})]})},eC={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},tC={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"数据删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보보호정책",terms:"약관/성명",deletion:"데이터 삭제 설명"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/คำแถลง",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Penyata",deletion:"Penerangan Pemadaman Data"},la:{privacy:"Consilium de Privata",terms:"Termini/Declaratio",deletion:"Explicatio Deletionis Datae"}},nC={"zh-TW":{back:"返回",logout:"登出",title:"重啟之路",subtitle:"一步步走出迷霧，看見全新的自己",steps:[{title:"第一站：迷霧山谷",desc:"寫下最近一件讓你感到強烈情緒的事。不必評判自己，單純描述事情的經過、你的感受，以及這個感受帶來的影響。",placeholder:"在這裡寫下你的故事...(300字內)"},{title:"第二站：希望之丘",desc:"回顧你剛剛寫下的事件，請思考：在那個情境下，你有沒有做過什麼小小的努力或嘗試？即使很微小，也請寫下來。",placeholder:"寫下你做過的努力或嘗試...(300字內)"},{title:"第三站：勇氣森林",desc:"根據你剛剛發現的努力或資源，請設定一個你願意嘗試的小行動，並寫下你預期會遇到的困難，以及你打算怎麼面對。",placeholder:"寫下你的小行動與預期困難...(300字內)"},{title:"第四站：智慧溪流",desc:"回顧你剛剛的行動經驗，請反思：這個過程中，你學到了什麼？有沒有什麼新的發現或領悟？",placeholder:"寫下你的學習與領悟...(300字內)"},{title:"第五站：重啟之巔",desc:"綜合前面所有關卡的經歷，請寫下你給未來自己的祝福或期許，並思考：如果未來再遇到困難，你會怎麼鼓勵自己？",placeholder:"寫下給自己的祝福或期許...(300字內)"}],submit:"提交，尋求指引",loading:"請稍候...",next:"前往下一站",finish:"恭喜你完成重啟之路！",finishSub:"未來也請繼續善待自己！",error:"發生錯誤，請稍後再試。",retry:"再來一次"},"zh-CN":{back:"返回首页",logout:"登出",title:"日常任务挑战",subtitle:"一步步走出迷雾，看见全新的自己",steps:[{title:"第一站：迷雾山谷",desc:"写下最近一件让你感到强烈情绪的事。不必评判自己，单纯描述事情的经过、你的感受，以及这个感受带来的影响。",placeholder:"在这里写下你的故事...(300字内)"},{title:"第二站：希望之丘",desc:"回顾你刚刚写下的事件，请思考：在那个情境下，你有没有做过什么小小的努力或尝试？即使很微小，也请写下来。",placeholder:"写下你做过的努力或尝试...(300字内)"},{title:"第三站：勇气森林",desc:"根据你刚刚发现的努力或资源，请设定一个你愿意尝试的小行动，并写下你预期会遇到的困难，以及你打算怎么面对。",placeholder:"写下你的小行动与预期困难...(300字内)"},{title:"第四站：智慧溪流",desc:"回顾你刚刚的行动经验，请反思：这个过程中，你学到了什么？有没有什么新的发现或领悟？",placeholder:"写下你的学习与领悟...(300字内)"},{title:"第五站：重启之巅",desc:"综合前面所有关卡的经历，请写下你给未来自己的祝福或期许，并思考：如果未来再遇到困难，你会怎么鼓励自己？",placeholder:"写下给自己的祝福或期许...(300字内)"}],submit:"提交，寻求指引",loading:"请稍候...",next:"前往下一站",finish:"恭喜你完成重启之路！",finishSub:"未来也请继续善待自己！",error:"发生错误，请稍后再试。",retry:"再来一次"},en:{back:"Back to Home",logout:"Logout",title:"Restart Journey",subtitle:"Step by step out of the mist, see a new self",steps:[{title:"Step 1: Misty Valley",desc:"Write about a recent event that made you feel strong emotions. No need to judge yourself, just describe what happened, how you felt, and how it affected you.",placeholder:"Write your story here...(300 words max)"},{title:"Step 2: Hill of Hope",desc:"Review the event you just wrote. Did you make any small effort or try anything in that situation? Even if it was minor, write it down.",placeholder:"Write your effort or attempt...(300 words max)"},{title:"Step 3: Forest of Courage",desc:"Based on your discovered effort or resources, set a small action you are willing to try, and write down the difficulties you expect and how you plan to face them.",placeholder:"Write your action and expected difficulties...(300 words max)"},{title:"Step 4: Stream of Wisdom",desc:"Reflect on your action experience. What did you learn? Any new discoveries or insights?",placeholder:"Write your learning and insights...(300 words max)"},{title:"Step 5: Summit of Restart",desc:"Summarize all your experiences and write a blessing or expectation for your future self. If you face difficulties again, how will you encourage yourself?",placeholder:"Write your blessing or expectation...(300 words max)"}],submit:"Submit for Guidance",loading:"Please wait...",next:"Next Step",finish:"Congratulations on completing your restart journey!",finishSub:"Please continue to be kind to yourself in the future!",error:"An error occurred, please try again later.",retry:"Try Again"},ja:{back:"ホームに戻る",logout:"ログアウト",title:"日課ミッション挑戦",subtitle:"一歩ずつ霧を抜けて、新しい自分に出会おう",steps:[{title:"第1ステップ：霧の谷",desc:"最近あなたが強い感情を抱いた出来事について書いてください。自分を評価せず、出来事の経過や感情、その影響を素直に書きましょう。",placeholder:"ここにあなたのストーリーを書いてください...(300字以内)"},{title:"第2ステップ：希望の丘",desc:"先ほど書いた出来事を振り返り、その状況であなたが行った小さな努力や試みがあれば書いてください。些細なことでも構いません。",placeholder:"あなたの努力や試みを書いてください...(300字以内)"},{title:"第3ステップ：勇気の森",desc:"発見した努力やリソースをもとに、挑戦したい小さな行動と、予想される困難、それにどう向き合うかを書いてください。",placeholder:"行動と予想される困難を書いてください...(300字以内)"},{title:"第4ステップ：知恵の流れ",desc:"行動の経験を振り返り、学んだことや新たな気づきがあれば書いてください。",placeholder:"学びや気づきを書いてください...(300字以内)"},{title:"第5ステップ：再出発の頂",desc:"これまでの経験をまとめ、未来の自分へのメッセージや期待を書いてください。困難に直面したとき、どう自分を励ますかも考えてみましょう。",placeholder:"未来の自分へのメッセージや期待を書いてください...(300字以内)"}],submit:"提出して指導を求める",loading:"お待ちください...",next:"次のステップへ",finish:"再出発の道を完了しました！",finishSub:"これからも自分を大切にしてください！",error:"エラーが発生しました。しばらくしてから再度お試しください。",retry:"もう一度"},ko:{back:"홈으로",logout:"로그아웃",title:"일일 미션 도전",subtitle:"한 걸음씩 안개를 걷고, 새로운 나를 만나보세요",steps:[{title:"1단계: 안개의 계곡",desc:"최근에 강한 감정을 느꼈던 일을 적어보세요. 자신을 평가하지 말고, 그 일의 과정과 감정, 그리고 그 감정이 가져온 영향을 솔직하게 적어보세요.",placeholder:"여기에 당신의 이야기를 적어주세요...(300자 이내)"},{title:"2단계: 희망의 언덕",desc:"방금 적은 일을 돌아보며, 그 상황에서 했던 작은 노력이나 시도가 있다면 적어보세요. 아주 사소한 것도 괜찮아요.",placeholder:"노력이나 시도를 적어주세요...(300자 이내)"},{title:"3단계: 용기의 숲",desc:"발견한 노력이나 자원을 바탕으로, 시도해보고 싶은 작은 행동과 예상되는 어려움, 그리고 어떻게 대처할지 적어보세요.",placeholder:"행동과 예상되는 어려움을 적어주세요...(300자 이내)"},{title:"4단계: 지혜의 시냇물",desc:"행동 경험을 돌아보며, 배운 점이나 새로운 깨달음이 있다면 적어보세요.",placeholder:"배운 점이나 깨달음을 적어주세요...(300자 이내)"},{title:"5단계: 재시작의 정상",desc:"지금까지의 경험을 종합해 미래의 나에게 전하고 싶은 메시지나 기대를 적어보세요. 앞으로 어려움이 닥칠 때 어떻게 자신을 격려할지도 생각해보세요.",placeholder:"미래의 나에게 전하고 싶은 메시지나 기대를 적어주세요...(300자 이내)"}],submit:"제출하고 안내받기",loading:"잠시만 기다려주세요...",next:"다음 단계로",finish:"재시작의 여정을 완료했습니다!",finishSub:"앞으로도 자신을 소중히 하세요!",error:"오류가 발생했습니다. 잠시 후 다시 시도해주세요.",retry:"다시 시도"},th:{back:"กลับหน้าหลัก",logout:"ออกจากระบบ",title:"ภารกิจประจำวัน",subtitle:"ก้าวออกจากหมอกทีละก้าว พบกับตัวเองในมุมใหม่",steps:[{title:"ขั้นที่ 1: หุบเขาหมอก",desc:"เขียนเกี่ยวกับเหตุการณ์ล่าสุดที่ทำให้คุณรู้สึกอารมณ์รุนแรง ไม่ต้องตัดสินตัวเอง เพียงบรรยายเหตุการณ์ ความรู้สึก และผลกระทบที่เกิดขึ้น",placeholder:"เขียนเรื่องราวของคุณที่นี่...(300 คำ)"},{title:"ขั้นที่ 2: เนินแห่งความหวัง",desc:"ทบทวนเหตุการณ์ที่เพิ่งเขียนไป มีความพยายามหรือการลองทำอะไรเล็กๆ ในสถานการณ์นั้นหรือไม่ แม้จะเล็กน้อยก็เขียนได้",placeholder:"เขียนความพยายามหรือสิ่งที่ลองทำ...(300 คำ)"},{title:"ขั้นที่ 3: ป่าแห่งความกล้าหาญ",desc:"จากความพยายามหรือทรัพยากรที่ค้นพบ กำหนดการกระทำเล็กๆ ที่อยากลอง พร้อมทั้งอุปสรรคที่คาดว่าจะเจอและวิธีรับมือ",placeholder:"เขียนการกระทำและอุปสรรคที่คาดไว้...(300 คำ)"},{title:"ขั้นที่ 4: ลำธารแห่งปัญญา",desc:"ทบทวนประสบการณ์การกระทำของคุณ มีอะไรที่ได้เรียนรู้หรือค้นพบใหม่ๆ หรือไม่",placeholder:"เขียนสิ่งที่ได้เรียนรู้หรือค้นพบ...(300 คำ)"},{title:"ขั้นที่ 5: ยอดเขาแห่งการเริ่มต้นใหม่",desc:"สรุปประสบการณ์ทั้งหมด เขียนคำอวยพรหรือความคาดหวังถึงตัวเองในอนาคต หากเจออุปสรรคอีกจะให้กำลังใจตัวเองอย่างไร",placeholder:"เขียนคำอวยพรหรือความคาดหวัง...(300 คำ)"}],submit:"ส่งและขอคำแนะนำ",loading:"กรุณารอสักครู่...",next:"ไปยังขั้นถัดไป",finish:"คุณสำเร็จภารกิจเริ่มต้นใหม่แล้ว!",finishSub:"ขอให้ดูแลตัวเองต่อไป!",error:"เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้งภายหลัง",retry:"ลองอีกครั้ง"},vi:{back:"Về trang chủ",logout:"Đăng xuất",title:"Thử thách nhiệm vụ hàng ngày",subtitle:"Từng bước vượt qua sương mù, khám phá bản thân mới",steps:[{title:"Bước 1: Thung lũng sương mù",desc:"Viết về một sự kiện gần đây khiến bạn cảm xúc mạnh. Không cần phán xét bản thân, chỉ cần mô tả diễn biến, cảm xúc và ảnh hưởng của nó.",placeholder:"Viết câu chuyện của bạn tại đây...(300 từ)"},{title:"Bước 2: Đồi hy vọng",desc:"Xem lại sự kiện vừa viết, bạn có nỗ lực hoặc thử điều gì nhỏ không? Dù nhỏ cũng hãy ghi lại.",placeholder:"Viết nỗ lực hoặc điều bạn đã thử...(300 từ)"},{title:"Bước 3: Rừng dũng cảm",desc:"Dựa trên nỗ lực hoặc nguồn lực vừa phát hiện, hãy đặt ra một hành động nhỏ muốn thử, dự đoán khó khăn và cách đối mặt.",placeholder:"Viết hành động và khó khăn dự đoán...(300 từ)"},{title:"Bước 4: Suối trí tuệ",desc:"Xem lại trải nghiệm hành động, bạn học được gì? Có phát hiện hay nhận thức mới không?",placeholder:"Viết điều bạn học được hoặc nhận ra...(300 từ)"},{title:"Bước 5: Đỉnh tái khởi động",desc:"Tổng hợp mọi trải nghiệm, viết lời chúc hoặc kỳ vọng cho bản thân tương lai. Nếu gặp khó khăn, bạn sẽ động viên mình thế nào?",placeholder:"Viết lời chúc hoặc kỳ vọng...(300 từ)"}],submit:"Gửi và nhận hướng dẫn",loading:"Vui lòng chờ...",next:"Bước tiếp theo",finish:"Chúc mừng bạn đã hoàn thành hành trình tái khởi động!",finishSub:"Hãy tiếp tục yêu thương bản thân nhé!",error:"Đã xảy ra lỗi, vui lòng thử lại sau.",retry:"Thử lại"},la:{back:"Redi ad domum",logout:"Exire",title:"Provocatio Cotidiana",subtitle:"Gradatim e nebula progredere, novum te aspice",steps:[{title:"Gradus I: Vallis Nebulosa",desc:"Scribe de re nuper te vehementer commotum. Te ipsum iudicare noli, sed simpliciter rem, sensus tuos, et effectus describas.",placeholder:"Hic fabulam tuam scribe...(300 verba)"},{title:"Gradus II: Collis Spei",desc:"Recense rem modo scriptam. In illa condicione quid parvum conatus es? Etiam minima, scribe.",placeholder:"Conatum tuum scribe...(300 verba)"},{title:"Gradus III: Silva Virtutis",desc:"Ex conatu aut opibus inventis, parvam actionem temptare velis, difficultates praevides et quomodo eas superaturus sis scribe.",placeholder:"Actionem et difficultates scribe...(300 verba)"},{title:"Gradus IV: Rivus Sapientiae",desc:"Recense experientiam actionis. Quid didicisti? Quid novi invenisti?",placeholder:"Quae didicisti scribe...(300 verba)"},{title:"Gradus V: Culmen Renovationis",desc:"Omnia experientia colligens, votum aut spem tibi futuro scribe. Si iterum difficultates occurrant, quomodo te hortaberis?",placeholder:"Votum aut spem scribe...(300 verba)"}],submit:"Mitte et consilium pete",loading:"Exspecta quaeso...",next:"Ad gradum proximum",finish:"Iter renovationis confecisti!",finishSub:"Te ipsum semper cura!",error:"Error factus est, quaeso postea repete.",retry:"Iterum conare"},ms:{back:"Kembali ke Laman Utama",logout:"Log keluar",title:"Cabaran Misi Harian",subtitle:"Melangkah keluar dari kabus, temui diri baharu",steps:[{title:"Langkah 1: Lembah Berkabus",desc:"Tulis tentang peristiwa baru-baru ini yang membuatkan anda beremosi kuat. Tidak perlu menilai diri, hanya gambarkan peristiwa, perasaan dan kesannya.",placeholder:"Tulis kisah anda di sini...(300 patah perkataan)"},{title:"Langkah 2: Bukit Harapan",desc:"Imbas kembali peristiwa tadi, adakah anda berusaha atau mencuba sesuatu walaupun kecil? Catatkan walaupun kecil.",placeholder:"Tulis usaha atau percubaan anda...(300 patah perkataan)"},{title:"Langkah 3: Hutan Keberanian",desc:"Berdasarkan usaha atau sumber yang ditemui, tetapkan tindakan kecil yang ingin dicuba, jangka cabaran dan cara menghadapinya.",placeholder:"Tulis tindakan dan cabaran dijangka...(300 patah perkataan)"},{title:"Langkah 4: Sungai Kebijaksanaan",desc:"Imbas kembali pengalaman tindakan anda, apa yang anda pelajari? Ada penemuan atau kesedaran baharu?",placeholder:"Tulis apa yang anda pelajari...(300 patah perkataan)"},{title:"Langkah 5: Puncak Permulaan Semula",desc:"Gabungkan semua pengalaman, tulis harapan atau ucapan untuk diri masa depan. Jika hadapi cabaran lagi, bagaimana anda akan beri semangat pada diri?",placeholder:"Tulis harapan atau ucapan...(300 patah perkataan)"}],submit:"Hantar & mohon panduan",loading:"Sila tunggu...",next:"Langkah seterusnya",finish:"Tahniah, anda telah tamat perjalanan permulaan semula!",finishSub:"Teruskan sayangi diri anda!",error:"Ralat berlaku, sila cuba lagi kemudian.",retry:"Cuba lagi"}};function iC(){var t,n,i,r;const a=le(),o=Fv(),{lang:s,setLang:l}=mw(),[c,d]=e.useState(null),[u,h]=e.useState(!1),[p,m]=e.useState(!1),g=e.useRef(null),x=e.useRef(null),[y,b]=e.useState(!1),v=nC["zh-TW"],k=nC[s]||v,w={...v,...k,steps:k.steps||v.steps,submit:k.submit||v.submit,loading:k.loading||v.loading,next:k.next||v.next,finish:k.finish||v.finish,finishSub:k.finishSub||v.finishSub,error:k.error||v.error,retry:k.retry||v.retry},[j,S]=e.useState(0),[T,C]=e.useState(""),[I,B]=e.useState([]),[R,A]=e.useState(""),[F,z]=e.useState(!1),[E,_]=e.useState(!1),[N,P]=e.useState(!1),D=null==(t=w.steps)?void 0:t[j];e.useEffect(()=>{const e=yb(o,e=>{d(e)});return()=>e()},[]),e.useEffect(()=>{const e=()=>P(window.innerWidth<=768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e.useEffect(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&h(!1),x.current&&!x.current.contains(e.target)&&m(!1)};return(u||p)&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[u,p]),e.useEffect(()=>{var e;if(R&&j===((null==(e=w.steps)?void 0:e.length)||0)-1){_(!0);const e=setTimeout(()=>_(!1),3e3);return()=>clearTimeout(e)}},[R,j]);const W=()=>f.jsxs("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",pointerEvents:"none",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:[f.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent"},title:"fireworks1"}),f.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",left:"20vw",top:"10vh"},title:"fireworks2"}),f.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",right:"20vw",top:"20vh"},title:"fireworks3"})]});return f.jsxs("div",{style:{minHeight:"100vh",width:"100vw",position:"relative",overflowX:"hidden",background:"url('/mountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)"},children:[N?f.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[f.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:f.jsx("img",{src:"/ctx-logo.png",alt:"logo",style:{width:72,height:72,cursor:"pointer"},onClick:()=>a("/")})}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:c.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),f.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:c.displayName||c.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(o)},style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px",borderRadius:4,fontWeight:600,border:"1px solid #ff6347",color:"#ff6347",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},children:eC[s]})]}):f.jsx("button",{className:"topbar-btn",onClick:()=>a("/register"),style:{background:"#fff",color:"#1976d2",border:"1px solid #1976d2",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:"zh-TW"===s?"註冊":"zh-CN"===s?"注册":"en"===s?"Register":"ja"===s?"登録":"ko"===s?"가입":"th"===s?"สมัคร":"vi"===s?"Đăng ký":"ms"===s?"Daftar":"Registrare"}),f.jsx(fw,{style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px"}}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:g,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:12,padding:"8px 10px",minWidth:44,height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>h(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#5a4fd9",e.currentTarget.style.borderColor="#5a4fd9"},onMouseOut:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.borderColor="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),u&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===s||"zh-CN"===s?"法律文件":"en"===s?"Legal Documents":"ja"===s?"法的文書":"ko"===s?"법적 문서":"th"===s?"เอกสารทางกฎหมาย":"vi"===s?"Tài liệu pháp lý":"ms"===s?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:tC,titleKey:"privacy",path:"/privacy-policy"},{key:"terms",title:tC,titleKey:"terms",path:"/terms"},{key:"data",title:tC,titleKey:"deletion",path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>{var t;return f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{a(e.path),h(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.titleKey?(null==(t=e.title[s])?void 0:t[e.titleKey])||e.title["zh-TW"][e.titleKey]:e.title[s]||e.title["zh-TW"]},e.key)})]})]})]})]}):f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsx("div",{style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>a("/")})}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>a("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":"zh-TW"===s||"zh-CN"===s?"了解 Restarter 平台":"en"===s?"Learn about Restarter platform":"ja"===s?"Restarter プラットフォームについて":"ko"===s?"Restarter 플랫폼에 대해 알아보기":"th"===s?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":"vi"===s?"Tìm hiểu về nền tảng Restarter":"ms"===s?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:"zh-TW"===s?"🧬 Restarter™｜我們是誰":"zh-CN"===s?"🧬 Restarter™｜我们是谁":"en"===s?"🧬 Restarter™｜Who We Are":"ja"===s?"🧬 Restarter™｜私たちについて":"ko"===s?"🧬 Restarter™｜우리는 누구인가":"th"===s?"🧬 Restarter™｜เราเป็นใคร":"vi"===s?"🧬 Restarter™｜Chúng tôi là ai":"ms"===s?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>a("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":"zh-TW"===s?"提供意見和建議":"zh-CN"===s?"提供意见和建议":"en"===s?"Provide feedback and suggestions":"ja"===s?"ご意見やご提案を提供":"ko"===s?"의견과 제안 제공":"th"===s?"ให้ข้อเสนอแนะและคำแนะนำ":"vi"===s?"Cung cấp phản hồi và đề xuất":"ms"===s?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:"zh-TW"===s?"💬 意見箱｜我們想聽你說":"zh-CN"===s?"💬 意见箱｜我们想听你说":"en"===s?"💬 Feedback｜We Want to Hear You":"ja"===s?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===s?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===s?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===s?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===s?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),c?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:c.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:c.displayName||c.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(o)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:eC[s]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>a("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===s?"註冊/登入":"zh-CN"===s?"注册/登录":"en"===s?"Register / Login":"ja"===s?"登録/ログイン":"ko"===s?"가입/로그인":"th"===s?"สมัคร/เข้าสู่ระบบ":"vi"===s?"Đăng ký/Đăng nhập":"ms"===s?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:x,children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>m(e=>!e),children:["zh-TW"===s?"繁中":"zh-CN"===s?"简中":"en"===s?"English":"ja"===s?"日本語":"ko"===s?"한국어":"th"===s?"ไทย":"vi"===s?"Tiếng Việt":"ms"===s?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),p&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===s?"#6B5BFF":"#232946",fontWeight:e===s?700:500,background:e===s?"#f3f0ff":"#fff"},onClick:()=>{l(e),m(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:g,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>h(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),u&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===s||"zh-CN"===s?"法律文件":"en"===s?"Legal Documents":"ja"===s?"法的文書":"ko"===s?"법적 문서":"th"===s?"เอกสารทางกฎหมาย":"vi"===s?"Tài liệu pháp lý":"ms"===s?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:tC,titleKey:"privacy",path:"/privacy-policy"},{key:"terms",title:tC,titleKey:"terms",path:"/terms"},{key:"data",title:tC,titleKey:"deletion",path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>{var t;return f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{a(e.path),h(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.titleKey?(null==(t=e.title[s])?void 0:t[e.titleKey])||e.title["zh-TW"][e.titleKey]:e.title[s]||e.title["zh-TW"]},e.key)})]})]})]}),f.jsx(ZT,{onTestModeChange:b}),f.jsxs("div",{style:{width:"100%",maxWidth:500,margin:"120px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[f.jsxs("h1",{style:{fontWeight:900,fontSize:24,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[f.jsx("span",{role:"img","aria-label":"mission",children:"🎯"})," 挑戰任務"]}),f.jsx("p",{style:{fontSize:14,color:"#666",margin:"8px 0 0 0",textAlign:"center",lineHeight:1.4,fontWeight:400,whiteSpace:"nowrap"},children:"不斷挑戰自我，這次完成，下一次更進一步，騎過難關，突破極限。"})]}),f.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:N?"1rem 0 2rem 0":"2rem 0 2rem 0",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",marginTop:N?"120px":"20px"},children:[f.jsx("h1",{style:{textAlign:"center",fontWeight:700,fontSize:"2rem",marginBottom:8},children:w.title}),f.jsx("div",{style:{textAlign:"center",color:"#666",marginBottom:32},children:w.subtitle}),f.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 2px 8px #0001",marginBottom:24},children:[f.jsx("div",{style:{fontWeight:700,fontSize:"1.3rem",color:"#2a5d8f",marginBottom:8},children:(null==D?void 0:D.title)||""}),f.jsx("div",{style:{color:"#333",marginBottom:24},children:(null==D?void 0:D.desc)||""}),f.jsxs("form",{onSubmit:async e=>{e.preventDefault(),z(!0),A("");try{const e=await fetch("/api/mission-ai",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({step:j,input:T,history:I})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();A(t.reply||"AI教練祝福你！"),B(e=>[...e,T])}catch(t){A("發生錯誤，請稍後再試。錯誤詳情："+(t instanceof Error?t.message:"未知錯誤"))}finally{z(!1)}},children:[f.jsx("textarea",{value:T,onChange:e=>C(e.target.value),placeholder:(null==D?void 0:D.placeholder)||"",style:{width:"100%",minHeight:100,borderRadius:8,border:"1px solid #ccc",padding:12,marginBottom:16},required:!0}),f.jsx("button",{type:"submit",disabled:F||!T,style:{width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,border:"none",borderRadius:8,padding:"12px 0",cursor:F?"not-allowed":"pointer",opacity:F?.99:1,filter:"none",textShadow:"none",transition:"background 0.18s"},children:F?w.loading:w.submit})]}),R&&f.jsx("div",{style:{marginTop:24,background:"#f5f5f5",borderRadius:8,padding:16,color:"#2a5d8f"},children:R}),R&&j<((null==(n=w.steps)?void 0:n.length)||0)-1&&f.jsx("button",{onClick:()=>{C(""),A(""),S(j+1)},style:{marginTop:16,width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 0",cursor:"pointer",transition:"background 0.18s"},children:w.next}),R&&j===((null==(i=w.steps)?void 0:i.length)||0)-1&&f.jsxs("div",{style:{marginTop:24,textAlign:"center",color:"#e6b800",fontWeight:700,fontSize:20},children:[w.finish,f.jsx("br",{}),f.jsx("span",{style:{fontSize:16,color:"#888"},children:w.finishSub}),E&&f.jsx(W,{}),f.jsx("div",{style:{marginTop:24},children:f.jsx("button",{onClick:()=>{S(0),C(""),B([]),A("")},style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 32px",cursor:"pointer",marginTop:8,boxShadow:"0 2px 8px #0001",transition:"background 0.18s"},children:w.retry})})]})]}),f.jsx("div",{style:{textAlign:"center",color:"#aaa",fontSize:14},children:(w.steps||[]).map((e,t)=>f.jsx("span",{style:{display:"inline-block",width:18,height:18,borderRadius:"50%",background:t<=j?"#8ec6f7":"#e0e0e0",margin:"0 4px",border:t===j?"2px solid #2a5d8f":"none",transition:"all 0.2s"}},t))})]}),R&&j===((null==(r=w.steps)?void 0:r.length)||0)-1&&E&&f.jsx(W,{})]})}const rC={encouragement:"/videos/encouragement.mp4",reproach:"/videos/reproach.mp4",motivation:"/videos/motivation.mp4",disappointment:"/videos/disappointment.mp4",joy:"/videos/joy.mp4",lost:"/videos/lost.mp4",breakthrough:"/videos/breakthrough.mp4",clarity:"/videos/clarity.mp4",reluctance:"/videos/reluctance.mp4",confusion:"/videos/confusion.mp4",affection:"/videos/affection.mp4",regret:"/videos/regret.mp4",admiration:"/videos/admiration.mp4",teasing:"/videos/teasing.mp4"};function aC({reactionType:t,onEnd:n,style:i,className:r="",autoPlay:a=!0,...o}){const s=e.useRef(null);return e.useEffect(()=>{a&&s.current&&(s.current.currentTime=0,s.current.play())},[t,a]),f.jsx("div",{className:`video-reaction-player ${r}`,style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:3e3,background:"rgba(0,0,0,0.32)",display:"flex",alignItems:"center",justifyContent:"center",...i},...o,children:f.jsx("video",{ref:s,src:rC[t],style:{maxWidth:"90vw",maxHeight:"80vh",borderRadius:18,boxShadow:"0 8px 32px #0008",background:"#000"},autoPlay:a,onEnded:n,controls:!1,playsInline:!0})})}const oC=e.createContext({setVideoReaction:()=>{}});function sC({children:t}){const[n,i]=e.useState(null);return f.jsxs(oC.Provider,{value:{setVideoReaction:i},children:[t,n&&f.jsx(aC,{reactionType:n,onEnd:()=>i(null)})]})}const lC={backToHome:{"zh-TW":"← 返回首頁","zh-CN":"← 返回首页",ja:"← ホームへ戻る",en:"← Home",ko:"← 홈으로 돌아가기",th:"← กลับหน้าหลัก",vi:"← Về trang chủ",ms:"← Kembali ke Laman Utama",la:"← Ad domum redire"},back:{"zh-TW":"↩ 返回上一頁","zh-CN":"↩ 返回上一页",ja:"↩ 前のページへ",en:"↩ Back",ko:"↩ 이전 페이지로",th:"↩ กลับไป",vi:"↩ Quay lại",ms:"↩ Kembali",la:"↩ Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"配對對聊 PairTalk","zh-CN":"配对对聊 PairTalk",ja:"ペアトーク PairTalk",en:"PairTalk",ko:"페어톡",th:"คู่คุย",vi:"Trò chuyện đôi",ms:"PairTalk",la:"PairTalk"},subtitle:{"zh-TW":"劫後餘生的交友最珍貴，沒人怕跨出第一步！","zh-CN":"劫后余生的交友最珍贵，没人怕跨出第一步！",en:"Friendship after hardship is the most precious, no one is afraid to take the first step!",ja:"困難を乗り越えた後の友情こそが最も貴重、一歩踏み出すのは誰も怖くない！",ko:"역경 후의 우정이 가장 소중하며, 첫 걸음을 내딛는 것을 두려워하는 사람은 아무도 없습니다!",th:"มิตรภาพหลังความยากลำบากนั้นมีค่าที่สุด ไม่มีใครกลัวที่จะก้าวแรก!",vi:"Tình bạn sau gian khó là quý giá nhất, không ai ngại bước bước đầu tiên!",ms:"Persahabatan selepas kesusahan adalah yang paling berharga, tiada siapa yang takut untuk mengambil langkah pertama!",la:"Amicitia post aerumnas pretiosissima est, nemo primum gradum timere metuit!"},matchStatus:{"zh-TW":"配對狀態","zh-CN":"配对状态",ja:"マッチ状況",en:"Match Status",ko:"매칭 상태",th:"สถานะการจับคู่",vi:"Tình trạng ghép đôi",ms:"Status Padanan",la:"Status Par"},empty:{"zh-TW":"目前沒有配對，等待系統為你尋找夥伴...","zh-CN":"目前没有配对，等待系统为你寻找伙伴...",en:"No matches yet. Waiting for a companion...",ja:"まだマッチがありません。相手を探しています...",ko:"아직 매칭이 없습니다. 상대를 기다리는 중...",th:"ยังไม่มีคู่ รอระบบหาคู่ให้อยู่...",vi:"Chưa có ai được ghép đôi. Đang chờ hệ thống tìm bạn đồng hành...",ms:"Tiada padanan lagi. Menunggu teman...",la:"Nulli pares adhuc. Socium exspectans..."},todayMatch:{"zh-TW":"今日配對：","zh-CN":"今日配对：",ja:"今日のマッチ：",en:"Today's Match:",ko:"오늘의 매칭:",th:"คู่ของวันนี้:",vi:"Ghép đôi hôm nay:",ms:"Padanan Hari Ini:",la:"Par Hodiernus:"},timeLeft:{"zh-TW":"剩餘時間：","zh-CN":"剩余时间：",ja:"残り時間：",en:"Time Left:",ko:"남은 시간:",th:"เวลาที่เหลือ:",vi:"Thời gian còn lại:",ms:"Masa Tinggal:",la:"Tempus Reliquum:"},archive:{"zh-TW":"封存對話","zh-CN":"封存对话",ja:"アーカイブ",en:"Archive",ko:"보관",th:"เก็บถาวร",vi:"Lưu trữ",ms:"Arkib",la:"Archivum"},rematch:{"zh-TW":"重配","zh-CN":"重配",ja:"再マッチ",en:"Rematch",ko:"재매칭",th:"จับคู่ใหม่",vi:"Ghép lại",ms:"Padan semula",la:"Repar"},history:{"zh-TW":"歷史配對","zh-CN":"历史配对",ja:"履歴",en:"History",ko:"기록",th:"ประวัติ",vi:"Lịch sử",ms:"Sejarah",la:"Historia"},viewDetails:{"zh-TW":"查看完整資料","zh-CN":"查看完整资料",ja:"詳細を見る",en:"View Details",ko:"상세 정보 보기",th:"ดูรายละเอียด",vi:"Xem chi tiết",ms:"Lihat Butiran",la:"Singula Videre"},hideDetails:{"zh-TW":"收合資料","zh-CN":"收起资料",ja:"閉じる",en:"Hide",ko:"숨기기",th:"ซ่อน",vi:"Ẩn",ms:"Sembunyi",la:"Celare"},nickname:{"zh-TW":"暱稱","zh-CN":"昵称",ja:"ニックネーム",en:"Nickname",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Samaran",la:"Agnomen"},country:{"zh-TW":"國家","zh-CN":"国家",ja:"国",en:"Country",ko:"국가",th:"ประเทศ",vi:"Quốc gia",ms:"Negara",la:"Natio"},age:{"zh-TW":"年齡","zh-CN":"年龄",ja:"年齢",en:"Age",ko:"나이",th:"อายุ",vi:"Tuổi",ms:"Umur",la:"Aetas"},gender:{"zh-TW":"性別","zh-CN":"性别",ja:"性別",en:"Gender",ko:"성별",th:"เพศ",vi:"Giới tính",ms:"Jantina",la:"Genus"},interest:{"zh-TW":"興趣","zh-CN":"兴趣",ja:"趣味",en:"Interest",ko:"관심사",th:"ความสนใจ",vi:"Sở thích",ms:"Minat",la:"Studium"},eventType:{"zh-TW":"事件類型","zh-CN":"事件类型",ja:"イベントタイプ",en:"Event Type",ko:"이벤트 유형",th:"ประเภทเหตุการณ์",vi:"Loại sự kiện",ms:"Jenis Acara",la:"Genus Eventus"},bio:{"zh-TW":"簡介","zh-CN":"简介",ja:"自己紹介",en:"Bio",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Bio"},sendGift:{"zh-TW":"送出禮物","zh-CN":"送出礼物",ja:"ギフトを送る",en:"Send Gift",ko:"선물 보내기",th:"ส่งของขวัญ",vi:"Gửi quà",ms:"Hantar Hadiah",la:"Donum Mittere"},sendEmail:{"zh-TW":"發送Email","zh-CN":"发送Email",ja:"メール送信",en:"Send Email",ko:"이메일 보내기",th:"ส่งอีเมล",vi:"Gửi Email",ms:"Hantar E-mel",la:"Epistulam Mittere"},next:{"zh-TW":"下一頁","zh-CN":"下一页",ja:"次へ",en:"Next",ko:"다음",th:"ถัดไป",vi:"Tiếp",ms:"Seterusnya",la:"Proximus"},lastPage:{"zh-TW":"最後一頁","zh-CN":"最后一页",ja:"最後のページ",en:"Last page",ko:"마지막 페이지",th:"หน้าสุดท้าย",vi:"Trang cuối",ms:"Halaman terakhir",la:"Pagina Ultima"}},cC=[{id:1,partner:"小明",status:"active",aiGuide:"你可以問對方：今天過得如何？"},{id:2,partner:"Sandy",status:"archived",aiGuide:"你可以問對方：最近有什麼開心的事？"}],dC=[{id:1,nickname:"Alice",country:"台灣",age:28,gender:"female",email:"alice@example.com",bio:"喜歡閱讀與旅行",interest:"閱讀",eventType:"經濟",avatar:"/avatars/female1.jpg"},{id:2,nickname:"Bob",country:"日本",age:32,gender:"male",email:"bob@example.com",bio:"音樂愛好者",interest:"音樂",eventType:"科技",avatar:"/avatars/male1.jpg"}],uC={"zh-TW":{male:"男性",female:"女性",other:"其他"},"zh-CN":{male:"男性",female:"女性",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},hC=[{value:"🌹",label:"🌹"},{value:"💍",label:"💍"},{value:"🍰",label:"🍰"},{value:"🎩",label:"🎩"},{value:"🌺",label:"🌺"},{value:"👗",label:"👗"},{value:"✒️",label:"✒️"},{value:"🏎️",label:"🏎️"}],pC={"zh-TW":"歲","zh-CN":"岁",en:"yrs",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"anni"};function mC(){var t,n,r,a;const o=le(),s=Fv(),l=(null==(t=s.currentUser)?void 0:t.email)||"",c=mw(),[d,u]=e.useState(JSON.parse(localStorage.getItem("pairs")||"[]")||cC),[h,p]=e.useState(300),[m,g]=e.useState((null==(n=d.find(e=>"active"===e.status))?void 0:n.id)||null),[x,y]=e.useState("AI：記得保持友善，互相傾聽！"),[b,v]=e.useState(0),k=dC[b],[w,j]=e.useState(!1),[S,T]=e.useState(hC[0].value),{setVideoReaction:C}=e.useContext(oC);i.useEffect(()=>{if(m){const e=setInterval(()=>p(e=>e>0?e-1:0),1e3);return()=>clearInterval(e)}},[m]);return f.jsxs("div",{className:"modern-bg",style:{background:"url('/valley.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[f.jsxs("div",{style:{position:"absolute",top:0,left:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent"},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>o("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginRight:8},onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:lC.backToHome[c]}),"/pairtalk"!==window.location.pathname&&f.jsx("button",{className:"topbar-btn",onClick:()=>o(-1),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginLeft:8},onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:lC.back[c]})]}),f.jsxs("div",{style:{position:"absolute",top:0,right:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",gap:12},children:[f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(s),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:lC.logout[c]}),f.jsx(fw,{})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[f.jsxs("h2",{style:{fontSize:"2.2rem",fontWeight:900,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,background:"#fff",borderRadius:12,boxShadow:"0 2px 12px #6B5BFF22",padding:"12px 32px",margin:0,marginBottom:24,display:"flex",alignItems:"center",gap:12},children:["🤝 ",lC.pageTitle[c]]}),f.jsxs("div",{style:{maxWidth:540,width:"100%",background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[f.jsx("div",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:24,textAlign:"center",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008"},children:lC.subtitle[c]}),f.jsx("h2",{style:{fontSize:28,fontWeight:900,marginBottom:18},children:lC.pageTitle[c]}),f.jsxs("div",{style:{marginTop:18},children:[f.jsx("b",{children:lC.matchStatus[c]}),f.jsx("div",{style:{marginTop:8},children:lC.empty[c]})]}),m?f.jsxs("div",{style:{marginBottom:16},children:[f.jsx("b",{children:lC.todayMatch[c]})," ",null==(r=d.find(e=>e.id===m))?void 0:r.partner,f.jsxs("div",{style:{marginTop:8,color:"#6B5BFF"},children:[lC.timeLeft[c],Math.floor(h/60),":",(h%60).toString().padStart(2,"0")]}),f.jsx("div",{style:{marginTop:8,color:"#23c6e6"},children:null==(a=d.find(e=>e.id===m))?void 0:a.aiGuide}),f.jsx("div",{style:{marginTop:8,color:"#614425"},children:x}),f.jsx("button",{onClick:()=>{return e=m,u(d.map(t=>t.id===e?{...t,status:"archived"}:t)),localStorage.setItem("pairs",JSON.stringify(d.map(t=>t.id===e?{...t,status:"archived"}:t))),void C("disappointment");var e},style:{marginTop:10,borderRadius:8,background:"#eee",color:"#6B5BFF",border:"none",fontWeight:700,padding:"6px 18px"},children:lC.archive[c]}),f.jsx("button",{onClick:()=>{C("breakthrough")},style:{marginTop:10,marginLeft:10,borderRadius:8,background:"#6B5BFF",color:"#fff",border:"none",fontWeight:700,padding:"6px 18px"},children:lC.rematch[c]})]}):f.jsx("div",{style:{color:"#614425",fontSize:18,textAlign:"center",marginTop:40},children:lC.empty[c]}),f.jsxs("div",{style:{marginTop:18},children:[f.jsx("b",{children:lC.history[c]}),f.jsx("ul",{style:{marginTop:8,paddingLeft:0,listStyle:"none"},children:d.filter(e=>"archived"===e.status).map((e,t)=>f.jsxs("li",{style:{background:"#f7f7ff",borderRadius:8,padding:10,marginBottom:8},children:[f.jsx("div",{style:{fontWeight:700},children:e.partner}),f.jsx("div",{style:{color:"#614425",marginTop:4},children:e.aiGuide})]},t))})]}),f.jsxs("div",{style:{width:"100%",maxWidth:420,margin:"0 auto",background:"#f7f7ff",borderRadius:16,padding:24,boxShadow:"0 2px 12px #6B5BFF11",marginBottom:24,textAlign:"center",position:"relative"},children:[f.jsx("img",{src:k.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:12}}),f.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#6B5BFF",marginBottom:6},children:k.nickname}),f.jsxs("div",{style:{color:"#614425",fontSize:16,marginBottom:6},children:[k.country," / ",k.age,pC[c]," / ",uC[c][k.gender]]}),f.jsx("button",{onClick:()=>j(e=>!e),style:{margin:"8px 0",padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",cursor:"pointer",fontSize:15,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff",e.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF",e.currentTarget.style.boxShadow="none"},children:w?lC.hideDetails[c]:lC.viewDetails[c]}),w&&f.jsxs("div",{style:{marginTop:8,color:"#232946",fontSize:15,background:"#fff",borderRadius:8,padding:12,boxShadow:"0 2px 8px #6B5BFF11",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[f.jsx("img",{src:k.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:6}}),f.jsxs("div",{children:[f.jsxs("b",{children:[lC.nickname[c],"："]}),k.nickname]}),f.jsxs("div",{children:[f.jsxs("b",{children:[lC.country[c],"："]}),k.country]}),f.jsxs("div",{children:[f.jsxs("b",{children:[lC.age[c],"："]}),k.age]}),f.jsxs("div",{children:[f.jsxs("b",{children:[lC.gender[c],"："]}),uC[c][k.gender]]}),f.jsxs("div",{children:[f.jsx("b",{children:"Email："}),k.email]}),f.jsxs("div",{children:[f.jsxs("b",{children:[lC.interest[c],"："]}),k.interest]}),f.jsxs("div",{children:[f.jsxs("b",{children:[lC.eventType[c],"："]}),k.eventType]}),f.jsxs("div",{children:[f.jsxs("b",{children:[lC.bio[c],"："]}),k.bio]})]}),f.jsxs("div",{style:{marginTop:14,display:"flex",flexDirection:"row",gap:10,justifyContent:"center",alignItems:"center"},children:[f.jsx("select",{value:S,onChange:e=>T(e.target.value),style:{padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",fontSize:18},children:hC.map(e=>f.jsx("option",{value:e.value,children:e.label},e.value))}),f.jsx("button",{onClick:()=>{alert(`${S} 已送出給 ${k.nickname}！`)},style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,transition:"background 0.18s, box-shadow 0.18s"},onMouseOver:e=>{e.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",e.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:e=>{e.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",e.currentTarget.style.boxShadow="none"},children:lC.sendGift[c]}),f.jsx("button",{onClick:()=>{window.location.href=`mailto:${k.email}?subject=PairTalk&body=Hi${l?`&from=${l}`:""}`},style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",fontSize:16,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff",e.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF",e.currentTarget.style.boxShadow="none"},children:lC.sendEmail[c]})]}),f.jsx("button",{onClick:()=>{dC.length<=1||b===dC.length-1?alert(lC.lastPage[c]):(j(!1),v(e=>e+1))},style:{position:"absolute",right:18,bottom:0,transform:"translateY(60px)",padding:"8px 24px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,boxShadow:"0 2px 8px #6B5BFF33",transition:"background 0.18s, box-shadow 0.18s, transform 0.18s",cursor:"pointer"},onMouseOver:e=>{e.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",e.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99",e.currentTarget.style.transform="translateY(55px) scale(1.04)"},onMouseOut:e=>{e.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",e.currentTarget.style.boxShadow="0 2px 8px #6B5BFF33",e.currentTarget.style.transform="translateY(60px)"},children:lC.next[c]})]})]})]}),f.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>o("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),f.jsx("span",{onClick:()=>o("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),f.jsx("span",{onClick:()=>o("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),f.jsx("span",{onClick:()=>o("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),f.jsx("span",{onClick:()=>o("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const gC={pageTitle:{"zh-TW":"情境模擬室 SkillBox","zh-CN":"情境模拟室 SkillBox",en:"SkillBox Scenario Room",ja:"シナリオ練習室 SkillBox",ko:"상황 시뮬레이션실 SkillBox",th:"ห้องจำลองสถานการณ์ SkillBox",vi:"Phòng mô phỏng tình huống SkillBox",ms:"Bilik Senario SkillBox",la:"Camera Scaenarii SkillBox"},subtitle:{"zh-TW":"在這裡磨練你的對話技巧，應對各種挑戰。","zh-CN":"在这里磨练你的对话技巧，应对各种挑战。",en:"Hone your conversation skills here for any challenge.",ja:"ここで会話スキルを磨き、様々な挑戦に備えましょう。",ko:"여기서 대화 기술을 연마하여 모든 도전에 대비하세요.",th:"ฝึกฝนทักษะการสนทนาของคุณที่นี่เพื่อรับมือกับทุกความท้าทาย",vi:"Rèn luyện kỹ năng trò chuyện của bạn ở đây cho mọi thử thách.",ms:"Asah kemahiran perbualan anda di sini untuk sebarang cabaran.",la:"Hic peritiam colloquii tui exacue ad quamvis provocationem."},selectScenario:{"zh-TW":"選擇一個情境開始練習","zh-CN":"选择一个情境开始练习",en:"Select a scenario to start practicing",ja:"練習を始めるシナリオを選択してください",ko:"연습을 시작할 시나리오를 선택하세요",th:"เลือกสถานการณ์เพื่อเริ่มฝึก",vi:"Chọn một kịch bản để bắt đầu luyện tập",ms:"Pilih senario untuk mula berlatih",la:"Scaenarium elige ut exercere incipias"},startPractice:{"zh-TW":"進入模擬","zh-CN":"进入模拟",en:"Enter Simulation",ja:"シミュレーションに入る",ko:"시뮬레이션 시작",th:"เข้าสู่การจำลอง",vi:"Vào mô phỏng",ms:"Masuk Simulasi",la:"Intra Simulationem"},scenarioDifficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy",ms:"Batal",la:"Abstinere"}};function fC(){var t,n,i;const r=le();Fv();const{lang:a}=mw(),o=a||localStorage.getItem("lang")||"zh-TW",[s,l]=e.useState(null),[c,d]=e.useState([]),[u,h]=e.useState(!0),[p,m]=e.useState(!1),[g,x]=e.useState(null),[y,b]=e.useState(!1),v=e.useRef(null);e.useEffect(()=>{(async()=>{h(!0);try{const e=await fetch(`/locales/${o}/scenarios.json`);if(!e.ok)throw new Error("Failed to fetch scenarios");const t=await e.json();d(t)}catch(e){d([])}finally{h(!1)}})()},[o]),e.useEffect(()=>{if(!y)return;const e=e=>{v.current&&!v.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[y]);const k=()=>{m(!1),x(null),l(null)};return u?f.jsx("div",{children:"Loading scenarios..."}):f.jsxs("div",{className:"modern-bg",style:{background:"url('/plains.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[f.jsx("div",{className:"mobile-shared-header",children:f.jsx(zw,{})}),window.innerWidth>768?f.jsxs("div",{className:"desktop-topbar",children:[f.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>r("/")})}),f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>r("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},children:"zh-TW"===o?"🧬 Restarter™｜我們是誰":"zh-CN"===o?"🧬 Restarter™｜我们是谁":"en"===o?"🧬 Restarter™｜Who We Are":"ja"===o?"🧬 Restarter™｜私たちについて":"ko"===o?"🧬 Restarter™｜우리는 누구인가":"th"===o?"🧬 Restarter™｜เราเป็นใคร":"vi"===o?"🧬 Restarter™｜Chúng tôi là ai":"ms"===o?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>r("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},children:"zh-TW"===o?"💬 意見箱｜我們想聽你說":"zh-CN"===o?"💬 意见箱｜我们想听你说":"en"===o?"💬 Feedback｜We Want to Hear You":"ja"===o?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===o?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===o?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===o?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===o?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),Fv().currentUser?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:(null==(t=Fv().currentUser)?void 0:t.photoURL)||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:(null==(n=Fv().currentUser)?void 0:n.displayName)||(null==(i=Fv().currentUser)?void 0:i.email)||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{const e=Fv();await e.signOut()},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:{"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"}[o]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>r("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===o?"註冊/登入":"zh-CN"===o?"注册/登录":"en"===o?"Register / Login":"ja"===o?"登録/ログイン":"ko"===o?"가입/로그인":"th"===o?"สมัคร/เข้าสู่ระบบ":"vi"===o?"Đăng ký/Đăng nhập":"ms"===o?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:v,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>b(e=>!e),children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),y&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"法律文件"})}),[{key:"privacy",title:"隱私政策",path:"/privacy-policy"},{key:"terms",title:"使用條款",path:"/terms"},{key:"data",title:"數據刪除",path:"/data-deletion"},{key:"ai",title:"AI使用聲明",path:"/ai-statement"},{key:"mental",title:"心理健康免責聲明",path:"/mental-health-disclaimer"},{key:"cookie",title:"Cookie政策",path:"/cookie-policy"},{key:"children",title:"兒童隱私保護",path:"/children-privacy"},{key:"international",title:"國際用戶聲明",path:"/international-users"},{key:"security",title:"安全聲明",path:"/security-statement"},{key:"update",title:"更新通知機制",path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"8px 16px",cursor:"pointer",color:"#232946",fontSize:"13px",transition:"all 0.2s ease",borderRadius:"4px",margin:"2px 8px"},onClick:()=>{r(e.path),b(!1)},children:e.title},e.key))]})]})]})]}):null,window.innerWidth>768?f.jsx("div",{style:{width:"100%",maxWidth:500,margin:"120px auto 0 auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:f.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[f.jsx("span",{role:"img","aria-label":"skillbox",children:"🛠️"})," ",gC.pageTitle[o]]})}):null,f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",width:"100%",padding:window.innerWidth<=768?"16px":"24px",marginTop:window.innerWidth<=768?80:20,minHeight:"calc(100vh - 120px)",overflowY:"auto"},children:[window.innerWidth<=768&&f.jsxs("h1",{style:{fontSize:22,fontWeight:900,color:"#6B5BFF",marginBottom:12,textAlign:"center",background:"rgba(255,255,255,0.95)",padding:"12px 20px",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsx("span",{role:"img","aria-label":"skillbox",children:"🛠️"})," 情境模擬室 SkillBox"]}),f.jsx("div",{style:{fontSize:16,color:"#4A4A4A",fontWeight:500,marginBottom:20,textAlign:"center",background:"rgba(255,255,255,0.7)",padding:"8px 16px",borderRadius:8},children:gC.subtitle[o]}),f.jsxs("div",{style:{maxWidth:800,width:window.innerWidth<=768?"95%":"90%",background:"#fff",borderRadius:16,padding:window.innerWidth<=768?"20px 16px":"24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center",margin:window.innerWidth<=768?"0 8px":"0"},children:[f.jsx("h3",{style:{fontSize:24,fontWeight:700,color:"#6B5BFF",marginBottom:24},children:gC.selectScenario[o]}),f.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:window.innerWidth<=768?"repeat(2, 1fr)":"repeat(auto-fit, minmax(200px, 1fr))",gap:window.innerWidth<=768?"16px":"24px"},children:c.map(e=>f.jsxs("div",{onClick:()=>(e=>{x(e),l(e.id),m(!0)})(e),style:{background:s===e.id?"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)":"#e8e6ff",color:s===e.id?"#fff":"#2D2D2D",borderRadius:12,padding:window.innerWidth<=768?16:20,boxShadow:s===e.id?"0 8px 24px #6B5BFF66":"0 4px 12px #0000001a",cursor:"pointer",transition:"all 0.3s ease",border:s===e.id?"2px solid #fff":"2px solid transparent",transform:s===e.id?"translateY(-5px)":"none",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:window.innerWidth<=768?36:48,marginBottom:window.innerWidth<=768?8:12},children:e.emoji}),f.jsx("h4",{style:{fontSize:window.innerWidth<=768?16:18,fontWeight:700,margin:"0 0 8px 0"},children:e.title}),f.jsx("p",{style:{fontSize:window.innerWidth<=768?12:14,margin:"0 0 12px 0",opacity:.8,minHeight:window.innerWidth<=768?"32px":"40px"},children:e.description}),f.jsxs("div",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:s===e.id?"rgba(255,255,255,0.2)":"rgba(107, 91, 255, 0.1)",color:s===e.id?"#fff":"#6B5BFF"},children:[gC.scenarioDifficulty[o],": ",e.difficulty]})]},e.id))})]})]}),p&&g&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:k,children:f.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",maxWidth:400,width:"90%",textAlign:"center",position:"relative"},onClick:e=>e.stopPropagation(),children:[f.jsx("button",{onClick:k,style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,cursor:"pointer",color:"#999",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#f0f0f0",onMouseOut:e=>e.currentTarget.style.backgroundColor="transparent",children:"×"}),f.jsx("div",{style:{fontSize:48,marginBottom:16},children:g.emoji}),f.jsx("h3",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",margin:"0 0 8px 0"},children:g.title}),f.jsx("p",{style:{fontSize:14,color:"#666",margin:"0 0 16px 0",lineHeight:1.5},children:g.description}),f.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[f.jsx("button",{onClick:k,style:{padding:"10px 20px",borderRadius:8,border:"1px solid #ddd",background:"#f8f9fa",color:"#666",cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s"},onMouseOver:e=>e.currentTarget.style.background="#e9ecef",onMouseOut:e=>e.currentTarget.style.background="#f8f9fa",children:gC.cancelButton[o]||"取消"}),f.jsx("button",{onClick:()=>{s?r(`/skillbox/${s}`):alert(gC.selectScenario[o])},style:{padding:"10px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)",color:"#fff",cursor:"pointer",fontSize:14,fontWeight:700,transition:"all 0.2s",boxShadow:"0 4px 12px rgba(107, 91, 255, 0.3)"},onMouseOver:e=>e.currentTarget.style.transform="translateY(-1px)",onMouseOut:e=>e.currentTarget.style.transform="translateY(0)",children:gC.startPractice[o]})]})]})}),f.jsx("style",{children:"\n        @media (min-width: 768px) {\n          .mobile-shared-header {\n            display: none !important;\n          }\n        }\n        @media (max-width: 767px) {\n          .mobile-shared-header {\n            display: block !important;\n          }\n        }\n      "})]})}const xC={"zh-TW":f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ 使用條款與更生者聲明"}),f.jsx("h2",{children:"一、平台理念聲明"}),f.jsx("p",{children:"Restarter™ 是幫助更生人社會、心理、生活自信恢復的 AI 平台。我們透過情感引導、角色扮演、任務挑戰，協助用戶釋放負面情緒、重建目標與自信，更引導使用者逐步建立內在動力與行動信心。"}),f.jsx("p",{children:"我們相信每一位更生人都值得被尊重與重新認識。即使你曾經犯錯，在這裡不再被貼標籤。"}),f.jsx("h2",{children:"二、用戶身份與行為規範"}),f.jsx("p",{children:"本平台歡迎曾經服刑、戒癮、感化、接受司法保護、霸凌或因社會排斥而渴望重新開始的個人註冊使用。"}),f.jsx("p",{children:"為確保社群安全與信任，嚴禁下列行為："}),f.jsxs("ul",{children:[f.jsx("li",{children:"冒用他人身份或誤導他人註冊資料"}),f.jsx("li",{children:"散佈仇恨、歧視、暴力、色情、違法內容"}),f.jsx("li",{children:"上傳侵犯他人肖像權或機敏資料的圖片"})]}),f.jsx("p",{children:"違反上述條款者，平台有權立即中止其帳號與使用權限。"}),f.jsx("h2",{children:"三、AI 使用與責任聲明"}),f.jsx("p",{children:"平台所提供的 AI 對話、建議與角色模擬，僅供陪伴、練習與個人成長參考，不構成法律、醫療或心理專業意見。"}),f.jsxs("ul",{children:[f.jsx("li",{children:"平台不對使用者依據 AI 輸出所做的決策承擔法律責任"}),f.jsx("li",{children:"平台不保證 AI 對話完全正確或與真實情境一致"}),f.jsx("li",{children:"請勿將 AI 對話內容散佈作為公共引用資訊"})]}),f.jsx("p",{children:"我們已設置基本風險過濾與話術限制，但 AI 存在輸出偏差或感受誤解的可能。"}),f.jsx("p",{children:"若遇到不適當內容，請透過回報機制通知我們，我們將持續優化模型。"}),f.jsx("h3",{children:"三之一、AI 對話內容使用規範"}),f.jsxs("ul",{children:[f.jsx("li",{children:"不得詢問或輸入他人私密資訊（如住址、犯罪紀錄）"}),f.jsx("li",{children:"不得操作 AI 模擬暴力、自殘或誘導非法行為"}),f.jsx("li",{children:"不得以 Restarter™ 名義散佈虛假或詐騙訊息"}),f.jsx("li",{children:"所有對話資料僅用於匿名模型優化，不作個人追蹤"}),f.jsx("li",{children:"如有必要，平台保留法律配合義務"}),f.jsx("li",{children:"未滿十八歲使用者，需經家長同意方可使用本平台"}),f.jsx("li",{children:"本平台禁止自動爬蟲或未授權系統串接"}),f.jsx("li",{children:"使用者需自負資料輸入內容之法律風險"})]}),f.jsx("h2",{children:"四、資料處理與隱私權聲明"}),f.jsx("p",{children:"平台僅會蒐集註冊所需最基本資料，如暱稱、電子信箱與使用語言偏好。"}),f.jsx("p",{children:"所有資料經加密儲存，不會轉售第三方或做商業行銷使用。"}),f.jsx("p",{children:"使用者可隨時申請帳號刪除，並請求系統清除其所有紀錄。"}),f.jsx("h2",{children:"五、帳號停用與終止權利"}),f.jsx("p",{children:"平台保留中止任何違反本條款使用者帳號的權利，且無須事前通知。"}),f.jsx("p",{children:"如帳號長期未使用，平台將主動發出提醒並保留停用處理權限。"}),f.jsx("p",{children:"用戶可自行隨時停用帳號並刪除所有資料紀錄。"}),f.jsx("h2",{children:"六、本條款之調整與最終解釋權"}),f.jsx("p",{children:"平台有權依據法律、政策與服務優化隨時修改本條款內容。"}),f.jsx("p",{children:"重大異動將透過站內公告與電子郵件通知用戶。"}),f.jsx("p",{children:"本條款之最終解釋權歸 Restarter™ 平台所有。"})]}),"zh-CN":f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ 使用条款与更生者声明"}),f.jsx("h2",{children:"一、平台理念声明"}),f.jsx("p",{children:"Restarter™ 是帮助更生人社会、心理、生活自信恢复的 AI 平台。我们通过情感引导、角色扮演、任务挑战，协助用户释放负面情绪、重建目标与自信，并引导用户逐步建立内在动力与行动信心。"}),f.jsx("p",{children:"我们相信每一位更生人都值得被尊重与重新认识。即使你曾经犯错，在这里不再被贴标签。"}),f.jsx("h2",{children:"二、用户身份与行为规范"}),f.jsx("p",{children:"本平台欢迎曾经服刑、戒瘾、感化、接受司法保护、霸凌或因社会排斥而渴望重新开始的个人注册使用。"}),f.jsx("p",{children:"为确保社群安全与信任，严禁下列行为："}),f.jsxs("ul",{children:[f.jsx("li",{children:"冒用他人身份或误导他人注册资料"}),f.jsx("li",{children:"散布仇恨、歧视、暴力、色情、违法内容"}),f.jsx("li",{children:"上传侵犯他人肖像权或敏感资料的图片"})]}),f.jsx("p",{children:"违反上述条款者，平台有权立即中止其账号与使用权限。"}),f.jsx("h2",{children:"三、AI 使用与责任声明"}),f.jsx("p",{children:"平台所提供的 AI 对话、建议与角色模拟，仅供陪伴、练习与个人成长参考，不构成法律、医疗或心理专业意见。"}),f.jsxs("ul",{children:[f.jsx("li",{children:"平台不对用户依据 AI 输出所做的决策承担法律责任"}),f.jsx("li",{children:"平台不保证 AI 对话完全正确或与真实情境一致"}),f.jsx("li",{children:"请勿将 AI 对话内容散布作为公共引用信息"})]}),f.jsx("p",{children:"我们已设置基本风险过滤与话术限制，但 AI 存在输出偏差或感受误解的可能。"}),f.jsx("p",{children:"若遇到不适当内容，请通过举报机制通知我们，我们将持续优化模型。"}),f.jsx("h3",{children:"三之一、AI 对话内容使用规范"}),f.jsxs("ul",{children:[f.jsx("li",{children:"不得询问或输入他人私密信息（如住址、犯罪记录）"}),f.jsx("li",{children:"不得操作 AI 模拟暴力、自残或诱导非法行为"}),f.jsx("li",{children:"不得以 Restarter™ 名义散布虚假或诈骗信息"}),f.jsx("li",{children:"全对话资料仅用于匿名模型优化，不作个人追踪"}),f.jsx("li",{children:"如有必要，平台保留法律配合义务"}),f.jsx("li",{children:"未满十八岁用户，需经家长同意方可使用本平台"}),f.jsx("li",{children:"本平台禁止自动爬虫或未授权系统串接"}),f.jsx("li",{children:"用户需自负资料输入内容之法律风险"})]}),f.jsx("h2",{children:"四、资料处理与隐私权声明"}),f.jsx("p",{children:"平台仅会收集注册所需最基本资料，如昵称、电子邮箱与使用语言偏好。"}),f.jsx("p",{children:"所有资料经加密存储，不会转售第三方或做商业营销使用。"}),f.jsx("p",{children:"用户可随时申请账号删除，并请求系统清除其所有记录。"}),f.jsx("h2",{children:"五、账号停用与终止权利"}),f.jsx("p",{children:"平台保留中止任何违反本条款用户账号的权利，且无需事前通知。"}),f.jsx("p",{children:"如账号长期未使用，平台将主动发出提醒并保留停用处理权限。"}),f.jsx("p",{children:"用户可自行随时停用账号并删除所有资料记录。"}),f.jsx("h2",{children:"六、本条款之调整与最终解释权"}),f.jsx("p",{children:"平台有权依据法律、政策与服务优化随时修改本条款内容。"}),f.jsx("p",{children:"重大变动将通过站内公告与电子邮件通知用户。"}),f.jsx("p",{children:"本条款之最终解释权归 Restarter™ 平台所有。"})]}),en:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ Terms of Use and Ex-Offender Declaration"}),f.jsx("h2",{children:"1. Platform Philosophy Statement"}),f.jsx("p",{children:"Restarter™ is an AI platform dedicated to helping ex-offenders rebuild social, psychological, and life confidence. Through emotional guidance, role-playing, and task challenges, we help users release negative emotions, rebuild goals and confidence, and guide them to gradually build inner motivation and action confidence."}),f.jsx("p",{children:"We believe that every ex-offender deserves respect and a new recognition. Even if you have made mistakes, you will not be labeled here."}),f.jsx("h2",{children:"2. User Identity and Code of Conduct"}),f.jsx("p",{children:"This platform welcomes individuals who have served sentences, undergone rehabilitation, received judicial protection, experienced bullying, or wish to start over due to social exclusion."}),f.jsx("p",{children:"To ensure community safety and trust, the following behaviors are strictly prohibited:"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Impersonating others or providing misleading registration information"}),f.jsx("li",{children:"Spreading hate, discrimination, violence, pornography, or illegal content"}),f.jsx("li",{children:"Uploading images that infringe on others' portrait rights or sensitive data"})]}),f.jsx("p",{children:"Those who violate the above terms may have their accounts and access immediately terminated by the platform."}),f.jsx("h2",{children:"3. AI Usage and Responsibility Statement"}),f.jsx("p",{children:"The AI dialogues, suggestions, and role simulations provided by the platform are for companionship, practice, and personal growth reference only, and do not constitute legal, medical, or psychological professional advice."}),f.jsxs("ul",{children:[f.jsx("li",{children:"The platform is not legally responsible for decisions made by users based on AI output"}),f.jsx("li",{children:"The platform does not guarantee that AI dialogues are completely accurate or consistent with real situations"}),f.jsx("li",{children:"Do not distribute AI dialogue content as public reference information"})]}),f.jsx("p",{children:"We have set up basic risk filtering and dialogue restrictions, but AI may still produce biased or misunderstood outputs."}),f.jsx("p",{children:"If you encounter inappropriate content, please notify us through the reporting mechanism, and we will continue to optimize the model."}),f.jsx("h3",{children:"3.1 AI Dialogue Content Usage Guidelines"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Do not ask for or input others' private information (such as address or criminal record)"}),f.jsx("li",{children:"Do not use AI to simulate violence, self-harm, or induce illegal behavior"}),f.jsx("li",{children:"Do not distribute false or fraudulent information in the name of Restarter™"}),f.jsx("li",{children:"All dialogue data is used only for anonymous model optimization, not for personal tracking"}),f.jsx("li",{children:"The platform reserves the right to cooperate with legal authorities if necessary"}),f.jsx("li",{children:"Users under 18 must have parental consent to use this platform"}),f.jsx("li",{children:"The platform prohibits automated crawling or unauthorized system integration"}),f.jsx("li",{children:"Users are responsible for the legal risks of the content they input"})]}),f.jsx("h2",{children:"4. Data Processing and Privacy Statement"}),f.jsx("p",{children:"The platform only collects the most basic registration information, such as nickname, email, and language preference."}),f.jsx("p",{children:"All data is stored encrypted and will not be sold to third parties or used for commercial marketing."}),f.jsx("p",{children:"Users can request account deletion at any time and ask the system to clear all their records."}),f.jsx("h2",{children:"5. Account Suspension and Termination Rights"}),f.jsx("p",{children:"The platform reserves the right to terminate any user's account that violates these terms at any time without prior notice."}),f.jsx("p",{children:"If an account is inactive for a long period, the platform will proactively send reminders and reserves the right to suspend the account."}),f.jsx("p",{children:"Users can deactivate their accounts and delete all data records at any time."}),f.jsx("h2",{children:"6. Amendments and Final Interpretation"}),f.jsx("p",{children:"The platform reserves the right to modify these terms at any time in accordance with laws, policies, and service optimization."}),f.jsx("p",{children:"Major changes will be announced on the platform and via email notifications to users."}),f.jsx("p",{children:"The final interpretation of these terms belongs to the Restarter™ platform."})]}),ja:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ 利用規約および更生者宣言"}),f.jsx("h2",{children:"1. プラットフォーム理念声明"}),f.jsx("p",{children:"Restarter™ は更生者の社会的・心理的・生活的自信の回復を支援するAIプラットフォームです。感情ガイダンス、ロールプレイ、タスクチャレンジを通じて、ユーザーがネガティブな感情を解放し、目標と自信を再構築し、内面の動機と行動への自信を段階的に築くことをサポートします。"}),f.jsx("p",{children:"私たちは、すべての更生者が尊重され、新たに認識される価値があると信じています。過去に過ちを犯したとしても、ここではラベルを貼られません。"}),f.jsx("h2",{children:"2. ユーザーの身分と行動規範"}),f.jsx("p",{children:"本プラットフォームは、服役経験者、依存症克服者、感化・司法保護を受けた方、いじめや社会的排除を経験し再出発を望む方の登録を歓迎します。"}),f.jsx("p",{children:"コミュニティの安全と信頼を守るため、以下の行為を厳禁とします："}),f.jsxs("ul",{children:[f.jsx("li",{children:"他人の身分を詐称または誤った登録情報の提供"}),f.jsx("li",{children:"憎悪・差別・暴力・ポルノ・違法コンテンツの拡散"}),f.jsx("li",{children:"他人の肖像権や機密情報を侵害する画像のアップロード"})]}),f.jsx("p",{children:"上記規約に違反した場合、プラットフォームは直ちにアカウントと利用権限を停止する権利を有します。"}),f.jsx("h2",{children:"3. AI利用と責任声明"}),f.jsx("p",{children:"本プラットフォームが提供するAI対話・提案・ロールプレイは、伴走・練習・自己成長の参考用であり、法的・医療的・心理的な専門アドバイスではありません。"}),f.jsxs("ul",{children:[f.jsx("li",{children:"AI出力に基づく意思決定に対し、プラットフォームは法的責任を負いません"}),f.jsx("li",{children:"AI対話が常に正確または現実と一致することを保証しません"}),f.jsx("li",{children:"AI対話内容を公共の引用情報として拡散しないでください"})]}),f.jsx("p",{children:"基本的なリスクフィルタと発話制限を設けていますが、AIには出力の偏りや誤解が生じる可能性があります。"}),f.jsx("p",{children:"不適切な内容に遭遇した場合は、報告機能からご連絡ください。モデルの最適化に努めます。"}),f.jsx("h3",{children:"3.1 AI対話内容の利用規範"}),f.jsxs("ul",{children:[f.jsx("li",{children:"他人の個人情報（住所・犯罪歴等）を尋ねたり入力しない"}),f.jsx("li",{children:"AIで暴力・自傷・違法行為を模擬しない"}),f.jsx("li",{children:"Restarter™名義で虚偽・詐欺情報を拡散しない"}),f.jsx("li",{children:"全対話データは匿名モデル最適化のみに利用し、個人追跡はしません"}),f.jsx("li",{children:"必要に応じて法的協力義務を負います"}),f.jsx("li",{children:"未満18歳の方は保護者の同意が必要です"}),f.jsx("li",{children:"自動クローラーや未承認システム連携は禁止します"}),f.jsx("li",{children:"入力内容の法的リスクは利用者自身が負います"})]}),f.jsx("h2",{children:"4. データ処理とプライバシー声明"}),f.jsx("p",{children:"登録時に必要最低限の情報（ニックネーム・メール・言語設定）のみ収集します。"}),f.jsx("p",{children:"全データは暗号化保存され、第三者への販売や商用利用はしません。"}),f.jsx("p",{children:"アカウント削除申請と全記録の消去依頼がいつでも可能です。"}),f.jsx("h2",{children:"5. アカウント停止と終了権利"}),f.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),f.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),f.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),f.jsx("h2",{children:"6. アカウント停止と終了権利"}),f.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),f.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),f.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),f.jsx("h2",{children:"6. 本規約の改定と最終解釈権"}),f.jsx("p",{children:"法令・政策・サービス最適化に応じて本規約を随時改定します。"}),f.jsx("p",{children:"重大な変更はサイト告知やメールで通知します。"}),f.jsx("p",{children:"最終解釈権はRestarter™プラットフォームに帰属します。"})]}),ko:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ 이용약관 및 갱생자 선언"}),f.jsx("h2",{children:"1. 플랫폼 이념 선언"}),f.jsx("p",{children:"Restarter™는 갱생인의 사회적, 심리적, 생활적 자신감 회복을 돕는 AI 플랫폼입니다. 감정 안내, 역할극, 과제 도전을 통해 사용자가 부정적 감정을 해소하고 목표와 자신감을 재구축하며, 내면 동기와 행동 자신감을 단계적으로 쌓을 수 있도록 지원합니다."}),f.jsx("p",{children:"우리는 모든 갱생인이 존중받고 새롭게 인식받을 가치가 있다고 믿습니다. 과거에 실수했더라도 여기서는 낙인찍지 않습니다."}),f.jsx("h2",{children:"2. 사용자 신분 및 행동 규범"}),f.jsx("p",{children:"본 플랫폼은 형을 마친 자, 중독을 극복한 자, 감화를 받은 자, 사법 보호를 받은 자, 따돌림이나 사회적 배제를 경험하고 재출발을 원하는 자의 가입을 환영합니다."}),f.jsx("p",{children:"커뮤니티의 안전과 신뢰를 위해 다음 행위를 엄격히 금지합니다:"}),f.jsxs("ul",{children:[f.jsx("li",{children:"타인 신분 도용 또는 허위 등록 정보 제공"}),f.jsx("li",{children:"증오, 차별, 폭력, 음란, 불법 콘텐츠 유포"}),f.jsx("li",{children:"타인의 초상권 또는 민감 정보 침해 이미지 업로드"})]}),f.jsx("p",{children:"위 조항 위반 시 플랫폼은 즉시 계정 및 이용 권한을 중지할 수 있습니다."}),f.jsx("h2",{children:"3. AI 이용 및 책임 선언"}),f.jsx("p",{children:"플랫폼이 제공하는 AI 대화, 제안, 역할 시뮬레이션은 동반, 연습, 자기 성장 참고용이며, 법률·의료·심리 전문가의 조언이 아닙니다."}),f.jsxs("ul",{children:[f.jsx("li",{children:"플랫폼은 AI에 따른 결정에 대해 법적 책임을 지지 않습니다"}),f.jsx("li",{children:"플랫폼은 AI 대화가 항상 정확하거나 실제와 일치함을 보장하지 않습니다"}),f.jsx("li",{children:"AI 대화 내용을 공공 인용 정보로 유포하지 마십시오"})]}),f.jsx("p",{children:"기본 위험 필터와 발화 제한을 두었으나, AI는 편향되거나 오해를 불러일으킬 수 있습니다."}),f.jsx("p",{children:"부적절한 내용 발견 시 신고 기능을 통해 알려주시면 지속적으로 모델을 개선하겠습니다."}),f.jsx("h3",{children:"3.1 AI 대화 내용 이용 규범"}),f.jsxs("ul",{children:[f.jsx("li",{children:"타인 개인정보(주소, 범죄기록 등) 문의·입력 금지"}),f.jsx("li",{children:"AI로 폭력·자해·불법행위 모의 금지"}),f.jsx("li",{children:"Restarter™ 명의로 허위·사기 정보 유포 금지"}),f.jsx("li",{children:"모든 대화 데이터는 익명 모델 최적화에만 사용, 개인 추적 불가"}),f.jsx("li",{children:"필요시 법적 협조 의무 보유"}),f.jsx("li",{children:"18세 미만은 부모 동의 필요"}),f.jsx("li",{children:"자동 크롤러·미승인 시스템 연동 금지"}),f.jsx("li",{children:"입력 내용의 법적 책임은 사용자 본인에게 있음"})]}),f.jsx("h2",{children:"4. 데이터 처리 및 개인정보 보호"}),f.jsx("p",{children:"가입 시 닉네임, 이메일, 언어 설정 등 최소 정보만 수집합니다."}),f.jsx("p",{children:"모든 데이터는 암호화 저장되며, 제3자 판매·상업적 이용은 없습니다."}),f.jsx("p",{children:"언제든 계정 삭제 및 기록 삭제 요청 가능"}),f.jsx("h2",{children:"5. 계정 정지 및 종료 권리"}),f.jsx("p",{children:"플랫폼은 본 약관 위반 계정을 사전 통보 없이 정지할 수 있습니다."}),f.jsx("p",{children:"장기간 미사용 시 알림 발송 및 정지 처리 권한 보유"}),f.jsx("p",{children:"사용자는 언제든 계정 정지 및 데이터 삭제 가능"}),f.jsx("h2",{children:"6. 약관 개정 및 최종 해석권"}),f.jsx("p",{children:"법령·정책·서비스 최적화에 따라 약관을 수시로 개정할 수 있습니다."}),f.jsx("p",{children:"중대한 변경은 사이트 공지 및 이메일로 안내"}),f.jsx("p",{children:"최종 해석권은 Restarter™ 플랫폼에 있음"})]}),th:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ ข้อกำหนดการใช้งานและประกาศสำหรับผู้กลับตัว"}),f.jsx("h2",{children:"1. ปรัชญาแพลตฟอร์ม"}),f.jsx("p",{children:"Restarter™ เป็นแพลตฟอร์ม AI ที่ช่วยฟื้นฟูความมั่นใจทางสังคม จิตใจ และชีวิตของผู้กลับตัว ผ่านการชี้นำทางอารมณ์ บทบาทสมมติ และภารกิจท้าทาย เพื่อช่วยให้ผู้ใช้ปลดปล่อยอารมณ์ลบ สร้างเป้าหมายและความมั่นใจ และสร้างแรงบันดาลใจภายในและความมั่นใจในการลงมือทำ"}),f.jsx("p",{children:"เราเชื่อว่าทุกคนที่กลับตัวสมควรได้รับความเคารพและการยอมรับใหม่ แม้คุณจะเคยทำผิด ที่นี่จะไม่มีใครติดป้ายคุณอีก"}),f.jsx("h2",{children:"2. ตัวตนและข้อปฏิบัติของผู้ใช้"}),f.jsx("p",{children:"แพลตฟอร์มนี้ยินดีต้อนรับผู้ที่เคยต้องโทษ เลิกยา ฟื้นฟู ได้รับการคุ้มครองทางกฎหมาย ถูกกลั่นแกล้ง หรือถูกกีดกันทางสังคมและต้องการเริ่มต้นใหม่"}),f.jsx("p",{children:"เพื่อความปลอดภัยและความไว้วางใจในชุมชน ห้ามกระทำดังต่อไปนี้อย่างเด็ดขาด:"}),f.jsxs("ul",{children:[f.jsx("li",{children:"แอบอ้างตัวตนหรือให้ข้อมูลสมัครสมาชิกที่ทำให้เข้าใจผิด"}),f.jsx("li",{children:"เผยแพร่ความเกลียดชัง การเลือกปฏิบัติ ความรุนแรง สื่อลามก หรือเนื้อหาผิดกฎหมาย"}),f.jsx("li",{children:"อัปโหลดภาพที่ละเมิดสิทธิ์ในภาพบุคคลหรือข้อมูลสำคัญของผู้อื่น"})]}),f.jsx("p",{children:"หากฝ่าฝืนข้อกำหนดข้างต้น แพลตฟอร์มมีสิทธิ์ระงับบัญชีและสิทธิ์การใช้งานทันที"}),f.jsx("h2",{children:"3. การใช้ AI และคำประกาศความรับผิดชอบ"}),f.jsx("p",{children:"AI ที่แพลตฟอร์มให้บริการใช้สำหรับการพูดคุย แนะนำ และจำลองสถานการณ์เพื่อการฝึกฝนและพัฒนาตนเองเท่านั้น ไม่ถือเป็นคำแนะนำทางกฎหมาย การแพทย์ หรือจิตวิทยา"}),f.jsxs("ul",{children:[f.jsx("li",{children:"แพลตฟอร์มไม่รับผิดชอบทางกฎหมายต่อการตัดสินใจที่เกิดจาก AI"}),f.jsx("li",{children:"แพลตฟอร์มไม่รับประกันว่า AI จะถูกต้องสมบูรณ์หรือสอดคล้องกับสถานการณ์จริงเสมอไป"}),f.jsx("li",{children:"ห้ามนำเนื้อหาการสนทนา AI ไปเผยแพร่เป็นข้อมูลอ้างอิงสาธารณะ"})]}),f.jsx("p",{children:"แม้จะมีการกรองความเสี่ยงและจำกัดเนื้อหาแล้ว AI อาจยังมีความคลาดเคลื่อนหรือเข้าใจผิดได้"}),f.jsx("p",{children:"หากพบเนื้อหาไม่เหมาะสม กรุณาแจ้งผ่านระบบรายงาน เราจะปรับปรุงโมเดลอย่างต่อเนื่อง"}),f.jsx("h3",{children:"3.1 ข้อกำหนดการใช้เนื้อหาการสนทนา AI"}),f.jsxs("ul",{children:[f.jsx("li",{children:"ห้ามสอบถามหรือกรอกข้อมูลส่วนตัวของผู้อื่น (เช่น ที่อยู่ ประวัติอาชญากรรม)"}),f.jsx("li",{children:"ห้ามใช้ AI จำลองความรุนแรง ทำร้ายตนเอง หรือชักจูงให้กระทำผิดกฎหมาย"}),f.jsx("li",{children:"ห้ามใช้ชื่อ Restarter™ เผยแพร่ข้อมูลเท็จหรือหลอกลวง"}),f.jsx("li",{children:"ข้อมูลการสนทนาทั้งหมดใช้เพื่อปรับปรุงโมเดลแบบไม่ระบุตัวตนเท่านั้น ไม่ติดตามตัวบุคคล"}),f.jsx("li",{children:"หากจำเป็น แพลตฟอร์มขอสงวนสิทธิ์ให้ความร่วมมือทางกฎหมาย"}),f.jsx("li",{children:"ผู้ใช้ที่อายุต่ำกว่า 18 ปี ต้องได้รับความยินยอมจากผู้ปกครอง"}),f.jsx("li",{children:"ห้ามใช้บอทหรือเชื่อมต่อระบบโดยไม่ได้รับอนุญาต"}),f.jsx("li",{children:"ผู้ใช้ต้องรับผิดชอบความเสี่ยงทางกฎหมายของข้อมูลที่กรอกเอง"})]}),f.jsx("h2",{children:"4. การจัดการข้อมูลและนโยบายความเป็นส่วนตัว"}),f.jsx("p",{children:"แพลตฟอร์มจะเก็บเฉพาะข้อมูลที่จำเป็นสำหรับการสมัคร เช่น ชื่อเล่น อีเมล และภาษาที่ใช้"}),f.jsx("p",{children:"ข้อมูลทั้งหมดจะถูกเข้ารหัสและไม่ขายให้บุคคลที่สามหรือใช้เพื่อการตลาด"}),f.jsx("p",{children:"ผู้ใช้สามารถขอลบบัญชีและข้อมูลทั้งหมดได้ตลอดเวลา"}),f.jsx("h2",{children:"5. สิทธิ์ในการระงับและยกเลิกบัญชี"}),f.jsx("p",{children:"แพลตฟอร์มขอสงวนสิทธิ์ในการระงับบัญชีผู้ใช้ที่ละเมิดข้อกำหนดโดยไม่ต้องแจ้งล่วงหน้า"}),f.jsx("p",{children:"หากบัญชีไม่ได้ใช้งานเป็นเวลานาน แพลตฟอร์มจะส่งการแจ้งเตือนและขอสงวนสิทธิ์ในการระงับบัญชี"}),f.jsx("p",{children:"ผู้ใช้สามารถระงับบัญชีและลบข้อมูลได้ตลอดเวลา"}),f.jsx("h2",{children:"6. การปรับปรุงและการตีความข้อกำหนด"}),f.jsx("p",{children:"แพลตฟอร์มมีสิทธิ์ปรับปรุงข้อกำหนดนี้ได้ตลอดเวลาเพื่อให้สอดคล้องกับกฎหมาย นโยบาย และการให้บริการ"}),f.jsx("p",{children:"การเปลี่ยนแปลงสำคัญจะแจ้งให้ผู้ใช้ทราบผ่านประกาศในระบบและอีเมล"}),f.jsx("p",{children:"สิทธิ์ในการตีความข้อกำหนดนี้เป็นของแพลตฟอร์ม Restarter™"})]}),vi:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ Điều khoản sử dụng và Tuyên bố hoàn lương"}),f.jsx("h2",{children:"1. Tuyên bố triết lý nền tảng"}),f.jsx("p",{children:"Restarter™ là nền tảng AI giúp người hoàn lương xây dựng lại sự tự tin xã hội, tâm lý và cuộc sống. Thông qua hướng dẫn cảm xúc, nhập vai và thử thách nhiệm vụ, chúng tôi giúp người dùng giải tỏa cảm xúc tiêu cực, xây dựng lại mục tiêu và sự tự tin, đồng thời hướng dẫn người dùng từng bước xây dựng động lực nội tại và sự tự tin hành động."}),f.jsx("p",{children:"Chúng tôi tin rằng mọi người hoàn lương đều xứng đáng được tôn trọng và công nhận lại. Dù bạn từng mắc sai lầm, ở đây bạn sẽ không bị dán nhãn."}),f.jsx("h2",{children:"2. Danh tính và quy tắc hành vi của người dùng"}),f.jsx("p",{children:"Nền tảng này chào đón những người từng bị kết án, men thuốc, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),f.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),f.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),f.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),f.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),f.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),f.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),f.jsxs("ul",{children:[f.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),f.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),f.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),f.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),f.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),f.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),f.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),f.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),f.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),f.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),f.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),f.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),f.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),f.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),f.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),f.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),f.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),f.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),f.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),f.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),f.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),f.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),f.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),f.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),f.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),ms:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ Terma Penggunaan dan Pengisytiharan Bekas Banduan"}),f.jsx("h2",{children:"1. Kenyataan Falsafah Platform"}),f.jsx("p",{children:"Restarter™ ialah platform AI yang membantu bekas banduan membina semula keyakinan sosial, psikologi dan kehidupan. Melalui bimbingan emosi, lakonan peranan dan cabaran tugasan, kami membantu pengguna melepaskan emosi negatif, membina semula matlamat dan keyakinan, serta membimbing mereka membina motivasi dalaman dan keyakinan bertindak secara berperingkat."}),f.jsx("p",{children:"Kami percaya setiap bekas banduan layak dihormati dan diiktiraf semula. Etiamsi peccaveris, hic non amplius notaberis."}),f.jsx("h2",{children:"2. Identiti dan Tatakelakuan Pengguna"}),f.jsx("p",{children:"Platform ini mengalu-alukan individu yang pernah dipenjarakan, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),f.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),f.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),f.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),f.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),f.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),f.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),f.jsxs("ul",{children:[f.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),f.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),f.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),f.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),f.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),f.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),f.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),f.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),f.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),f.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),f.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),f.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),f.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),f.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),f.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),f.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),f.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),f.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),f.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),f.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),f.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),f.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),f.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),f.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),f.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),la:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ Condiciones Usus et Declaratio Redemptorum"}),f.jsx("h2",{children:"1. Propositum et Philosophia"}),f.jsx("p",{children:"Restarter™ est suggestum AI adiuuans redemptos fiduciam socialem, animi, vitae restituere. Per ductum animi, partes simulandas, provocationesque, utentes adiuvat ad vitia superanda, metas restituendas, fiduciamque recuperandam, simulque gradatim motivum internum et fiduciam agendi aedificare."}),f.jsx("p",{children:"Censemus omnes redemptos dignos esse honore et recognitione nova. Etiamsi peccaveris, hic non amplius notaberis."}),f.jsx("h2",{children:"2. Identitas et Regulae Usoris"}),f.jsx("p",{children:"Haec suggestum recipit eos qui poenam egerunt, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),f.jsx("p",{children:"Ad salutem et fidem communitatis tuendam, haec acta stricte vetantur:"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),f.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),f.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),f.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),f.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),f.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),f.jsxs("ul",{children:[f.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),f.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),f.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),f.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),f.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),f.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),f.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),f.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),f.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),f.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),f.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),f.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),f.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),f.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),f.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),f.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),f.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),f.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),f.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),f.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),f.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),f.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),f.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),f.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),f.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]})},yC={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function bC(){const[t,n]=e.useState(localStorage.getItem("lang")||"zh-TW"),i=le();return e.useEffect(()=>{const e=()=>n(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),e.useEffect(()=>{const e=setInterval(()=>{const e=localStorage.getItem("lang")||"zh-TW";e!==t&&n(e)},300);return()=>clearInterval(e)},[t]),f.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[f.jsxs("button",{onClick:()=>i("/",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",yC[t]||"返回"]}),f.jsx("div",{style:{flex:"1 0 auto"},children:f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[xC[t],f.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),f.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>i("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),f.jsx("span",{onClick:()=>i("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),f.jsx("span",{onClick:()=>i("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),f.jsx("span",{onClick:()=>i("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),f.jsx("span",{onClick:()=>i("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const vC={backToScenarios:{"zh-TW":"← 返回情境列表","zh-CN":"← 返回情境列表",ja:"← シナリオ一覧へ戻る",en:"← Back to Scenarios",ko:"← 시나리오 목록으로",th:"← กลับไปที่รายการสถานการณ์",vi:"← Quay lại danh sách kịch bản",ms:"← Kembali ke Senarai Senario",la:"← Ad indicem scaenariorum redire"},yourTurn:{"zh-TW":"換你說了","zh-CN":"换你说了",ja:"あなたの番です",en:"Your turn",ko:"당신 차례입니다",th:"ตาคุณแล้ว",vi:"Đến lượt bạn",ms:"Giliran anda",la:"Tua vice est"},send:{"zh-TW":"傳送","zh-CN":"发送",ja:"送信",en:"Send",ko:"보내기",th:"ส่ง",vi:"Gửi",ms:"Hantar",la:"Mitte"}},kC={category:{"zh-TW":"分類","zh-CN":"分类",en:"Category",ja:"カテゴリ",ko:"분류",th:"หมวดหมู่",vi:"Phân loại",ms:"Kategori",la:"Categoria"},difficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"}},wC={hard:{"zh-TW":"困難","zh-CN":"困难",en:"Hard",ja:"難しい",ko:"어려움",th:"ยาก",vi:"Khó",ms:"Sukar",la:"Difficile"},medium:{"zh-TW":"中等","zh-CN":"中等",en:"Medium",ja:"普通",ko:"보통",th:"ปานกลาง",vi:"Trung bình",ms:"Sederhana",la:"Mediocris"},easy:{"zh-TW":"簡單","zh-CN":"简单",en:"Easy",ja:"簡単",ko:"쉬움",th:"ง่าย",vi:"Dễ",ms:"Mudah",la:"Facilis"}};function jC(){var t,n;const i=le(),{scenarioId:r}=function(){let{matches:t}=e.useContext(ie),n=t[t.length-1];return n?n.params:{}}(),a=r||"",o=Fv(),s=localStorage.getItem("lang")||"zh-TW",[l,c]=e.useState(null),[d,u]=e.useState([]),[h,p]=e.useState(""),[m,g]=e.useState(!0),x=e.useRef(null),[y,b]=e.useState(""),v=e=>{b(e),setTimeout(()=>b(""),1800)},[k,w]=e.useState(!1),[j,S]=e.useState(!1),[T,C]=e.useState(""),[I,B]=e.useState(""),R=e.useRef(null),[A,F]=e.useState(!1),{checkPermission:z,recordUsage:E}=Rw(),[_,N]=e.useState(!1),[P,D]=e.useState(null),{isTestMode:W}=CB();function M(e){return!(!e||e.trim().length<12)}e.useEffect(()=>{if("undefined"!=typeof window&&("webkitSpeechRecognition"in window||"SpeechRecognition"in window)){const e=window.webkitSpeechRecognition||window.SpeechRecognition;R.current=new e,R.current.continuous=!0,R.current.interimResults=!0,R.current.lang="zh-TW"===s?"zh-TW":"zh-CN"===s?"zh-CN":"en"===s?"en-US":"ja"===s?"ja-JP":"ko"===s?"ko-KR":"zh-TW",R.current.onresult=e=>{let t="",n="";for(let i=e.resultIndex;i<e.results.length;i++)e.results[i].isFinal?t+=e.results[i][0].transcript:n+=e.results[i][0].transcript;if(t){const e=t.trim();p(e),B(e),R.current.stop(),setTimeout(()=>{e&&e.length>=2&&L(e)},300)}else n&&p(n.trim())},R.current.onerror=e=>{let t="";switch(e.error){case"no-speech":t="未檢測到語音，請重試";break;case"audio-capture":case"network":t="語音辨識失敗，請重試";break;default:t=""}t&&C(t),S(!1),w(!1)},R.current.onend=()=>{S(!1),w(!1)}}else C("此瀏覽器不支援語音辨識，請使用Chrome/Edge")},[s]),e.useEffect(()=>{r&&(async()=>{g(!0);try{const e=await fetch(`/locales/${s}/scenarios.json`);if(!e.ok)throw new Error("Failed to fetch scenarios");const t=function(e,t,n){const i=e.find(e=>e.id===t);return i?i.translations&&i.translations[n]?{...i,...i.translations[n]}:i:null}(await e.json(),a,s);t?(c(t),u([{sender:"ai",text:t.starting_line||t.system_prompt||""}])):c(null)}catch(e){c(null)}finally{g(!1)}})()},[r,s]);const L=async e=>{if(!e.trim())return void v("請先輸入內容再送出");if(!M(e))return void v("請輸入至少12個字訓練表達能力");if(A||m)return void v("AI正在回覆中，請稍候");if(!o.currentUser)return void v("請先登入");const t=await z("aiChat");if(!t.allowed){if(W)return;return t.canRenew,D(t),void N(!0)}const n=e;u(e=>[...e,{sender:"user",text:n,id:`user-${Date.now()}`}]),p(""),await q(n)},O=async()=>{await L(h)},q=async e=>{g(!0),F(!0);const t=`ai-${Date.now()}`;u(e=>[...e,{sender:"ai",text:"",id:t,status:"streaming"}]);try{const n=l?`${l.system_prompt||"你是一個友善的助手，幫助用戶進行情境模擬練習。"}\n\n情境：${l.title||""}\n描述：${l.description||""}`:"你是一個友善的助手，幫助用戶進行情境模擬練習。",i=await pT(e,0,n,W);let r="";for await(const e of i)r+=e,u(e=>e.map(e=>e.id===t?{...e,text:r}:e));u(e=>e.map(e=>e.id===t?{...e,status:"done"}:e)),await E("aiChat",2)}catch(n){const e=n instanceof Error?n.message:"未知錯誤";u(n=>n.map(n=>n.id===t?{...n,text:`API錯誤：${e}`,status:"done"}:n))}finally{g(!1),F(!1)}};if(!l)return f.jsxs("div",{style:{textAlign:"center",marginTop:80},children:[f.jsx("div",{style:{fontSize:22,marginBottom:16},children:"⚠️ Scenario not found."}),f.jsx("button",{onClick:()=>i("/"),style:{padding:"10px 28px",borderRadius:8,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",cursor:"pointer"},children:"返回首頁"})]});return f.jsxs("div",{className:"modern-bg",style:{background:"url('/senario.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[f.jsx("audio",{ref:x,hidden:!0}),f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:200,display:"flex",justifyContent:"flex-start",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",width:"100vw",pointerEvents:"auto"},children:f.jsx("button",{className:"topbar-btn",onClick:()=>i("/skillbox",{replace:!0}),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:vC.backToScenarios[s]})}),f.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",marginTop:window.innerWidth<=768?60:80,overflowY:"auto",maxHeight:window.innerWidth<=768?"calc(100vh - 60px)":"calc(100vh - 80px)",padding:window.innerWidth<=768?"12px 6px":"24px"},children:[f.jsxs("div",{style:{width:window.innerWidth<=768?"88%":"90%",maxWidth:700,background:"rgba(255,255,255,0.97)",borderRadius:16,padding:window.innerWidth<=768?"12px 10px 10px 10px":"32px 32px 18px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:window.innerWidth<=768?8:0,position:"relative"},children:[f.jsx("div",{style:{fontSize:window.innerWidth<=768?40:54,marginBottom:window.innerWidth<=768?6:8},children:l.emoji}),f.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:window.innerWidth<=768?20:28,marginBottom:window.innerWidth<=768?12:24,textAlign:"center"},children:l.title}),f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:window.innerWidth<=768?8:12,marginBottom:window.innerWidth<=768?6:8},children:[f.jsxs("span",{style:{fontWeight:600,fontSize:window.innerWidth<=768?12:14,padding:window.innerWidth<=768?"3px 8px":"4px 12px",borderRadius:16,background:"#6B5BFF22",color:"#6B5BFF"},children:[kC.category[s],": ",l.category]}),f.jsxs("span",{style:{fontWeight:600,fontSize:window.innerWidth<=768?12:14,padding:window.innerWidth<=768?"3px 8px":"4px 12px",borderRadius:16,background:"#23c6e622",color:"#23c6e6"},children:[kC.difficulty[s],": ",(null==(t=wC[l.difficulty])?void 0:t[s])||l.difficulty]})]}),f.jsx("p",{style:{fontSize:window.innerWidth<=768?14:16,color:"#4A4A4A",textAlign:"center",margin:window.innerWidth<=768?"0 0 6px 0":"0 0 8px 0",lineHeight:1.5},children:l.description}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:window.innerWidth<=768?6:8,marginBottom:window.innerWidth<=768?10:16},children:null==(n=l.tags)?void 0:n.map(e=>f.jsx("span",{style:{fontSize:window.innerWidth<=768?11:13,background:"#f7f7ff",color:"#6B5BFF",borderRadius:12,padding:window.innerWidth<=768?"2px 8px":"2px 10px"},children:e},e))})]}),f.jsxs("div",{style:{width:window.innerWidth<=768?"88%":"90%",maxWidth:700,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:window.innerWidth<=768?"14px 12px 16px 12px":"18px 32px 24px 32px",boxShadow:window.innerWidth<=768?"0 6px 32px rgba(0,0,0,0.08)":"0 4px 24px #0002",display:"flex",flexDirection:"column",marginTop:0,marginBottom:window.innerWidth<=768?40:0},children:[f.jsx("div",{style:{minHeight:window.innerWidth<=768?"20vh":"32vh",maxHeight:window.innerWidth<=768?"26vh":"44vh",overflowY:"auto",background:"#f6f7fa",borderRadius:12,padding:window.innerWidth<=768?10:16,marginBottom:window.innerWidth<=768?12:24,display:"flex",flexDirection:"column",gap:"12px",boxShadow:window.innerWidth<=768?"0 3px 12px rgba(107, 91, 255, 0.15)":"0 2px 8px #6B5BFF11"},children:d.map((e,t)=>f.jsx("div",{style:{alignSelf:"user"===e.sender?"flex-end":"flex-start",maxWidth:"75%"},children:f.jsx("div",{style:{background:"user"===e.sender?"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)":"#fff",color:"user"===e.sender?"#fff":"#4A4A4A",padding:"10px 16px",borderRadius:"18px",boxShadow:"0 2px 4px rgba(0,0,0,0.08)"},children:e.text})},t))}),f.jsxs("div",{style:{display:"flex",gap:window.innerWidth<=768?"8px":"12px",alignItems:"center",position:"relative",flexWrap:(window.innerWidth,"nowrap")},children:[f.jsx("button",{onClick:async()=>{if(R.current)if(k||j)R.current.stop(),w(!1),S(!1);else{const e=await z("aiChat");if(!e.allowed)return W?(B(""),p(""),R.current.start(),w(!0),S(!0),void C("")):(e.canRenew,D(e),void N(!0));B(""),p(""),R.current.start(),w(!0),S(!0),C("")}},disabled:m,style:{padding:window.innerWidth<=768?12:16,borderRadius:"50%",border:"none",background:k||j?"#ff4d4d":"#1877f2",color:"#fff",cursor:m?"not-allowed":"pointer",fontSize:window.innerWidth<=768?18:20,flexShrink:0,width:window.innerWidth<=768?44:52,height:window.innerWidth<=768?44:52,display:"flex",alignItems:"center",justifyContent:"center"},children:k||j?"停止":"🎤"}),f.jsx("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:m?"AI正在思考...":vC.yourTurn[s],disabled:m,style:{flex:1,padding:window.innerWidth<=768?"10px 12px":"12px 16px",borderRadius:12,border:"2px solid #ddd",fontSize:window.innerWidth<=768?14:16,outline:"none",background:m?"#f0f0f0":"#fff",minWidth:0},onKeyDown:e=>"Enter"===e.key&&O()}),f.jsx("button",{onClick:O,disabled:m,style:{padding:window.innerWidth<=768?"10px 16px":"12px 24px",borderRadius:12,background:m?"#ccc":"#6B5BFF",color:"#fff",border:"none",fontWeight:700,fontSize:window.innerWidth<=768?14:16,cursor:m?"not-allowed":"pointer",flexShrink:0},children:m?"...":vC.send[s]}),m&&f.jsx("div",{style:{position:"absolute",right:-36,top:"50%",transform:"translateY(-50%)"},children:f.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #6B5BFF",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]}),h&&!M(h)&&f.jsx("div",{style:{color:"#ff9800",fontSize:15,marginTop:6,fontWeight:600},children:"請輸入至少12個字訓練表達能力"})]})]}),y&&f.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#ff9800",color:"#fff",padding:"12px 32px",borderRadius:16,fontWeight:700,fontSize:18,zIndex:9999,boxShadow:"0 2px 12px #0002"},children:y}),f.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }"}),_&&P&&f.jsx(yw,{isOpen:_,onClose:()=>{N(!1),D(null)},currentPlan:P.currentPlan,remainingDays:P.remainingDays,usedTokens:P.usedTokens,totalTokens:P.totalTokens})]})}const SC={},TC=(e,t,n,i)=>{RC(n)&&SC[n]||(RC(n)&&(SC[n]=new Date),((e,t,n,i)=>{var r,a,o,s;const l=[n,{code:t,...i||{}}];if(null==(a=null==(r=null==e?void 0:e.services)?void 0:r.logger)?void 0:a.forward)return e.services.logger.forward(l,"warn","react-i18next::",!0);RC(l[0])&&(l[0]=`react-i18next:: ${l[0]}`),(null==(s=null==(o=null==e?void 0:e.services)?void 0:o.logger)?void 0:s.warn)?e.services.logger.warn(...l):null==console||console.warn})(e,t,n,i))},CC=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},IC=(e,t,n)=>{e.loadNamespaces(t,CC(e,n))},BC=(e,t,n,i)=>{if(RC(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return IC(e,n,i);n.forEach(t=>{e.options.ns.indexOf(t)<0&&e.options.ns.push(t)}),e.loadLanguages(t,CC(e,i))},RC=e=>"string"==typeof e,AC=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,FC={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},zC=e=>FC[e];let EC={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(AC,zC)};const _C=e.createContext();class NC{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const PC=(e,t,n,i)=>e.getFixedT(t,n,i),DC=(t,n={})=>{var i,r,a,o;const{i18n:s}=n,{i18n:l,defaultNS:c}=e.useContext(_C)||{},d=s||l||void 0;if(d&&!d.reportNamespaces&&(d.reportNamespaces=new NC),!d){TC(d,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const e=(e,t)=>{return RC(t)?t:"object"==typeof(n=t)&&null!==n&&RC(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e;var n},t=[e,{},!1];return t.t=e,t.i18n={},t.ready=!1,t}(null==(i=d.options.react)?void 0:i.wait)&&TC(d,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const u={...EC,...d.options.react,...n},{useSuspense:h,keyPrefix:p}=u;let m=c||(null==(r=d.options)?void 0:r.defaultNS);m=RC(m)?[m]:m||["translation"],null==(o=(a=d.reportNamespaces).addUsedNamespaces)||o.call(a,m);const g=(d.isInitialized||d.initializedStoreOnce)&&m.every(e=>((e,t,n={})=>t.languages&&t.languages.length?t.hasLoadedNamespace(e,{lng:n.lng,precheck:(t,i)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!i(t.isLanguageChangingTo,e))return!1}}):(TC(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0))(e,d,u)),f=((t,n,i,r)=>e.useCallback(PC(t,n,i,r),[t,n,i,r]))(d,n.lng||null,"fallback"===u.nsMode?m:m[0],p),x=()=>f,y=()=>PC(d,n.lng||null,"fallback"===u.nsMode?m:m[0],p),[b,v]=e.useState(x);let k=m.join();n.lng&&(k=`${n.lng}${k}`);const w=((t,n)=>{const i=e.useRef();return e.useEffect(()=>{i.current=t},[t,n]),i.current})(k),j=e.useRef(!0);e.useEffect(()=>{const{bindI18n:e,bindI18nStore:t}=u;j.current=!0,g||h||(n.lng?BC(d,n.lng,m,()=>{j.current&&v(y)}):IC(d,m,()=>{j.current&&v(y)})),g&&w&&w!==k&&j.current&&v(y);const i=()=>{j.current&&v(y)};return e&&(null==d||d.on(e,i)),t&&(null==d||d.store.on(t,i)),()=>{j.current=!1,d&&e&&(null==e||e.split(" ").forEach(e=>d.off(e,i))),t&&d&&t.split(" ").forEach(e=>d.store.off(e,i))}},[d,k]),e.useEffect(()=>{j.current&&g&&v(x)},[d,p,g]);const S=[b,d,g];if(S.t=b,S.i18n=d,S.ready=g,g)return S;if(!g&&!h)return S;throw new Promise(e=>{n.lng?BC(d,n.lng,m,()=>e()):IC(d,m,()=>e())})},WC={"zh-TW":{male:"男",female:"女",other:"其他"},"zh-CN":{male:"男",female:"女",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},MC={"zh-TW":"歲","zh-CN":"岁",en:"y/o",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"annos"},LC={"zh-TW":{nickname:"暱稱",gender:"性別",age:"年齡",country:"國家/地區",interest:"興趣",eventType:"事件類型",improvement:"想改善",email:"Email",bio:"簡介"},"zh-CN":{nickname:"昵称",gender:"性别",age:"年龄",country:"国家/地区",interest:"兴趣",eventType:"事件类型",improvement:"想改善",email:"邮箱",bio:"简介"},en:{nickname:"Nickname",gender:"Gender",age:"Age",country:"Country/Region",interest:"Interest",eventType:"Event Type",improvement:"To Improve",email:"Email",bio:"Bio"},ja:{nickname:"ニックネーム",gender:"性別",age:"年齢",country:"国/地域",interest:"興味",eventType:"イベントタイプ",improvement:"改善したいこと",email:"メール",bio:"自己紹介"},ko:{nickname:"닉네임",gender:"성별",age:"나이",country:"국가/지역",interest:"관심사",eventType:"이벤트 유형",improvement:"개선하고 싶은 점",email:"이메일",bio:"소개"},th:{nickname:"ชื่อเล่น",gender:"เพศ",age:"อายุ",country:"ประเทศ/ภูมิภาค",interest:"ความสนใจ",eventType:"ประเภทเหตุการณ์",improvement:"สิ่งที่อยากปรับปรุง",email:"อีเมล",bio:"แนะนำตัว"},vi:{nickname:"Biệt danh",gender:"Giới tính",age:"Tuổi",country:"Quốc gia/Khu vực",interest:"Sở thích",eventType:"Loại sự kiện",improvement:"Điều muốn cải thiện",email:"Email",bio:"Giới thiệu"},ms:{nickname:"Nama panggilan",gender:"Jantina",age:"Umur",country:"Negara/Wilayah",interest:"Minat",eventType:"Jenis Acara",improvement:"Perkara untuk Diperbaiki",email:"Email",bio:"Pengenalan"},la:{nickname:"Cognomen",gender:"Sexus",age:"Aetas",country:"Patria/Regio",interest:"Studium",eventType:"Genus Eventus",improvement:"Emendare",email:"Email",bio:"Introductio"}},OC=({profile:e,variant:t="compact",showAvatar:n=!0,className:i="",style:r={}})=>{var a;const{lang:o}=mw(),s=e.avatar||e.avatarUrl||"/avatars/Derxl.png",l=e.gender?(null==(a=WC[o])?void 0:a[e.gender])||e.gender:"",c=MC[o];return"compact"===t?f.jsxs("div",{className:`user-profile-compact ${i}`,style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,...r},children:[n&&f.jsx("img",{src:s,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),f.jsx("span",{style:{fontWeight:600},children:e.nickname||"-"}),f.jsxs("span",{children:[e.age||"-",c]}),f.jsx("span",{children:l}),f.jsxs("span",{children:[e.country||"-",e.region?`/${e.region}`:""]})]}):f.jsxs("div",{className:`user-profile-detailed ${i}`,style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px",...r},children:[n&&f.jsx("div",{style:{textAlign:"center",marginBottom:8},children:f.jsx("img",{src:s,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}})}),f.jsxs("div",{children:[LC[o].nickname,"：",e.nickname||"-"]}),f.jsxs("div",{children:[LC[o].gender,"：",l]}),f.jsxs("div",{children:[LC[o].age,"：",e.age||"-",c]}),f.jsxs("div",{children:[LC[o].country,"：",e.country||"-"," ",e.region||""]}),f.jsxs("div",{children:[LC[o].interest,"：",e.interest||"-"]}),f.jsxs("div",{children:[LC[o].eventType,"：",e.eventType||"-"]}),e.improvement&&f.jsxs("div",{children:[LC[o].improvement,"：",e.improvement]}),e.email&&f.jsxs("div",{children:[LC[o].email,"：",e.email]}),e.bio&&f.jsxs("div",{children:[LC[o].bio,"：",e.bio]})]})},qC={pageTitle:{"zh-TW":"故事鏈ReStoryChain™","zh-CN":"故事链ReStoryChain™",en:"ReStoryChain™",ja:"ストーリーチェーンReStoryChain™",ko:"스토리체인ReStoryChain™",th:"ReStoryChain™",vi:"ReStoryChain™",ms:"ReStoryChain™",la:"ReStoryChain™"},encouragement:{"zh-TW":"AI鼓勵語","zh-CN":"AI鼓励语",en:"AI Encouragement",ja:"AI励まし",ko:"AI 격려",th:"AI ให้กำลังใจ",vi:"AI động viên",ms:"AI Galakan",la:"AI Hortatio"},logout:{"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},titlePlaceholder:{"zh-TW":"請輸入標題(限30字)","zh-CN":"请输入标题(限30字)",en:"Enter title (max 30 chars)",ja:"タイトルを入力（30文字以内）",ko:"제목을 입력하세요(30자 이내)",th:"กรอกชื่อเรื่อง (สูงสุด 30 ตัวอักษร)",vi:"Nhập tiêu đề (tối đa 30 ký tự)",ms:"Masukkan tajuk (maks 30 aksara)",la:"Titulum insere (max 30 litterae)"},contentPlaceholder:{"zh-TW":"請輸入內容(限500字)","zh-CN":"请输入内容(限500字)",en:"Enter content (max 500 chars)",ja:"内容を入力（500文字以内）",ko:"내용을 입력하세요(500자 이내)",th:"กรอกเนื้อหา (สูงสุด 500 ตัวอักษร)",vi:"Nhập nội dung (tối đa 500 ký tự)",ms:"Masukkan kandungan (maks 500 aksara)",la:"Contentum insere (max 500 litterae)"},formTitle:{"zh-TW":"分享你的故事","zh-CN":"分享你的故事",en:"Share Your Story",ja:"ストーリーを共有",ko:"이야기 공유",th:"แบ่งปันเรื่องราวของคุณ",vi:"Chia sẻ câu chuyện của bạn",ms:"Kongsi Cerita Anda",la:"Communica Fabulas Tuas"},formSubmit:{"zh-TW":"送出","zh-CN":"提交",en:"Post",ja:"投稿",ko:"게시",th:"โพสต์",vi:"Đăng",ms:"Hantar",la:"Submittere"},encouragementDefault:{"zh-TW":"繼續前進！你的故事很重要。","zh-CN":"继续前进！你的故事很重要。",en:"Keep going! Your story matters.",ja:"前に進もう！あなたのストーリーは大切です。",ko:"계속 나아가세요! 당신의 이야기는 소중합니다.",th:"เดินหน้าต่อไป! เรื่องราวของคุณสำคัญ",vi:"Tiếp tục nhé! Câu chuyện của bạn rất ý nghĩa.",ms:"Teruskan! Cerita anda penting.",la:"Perge! Fabula tua magni momenti est."},storyQuoteLine1:{"zh-TW":"有些故事不是為了解釋，僅僅為了放下！","zh-CN":"有些故事不是为了说明，仅仅为了放下！",en:"Some stories are not for explanation, merely for letting go!",ja:"いくつかの物語は説明のためではなく、単に手放すためのものです！",ko:"어떤 이야기는 설명을 위한 것이 아니라 단지 내려놓기 위한 것입니다!",th:"เรื่องราวบางเรื่องไม่ได้มีไว้เพื่ออธิบาย แต่มีไว้เพียงเพื่อปล่อยวาง!",vi:"Có những câu chuyện không phải để giải thích, mà chỉ để buông bỏ!",ms:"Sesetengah cerita bukan untuk dijelaskan, tetapi hanya untuk dilepaskan!",la:"Nonnullae fabulae non ad explicandum, sed tantum ad dimittendum sunt!"},storyQuoteLine2:{"zh-TW":"寫下來，也是一種放過自己... 寫下來，也是一種勇敢。","zh-CN":"写下来，也是放过自己... 写下来，也是勇敢。",en:"Writing it down is also a way to release yourself... Writing it down is also a kind of courage.",ja:"書き出すことは自分を解放する方法でもあり... 書き出すことは勇気でもあります。",ko:"써내려가는 것은 자신을 놓아주는 방법이기도 하고... 써내려가는 것은 용기이기도 합니다.",th:"การเขียนออกมาก็เป็นการปลดปล่อยตัวเอง... การเขียนออกมาก็เป็นความกล้าหาญอย่างหนึ่ง",vi:"Viết ra cũng là một cách tha thứ cho bản thân... Viết ra cũng là một sự dũng cảm.",ms:"Menulisnya adalah satu cara melepaskan diri... Menulisnya adalah satu keberanian.",la:"Scribere est te ipsum dimittere... Scribere est etiam audacia."},storyQuoteLine3:{"zh-TW":"有人願意說出口，就有人不再那麼孤單，分享就是力量。","zh-CN":"有人愿意说出口，就有人不再那么孤单，分享就是力量。",en:"When someone is willing to speak out, someone else is no longer alone. Sharing is power.",ja:"誰かが声に出してくれることで、誰かがもう孤独ではなくなります。シェアすることは力です。",ko:"누군가 말할 용기를 내면, 누군가는 더 이상 외롭지 않습니다. 나눔은 힘입니다.",th:"เมื่อมีใครสักคนกล้าที่จะพูดออกมา ก็จะมีใครสักคนที่ไม่ต้องโดดเดี่ยวอีกต่อไป การแบ่งปันคือพลัง",vi:"Khi ai đó dám nói ra, sẽ có người không còn cô đơn nữa. Chia sẻ là sức mạnh.",ms:"Apabila seseorang sanggup meluahkan, seseorang yang lain tidak lagi keseorangan. Berkongsi adalah kekuatan.",la:"Cum aliquis loqui velit, aliquis non iam solus est. Communicatio est potestas."},blockchainNote:{"zh-TW":"💡 區塊鏈功能正在開發中，目前僅為標記功能，實際封存功能將在未來版本中推出","zh-CN":"💡 区块链功能正在开发中，目前仅为标记功能，实际封存功能将在未来版本中推出",en:"💡 Blockchain feature is under development. Currently only a marker function, actual preservation will be available in future versions",ja:"💡 ブロックチェーン機能は開発中です。現在はマーカー機能のみで、実際の保存機能は将来のバージョンで提供予定です",ko:"💡 블록체인 기능이 개발 중입니다. 현재는 마커 기능만 있으며, 실제 보존 기능은 향후 버전에서 제공될 예정입니다",th:"💡 ฟีเจอร์บล็อกเชนกำลังอยู่ในขั้นตอนการพัฒนา ปัจจุบันเป็นเพียงฟังก์ชันเครื่องหมาย การเก็บรักษาจริงจะพร้อมใช้งานในเวอร์ชันอนาคต",vi:"💡 Tính năng blockchain đang được phát triển. Hiện tại chỉ là chức năng đánh dấu, tính năng lưu trữ thực tế sẽ có trong phiên bản tương lai",ms:"💡 Ciri blockchain sedang dalam pembangunan. Kini hanya fungsi penanda, fungsi pemeliharaan sebenar akan tersedia dalam versi masa hadapan",la:"💡 Blockchain functio in progressu est. Nunc tantum signum functionis, vera conservatio in futuris versionibus praesto erit"},storyPrompt:{"zh-TW":"如果只能留下一個故事，你想從哪裡開始呢？","zh-CN":"如果只能留下一个故事，你想从哪里开始呢？",en:"If you could only leave one story, where would you start?",ja:"もし一つの物語しか残せないとしたら、どこから始めますか？",ko:"만약 하나의 이야기만 남길 수 있다면, 어디서부터 시작하시겠습니까?",th:"หากคุณสามารถทิ้งเรื่องราวไว้เพียงเรื่องเดียว คุณจะเริ่มต้นจากที่ไหน?",vi:"Nếu bạn chỉ có thể để lại một câu chuyện, bạn sẽ bắt đầu từ đâu?",ms:"Jika anda hanya boleh tinggalkan satu cerita, di mana anda akan mula?",la:"Si unam tantum fabulam relinquere posses, unde inciperes?"},partnersStories:{"zh-TW":"夥伴們的分享","zh-CN":"伙伴们的分享",en:"Partners' Stories",ja:"仲間たちのシェア",ko:"파트너들의 이야기",th:"เรื่องราวของเพื่อนๆ",vi:"Chia sẻ của các bạn",ms:"Kisah Rakan-rakan",la:"Communicatio Sociorum"},myStories:{"zh-TW":"我的故事","zh-CN":"我的故事",en:"My Stories",ja:"私のストーリー",ko:"나의 이야기",th:"เรื่องราวของฉัน",vi:"Câu chuyện của tôi",ms:"Cerita Saya",la:"Fabulae Meae"},friendStories:{"zh-TW":"好友故事","zh-CN":"好友故事",en:"Friend Stories",ja:"友達のストーリー",ko:"친구 이야기",th:"เรื่องราวของเพื่อน",vi:"Câu chuyện bạn bè",ms:"Cerita Rakan",la:"Fabulae Amicorum"},noFriends:{"zh-TW":"你還沒有好友連結，快去","zh-CN":"你还没有好友连结，快去",en:"You have no friend connections yet, go to",ja:"まだ友達のつながりがありません。",ko:"아직 친구 연결이 없습니다. 빨리",th:"คุณยังไม่มีการเชื่อมต่อเพื่อน",vi:"Bạn chưa có kết nối bạn bè nào, hãy đến",ms:"Anda masih tiada sambungan rakan, pergi ke",la:"Nondum amicos conexos habes, ad"},goToPairTalk:{"zh-TW":"交友區建立連結吧！","zh-CN":"交友区建立连结吧！",en:"Go to Friend Zone to connect!",ja:"フレンドゾーンでつながろう！",ko:"프렌드존에서 연결하세요!",th:"ไปที่ Friend Zone เพื่อเชื่อมต่อ!",vi:"đến Friend Zone để kết nối!",ms:"ke Friend Zone untuk sambung!",la:"ad Friend Zone coniunge!"},visibilityPrivate:{"zh-TW":"私密","zh-CN":"私密",en:"Private",ja:"非公開",ko:"비공개",th:"ส่วนตัว",vi:"Riêng tư",ms:"Peribadi",la:"Privatus"},visibilityFriends:{"zh-TW":"限好友","zh-CN":"限好友",en:"Friends Only",ja:"友達のみ",ko:"친구만",th:"เฉพาะเพื่อน",vi:"Chỉ bạn bè",ms:"Hanya Rakan",la:"Amicis Tantum"},visibilityPublic:{"zh-TW":"開放分享","zh-CN":"开放分享",en:"Public",ja:"公開",ko:"공개",th:"สาธารณะ",vi:"Công khai",ms:"Umum",la:"Publicus"},profileLabels:{"zh-TW":"暱稱：{nickname}\n性別：{gender}\n年齡：{age}\n國家/地區：{country}\n興趣：{interest}\n事件類型：{eventType}","zh-CN":"昵称：{nickname}\n性别：{gender}\n年龄：{age}\n国家/地区：{country}\n兴趣：{interest}\n事件类型：{eventType}",en:"Nickname: {nickname}\nGender: {gender}\nAge: {age}\nCountry/Region: {country}\nInterest: {interest}\nEvent Type: {eventType}",ja:"ニックネーム：{nickname}\n性別：{gender}\n年齢：{age}\n国/地域：{country}\n興味：{interest}\nイベントタイプ：{eventType}",ko:"닉네임: {nickname}\n성별: {gender}\n나이: {age}\n국가/지역: {country}\n관심사: {interest}\n이벤트 유형: {eventType}",th:"ชื่อเล่น: {nickname}\nเพศ: {gender}\nอายุ: {age}\nประเทศ/ภูมิภาค: {country}\nความสนใจ: {interest}\nประเภทเหตุการณ์: {eventType}",vi:"Biệt danh: {nickname}\nGiới tính: {gender}\nTuổi: {age}\nQuốc gia/Khu vực: {country}\nSở thích: {interest}\nLoại sự kiện: {eventType}",ms:"Nama panggilan: {nickname}\nJantina: {gender}\nUmur: {age}\nNegara/Wilayah: {country}\nMinat: {interest}\nJenis Acara: {eventType}",la:"Cognomen: {nickname}\nSexus: {gender}\nAetas: {age}\nPatria/Regio: {country}\nStudium: {interest}\nGenus Eventus: {eventType}"}},UC=["bg-gradient-to-br from-[#7f8fff] to-[#b6b6f6]","bg-gradient-to-br from-[#ffb6b6] to-[#ffd6e0]","bg-gradient-to-br from-[#6be6ff] to-[#b6f6ff]","bg-gradient-to-br from-[#ffe66b] to-[#ffb86b]"];function HC(e){if(!e||"string"!=typeof e)return UC[0];let t=0;for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return UC[t%UC.length]}const VC={"zh-TW":{work_restart:"工作重啟",family_trust:"家庭信任",social_treatment:"社會對待",inner_choice:"內心選擇",misunderstood_and_recovered:"誤解與復原",restart_path:"重啟之路"},"zh-CN":{work_restart:"工作重启",family_trust:"家庭信任",social_treatment:"社会对待",inner_choice:"内心选择",misunderstood_and_recovered:"误解与复原",restart_path:"重启之路"},en:{work_restart:"Work Restart",family_trust:"Family Trust",social_treatment:"Social Treatment",inner_choice:"Inner Choice",misunderstood_and_recovered:"Misunderstood & Recovered",restart_path:"Restart Path"},ja:{work_restart:"仕事の再出発",family_trust:"家族の信頼",social_treatment:"社会の扱い",inner_choice:"内なる選択",misunderstood_and_recovered:"誤解と回復",restart_path:"再出発の道"},ko:{work_restart:"일 재시작",family_trust:"가족의 신뢰",social_treatment:"사회적 대우",inner_choice:"내면의 선택",misunderstood_and_recovered:"오해와 회복",restart_path:"재시작의 길"},th:{work_restart:"เริ่มงานใหม่",family_trust:"ความไว้วางใจในครอบครัว",social_treatment:"การปฏิบัติของสังคม",inner_choice:"ทางเลือกภายในใจ",misunderstood_and_recovered:"ความเข้าใจผิดและการฟื้นฟู",restart_path:"เส้นทางเริ่มต้นใหม่"},vi:{work_restart:"Khởi động lại công việc",family_trust:"Niềm tin gia đình",social_treatment:"Cách đối xử của xã hội",inner_choice:"Lựa chọn nội tâm",misunderstood_and_recovered:"Hiểu lầm và phục hồi",restart_path:"Con đường làm lại"},ms:{work_restart:"Mula Kerja Semula",family_trust:"Kepercayaan Keluarga",social_treatment:"Layanan Sosial",inner_choice:"Pilihan Dalaman",misunderstood_and_recovered:"Salah Faham & Pemulihan",restart_path:"Jalan Permulaan Semula"},la:{work_restart:"Opus Renovatum",family_trust:"Fides Familiaris",social_treatment:"Tractatio Socialis",inner_choice:"Electio Interior",misunderstood_and_recovered:"Error et Recuperatio",restart_path:"Iter Renovationis"}},KC={"zh-TW":"✔ 我願意將這段見證封存於區塊鏈（開發中）","zh-CN":"✔ 我愿意将这段见证封存于区块链（开发中）",en:"✔ I agree to preserve this testimony on the blockchain (In Development)",ja:"✔ この証言をブロックチェーンに保存することに同意します（開発中）",ko:"✔ 이 증언을 블록체인에 보존하는 것에 동의합니다（개발 중）",th:"✔ ฉันยินยอมให้บันทึกเรื่องราวนี้บนบล็อกเชน（กำลังพัฒนา）",vi:"✔ Tôi đồng ý lưu giữ câu chuyện này trên blockchain (Đang phát triển)",ms:"✔ Saya bersetuju untuk menyimpan kisah ini di blockchain (Dalam Pembangunan)",la:"✔ Assentior hanc testificationem in blockchain servari (In Progressu)"},$C={"zh-TW":{private:"只有我",friends:"好友可見",public:"所有人",label:"誰可以看到這段故事？"},"zh-CN":{private:"只有我",friends:"好友可见",public:"所有人",label:"谁可以看到这段故事？"},en:{private:"Only me",friends:"Friends only",public:"Everyone",label:"Who can see this story?"},ja:{private:"自分だけ",friends:"友達のみ",public:"全員",label:"誰がこのストーリーを見られますか？"},ko:{private:"나만 보기",friends:"친구만 보기",public:"모두 보기",label:"이 이야기를 누가 볼 수 있나요?"},th:{private:"เฉพาะฉัน",friends:"เพื่อนเท่านั้น",public:"ทุกคน",label:"ใครสามารถเห็นเรื่องราวนี้ได้บ้าง?"},vi:{private:"Chỉ mình tôi",friends:"Chỉ bạn bè",public:"Mọi người",label:"Ai có thể xem câu chuyện này?"},ms:{private:"Hanya saya",friends:"Hanya rakan",public:"Semua orang",label:"Siapa boleh melihat cerita ini?"},la:{private:"Solus ego",friends:"Amici tantum",public:"Omnes",label:"Quis hanc historiam videre potest?"}},GC={"zh-TW":{launch:"寫下來，也是⼀種勇敢。",ask:"如果只能留下一個故事，你會從哪裡說起？",thanks:"🎉 感謝你分享，這是你的故事",success:"你寫得很好，這段經歷值得被看見。",randomEncourage:["你的過去不定義你，選擇講述它，才是你的力量。","每個故事都值得被聽見。","你願意分享真心，我們願意陪你走一段。","你的經歷很珍貴，謝謝你願意說出來。"],chain:"我要將這段故事封存於區塊鏈",anonymous:"我要匿名分享",countryName:{"中國大陸":"中國大陸","台灣":"台灣","日本":"日本","韓國":"韓國","美國":"美國","其他":"其他"},eventTypeName:{"家暴加害":"家暴加害","家暴受害":"家暴受害","其他":"其他"}},"zh-CN":{launch:"写下来，也是一种勇敢。",ask:"这次你想聊的是什么？",thanks:"🎉 感谢你的分享，这是你的故事",success:"你写得很好，这段经历值得被看见。",randomEncourage:["你的过去不定义你，选择讲述它，才是你的力量。","每个故事都值得被听见。","你愿意分享真心，我们愿意陪你走一段。","你的经历很珍贵，谢谢你愿意说出来。"],chain:"我要将这段故事封存于区块链",anonymous:"我要匿名分享",countryName:{"中國大陸":"中国大陆","台灣":"台湾","日本":"日本","韓國":"韩国","美國":"美国","其他":"其他"},eventTypeName:{"家暴加害":"家暴加害","家暴受害":"家暴受害","其他":"其他"}},en:{launch:"Writing it down is also an act of courage.",ask:"What do you want to talk about this time?",thanks:"🎉 Thank you for sharing, this is your story",success:"You wrote beautifully. This experience deserves to be seen.",randomEncourage:["Your past does not define you. Choosing to tell it is your power.","Every story deserves to be heard.","You share your heart, we walk with you.","Your experience is precious, thank you for sharing."],chain:"I want to preserve this story on the blockchain",anonymous:"I want to share anonymously",countryName:{"中國大陸":"China","台灣":"Taiwan","日本":"Japan","韓國":"Korea","美國":"USA","其他":"Other"},eventTypeName:{"家暴加害":"Domestic Violence Perpetrator","家暴受害":"Domestic Violence Victim","其他":"Other"}},ja:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ko:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},th:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},vi:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ms:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},la:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""}};async function QC(e,t,n){var i;const r={[t]:e};for(const a of n)if(a!==t)try{const n=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,from:t,to:a})}),i=await n.json();r[a]=i.translated||""}catch{try{const n=await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${t}&tl=${a}&dt=t&q=${encodeURIComponent(e)}`),o=await n.json();r[a]=(null==(i=o[0])?void 0:i.map(e=>e[0]).join(""))||""}catch{r[a]=""}}return r}function YC(e,t){return e.titleLangs&&e.titleLangs[t]||e.title}function JC(e,t){return e.contentLangs&&e.contentLangs[t]||e.content}const XC={"zh-TW":{"中國大陸":"中國大陸","台灣":"台灣","日本":"日本","韓國":"韓國","美國":"美國","其他":"其他"},"zh-CN":{"中國大陸":"中国大陆","台灣":"台湾","日本":"日本","韓國":"韩国","美國":"美国","其他":"其他"},en:{"中國大陸":"China","台灣":"Taiwan","日本":"Japan","韓國":"Korea","美國":"USA","其他":"Other"},ja:{"中國大陸":"中国大陸","台灣":"台湾","日本":"日本","韓國":"韓国","美國":"アメリカ","其他":"その他"},ko:{"中國大陸":"중국","台灣":"대만","日本":"일본","韓國":"한국","美國":"미국","其他":"기타"},th:{"中國大陸":"จีน","台灣":"ไต้หวัน","日本":"ญี่ปุ่น","韓國":"เกาหลี","美國":"สหรัฐอเมริกา","其他":"อื่นๆ"},vi:{"中國大陸":"Trung Quốc","台灣":"Đài Loan","日本":"Nhật Bản","韓國":"Hàn Quốc","美國":"Mỹ","其他":"Khác"},ms:{"中國大陸":"China","台灣":"Taiwan","日本":"Jepun","韓國":"Korea","美國":"Amerika","其他":"Lain-lain"},la:{"中國大陸":"Sina","台灣":"Taiwan","日本":"Iaponia","韓國":"Corea","美國":"CFA","其他":"Aliud"}},ZC={"zh-TW":{"家暴加害":"家暴加害","家暴受害":"家暴受害","其他":"其他"},"zh-CN":{"家暴加害":"家暴加害","家暴受害":"家暴受害","其他":"其他"},en:{"家暴加害":"Domestic Violence Perpetrator","家暴受害":"Domestic Violence Victim","其他":"Other"},ja:{"家暴加害":"家庭内暴力加害者","家暴受害":"家庭内暴力被害者","其他":"その他"},ko:{"家暴加害":"가정폭력 가해자","家暴受害":"가정폭력 피해자","其他":"기타"},th:{"家暴加害":"ผู้กระทำความรุนแรงในครอบครัว","家暴受害":"เหยื่อความรุนแรงในครอบครัว","其他":"อื่นๆ"},vi:{"家暴加害":"Người gây bạo lực gia đình","家暴受害":"Nạn nhân bạo lực gia đình","其他":"Khác"},ms:{"家暴加害":"Pelaku Keganasan Rumah Tangga","家暴受害":"Mangsa Keganasan Rumah Tangga","其他":"Lain-lain"},la:{"家暴加害":"Violentus Domesticus","家暴受害":"Victima Violentiae Domesticae","其他":"Aliud"}},eI=()=>{const t=vg(lw),n=Fv(),i=le(),{t:r,i18n:a}=DC(),[o,s]=e.useState("zh-TW");e.useEffect(()=>{const e=localStorage.getItem("lang");e&&["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].includes(e)&&s(e)},[]);const[l,c]=e.useState(null),[d,u]=e.useState([]),[h,p]=e.useState(""),[m,g]=e.useState(""),[x,y]=e.useState(""),[b,v]=e.useState(null),[k,w]=e.useState(!1),[j,S]=e.useState(""),[T,C]=e.useState(!1),[I,B]=e.useState("public"),[R,A]=e.useState({tags:{}}),[F,z]=e.useState(null),[E,_]=e.useState(!1),[N,P]=e.useState(!1),[D,W]=e.useState(""),[M,L]=e.useState(null),[O,q]=e.useState(""),[U,H]=e.useState(!1),[V,K]=e.useState({}),[$,G]=e.useState({}),[Q,Y]=e.useState({}),[J,X]=e.useState(!1),[Z,ee]=e.useState([]),[te,ne]=e.useState(!1),[ie,re]=e.useState(!1);e.useEffect(()=>{const e=yb(n,e=>c(e));return()=>e()},[n]),e.useEffect(()=>{(async()=>{const e=hf(ug(t,"stories"),xf("createdAt","desc")),n=await Wf(e);u(n.docs.map(e=>({id:e.id,...e.data()})))})()},[t]),e.useEffect(()=>{fetch(`/locales/${o}/tags.json`).then(e=>e.json()).then(e=>A(e)).catch(()=>A({tags:{}}))},[o]),e.useEffect(()=>{let e;if(N){let t=0;e=setInterval(()=>{t=(t+1)%6,W(".".repeat(t))},400)}else W("");return()=>clearInterval(e)},[N]),e.useEffect(()=>{!async function(){const e=await vT(()=>Promise.resolve().then(()=>hx),void 0).then(e=>e.getDocs(e.collection(t,"profiles"))),n={};e.forEach(e=>{const t=e.data();t.nickname&&(n[t.nickname]=t),t.name&&(n[t.name]=t)}),G(n)}()},[]),e.useEffect(()=>{!async function(){const e=await vT(()=>Promise.resolve().then(()=>hx),void 0).then(e=>e.getDocs(e.collection(t,"profiles"))),n={};e.forEach(e=>{const t=e.data();t.email&&(n[t.email]=t)}),Y(n)}()},[]),e.useEffect(()=>{if(l){(async()=>{const e=ug(t,"links"),n=hf(e,mf("user1Id","==",l.uid),mf("status","==","connected")),i=hf(e,mf("user2Id","==",l.uid),mf("status","==","connected")),[r,a]=await Promise.all([Wf(n),Wf(i)]),o=new Set;r.forEach(e=>o.add(e.data().user2Id)),a.forEach(e=>o.add(e.data().user1Id)),ee(Array.from(o))})()}},[l]),e.useEffect(()=>{const e=e=>{const t=e.target;t.closest(".language-selector")||t.closest(".legal-menu")||(re(!1),ne(!1))};return(ie||te)&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[ie,te]);const ae=async()=>{if(!h.trim()||!m.trim())return;P(!0),_(!1);let e=0;const n=setInterval(()=>{e=(e+1)%6,W(".".repeat(e))},400);try{w(!0);const[e,n,i]=await Promise.all([fetch("/api/gpt/encourage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({story:m})}).then(e=>e.json()).catch(()=>({encouragement:""})),QC(h,o,["zh-TW","zh-CN","en"]),QC(m,o,["zh-TW","zh-CN","en"])]),r=e.encouragement||"",a=r?await QC(r,o,["zh-TW","zh-CN","en"]):{},s=GC[de].randomEncourage,c=s[Math.floor(Math.random()*s.length)];q(c),await qf(ug(t,"stories"),{title:h,content:m,author:(null==l?void 0:l.displayName)||"匿名",authorEmail:(null==l?void 0:l.email)||"",createdAt:new Date,comments:[],likes:0,encouragement:r,encouragementLangs:a,tag:j,visibility:I,onChain:T,titleLangs:n,contentLangs:i}),p(""),g(""),w(!1);const d=hf(ug(t,"stories"),xf("createdAt","desc")),f=(await Wf(d)).docs.map(e=>({id:e.id,...e.data()}));u(f),z(f[0]||null)}catch(i){p(""),g(""),w(!1)}finally{clearInterval(n),P(!1)}};function oe(e){return e.encouragementLangs&&e.encouragementLangs[de]?e.encouragementLangs[de]:e.encouragement||qC.encouragementDefault[de]}(new Date).getDay();const se=async e=>{await Of(hg(t,"stories",e)),u(d.filter(t=>t.id!==e)),F&&F.id===e&&z(null)},ce=e=>{B(e),"public"!==e&&C(!1)},de=o||"zh-TW";return f.jsxs("div",{children:[window.innerWidth<=768?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"mobile-shared-header",children:f.jsx(zw,{})}),f.jsx("div",{style:{marginTop:"80px",marginBottom:16,width:"240px",marginLeft:"auto",marginRight:"auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"12px 16px",boxShadow:"0 2px 12px #6B5BFF22",display:"flex",justifyContent:"center",alignItems:"center"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("span",{style:{fontSize:"1.5rem",fontWeight:900,color:"#6B5BFF"},children:"📖"}),f.jsx("span",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF"},children:qC.pageTitle[de]})]})}),f.jsxs("div",{style:{marginBottom:16,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22",textAlign:"center"},children:[f.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:qC.storyQuoteLine1[de]}),f.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:qC.storyQuoteLine2[de]}),f.jsx("div",{style:{fontSize:12,color:"#888",fontWeight:500},children:qC.storyQuoteLine3[de]})]}),f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[f.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center",marginBottom:16},children:qC.formTitle[de]}),f.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,marginBottom:16,textAlign:"center"},children:qC.storyPrompt[de]}),f.jsx("input",{value:h,onChange:e=>p(e.target.value),placeholder:qC.titlePlaceholder[de],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),f.jsx("textarea",{value:m,onChange:e=>g(e.target.value),rows:3,placeholder:qC.contentPlaceholder[de],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),f.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[f.jsx("input",{type:"radio",name:"visibility",value:"private",checked:"private"===I,onChange:()=>ce("private")})," ",qC.visibilityPrivate[de]]}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[f.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:"friends"===I,onChange:()=>ce("friends")})," ",qC.visibilityFriends[de]]}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[f.jsx("input",{type:"radio",name:"visibility",value:"public",checked:"public"===I,onChange:()=>ce("public")})," ",qC.visibilityPublic[de]]})]}),"public"===I&&f.jsxs("div",{style:{marginBottom:8},children:[f.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[f.jsx("input",{type:"checkbox",checked:T,onChange:e=>C(e.target.checked),style:{marginRight:4}})," ",KC[de]]}),f.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:qC.blockchainNote[de]})]}),f.jsx("button",{onClick:ae,disabled:k,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:k?"not-allowed":"pointer",opacity:k?.6:1},children:qC.formSubmit[de]})]}),f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[f.jsxs("div",{style:{display:"flex",gap:4,marginBottom:16,flexWrap:"nowrap",justifyContent:"space-between"},children:[f.jsxs("button",{onClick:()=>{_(!0),X(!1),H(!1),L(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:E?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:E?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#💬",qC.partnersStories[de]]}),f.jsxs("button",{onClick:()=>{X(!0),_(!1),H(!1),L(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:J?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:J?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#🤝",qC.friendStories[de]]}),f.jsxs("button",{onClick:()=>{H(!0),_(!1),X(!1),L(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:U?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:U?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1},children:["#📝",qC.myStories[de]]})]}),f.jsx("div",{style:{maxHeight:400,overflowY:"auto",width:"100%",paddingRight:6},children:J?0===Z.length?f.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[qC.noFriends[de],f.jsx("span",{onClick:()=>i("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:qC.goToPairTalk[de]})]}):d.filter(e=>"friends"===e.visibility&&Z.includes(e.authorEmail)).map(e=>{const t=Q[e.authorEmail]||{};return f.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:t=>{t.stopPropagation(),L(M===e.id?null:e.id)},children:YC(e,de)}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[f.jsx("img",{src:t.avatar||t.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),f.jsx("span",{style:{fontWeight:600},children:t&&t.nickname?t.nickname:"-"}),f.jsxs("span",{children:["，",t&&t.age?t.age:"-"]}),f.jsxs("span",{children:["，",t&&t.gender?t.gender:"-"]})]}),M===e.id&&f.jsxs("div",{style:{marginTop:8},children:[f.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:JC(e,de)}),f.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[f.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qC.encouragement[de],"："]}),f.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:oe(e)})]}),e.tag&&f.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:VC[de][e.tag]}),e.onChain&&f.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),f.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:f.jsxs("div",{children:[`${qC.profileLabels[de].split("\n")[0].split("：")[0]}：${t&&t.nickname?t.nickname:"-"}，`,`${qC.profileLabels[de].split("\n")[1].split("：")[0]}：${t&&t.gender?t.gender:"-"}，`,`${qC.profileLabels[de].split("\n")[2].split("：")[0]}：${t&&t.age?t.age:"-"}，`,`${qC.profileLabels[de].split("\n")[3].split("：")[0]}：${t&&"string"==typeof t.country&&t.country?XC[de][t.country]||t.country:"-"}，`,`${qC.profileLabels[de].split("\n")[4].split("：")[0]}：${t&&"string"==typeof t.interest&&t.interest?VC&&VC[de]&&VC[de][t.interest]?VC[de][t.interest]:t.interest:"-"}，`,`${qC.profileLabels[de].split("\n")[5].split("：")[0]}：${t&&"string"==typeof t.eventType&&t.eventType?ZC[de][t.eventType]||t.eventType:"-"}`]})})]})]},e.id)}):U?d.filter(e=>e.author===(null==l?void 0:l.displayName)).map(e=>{var t;const n=Q[e.authorEmail]||{};return f.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[f.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-white font-extrabold text-sm border-2 border-[#ececff] shadow ${HC(e.author)}`,children:(null==(t=e.author)?void 0:t[0])||"A"}),f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:14,cursor:"pointer"},onClick:t=>{t.stopPropagation(),L(M===e.id?null:e.id)},children:YC(e,de)}),f.jsx("button",{onClick:()=>se(e.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:6,padding:"2px 8px",fontWeight:700,cursor:"pointer",fontSize:12},children:"刪除"})]}),M===e.id&&f.jsxs("div",{style:{marginTop:8},children:[f.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4},children:JC(e,de)}),f.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[f.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qC.encouragement[de],"："]}),f.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:oe(e)})]}),e.tag&&f.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:VC[de][e.tag]}),e.onChain&&f.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),f.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:f.jsxs("div",{children:[`${qC.profileLabels[de].split("\n")[0].split("：")[0]}：${n&&n.nickname?n.nickname:"-"}，`,`${qC.profileLabels[de].split("\n")[1].split("：")[0]}：${n&&n.gender?n.gender:"-"}，`,`${qC.profileLabels[de].split("\n")[2].split("：")[0]}：${n&&n.age?n.age:"-"}，`,`${qC.profileLabels[de].split("\n")[3].split("：")[0]}：${n&&"string"==typeof n.country&&n.country?XC[de][n.country]||n.country:"-"}，`,`${qC.profileLabels[de].split("\n")[4].split("：")[0]}：${n&&"string"==typeof n.interest&&n.interest?VC&&VC[de]&&VC[de][n.interest]?VC[de][n.interest]:n.interest:"-"}，`,`${qC.profileLabels[de].split("\n")[5].split("：")[0]}：${n&&"string"==typeof n.eventType&&n.eventType?ZC[de][n.eventType]||n.eventType:"-"}`]})})]})]},e.id)}):d.filter(e=>"public"===e.visibility).map(e=>{const t=Q[e.authorEmail]||{};return f.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:t=>{t.stopPropagation(),L(M===e.id?null:e.id)},children:YC(e,de)}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[f.jsx("img",{src:t.avatar||t.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),f.jsx("span",{style:{fontWeight:600},children:t&&t.nickname?t.nickname:"-"}),f.jsxs("span",{children:["，",t&&t.age?t.age:"-"]}),f.jsxs("span",{children:["，",t&&t.gender?t.gender:"-"]})]}),M===e.id&&f.jsxs("div",{style:{marginTop:8},children:[f.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:JC(e,de)}),f.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[f.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qC.encouragement[de],"："]}),f.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:oe(e)})]}),e.tag&&f.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:VC[de][e.tag]}),e.onChain&&f.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),f.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:f.jsxs("div",{children:[`${qC.profileLabels[de].split("\n")[0].split("：")[0]}：${t&&t.nickname?t.nickname:"-"}，`,`${qC.profileLabels[de].split("\n")[1].split("：")[0]}：${t&&t.gender?t.gender:"-"}，`,`${qC.profileLabels[de].split("\n")[2].split("：")[0]}：${t&&t.age?t.age:"-"}，`,`${qC.profileLabels[de].split("\n")[3].split("：")[0]}：${t&&"string"==typeof t.country&&t.country?XC[de][t.country]||t.country:"-"}，`,`${qC.profileLabels[de].split("\n")[4].split("：")[0]}：${t&&"string"==typeof t.interest&&t.interest?VC&&VC[de]&&VC[de][t.interest]?VC[de][t.interest]:t.interest:"-"}，`,`${qC.profileLabels[de].split("\n")[5].split("：")[0]}：${t&&"string"==typeof t.eventType&&t.eventType?ZC[de][t.eventType]||t.eventType:"-"}`]})})]})]},e.id)})})]})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"url(/skytree.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",zIndex:-1}}),f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsx("div",{style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>i("/")})}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>i("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":"zh-TW"===de||"zh-CN"===de?"了解 Restarter 平台":"en"===de?"Learn about Restarter platform":"ja"===de?"Restarter プラットフォームについて":"ko"===de?"Restarter 플랫폼에 대해 알아보기":"th"===de?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":"vi"===de?"Tìm hiểu về nền tảng Restarter":"ms"===de?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:"zh-TW"===de?"🧬 Restarter™｜我們是誰":"zh-CN"===de?"🧬 Restarter™｜我们是谁":"en"===de?"🧬 Restarter™｜Who We Are":"ja"===de?"🧬 Restarter™｜私たちについて":"ko"===de?"🧬 Restarter™｜우리는 누구인가":"th"===de?"🧬 Restarter™｜เราเป็นใคร":"vi"===de?"🧬 Restarter™｜Chúng tôi là ai":"ms"===de?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>i("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":"zh-TW"===de?"提供意見和建議":"zh-CN"===de?"提供意见和建议":"en"===de?"Provide feedback and suggestions":"ja"===de?"ご意見やご提案を提供":"ko"===de?"의견과 제안 제공":"th"===de?"ให้ข้อเสนอแนะและคำแนะนำ":"vi"===de?"Cung cấp phản hồi và đề xuất":"ms"===de?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:"zh-TW"===de?"💬 意見箱｜我們想聽你說":"zh-CN"===de?"💬 意见箱｜我们想听你说":"en"===de?"💬 Feedback｜We Want to Hear You":"ja"===de?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===de?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===de?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===de?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===de?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),l?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:l.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:l.displayName||l.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(n)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:qC.logout[de]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>i("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===de?"註冊/登入":"zh-CN"===de?"注册/登录":"en"===de?"Register / Login":"ja"===de?"登録/ログイン":"ko"===de?"가입/로그인":"th"===de?"สมัคร/เข้าสู่ระบบ":"vi"===de?"Đăng ký/Đăng nhập":"ms"===de?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},className:"language-selector",children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>re(e=>!e),children:["zh-TW"===o?"繁中":"zh-CN"===o?"简中":"en"===o?"English":"ja"===o?"日本語":"ko"===o?"한국어":"th"===o?"ไทย":"vi"===o?"Tiếng Việt":"ms"===o?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),ie&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===o?"#6B5BFF":"#232946",fontWeight:e===o?700:500,background:e===o?"#f3f0ff":"#fff"},onClick:()=>{s(e),re(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},className:"legal-menu",children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:44,height:"44px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>ne(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff"},onMouseOut:e=>{e.currentTarget.style.background="#fff"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),te&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:180,maxWidth:220,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===de||"zh-CN"===de?"法律文件":"en"===de?"Legal Documents":"ja"===de?"法的文書":"ko"===de?"법적 문서":"th"===de?"เอกสารทางกฎหมาย":"vi"===de?"Tài liệu pháp lý":"ms"===de?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:{"zh-TW":"隱私權政策","zh-CN":"隐私政策",en:"Privacy Policy",ja:"プライバシーポリシー",ko:"개인정보보호정책",th:"นโยบายความเป็นส่วนตัว",vi:"Chính sách bảo mật",ms:"Dasar Privasi",la:"Consilium de Privata"},path:"/privacy-policy"},{key:"terms",title:{"zh-TW":"條款/聲明","zh-CN":"条款/声明",en:"Terms/Statement",ja:"利用規約/声明",ko:"약관/성명",th:"ข้อกำหนด/คำแถลง",vi:"Điều khoản/Tuyên bố",ms:"Terma/Penyata",la:"Termini/Declaratio"},path:"/terms"},{key:"data",title:{"zh-TW":"資料刪除說明","zh-CN":"数据删除说明",en:"Data Deletion",ja:"データ削除について",ko:"데이터 삭제 설명",th:"คำอธิบายการลบข้อมูล",vi:"Giải thích xóa dữ liệu",ms:"Penerangan Pemadaman Data",la:"Explicatio Deletionis Datae"},path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"11px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{i(e.path),ne(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title[de]||e.title["zh-TW"]},e.key))]})]})]}),f.jsx("div",{style:{marginTop:"100px",marginBottom:"0px",display:"flex",justifyContent:"center"},children:f.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px 24px",boxShadow:"0 4px 20px #6B5BFF22",backdropFilter:"blur(10px)"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[f.jsx("span",{style:{fontSize:"2rem",fontWeight:900,color:"#6B5BFF"},children:"📖"}),f.jsx("span",{style:{fontSize:"1.5rem",fontWeight:900,color:"#6B5BFF"},children:qC.pageTitle[de]})]})})}),f.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"0px 20px 20px 20px"},children:f.jsxs("div",{className:"modern-container",style:{width:"90%",maxWidth:1e3,display:"flex",flexDirection:"column",gap:32,background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:20,padding:32,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"},children:[f.jsxs("div",{style:{textAlign:"center",marginBottom:24},children:[f.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:qC.storyQuoteLine1[de]}),f.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:qC.storyQuoteLine2[de]}),f.jsx("p",{style:{fontSize:"0.9rem",color:"#888",fontWeight:500,margin:0,lineHeight:1.4},children:qC.storyQuoteLine3[de]})]}),f.jsxs("div",{style:{display:"flex",gap:32},children:[f.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:24},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginBottom:16},children:[f.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:f.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center"},children:qC.formTitle[de]})}),f.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,textAlign:"center"},children:qC.storyPrompt[de]})]}),f.jsx("input",{value:h,onChange:e=>p(e.target.value),placeholder:qC.titlePlaceholder[de],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),f.jsx("textarea",{value:m,onChange:e=>g(e.target.value),rows:3,placeholder:qC.contentPlaceholder[de],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),f.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[f.jsx("input",{type:"radio",name:"visibility",value:"private",checked:"private"===I,onChange:()=>ce("private")})," ",qC.visibilityPrivate[de]]}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[f.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:"friends"===I,onChange:()=>ce("friends")})," ",qC.visibilityFriends[de]]}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[f.jsx("input",{type:"radio",name:"visibility",value:"public",checked:"public"===I,onChange:()=>ce("public")})," ",qC.visibilityPublic[de]]})]}),"public"===I&&f.jsxs("div",{style:{marginBottom:8},children:[f.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[f.jsx("input",{type:"checkbox",checked:T,onChange:e=>C(e.target.checked),style:{marginRight:4}})," ",KC[de]]}),f.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:qC.blockchainNote[de]})]}),f.jsx("button",{onClick:ae,disabled:k,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:k?"not-allowed":"pointer",opacity:k?.6:1},children:qC.formSubmit[de]})]}),f.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[f.jsxs("div",{style:{display:"flex",gap:10,marginBottom:18},children:[f.jsxs("button",{onClick:()=>{_(!0),X(!1),H(!1),L(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:E?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:E?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#💬",qC.partnersStories[de]]}),f.jsxs("button",{onClick:()=>{X(!0),_(!1),H(!1),L(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:J?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:J?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#🤝",qC.friendStories[de]]}),f.jsxs("button",{onClick:()=>{H(!0),_(!1),X(!1),L(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:U?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:U?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#📝",qC.myStories[de]]})]}),N?f.jsxs("div",{style:{padding:"48px 0",textAlign:"center",color:"#6B5BFF",fontWeight:700,fontSize:22},children:["🤖 AI正在幫你包裝故事，請稍候",D,f.jsx("div",{style:{fontSize:15,color:"#888",marginTop:12},children:"（有時AI會偷偷加點幽默，請耐心等候...）"})]}):J?f.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[f.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#🤝",qC.friendStories[de]]}),f.jsx("button",{onClick:()=>{X(!1),_(!0),H(!1),L(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),f.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:0===Z.length?f.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[qC.noFriends[de],f.jsx("span",{onClick:()=>i("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:qC.goToPairTalk[de]})]}):d.filter(e=>"friends"===e.visibility&&Z.includes(e.authorEmail)).map(e=>{const t=Q[e.authorEmail]||{};return f.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:t=>{t.stopPropagation(),L(M===e.id?null:e.id)},children:YC(e,de)}),f.jsx(OC,{profile:t,variant:"compact"}),M===e.id&&f.jsxs("div",{style:{marginTop:10},children:[f.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:JC(e,de)}),f.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[f.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qC.encouragement[de],"："]}),f.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:oe(e)})]}),e.tag&&f.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:VC[de][e.tag]}),e.onChain&&f.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),e.visibility&&["private","friends","public"].includes(e.visibility)&&f.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:$C[de][e.visibility]}),f.jsx(OC,{profile:t,variant:"detailed"})]})]},e.id)})})]}):U?f.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[f.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#6B5BFF 0%,#23c6e6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#📝",qC.myStories[de]]}),f.jsx("button",{onClick:()=>{H(!1),_(!0),X(!1),L(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),f.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:d.filter(e=>e.author===(null==l?void 0:l.displayName)).map(e=>{var t;const n=Q[e.authorEmail]||{};return f.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[f.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-extrabold text-lg border-2 border-[#ececff] shadow ${HC(e.author)}`,children:(null==(t=e.author)?void 0:t[0])||"A"}),f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,cursor:"pointer"},onClick:t=>{t.stopPropagation(),L(M===e.id?null:e.id)},children:YC(e,de)}),f.jsx("button",{onClick:()=>se(e.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:8,padding:"4px 12px",fontWeight:700,cursor:"pointer"},children:"刪除"})]}),M===e.id&&f.jsxs("div",{style:{marginTop:10},children:[f.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4},children:JC(e,de)}),f.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[f.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qC.encouragement[de],"："]}),f.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:oe(e)})]}),e.tag&&f.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:VC[de][e.tag]}),e.onChain&&f.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),e.visibility&&["private","friends","public"].includes(e.visibility)&&f.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:$C[de][e.visibility]}),f.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:f.jsxs("div",{children:[`${qC.profileLabels[de].split("\n")[0].split("：")[0]}：${n&&n.nickname?n.nickname:"-"}，`,`${qC.profileLabels[de].split("\n")[1].split("：")[0]}：${n&&n.gender?n.gender:"-"}，`,`${qC.profileLabels[de].split("\n")[2].split("：")[0]}：${n&&n.age?n.age:"-"}，`,`${qC.profileLabels[de].split("\n")[3].split("：")[0]}：${n&&"string"==typeof n.country&&n.country?XC[de][n.country]||n.country:"-"}，`,`${qC.profileLabels[de].split("\n")[4].split("：")[0]}：${n&&"string"==typeof n.interest&&n.interest?VC&&VC[de]&&VC[de][n.interest]?VC[de][n.interest]:n.interest:"-"}，`,`${qC.profileLabels[de].split("\n")[5].split("：")[0]}：${n&&"string"==typeof n.eventType&&n.eventType?ZC[de][n.eventType]||n.eventType:"-"}`]})})]})]},e.id)})})]}):f.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[f.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#💬",qC.partnersStories[de]]}),f.jsx("button",{onClick:()=>{H(!0),_(!1),X(!1),L(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回我的故事"}),f.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:d.filter(e=>"public"===e.visibility).map(e=>{const t=Q[e.authorEmail]||{};return f.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:t=>{t.stopPropagation(),L(M===e.id?null:e.id)},children:YC(e,de)}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,fontSize:"14px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[f.jsx("img",{src:t.avatar||t.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),f.jsx("span",{style:{fontWeight:600},children:t&&t.nickname?t.nickname:"-"}),f.jsxs("span",{children:["，",t&&t.age?t.age:"-"]}),f.jsxs("span",{children:["，",t&&t.gender?t.gender:"-"]}),f.jsxs("span",{children:["，",t&&"string"==typeof t.country&&t.country?XC[de][t.country]||t.country:"-"]}),f.jsxs("span",{children:["，",t&&"string"==typeof t.interest&&t.interest?VC&&VC[de]&&VC[de][t.interest]?VC[de][t.interest]:t.interest:"-"]}),f.jsxs("span",{children:["，",t&&"string"==typeof t.eventType&&t.eventType?ZC[de][t.eventType]||t.eventType:"-"]})]}),M===e.id&&f.jsxs("div",{style:{marginTop:10},children:[f.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:JC(e,de)}),f.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[f.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qC.encouragement[de],"："]}),f.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:oe(e)})]}),e.tag&&f.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:VC[de][e.tag]}),e.onChain&&f.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),e.visibility&&["private","friends","public"].includes(e.visibility)&&f.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:$C[de][e.visibility]}),f.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:f.jsxs("div",{children:[`${qC.profileLabels[de].split("\n")[0].split("：")[0]}：${t&&t.nickname?t.nickname:"-"}，`,`${qC.profileLabels[de].split("\n")[1].split("：")[0]}：${t&&t.gender?t.gender:"-"}，`,`${qC.profileLabels[de].split("\n")[2].split("：")[0]}：${t&&t.age?t.age:"-"}，`,`${qC.profileLabels[de].split("\n")[3].split("：")[0]}：${t&&"string"==typeof t.country&&t.country?XC[de][t.country]||t.country:"-"}，`,`${qC.profileLabels[de].split("\n")[4].split("：")[0]}：${t&&"string"==typeof t.interest&&t.interest?VC&&VC[de]&&VC[de][t.interest]?VC[de][t.interest]:t.interest:"-"}，`,`${qC.profileLabels[de].split("\n")[5].split("：")[0]}：${t&&"string"==typeof t.eventType&&t.eventType?ZC[de][t.eventType]||t.eventType:"-"}`]})})]})]},e.id)})})]})]})]})]})})]}),f.jsx("style",{children:"\n      @media (min-width: 768px) {\n        .mobile-shared-header {\n          display: none !important;\n        }\n      }\n      @media (max-width: 767px) {\n        .mobile-shared-header {\n          display: block !important;\n        }\n      }\n    "})]})},tI=[{id:1,name_zh:"書吏",name_en:"Scribe",icon:"📜",upgrade_cost:10},{id:2,name_zh:"縣丞",name_en:"County Clerk",icon:"🪪",upgrade_cost:10},{id:3,name_zh:"通判",name_en:"Overseer",icon:"🧾",upgrade_cost:10},{id:4,name_zh:"巡撫",name_en:"Inspector",icon:"🛡️",upgrade_cost:10},{id:5,name_zh:"尚書",name_en:"Minister",icon:"🏛️",upgrade_cost:10},{id:6,name_zh:"太保",name_en:"Imperial Counselor",icon:"📯",upgrade_cost:10},{id:7,name_zh:"宰相",name_en:"Chancellor",icon:"🏯",upgrade_cost:10},{id:8,name_zh:"皇帝",name_en:"Emperor",icon:"🏰🫅",upgrade_cost:0}];function nI(e){return tI.find(t=>t.id===e)}const iI=e.createContext(void 0);function rI({children:t}){const[n,i]=e.useState(parseInt(localStorage.getItem("badges")||"0",10)),[r,a]=e.useState(parseInt(localStorage.getItem("rankId")||"1",10)),[o,s]=e.useState(!1);const l=nI(r),c=(d=r,tI.find(e=>e.id===d+1));var d;return f.jsx(iI.Provider,{value:{badges:n,rankId:r,rank:l,nextRank:c,promotion:o,addBadge:function(){let e=n+1,t=r,o=!1;return function(e,t){const n=nI(t);return!!n&&n.upgrade_cost>0&&e>=n.upgrade_cost}(e,r)&&(t=r+1,e=0,o=!0,s(!0),setTimeout(()=>s(!1),3e3)),i(e),a(t),localStorage.setItem("badges",String(e)),localStorage.setItem("rankId",String(t)),o},setBadges:i,setRankId:a},children:t})}const aI=e.createContext(void 0),oI=({children:t})=>{const[n,i]=e.useState(!1);return f.jsx(aI.Provider,{value:{isMicOn:n,setMicOn:i},children:t})},sI=e.createContext(null);function lI({children:t}){const n=e.useRef(null);return e.useEffect(()=>{try{return n.current=new WebSocket(kw),n.current.onopen=()=>{},n.current.onerror=e=>{},n.current.onclose=()=>{},()=>{var e;return null==(e=n.current)?void 0:e.close()}}catch(e){}},[]),f.jsx(sI.Provider,{value:n.current,children:t})}const cI={logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},subtitle:{"zh-TW":"每天自我反思，抒發心情，一天一片追蹤情緒，照顧自己","zh-CN":"每天自我反思，抒發心情，一天一片追蹤情緒，照顧自己",ja:"毎日自分を見つめ、気持ちを表現し、感情を追いかけ、自分を大切に",en:"Daily self-reflection, express your feelings, track emotions, take care of yourself",ko:"매일 자기 성찰, 감정 표현, 감정 추적, 자신을 돌보기",th:"สะท้อนตนเองทุกวัน ระบายความรู้สึก ติดตามอารมณ์ ดูแลตัวเอง",vi:"Tự phản ánh mỗi ngày, bày tỏ cảm xúc, theo dõi cảm xúc, chăm sóc bản thân",ms:"Refleksi diri setiap hari, luahkan perasaan, jejak emosi, jaga diri",la:"Cotidie te ipsum considera, affectus exprime, motus tuos persequere, te ipsum cura"},inputPlaceholder:{"zh-TW":"請寫下你的心情...(30字內)","zh-CN":"请写下你的心情...(30字内)",en:"Write your mood... (max 30 chars)",ja:"あなたの気持ちを書いてください...(30文字以内)",ko:"당신의 기분을 적어주세요...(30자 이내)",th:"เขียนความรู้สึกของคุณ...(ไม่เกิน 30 ตัวอักษร)",vi:"Hãy viết tâm trạng của bạn...(tối đa 30 ký tự)",ms:"Tulis perasaan anda...(maksimum 30 aksara)",la:"Animum tuum scribe...(max 30 litterae)"},plantButton:{"zh-TW":"記錄此刻心情","zh-CN":"记录此刻心情",ja:"今の気持ちを記録する",en:"Record Today's Mood",ko:"오늘의 기분 기록",th:"บันทึกอารมณ์วันนี้",vi:"Ghi lại tâm trạng hôm nay",ms:"Catat Perasaan Hari Ini",la:"Inscribere hodiernum animum"},completeTitle:{"zh-TW":"🎉 恭喜你完成拼圖！🎉","zh-CN":"🎉 恭喜你完成拼图！🎉",en:"🎉 Puzzle Completed! 🎉",ja:"🎉 パズル完成！🎉",ko:"🎉 퍼즐 완성! 🎉",th:"🎉 ต่อจิ๊กซอว์สำเร็จ! 🎉",vi:"🎉 Hoàn thành ghép hình! 🎉",ms:"🎉 Teka-teki Selesai! 🎉",la:"🎉 Puzzle Perfectum! 🎉"},completeDesc:{"zh-TW":"你已經解鎖全部心情拼圖，準備好迎接下一個挑戰了嗎？","zh-CN":"你已经解锁全部心情拼图，准备好迎接下一个挑战了吗？",en:"You have unlocked all mood puzzle pieces. Ready for the next challenge?",ja:"すべての気持ちパズルを解放しました。次のチャレンジの準備はできましたか？",ko:"모든 감정 퍼즐을 해제했습니다. 다음 도전을 준비하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์อารมณ์ทั้งหมดแล้ว พร้อมสำหรับความท้าทายถัดไปหรือยัง?",vi:"Bạn đã mở khóa tất cả các mảnh ghép cảm xúc. Sẵn sàng cho thử thách tiếp theo chưa?",ms:"Anda telah membuka semua kepingan teka-teki emosi. Sedia untuk cabaran seterusnya?",la:"Omnes partes animi puzzle aperuisti. Paratus es ad provocationem sequentem?"},nextChallenge:{"zh-TW":"前往{size}x{size}新挑戰","zh-CN":"前往{size}x{size}新挑战",en:"Next {size}x{size} Challenge",ja:"{size}x{size}新しいチャレンジへ",ko:"{size}x{size} 새 도전으로",th:"ไปยังความท้าทาย {size}x{size} ถัดไป",vi:"Thử thách {size}x{size} tiếp theo",ms:"Cabaran {size}x{size} Seterusnya",la:"Ad novam provocationem {size}x{size}"},encouragement:{"zh-TW":"有時候，記錄心情，就是給自己一份溫柔的陪伴。","zh-CN":"有时候，记录心情，就是给自己一份温柔的陪伴。",en:"Sometimes, recording your feelings is a gentle way to accompany yourself.",ja:"ときどき、気持ちを記録することは自分へのやさしい寄り添いです。",ko:"가끔은 마음을 기록하는 것이 자신에게 주는 따뜻한 동행입니다.",th:"บางครั้งการบันทึกความรู้สึก คือการมอบความอ่อนโยนให้ตัวเอง",vi:"Đôi khi, ghi lại cảm xúc là cách dịu dàng để đồng hành cùng chính mình.",ms:"Kadang-kadang, mencatat perasaan adalah teman yang lembut untuk diri sendiri.",la:"Aliquando, animum inscribere est tibi ipsum leniter comitari."},toastInput:{"zh-TW":"請先輸入你的心情！","zh-CN":"请先输入你的心情！",en:"Please enter your mood first!",ja:"まず気持ちを入力してください！",ko:"먼저 기분을 입력해주세요!",th:"กรุณากรอกความรู้สึกของคุณก่อน!",vi:"Vui lòng nhập tâm trạng của bạn trước!",ms:"Sila masukkan perasaan anda dahulu!",la:"Primum animum tuum inscribe!"},invalidMood:{"zh-TW":"請輸入有意義的心情內容（不能全是數字、符號或重複字元）","zh-CN":"请输入有意义的心情内容（不能全是数字、符号或重复字符）",en:"Please enter a meaningful mood (not just numbers, symbols, or repeated characters)",ja:"意味のある気持ちを入力してください（数字や記号、同じ文字だけは不可）",ko:"의미 있는 기분을 입력해주세요(숫자, 기호, 반복문자만은 불가)",th:"กรุณากรอกความรู้สึกที่มีความหมาย (ห้ามเป็นตัวเลข สัญลักษณ์ หรืออักษรซ้ำ)",vi:"Vui lòng nhập tâm trạng có ý nghĩa (không chỉ là số, ký hiệu hoặc ký tự lặp lại)",ms:"Sila masukkan perasaan yang bermakna (bukan hanya nombor, simbol atau aksara berulang)",la:"Sententiam significantem inscribe (non solum numeri, signa aut litterae repetitae)"},completeNext:{"zh-TW":"已完成本關，請點擊前往新挑戰","zh-CN":"已完成本关，请点击前往新挑战",en:"Puzzle completed! Please proceed to the next challenge.",ja:"このステージはクリアしました。次のチャレンジへ進んでください。",ko:"이 단계는 완료되었습니다. 다음 도전으로 이동하세요.",th:"คุณผ่านด่านนี้แล้ว กรุณาไปยังความท้าทายถัดไป",vi:"Bạn đã hoàn thành màn này, hãy chuyển sang thử thách tiếp theo.",ms:"Tahap ini telah selesai. Sila ke cabaran seterusnya.",la:"Hoc gradum perfecisti. Ad provocationem sequentem procede."},finalCompleteTitle:{"zh-TW":"🎉🎉 你已經完成所有心情拼圖！ 🎉🎉","zh-CN":"🎉🎉 你已经完成所有心情拼图！ 🎉🎉",en:"🎉🎉 You have completed all mood puzzles! 🎉🎉",ja:"🎉🎉 すべての気持ちパズルを完成しました！ 🎉🎉",ko:"🎉🎉 모든 감정 퍼즐을 완성했습니다! 🎉🎉",th:"🎉🎉 คุณได้ต่อจิ๊กซอว์อารมณ์ครบทุกชิ้นแล้ว! 🎉🎉",vi:"🎉🎉 Bạn đã hoàn thành tất cả các mảnh ghép cảm xúc! 🎉🎉",ms:"🎉🎉 Anda telah melengkapkan semua teka-teki emosi! 🎉🎉",la:"🎉🎉 Omnes partes animi puzzle perfecisti! 🎉🎉"},finalCompleteDesc:{"zh-TW":"你已經解鎖所有拼圖碎片，這是屬於你的堅持與成就！請繼續相信自己，未來每一天都值得被記錄與慶祝！","zh-CN":"你已经解锁所有拼图碎片，这是属于你的坚持与成就！请继续相信自己，未来每一天都值得被记录与庆祝！",en:"You have unlocked every puzzle piece. This is your perseverance and achievement! Keep believing in yourself—every day ahead is worth celebrating!",ja:"すべてのピースをアンロックしました。これはあなたの努力と成果です！これからも自分を信じて、毎日を大切にしてください！",ko:"모든 퍼즐 조각을 해제했습니다. 이것은 당신의 끈기와 성취입니다! 앞으로도 자신을 믿고, 매일을 소중히 하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์ทุกชิ้นแล้ว นี่คือความพยายามและความสำเร็จของคุณ! จงเชื่อมั่นในตัวเองและเฉลิมฉลองทุกวัน!",vi:"Bạn đã mở khóa mọi mảnh ghép. Đây là sự kiên trì và thành tựu của bạn! Hãy tiếp tục tin vào bản thân và ăn mừng mỗi ngày!",ms:"Anda telah membuka semua kepingan teka-teki. Ini adalah ketabahan dan pencapaian anda! Teruskan percaya pada diri sendiri dan raikan setiap hari!",la:"Omnia fragmenta aenigmatis aperuisti. Haec est constantia et perfectio tua! Crede tibi et diem quemque celebra!"}};function dI(){var t,n,r,a;const o=le(),s=Fv(),{lang:l,setLang:c}=mw(),[d,u]=e.useState(""),[h,p]=e.useState(!1),[m,g]=e.useState([]),x=(null==(t=s.currentUser)?void 0:t.uid)||"",[y,b]=e.useState(!1),[v,k]=e.useState(""),[w,j]=e.useState(!1),[S,T]=e.useState(!1),C=e.useRef(null),I=e.useRef(null),B=(new Date).toISOString().slice(0,10);e.useEffect(()=>{if(!S)return;const e=e=>{I.current&&!I.current.contains(e.target)&&T(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[S]),e.useEffect(()=>{if(!w)return;const e=e=>{C.current&&!C.current.contains(e.target)&&j(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[w]),e.useEffect(()=>{x&&fetch(`/api/mood?userId=${x}`).then(e=>e.json()).then(e=>g(e))},[x]);const[R,A]=i.useState(()=>{const e=localStorage.getItem("puzzleStage");return e?JSON.parse(e):{size:3,unlocked:0,completed:!1,lastDate:""}});i.useEffect(()=>{localStorage.setItem("puzzleStage",JSON.stringify(R))},[R]);const F=R.size||3,z=F+1,E=`/puzzle${F-2}.png`,_=F,N=_*_;const P=R.unlocked,D=(W=P,Array.from({length:N},(e,t)=>t<W));var W;const[M,L]=i.useState(!1),[O,q]=i.useState(null),U=P>=N;function H(){localStorage.setItem("puzzleStage",JSON.stringify({size:3,unlocked:0,completed:!1,lastDate:""})),window.location.reload()}const V={};if(Array.isArray(m)&&m.forEach((e,t)=>{let n=null;e&&Array.isArray(e.petals)?n=e.petals:e&&Array.isArray(e)?n=e:e&&"object"==typeof e&&e.mood&&e.date&&(n=[e]),n&&n.forEach((e,t)=>{if(e&&"string"==typeof e.mood&&"string"==typeof e.date){const t=e.date.slice(0,10);V[t]={mood:e.mood,date:t}}})}),0===Object.keys(V).length)for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e);if(t&&t.startsWith("mood_"))try{const e=JSON.parse(localStorage.getItem(t)||"{}");if(e.date&&e.mood){const t=e.date.slice(0,10);V[t]={mood:e.mood,date:t}}}catch(RB){}}const K=Object.values(V).sort((e,t)=>e.date.localeCompare(t.date)),$=["明天記得再來喔 🌈","每天一點點，心情拼圖就會完成！🧩","你的心情很重要，明天也來記錄吧！📝","給自己一個鼓勵，明天見！💪","一天一片，慢慢拼出美好心情！🌟","明天再來解鎖新拼圖吧！🔓","保持好心情，明天繼續加油！😊"],G={"zh-TW":"用心情解鎖拼圖","zh-CN":"用心情解锁拼图",en:"Unlock puzzles with your mood",ja:"気持ちでパズルを解こう",ko:"마음으로 퍼즐을 해제하세요",th:"ปลดล็อกจิ๊กซอว์ด้วยอารมณ์",vi:"Mở khóa ghép hình bằng cảm xúc",ms:"Buka teka-teki dengan perasaan",la:"Affectibus tuis aenigmata solve"};return f.jsxs("div",{style:{width:"100vw",position:"relative",overflowX:"hidden",background:"url('/snowmountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)",minHeight:"0"},children:[y&&f.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.98)",color:"#6B5BFF",fontWeight:700,fontSize:20,padding:"28px 48px",borderRadius:18,boxShadow:"0 4px 32px #6B5BFF33",zIndex:3e3,textAlign:"center",letterSpacing:1.5,transition:"opacity 0.3s"},children:v}),window.innerWidth>768&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>o("/")})}),f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>o("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":"zh-TW"===l||"zh-CN"===l?"了解 Restarter 平台":"en"===l?"Learn about Restarter platform":"ja"===l?"Restarter プラットフォームについて":"ko"===l?"Restarter 플랫폼에 대해 알아보기":"th"===l?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":"vi"===l?"Tìm hiểu về nền tảng Restarter":"ms"===l?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:"zh-TW"===l?"🧬 Restarter™｜我們是誰":"zh-CN"===l?"🧬 Restarter™｜我们是谁":"en"===l?"🧬 Restarter™｜Who We Are":"ja"===l?"🧬 Restarter™｜私たちについて":"ko"===l?"🧬 Restarter™｜우리는 누구인가":"th"===l?"🧬 Restarter™｜เราเป็นใคร":"vi"===l?"🧬 Restarter™｜Chúng tôi là ai":"ms"===l?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>o("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":"zh-TW"===l?"提供意見回饋":"zh-CN"===l?"提供意见反馈":"en"===l?"Provide feedback":"ja"===l?"フィードバックを提供":"ko"===l?"피드백 제공":"th"===l?"ให้ข้อเสนอแนะ":"vi"===l?"Cung cấp phản hồi":"ms"===l?"Beri maklum balas":"Praebe consilium",role:"button",children:"zh-TW"===l?"💬 意見箱｜我們想聽你說":"zh-CN"===l?"💬 意见箱｜我们想听你说":"en"===l?"💬 Feedback｜We Want to Hear You":"ja"===l?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===l?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===l?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===l?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===l?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:(null==(n=Fv().currentUser)?void 0:n.photoURL)||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),f.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:(null==(r=Fv().currentUser)?void 0:r.displayName)||(null==(a=Fv().currentUser)?void 0:a.email)||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{const e=Fv();await e.signOut(),o("/")},style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px",borderRadius:4,fontWeight:600,border:"1px solid #ff6347",color:"#ff6347",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},children:cI.logout[l]})]})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:I,children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>T(e=>!e),children:["zh-TW"===l?"繁中":"zh-CN"===l?"简中":"en"===l?"English":"ja"===l?"日本語":"ko"===l?"한국어":"th"===l?"ไทย":"vi"===l?"Tiếng Việt":"ms"===l?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),S&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===l?"#6B5BFF":"#232946",fontWeight:e===l?700:500,background:e===l?"#f3f0ff":"#fff"},onClick:()=>{c(e),T(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:C,children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>j(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#6B5BFF"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),w&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===l||"zh-CN"===l?"法律文件":"en"===l?"Legal Documents":"ja"===l?"法的文書":"ko"===l?"법적 문서":"th"===l?"เอกสารทางกฎหมาย":"vi"===l?"Tài liệu pháp lý":"ms"===l?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:"隱私政策",path:"/privacy-policy"},{key:"terms",title:"使用條款",path:"/terms"},{key:"data",title:"資料刪除",path:"/data-deletion"},{key:"ai",title:"AI使用聲明",path:"/ai-statement"},{key:"mental",title:"心理健康免責聲明",path:"/mental-health-disclaimer"},{key:"cookie",title:"Cookie政策",path:"/cookie-policy"},{key:"children",title:"兒童隱私保護",path:"/children-privacy"},{key:"international",title:"國際用戶聲明",path:"/international-users"},{key:"security",title:"安全聲明",path:"/security-statement"},{key:"update",title:"更新通知機制",path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{o(e.path),j(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title},e.key))]})]})]})]}),window.innerWidth<=768&&f.jsx(zw,{}),f.jsx("div",{style:{width:"100%",maxWidth:window.innerWidth<=768?280:400,margin:window.innerWidth<=768?"100px auto 20px auto":"120px auto 20px auto",padding:window.innerWidth<=768?"8px 20px":"12px 20px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:f.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[f.jsx("span",{role:"img","aria-label":"mood",children:"🌱"})," ",cI.pageTitle[l]]})}),f.jsxs("div",{style:{maxWidth:700,margin:window.innerWidth<=768?"0 auto 0 auto":"20px auto 0 auto",padding:window.innerWidth<=768?"2.5rem 2vw 0 2vw":"1.2rem 2vw 0 2vw",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",position:"relative"},children:[f.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:12,flexWrap:"nowrap",marginBottom:8},children:f.jsx("span",{style:{fontSize:15,color:"#888",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55",whiteSpace:"nowrap"},children:G[l]||G.en})}),f.jsx("div",{style:{color:"#888",fontSize:18,marginBottom:0,textAlign:"center",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55"},children:cI.subtitle[l]}),f.jsxs("div",{style:{width:"100%",textAlign:"center",color:"#232323",fontSize:17,fontWeight:500,margin:"0 0 10px 0",letterSpacing:.5,lineHeight:1.5,textShadow:"0 2px 8px #bbb8"},children:[cI.encouragement[l],f.jsx("span",{role:"img","aria-label":"rainbow",children:"🌈"})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end",gap:12,width:"100%",justifyContent:"center",marginBottom:8},children:[f.jsx("textarea",{value:d,onChange:e=>u(e.target.value),placeholder:cI.inputPlaceholder[l],maxLength:30,rows:3,style:{width:260,minWidth:180,maxWidth:320,padding:12,borderRadius:8,border:"1.5px solid #ddd",fontSize:16,resize:"vertical",marginRight:0}}),f.jsx("button",{onClick:async()=>{if(!x)return k("請先登入才能解鎖拼圖"),b(!0),void setTimeout(()=>b(!1),2e3);let e=!1;if(R.lastDate===B&&(e=!0),!e&&Array.isArray(m))for(const i of m)if(i&&Array.isArray(i.petals)&&i.petals.some(e=>"string"==typeof e.date&&e.date.slice(0,10)===B)){e=!0;break}if(!e){const t=`mood_${x}_${B}`;localStorage.getItem(t)&&(e=!0)}if(e)return k("今天已經記錄過心情了，明天再來解鎖新的拼圖吧！✨"),b(!0),void setTimeout(()=>b(!1),2e3);if(U)return k(cI.completeNext[l]),b(!0),void setTimeout(()=>b(!1),2e3);if(!d)return k(cI.toastInput[l]),b(!0),void setTimeout(()=>b(!1),2e3);const t=d.replace(/\s/g,"");if(/^\d+$/.test(t))return k(cI.invalidMood[l]),b(!0),void setTimeout(()=>b(!1),2e3);if(/^[\p{P}\p{S}]+$/u.test(t))return k(cI.invalidMood[l]),b(!0),void setTimeout(()=>b(!1),2e3);if(t.length>=4&&/^(.)\1+$/.test(t))return k(cI.invalidMood[l]),b(!0),void setTimeout(()=>b(!1),2e3);if(t.length<4)return k(cI.invalidMood[l]),b(!0),void setTimeout(()=>b(!1),2e3);p(!0);try{await fetch("/api/mood",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:x,mood:d,date:(new Date).toISOString().slice(0,10)+"-"+Math.random()})}),u(""),fetch(`/api/mood?userId=${x}`).then(e=>e.json()).then(e=>g(e)),p(!1),A(e=>({...e,unlocked:e.unlocked+1,lastDate:(new Date).toISOString().slice(0,10)}));const e=`mood_${x}_${B}`;localStorage.setItem(e,JSON.stringify({date:B,mood:d,timestamp:Date.now()}));const t=new Date,n=t.getDay();q({date:t.toISOString().slice(0,10),mood:$[n],isTodayNewPiece:!0})}catch(n){p(!1),k("解鎖失敗，請稍後再試"),b(!0),setTimeout(()=>b(!1),2e3)}},disabled:h,style:{width:140,minWidth:100,padding:"14px 0",background:h?"#ccc":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:16,letterSpacing:1,cursor:h?"not-allowed":"pointer",transition:"all 0.2s ease",marginLeft:0,marginBottom:0},children:h?"...":cI.plantButton[l]})]}),f.jsx("div",{style:{borderTop:"1px solid #eee",margin:"16px 0"}}),f.jsx("div",{children:f.jsxs("div",{style:{minHeight:0,background:"#f0f8ff",borderRadius:12,display:"block",color:"#aaa",position:"relative",width:"100%",maxWidth:540,overflow:"hidden",margin:"0 auto",padding:"0 0 24px 0"},children:[f.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${_}, 1fr)`,gridTemplateRows:`repeat(${_}, 1fr)`,width:"100%",maxWidth:"100%",margin:"0 auto",aspectRatio:"1 / 1",position:"relative",zIndex:1,gap:0,background:"#fff",boxShadow:"0 2px 24px #6B5BFF22",boxSizing:"border-box"},children:D.map((e,t)=>{const n=K[t]||null,i=(null==n?void 0:n.mood)||"",r=(null==n?void 0:n.date)||"",a=Math.floor(t/_),o=t%_,s=e&&!!n;return f.jsxs("div",{style:{width:"100%",height:"100%",aspectRatio:"1/1",overflow:"hidden",position:"relative",border:"none",boxSizing:"border-box",cursor:s?"pointer":"default",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{s&&q({date:r,mood:i})},children:[f.jsx("img",{src:E,alt:"puzzle",style:{width:`calc(100% * ${_})`,height:`calc(100% * ${_})`,objectFit:"cover",position:"absolute",left:`-${100*o}%`,top:`-${100*a}%`,filter:e?"none":"blur(8px) grayscale(1) brightness(1.2)",opacity:e?1:.5,transition:"filter 0.3s, opacity 0.3s"}}),!e&&f.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:32},children:"?"})]},t)})}),O&&!U&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>q(null),children:f.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px 40px",boxShadow:"0 4px 32px #0008",minWidth:260,maxWidth:320,textAlign:"center",fontSize:18,fontWeight:700},children:[f.jsx("div",{style:{fontSize:16,color:"#6B5BFF",marginBottom:8},children:O.date}),f.jsx("div",{style:{fontSize:22,color:"#232946",marginBottom:8},children:O.mood}),O.isTodayNewPiece&&f.jsx("div",{style:{fontSize:15,color:"#888",marginTop:8},children:"(一天只能解鎖一片，明天再來！)"}),f.jsx("div",{style:{fontSize:14,color:"#888"},children:"（點擊空白處關閉）"})]})}),U&&f.jsx(f.Fragment,{children:f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2,pointerEvents:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",background:"rgba(255,255,255,0.0)"},children:22===R.size?f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",maxWidth:"90vw",margin:"0 auto"},children:[f.jsx("div",{style:{fontSize:32,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",letterSpacing:2,marginBottom:12,lineHeight:1.2,wordBreak:"break-word",maxWidth:"100%"},children:cI.finalCompleteTitle[l]}),f.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88",letterSpacing:1,lineHeight:1.5,wordBreak:"break-word",maxWidth:"100%",marginBottom:24},children:cI.finalCompleteDesc[l]}),f.jsx("button",{onClick:H,style:{padding:"14px 40px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:16,fontWeight:900,fontSize:22,boxShadow:"0 2px 12px #6B5BFF44",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:"再來一次"})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{style:{position:"relative",fontSize:24,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",transform:"scale(0.7)",opacity:1,animation:"flyIn1 0.5s 0.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:cI.completeTitle[l]}),f.jsx("div",{style:{position:"relative",fontSize:20,fontWeight:700,color:"#6B5BFF",marginTop:18,opacity:0,animation:"flyIn2 0.5s 0.6s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:cI.completeDesc[l]}),f.jsx("div",{style:{position:"relative",marginTop:32,opacity:0,animation:"flyIn3 0.5s 1.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:f.jsx("button",{type:"button",onClick:function(){const e={size:z,unlocked:0,completed:!1,lastDate:(new Date).toISOString().slice(0,10)};A(e),g([]),q(null)},style:{padding:"18px 48px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",borderRadius:16,fontWeight:900,fontSize:24,boxShadow:"0 2px 12px #6B5BFF44",border:"none",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:cI.nextChallenge[l].replace(/\{size\}/g,String(z))})}),f.jsx("style",{children:"\n@keyframes flyIn1 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }\n@keyframes flyIn2 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }\n@keyframes flyIn3 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }\n"})]})})})]})})]}),f.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,flexWrap:"wrap"},children:[f.jsx("button",{onClick:function(){const e={...R,unlocked:0,lastDate:""};localStorage.setItem("puzzleStage",JSON.stringify(e)),window.location.reload()},style:{padding:"8px 16px",background:"linear-gradient(135deg,#ff6b6b 60%,#ff8e8e 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:700,fontSize:14,cursor:"pointer",letterSpacing:1},children:"清理當前拼圖"}),f.jsx("button",{onClick:H,style:{padding:"8px 16px",background:"linear-gradient(135deg,#4ecdc4 60%,#6bcfc4 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:700,fontSize:14,cursor:"pointer",letterSpacing:1},children:"重置到第一關"})]})}),f.jsx("style",{children:"\n        @media (min-width: 768px) {\n          .mobile-shared-header {\n            display: none !important;\n          }\n          .desktop-header {\n            display: flex !important;\n          }\n        }\n        @media (max-width: 767px) {\n          .mobile-shared-header {\n            display: block !important;\n          }\n          .desktop-header {\n            display: none !important;\n          }\n        }\n      "})]})}const uI={"zh-TW":{back:"← 返回上一頁",title:"聊天室",send:"送出",placeholder:"輸入訊息..."},"zh-CN":{back:"← 返回上一页",title:"聊天室",send:"发送",placeholder:"输入信息..."},en:{back:"← Back",title:"Chat Room",send:"Send",placeholder:"Type a message..."},ja:{back:"← 前のページへ",title:"チャットルーム",send:"送信",placeholder:"メッセージを入力..."},ko:{back:"← 이전 페이지",title:"채팅방",send:"보내기",placeholder:"메시지 입력..."},th:{back:"← กลับ",title:"ห้องแชท",send:"ส่ง",placeholder:"พิมพ์ข้อความ..."},vi:{back:"← Quay lại",title:"Phòng chat",send:"Gửi",placeholder:"Nhập tin nhắn..."},ms:{back:"← Kembali",title:"Bilik Sembang",send:"Hantar",placeholder:"Taip mesej..."},la:{back:"← Redire",title:"Cella Colloquii",send:"Mitte",placeholder:"Nuntium insere..."}};function hI({open:t,onClose:n,roomId:i,friendName:r}){const[a,o]=e.useState(!1),[s,l]=e.useState(!0),[c,d]=e.useState(""),[u,h]=e.useState([]),p=e.useRef(null),m=e.useRef(null),[g,x]=e.useState(null);e.useEffect(()=>{t&&y()},[t]);const y=async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});x(e),p.current&&(p.current.srcObject=e);const t=e.getAudioTracks()[0];t&&(t.enabled=!1)}catch(e){alert("無法取得視訊權限，請檢查瀏覽器設定")}},b=()=>{if(c.trim()){const e={id:Date.now().toString(),text:c,sender:"我",time:(new Date).toLocaleTimeString()};h(t=>[...t,e]),d("")}};return t?f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0007",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:24,boxShadow:"0 2px 16px #0003",width:"80%",maxWidth:800,height:"80%",maxHeight:600,position:"relative",display:"flex",flexDirection:"column"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontWeight:700,fontSize:20,margin:0},children:"免費一對一視訊聊天"}),f.jsx("button",{onClick:n,style:{background:"#eee",border:"none",borderRadius:8,padding:"6px 14px",fontWeight:700,cursor:"pointer"},children:"關閉"})]}),f.jsxs("div",{style:{display:"flex",flex:1,gap:16},children:[f.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",gap:12},children:[f.jsxs("div",{style:{display:"flex",gap:12,flex:1},children:[f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:"我"}),f.jsx("video",{ref:p,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",height:120,background:"#000",borderRadius:8,objectFit:"cover",transform:"scaleX(-1)"}})]}),f.jsxs("div",{style:{flex:1},children:[f.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:r}),f.jsx("video",{ref:m,autoPlay:!0,playsInline:!0,style:{width:"100%",height:120,background:"#000",borderRadius:8,objectFit:"cover"}})]})]}),f.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{if(g){const e=g.getAudioTracks()[0];e&&(e.enabled=!e.enabled,o(e.enabled))}},style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 16px",fontWeight:700,fontSize:14,cursor:"pointer"},children:a?"關閉語音":"開啟語音"}),f.jsx("button",{onClick:()=>{if(g){const e=g.getVideoTracks()[0];e&&(e.enabled=!e.enabled,l(e.enabled))}},style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 16px",fontWeight:700,fontSize:14,cursor:"pointer"},children:s?"關閉視訊":"開啟視訊"})]})]}),f.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",border:"1px solid #eee",borderRadius:8,padding:12},children:[f.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:"即時聊天"}),f.jsx("div",{style:{flex:1,background:"#f7f7f7",borderRadius:6,padding:8,marginBottom:8,overflowY:"auto",minHeight:100},children:0===u.length?f.jsx("div",{style:{fontSize:12,color:"#666",textAlign:"center",marginTop:20},children:"視訊聊天中，可以同時打字聊天"}):u.map(e=>f.jsxs("div",{style:{marginBottom:8,fontSize:12},children:[f.jsx("div",{style:{fontWeight:600,color:"#6B5BFF"},children:e.sender}),f.jsx("div",{style:{color:"#333",marginTop:2},children:e.text}),f.jsx("div",{style:{fontSize:10,color:"#999",marginTop:2},children:e.time})]},e.id))}),f.jsxs("div",{style:{display:"flex",gap:8},children:[f.jsx("input",{value:c,onChange:e=>d(e.target.value),onKeyPress:e=>{"Enter"===e.key&&b()},placeholder:"輸入訊息...",style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:"6px 8px",fontSize:12}}),f.jsx("button",{onClick:b,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"6px 12px",fontWeight:700,fontSize:12,cursor:"pointer"},children:"發送"})]})]})]})]})}):null}function pI(){const[t,n]=e.useState([]),[i,r]=e.useState(null),[a,o]=e.useState([]),[s,l]=e.useState(""),{lang:c,setLang:d}=mw(),[u,h]=e.useState(null),[p,m]=e.useState(!0),g=e.useRef(null),x=le(),[y,b]=e.useState(!1),{isTestMode:v}=CB();e.useEffect(()=>{const e=yb(dw,async e=>{e?(h(e),await k(e.uid)):x("/")});return()=>e()},[x]);const k=async e=>{m(!0);const t=ug(cw,"links"),i=hf(t,mf("user1Id","==",e),mf("status","==","connected")),a=hf(t,mf("user2Id","==",e),mf("status","==","connected")),[o,s]=await Promise.all([Wf(i),Wf(a)]),l=new Set;o.forEach(e=>l.add(e.data().user2Id)),s.forEach(e=>l.add(e.data().user1Id));const c=[];for(const n of l){const e=hg(cw,"profiles",n),t=await Pf(e);if(t.exists()){const e=t.data();c.push({id:n,name:e.name||"好友",avatar:e.avatar||"/avatars/Derxl.png",online:!!e.online})}}if(v&&c.push({id:"test-friend-1",name:"測試好友 1",avatar:"/avatars/Annie.png",online:!0},{id:"test-friend-2",name:"測試好友 2",avatar:"/avatars/Bray.png",online:!1},{id:"test-friend-3",name:"測試好友 3",avatar:"/avatars/berlex.png",online:!0}),n(c),m(!1),v&&c.length>0){const e=c.find(e=>e.id.startsWith("test-friend-"));e&&r(e)}};e.useEffect(()=>{if(u&&i){if(m(!0),v&&i.id.startsWith("test-friend-")){const e=[{id:"test-msg-1",fromUserId:i.id,fromUserName:i.name,toUserId:u.uid,toUserName:u.displayName||"我",text:"你好！很高興認識你 😊",participants:[u.uid,i.id],createdAt:new Date(Date.now()-3e5)},{id:"test-msg-2",fromUserId:u.uid,fromUserName:u.displayName||"我",toUserId:i.id,toUserName:i.name,text:"你好！我也很高興認識你 👋",participants:[u.uid,i.id],createdAt:new Date(Date.now()-24e4)},{id:"test-msg-3",fromUserId:i.id,fromUserName:i.name,toUserId:u.uid,toUserName:u.displayName||"我",text:"今天天氣真不錯，你有什麼計劃嗎？",participants:[u.uid,i.id],createdAt:new Date(Date.now()-18e4)},{id:"test-msg-4",fromUserId:u.uid,fromUserName:u.displayName||"我",toUserId:i.id,toUserName:i.name,text:"我想去公園散步，你要一起嗎？",participants:[u.uid,i.id],createdAt:new Date(Date.now()-12e4)},{id:"test-msg-5",fromUserId:i.id,fromUserName:i.name,toUserId:u.uid,toUserName:u.displayName||"我",text:"好啊！聽起來很有趣 🌳",participants:[u.uid,i.id],createdAt:new Date(Date.now()-6e4)}];return o(e),void m(!1)}const e=Uf(hf(ug(cw,"messages"),mf("participants","array-contains",u.uid),xf("createdAt","asc")),e=>{const t=[];e.forEach(e=>{const n=e.data();n.participants.includes(i.id)&&t.push({...n,id:e.id})}),o(t),m(!1)});return()=>e()}},[u,i,v]),e.useEffect(()=>{var e;null==(e=g.current)||e.scrollIntoView({behavior:"smooth"})},[a]);const w=async()=>{if(s.trim()&&u&&i){if(v&&i.id.startsWith("test-friend-")){const e={id:`test-msg-${Date.now()}`,fromUserId:u.uid,fromUserName:u.displayName||"我",toUserId:i.id,toUserName:i.name,text:s,participants:[u.uid,i.id],createdAt:new Date};return o(t=>[...t,e]),void l("")}try{const e={fromUserId:u.uid,fromUserName:u.displayName||"我",toUserId:i.id,toUserName:i.name,text:s,participants:[u.uid,i.id],createdAt:ax()};await qf(ug(cw,"messages"),e),l("")}catch(e){alert("發送訊息失敗")}}},j=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())};return p?f.jsx("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):f.jsxs("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:(window.innerWidth,"flex"),flexDirection:window.innerWidth<=768?"column":"row",alignItems:window.innerWidth<=768?"center":"flex-start",justifyContent:"center",paddingTop:window.innerWidth<=768?20:40,position:"relative"},children:[f.jsx("button",{onClick:()=>x("/friend"),style:{position:"fixed",top:24,left:24,zIndex:10001,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回上一頁"}),window.innerWidth<=768?f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",width:"100%",maxWidth:400,padding:"20px"},children:[v&&f.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",padding:"8px 12px",borderRadius:8,fontSize:12,color:"#666",marginBottom:10},children:["測試模式：好友數量 ",t.length,"，選中好友 ",(null==i?void 0:i.name)||"無"]}),f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[f.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"好友列表"}),f.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:0===t.length?v?"測試模式已啟用，但沒有測試好友":"請先加好友,才能開始聊天":"選擇好友開始聊天"}),t.length>0&&f.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:t.map(e=>f.jsxs("div",{onClick:()=>e.online&&r(e),style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,cursor:e.online?"pointer":"not-allowed",padding:"8px",borderRadius:8,background:(null==i?void 0:i.id)===e.id?"rgba(107,91,255,0.1)":"transparent",border:(null==i?void 0:i.id)===e.id?"1px solid #6B5BFF":"1px solid transparent",opacity:e.online?1:.5},children:[f.jsx("img",{src:e.avatar,alt:e.name,style:{width:36,height:36,borderRadius:"50%",filter:e.online?"none":"grayscale(1)",border:(null==i?void 0:i.id)===e.id?"2px solid #6B5BFF":"2px solid #eee"}}),f.jsxs("div",{style:{flex:1},children:[f.jsxs("div",{style:{fontWeight:600,color:e.online?"#222":"#aaa",fontSize:14},children:[e.name,v&&e.id.startsWith("test-friend-")&&f.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),f.jsx("div",{style:{fontSize:11,color:e.online?"#23c6e6":"#aaa"},children:e.online?"在線":"離線"})]})]},e.id))})]}),f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[f.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"聊天訊息框"}),f.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:0===t.length?v?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友,去交友區加好友吧!":i?`與 ${i.name} 聊天`:"請選擇好友開始聊天"}),i&&f.jsx("div",{style:{maxHeight:150,overflowY:"auto",background:"#f7f7f7",borderRadius:8,padding:12,marginBottom:16},children:0===a.length?f.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:14},children:v&&i.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！"}):a.map((e,t)=>f.jsxs("div",{style:{textAlign:e.fromUserId===(null==u?void 0:u.uid)?"right":"left",marginBottom:8},children:[f.jsxs("span",{style:{fontWeight:600,color:e.fromUserId===(null==u?void 0:u.uid)?"#2a5d8f":"#888",fontSize:12},children:[e.fromUserName,"："]}),f.jsx("span",{style:{marginLeft:4,fontSize:12},children:e.text})]},e.id||t))}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48},children:[f.jsx("input",{value:s,onChange:e=>l(e.target.value),onKeyPress:j,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:8,fontSize:14},placeholder:v&&(null==i?void 0:i.id.startsWith("test-friend-"))?"輸入測試訊息...":uI[c].placeholder,disabled:0===t.length||!i}),f.jsx("button",{onClick:i?w:void 0,disabled:0===t.length||!i,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:0!==t.length&&i?"pointer":"not-allowed",opacity:0!==t.length&&i?1:.5},children:v&&(null==i?void 0:i.id.startsWith("test-friend-"))?"發送":uI[c].send}),f.jsx("button",{onClick:i?()=>b(!0):void 0,disabled:0===t.length||!i,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:0!==t.length&&i?"pointer":"not-allowed",opacity:0!==t.length&&i?1:.5},children:v&&(null==i?void 0:i.id.startsWith("test-friend-"))?"視訊":"視訊聊天"})]})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{width:220,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:16,marginRight:32,minHeight:600},children:[f.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:16},children:"好友列表"}),0===t.length?f.jsx("div",{style:{color:"#888",textAlign:"center",marginTop:80,fontSize:16,fontWeight:600},children:v?f.jsxs(f.Fragment,{children:["測試模式已啟用，但沒有測試好友",f.jsx("br",{}),f.jsx("span",{style:{fontSize:32},children:"🧪"})]}):f.jsxs(f.Fragment,{children:["你暫時沒有連結朋友，再繼續加油 💪",f.jsx("br",{}),f.jsx("span",{style:{fontSize:32},children:"🦋"})]})}):t.map(e=>f.jsxs("div",{onClick:()=>e.online&&r(e),style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,cursor:e.online?"pointer":"not-allowed",opacity:e.online?(null==i?void 0:i.id)===e.id?1:.7:.3},children:[f.jsx("img",{src:e.avatar,alt:e.name,style:{width:44,height:44,borderRadius:"50%",filter:e.online?"none":"grayscale(1)",border:(null==i?void 0:i.id)===e.id?"2px solid #6B5BFF":"2px solid #eee"}}),f.jsxs("div",{children:[f.jsxs("div",{style:{fontWeight:600,color:e.online?"#222":"#aaa"},children:[e.name,v&&e.id.startsWith("test-friend-")&&f.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),f.jsx("div",{style:{fontSize:12,color:e.online?"#23c6e6":"#aaa"},children:e.online?"在線":"離線"})]})]},e.id))]}),f.jsxs("div",{style:{flex:1,maxWidth:500,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:32,minHeight:600,display:"flex",flexDirection:"column",position:"relative"},children:[f.jsx("div",{style:{fontWeight:700,fontSize:22,marginBottom:16,marginTop:8},children:i?v&&i.id.startsWith("test-friend-")?`與 ${i.name} 聊天 (測試模式)`:`與 ${i.name} 聊天`:0===t.length?v?"測試模式已啟用，請選擇測試好友開始聊天":"請先加好友，才能開始聊天":"請選擇好友開始聊天"}),f.jsxs("div",{style:{flex:1,overflowY:"auto",marginBottom:16,background:"#f7f7f7",borderRadius:8,padding:16,minHeight:240,maxHeight:340},children:[(!i||0===a.length)&&f.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:20},children:i?v&&i.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！":0===t.length?v?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友，去交友區加好友吧！":"請先選擇好友"}),i&&a.map((e,t)=>f.jsxs("div",{style:{textAlign:e.fromUserId===(null==u?void 0:u.uid)?"right":"left",marginBottom:10},children:[f.jsxs("span",{style:{fontWeight:600,color:e.fromUserId===(null==u?void 0:u.uid)?"#2a5d8f":"#888"},children:[e.fromUserName,"："]}),f.jsx("span",{style:{marginLeft:8},children:e.text})]},e.id||t)),f.jsx("div",{ref:g})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48,marginTop:8},children:[f.jsx("input",{value:s,onChange:e=>l(e.target.value),onKeyPress:j,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:10,fontSize:16},placeholder:v&&(null==i?void 0:i.id.startsWith("test-friend-"))?"輸入測試訊息...":uI[c].placeholder,disabled:0===t.length||!i}),f.jsx("button",{onClick:i?w:void 0,disabled:0===t.length||!i,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:0!==t.length&&i?"pointer":"not-allowed",opacity:0!==t.length&&i?1:.5},children:v&&(null==i?void 0:i.id.startsWith("test-friend-"))?"發送":uI[c].send}),f.jsx("button",{onClick:i?()=>b(!0):void 0,disabled:0===t.length||!i,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:0!==t.length&&i?"pointer":"not-allowed",opacity:0!==t.length&&i?1:.5},children:v&&(null==i?void 0:i.id.startsWith("test-friend-"))?"視訊":"視訊聊天"})]}),f.jsx(hI,{open:y,onClose:()=>b(!1),roomId:u&&i?`${u.uid}_${i.id}`:"",friendName:(null==i?void 0:i.name)||"對方"})]})]})]})}const mI={"zh-TW":{title:"我們是誰",subtitle:"🧬 Restarter™｜我們是誰（關於我們）",story:`${"每個人都值得一個能「重啟」的起點。"}\n你可能來自一場重創，或正走在一條孤獨的路上。\n在這個被標籤和數據主導的世界裡，我們知道——有些情緒，不是一句「加油」能解決的。\n\nRestarter™ 是專為「曾經失去節奏的人」打造的 AI 陪伴平台。\n我們不但教你怎麼變強、不單告訴你要正能量，\n我們更提供一個空間,讓你可以呼吸、可以交流、可以說實話、可以重新選擇。\n\n這裡沒有社會的審判，只有一群「曾經也痛過的人」在用技術把陪伴具體化。\n透過 AI，我們讓每一次對話、每一段情緒，都有人接得住。`,quote:"「我們不是修復你，我們是來陪你重啟。」",restart:"Restarter™，是你重新定義自己的起點。\nRestarter™更願意和各不同領域共同打造越加良善的社會環境。",founder:"創辦者的話",founderStory:"我曾經失去自由十年。<br/>\n那不是旅居、不是修行，而是被法律與命運關進去的十年。<br/>\n在一間不大的房間裡，和一群同樣頂著光頭、穿著另類制服的人擠在一起，日子一開始像是一場長夢，到了後來，連夢都不做了。我以為這一生就這樣被定義了。<br/><br/>\n出去那天，天空灰得刺眼。我笑著走出來，但心裡卻是空的。<br/>\n社會沒有在等你，家人不知如何面對你，朋友的問候也帶著距離。<br/>\n起初的很多時候，我甚至不敢正眼看便利商店的收銀員，因為<span style='color:#e4572e;font-weight:700;'>我忘了怎麼當一個「普通人」</span>。<br/><br/>\n我一直想問：<br/>\n<span style='color:#614425;font-weight:900;'>我還有沒有機會，重新開始？</span><br/><br/>\n後來我才明白——<br/>\n<span style='color:#e4572e;font-weight:900;'>不是世界不給機會，是我們被迫忘了怎麼伸手抓。</span><br/><br/>\n這就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>\n不是來修復你，不是總告訴你「要振作」，<br/>\n而是給你一個空間，一個能慢慢重新建立自己的容器。<br/>\n讓你在失落裡還能大聲說話，在混亂中依然有人接得住。<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技術產品，<br/>\n是我從自己生命最底部捧出來的一個火種，<br/>\n我希望它能為你，也為更多人，點起一盞燈。<br/><br/>\n<span style='color:#614425;font-weight:900;'>不論你是誰，經歷什麼，來自世界哪個角落，<br/>在這裡你可以大膽放下那些標籤、包裝、包袱。</span><br/>\n因為我們相信——<br/>\n<span style='color:#e4572e;font-weight:900;'>「破碎過的人，不僅能堅強，也能很溫柔。」</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>我們不是修復你，我們是來陪你重啟。</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>發起人：Ben<br/>May,21,2025</div>"},"zh-CN":{title:"我们是谁",subtitle:"🧬 Restarter™｜我们是谁（关于我们）",story:`${"每个人都值得一个能“重启”的起点。"}\n你可能来自一场重创，或正走在一条孤独的路上。\n在这个被标签和数据主导的世界里，我们知道——有些情绪，不是一句「加油」能解决的。\n\nRestarter™ 是专为「曾经失去节奏的人」打造的 AI 陪伴平台。\n我们不教你怎么变强、不告诉你要正能量，\n我们只提供一个空间，让你可以呼吸、可以说实话、可以重新选择。\n\n这里没有社会的审判，只有一群「曾经也痛过的人」在用技术把陪伴实体化。\n通过 AI，我们让每一次对话、每一段情绪，都有人接得住。`,quote:"「我们不是修复你，我们陪你重启。」",restart:"Restarter™，是你重新定义自己的起点。\nRestarter™更愿意和各不同领域共同打造越加良善的社会环境。",founder:"创办者的话",founderStory:"我曾经失去自由十年。<br/>\n那不是旅行、不是修行，而是被法律和命运关进去了十年。<br/>\n在一间不大的房间里，和一群同样光头、穿着统一服装的人挤在一起，日子一开始像是一场长梦，后来连梦都不做了。我以为这一生就这样被定义了。<br/><br/>\n出去那天，天空灰得刺眼。我笑着走出来，但心里却是空的。<br/>\n社会没有在等你，家人不知如何面对你，朋友的问候也带着距离。<br/>\n很多时候，我甚至不敢正眼看便利店的收银员，因为<span style='color:#e4572e;font-weight:700;'>我忘了怎么当一个\"普通人\"</span>。<br/><br/>\n我一直想问：<br/>\n<span style='color:#614425;font-weight:900;'>我还有没有机会，重新开始？</span><br/><br/>\n后来我才明白——<br/>\n<span style='color:#e4572e;font-weight:900;'>不是世界不给机会，是我们被迫忘了怎么伸手抓。</span><br/><br/>\n这就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>\n不是来修复你，不是总告诉你\"要振作\"，<br/>\n而是给你一个空间，一个能慢慢重新建立自己的容器。<br/>\n让你在失落里还能大声说话，在混乱中有人接得住。<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技术产品，<br/>\n是我从自己生命最底部捧出来的一束火种，<br/>\n我希望它能为你，也为更多人，点亮一盏灯。<br/><br/>\n<span style='color:#614425;font-weight:900;'>无论你是谁，经历什么，来自世界哪个角落，<br/>在这里你可以大胆放下那些伪装。</span><br/>\n因为我们相信——<br/>\n<span style='color:#e4572e;font-weight:900;'>\"破碎过的人，不仅能坚强，也能很温柔。\"</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>我们不是修复你，我们是来陪你重启。</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>发起人：Ben<br/>2025年5月21日</div>"},en:{title:"About Us",subtitle:"🧬 Restarter™｜Who We Are",story:`${"Everyone deserves a new beginning."}\nYou may have come from a major setback, or are walking a lonely road.\nIn a world dominated by labels and data, we know—some feelings can't be fixed by a simple "cheer up".\n\nRestarter™ is an AI companion platform built for those who have lost their rhythm.\nWe don't teach you how to be strong, nor tell you to be positive.\nWe simply offer a space where you can breathe, speak your truth, and choose again.\n\nThere is no judgment here—only people who have also suffered, using technology to make companionship real.\nThrough AI, every conversation and every emotion is caught and cared for.`,quote:"“We are not here to fix you, we are here to restart with you.”",restart:"Restarter™ is your new beginning to redefine yourself.\nRestarter™ is more willing to work with various fields to create a more benevolent social environment.",founder:"Founder's Message",founderStory:"I lost my freedom for ten years.<br/>\nIt wasn't travel or spiritual retreat, but ten years locked away by law and fate.<br/>\nIn a small room, crowded with others in the same uniform, the days first felt like a long dream, then even dreams faded. I thought my life was defined forever.<br/><br/>\nThe day I got out, the sky was a blinding gray. I walked out smiling, but my heart was empty.<br/>\nSociety wasn't waiting for me, my family didn't know how to face me, and friends' greetings felt distant.<br/>\nMany times, I couldn't even look a cashier in the eye, because <span style='color:#e4572e;font-weight:700;'>I'd forgotten how to be \"normal\"</span>.<br/><br/>\nI kept asking myself:<br/>\n<span style='color:#614425;font-weight:900;'>Do I still have a chance to start over?</span><br/><br/>\nLater, I realized—<br/>\n<span style='color:#e4572e;font-weight:900;'>It's not that the world doesn't give chances, but that we've forgotten how to reach for them.</span><br/><br/>\nThat's why <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> exists.<br/>\nNot to fix you, not to always tell you to \"cheer up,\"<br/>\nbut to give you a space—a container to slowly rebuild yourself.<br/>\nA place where you can speak up in your loss, and someone will catch you in your chaos.<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> is not just a tech product;<br/>\nit's a spark I brought up from the bottom of my life.<br/>\nI hope it lights a lamp for you, and for many others.<br/><br/>\n<span style='color:#614425;font-weight:900;'>Whoever you are, whatever you've been through, wherever you're from—<br/>here, you can let go of all the masks.</span><br/>\nBecause we believe—<br/>\n<span style='color:#e4572e;font-weight:900;'>\"Those who have been broken can be strong, and gentle too.\"</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>We are not here to fix you, we are here to restart with you.</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Founder: Ben<br/>May 21, 2025</div>"},ja:{title:"私たちについて",subtitle:"🧬 Restarter™｜私たちについて",story:`${"誰もが「再出発」できるスタート地点を持つべきです。"}\nあなたは大きな挫折から来たかもしれないし、孤独な道を歩んでいるかもしれません。\nラベルやデータが支配するこの世界で、私たちは知っています——「頑張って」だけでは解決できない感情があることを。\n\nRestarter™は「リズムを失った人」のためのAI伴走プラットフォームです。\n強くなる方法を教えたり、ポジティブになれと言ったりはしません。\nただ、呼吸できて、本音を言えて、もう一度選び直せる空間を提供します。\n\nここには社会の裁きはなく、「かつて痛みを知った人たち」が技術で寄り添っています。\nAIを通じて、すべての対話と感情が、誰かに受け止められます。`,quote:"「私たちはあなたを修復するのではなく、一緒に再出発します。」",restart:"Restarter™は、あなたが自分を再定義する新たなスタート地点です。\nRestarter™は、様々な分野と協力してより善良な社会環境を作ることを望んでいます。",founder:"創業者の言葉",founderStory:"私は10年間、自由を失いました。<br/>\nそれは旅でも修行でもなく、法律と運命によって閉じ込められた10年でした。<br/>\n小さな部屋で、同じ服を着た仲間たちと押し込められ、最初は長い夢のようで、やがて夢さえ見なくなりました。人生はもう決まったものだと思っていました。<br/><br/>\n出所の日、空は眩しいほど灰色でした。我笑顔で外に出たけれど、心は空っぽ。<br/>\n社會は待っていない、家族もどう接していいかわからない、友人の声もどこか遠い。<br/>\n何度も、コンビニの店員の目を見られなかった。<span style='color:#e4572e;font-weight:700;'>「普通の人」になる方法を忘れてしまった</span>から。<br/><br/>\nずっと自問していました：<br/>\n<span style='color:#614425;font-weight:900;'>もう一度やり直すチャンスはあるのか？</span><br/><br/>\nやがて気づきました——<br/>\n<span style='color:#e4572e;font-weight:900;'>世界がチャンスをくれないのではなく、手を伸ばす方法を忘れてしまったのだと。</span><br/><br/>\nこれが <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> の存在理由です。<br/>\nあなたを修復するためでも、無理に「元気を出して」と言うためでもなく、<br/>\nゆっくり自分を取り戻せる場所を作りたかった。<br/>\n失意の中でも声を上げられ、混乱の中でも誰かが受け止めてくれる場所を。<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> は単なる技術製品ではありません。<br/>\n人生のどん底からすくい上げた火種です。<br/>\nあなたや多くの人のために、灯りをともしたい。<br/><br/>\n<span style='color:#614425;font-weight:900;'>あなたが誰であれ、どんな経験をしてきたとしても、<br/>ここではすべての仮面を外していい。</span><br/>\n私たちは信じています——<br/>\n<span style='color:#e4572e;font-weight:900;'>「壊れた人は、強くもなれるし、優しくもなれる。」</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>私たちはあなたを修復するのではなく、一緒に再出発します。</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>発起人：Ben<br/>2025年5月21日</div>"},ko:{title:"우리는 누구인가",subtitle:"🧬 Restarter™｜우리는 누구인가",story:`${'모든 사람은 "다시 시작"할 수 있는 출발점이 필요합니다.'}\n당신은 큰 시련을 겪었거나, 외로운 길을 걷고 있을지도 모릅니다.\n라벨과 데이터가 지배하는 세상에서, 우리는 압니다—어떤 감정은 "힘내"라는 말로 해결되지 않는다는 것을.\n\nRestarter™는 "한때 리듬을 잃었던 사람"을 위한 AI 동반자 플랫폼입니다.\n우리는 당신에게 강해지는 법을 가르치지 않고, 긍정적이 되라고 말하지 않습니다.\n우리는 단지 숨 쉴 수 있고, 진실을 말할 수 있고, 다시 선택할 수 있는 공간을 제공합니다.\n\n여기에는 사회의 심판이 없고, "한때 아팠던 사람들"이 기술로 동행합니다.\nAI를 통해 모든 대화와 감정이 누군가에게 받아들여집니다。`,quote:'"우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다."',restart:"Restarter™는 당신이 자신을 새롭게 정의하는 출발점입니다。\nRestarter™는 다양한 분야와 협력하여 더욱 선한 사회 환경을 만들고자 합니다。",founder:"창업자의 말",founderStory:"저는 10년 동안 자유를 잃었습니다.<br/>\n그것은 여행도, 수련도 아니었고, 법과 운명에 의해 갇혀 있던 10년이었습니다.<br/>\n작은 방에서 같은 옷을 입은 사람들과 함께 지내며, 처음에는 긴 꿈을 꾸는 것 같았지만, 나중에는 꿈조차 꾸지 않게 되었습니다. 저는 제 인생이 그렇게 정의될 거라 생각했습니다.<br/><br/>\n밖으로 나왔던 날, 하늘은 눈부시게 회색이었습니다. 저는 웃으며 나왔지만, 마음은 텅 비어 있었습니다.<br/>\n사회는 저를 기다려주지 않았고, 가족도 저를 어떻게 대해야 할지 몰랐으며, 친구들의 인사도 어딘가 멀게 느껴졌습니다.<br/>\n처음에는 편의점 계산원의 눈을 제대로 쳐다보지도 못했습니다. <span style='color:#e4572e;font-weight:700;'>\"평범한 사람\"이 되는 법을 잊어버렸기 때문입니다</span>.<br/><br/>\n저는 계속해서 스스로에게 물었습니다:<br/>\n<span style='color:#614425;font-weight:900;'>나는 다시 시작할 기회가 있을까?</span><br/><br/>\n나중에야 깨달았습니다——<br/>\n<span style='color:#e4572e;font-weight:900;'>세상이 기회를 주지 않는 것이 아니라, 우리가 손을 내미는 법을 잊어버린 것입니다.</span><br/><br/>\n이것이 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>가 존재하는 이유입니다.<br/>\n당신을 고치기 위해서도, 항상 \"힘내라\"고 말하기 위해서도 아닙니다.<br/>\n당신이 천천히 자신을 다시 세울 수 있는 공간, 그릇을 주고 싶었습니다.<br/>\n상실 속에서도 목소리를 낼 수 있고, 혼란 속에서도 누군가가 당신을 받아줄 수 있는 곳.<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>는 단순한 기술 제품이 아닙니다.<br/>\n제 인생의 가장 밑바닥에서 끌어올린 불씨입니다.<br/>\n이 불씨가 당신과 더 많은 사람들에게 등불이 되길 바랍니다.<br/><br/>\n<span style='color:#614425;font-weight:900;'>당신이 누구든, 어떤 경험을 했든, 어디에서 왔든,<br/>여기서는 모든 가면을 내려놓을 수 있습니다.</span><br/>\n우리는 믿습니다——<br/>\n<span style='color:#e4572e;font-weight:900;'>\"부서진 사람도 강해질 수 있고, 아주 다정해질 수도 있습니다.\"</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다.</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>발기인: Ben<br/>2025년 5월 21일</div>"},th:{title:"เราเป็นใคร",subtitle:"🧬 Restarter™｜เราเป็นใคร",story:`${"ทุกคนสมควรได้รับจุดเริ่มต้นใหม่"}\nคุณอาจมาจากความสูญเสียครั้งใหญ่ หรือกำลังเดินอยู่บนเส้นทางที่โดดเดี่ยว\nในโลกที่เต็มไปด้วยป้ายและข้อมูล เรารู้ว่าบางความรู้สึกไม่ได้แค่พูดว่า "สู้ๆ" แล้วจะดีขึ้น\n\nRestarter™ คือแพลตฟอร์ม AI สำหรับผู้ที่เคยหลงจังหวะชีวิต\nเราไม่สอนให้คุณเข้มแข็ง ไม่บอกให้คุณคิดบวก\nเราแค่ให้พื้นที่ที่คุณจะได้หายใจ พูดความจริง และเลือกใหม่อีกครั้ง\n\nที่นี่ไม่มีการตัดสินจากสังคม มีแต่คนที่เคยเจ็บปวดมาก่อน ใช้เทคโนโลยีสร้างการอยู่ร่วมกัน\nผ่าน AI ทุกบทสนทนา ทุกอารมณ์ จะมีคนรับฟังเสมอ`,quote:"“เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่”",restart:"Restarter™ คือจุดเริ่มต้นใหม่ในการนิยามตัวเองของคุณ\nRestarter™ ต้องการทำงานร่วมกับสาขาต่างๆ เพื่อสร้างสภาพแวดล้อมทางสังคมที่ดีขึ้น",founder:"คำจากผู้ก่อตั้ง",founderStory:"ฉันเคยสูญเสียอิสรภาพสิบปี<br/>\nไม่ใช่การเดินทางหรือการบำเพ็ญตน แต่เป็นสิบปีที่ถูกกฎหมายและโชคชะตากักขังไว้<br/>\nในห้องเล็ก ๆ กับผู้คนที่สวมชุดเหมือนกัน วันเวลาช่วงแรกเหมือนฝันยาว ๆ สุดท้ายแม้แต่ฝันก็ไม่มี ฉันคิดว่าชีวิตคงถูกกำหนดไว้แล้ว<br/><br/>\nวันที่ออกมา ท้องฟ้าสีเทาจนแสบตา ฉันยิ้มออกมาแต่ในใจว่างเปล่า<br/>\nสังคมไม่ได้รอคุณ ครอบครัวไม่รู้จะรับมืออย่างไร เพื่อน ๆ ก็ทักทายด้วยความห่างเหิน<br/>\nหลายครั้งฉันไม่กล้ามองตาแคชเชียร์ เพราะ<span style='color:#e4572e;font-weight:700;'>ฉันลืมไปแล้วว่าต้องเป็น \"คนธรรมดา\" อย่างไร</span><br/><br/>\nฉันถามตัวเองเสมอว่า:<br/>\n<span style='color:#614425;font-weight:900;'>ฉันยังมีโอกาสเริ่มต้นใหม่อีกไหม?</span><br/><br/>\nต่อมาฉันจึงเข้าใจ——<br/>\n<span style='color:#e4572e;font-weight:900;'>ไม่ใช่โลกที่ไม่ให้โอกาส แต่เราเองที่ลืมวิธีเอื้อมมือคว้า</span><br/><br/>\nนี่คือเหตุผลที่ <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> มีอยู่<br/>\nไม่ใช่เพื่อซ่อมคุณ ไม่ใช่เพื่อบอกให้ \"สู้ ๆ\"<br/>\nแต่เพื่อให้คุณมีพื้นที่ค่อย ๆ สร้างตัวเองขึ้นใหม่<br/>\nให้คุณได้เปล่งเสียงในความสูญเสีย และมีใครสักคนรับฟังในความสับสน<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> ไม่ใช่แค่เทคโนโลยี<br/>\nแต่เป็นประกายไฟที่ฉันหยิบขึ้นมาจากก้นบึ้งของชีวิต<br/>\nหวังว่าจะเป็นแสงสว่างให้คุณและอีกหลาย ๆ คน<br/><br/>\n<span style='color:#614425;font-weight:900;'>ไม่ว่าคุณจะเป็นใคร ผ่านอะไรมาก็ตาม มาจากที่ไหน—<br/>ที่นี่คุณสามารถถอดหน้ากากเหล่านั้นได้อย่างกล้าหาญ</span><br/>\nเพราะเราเชื่อว่า——<br/>\n<span style='color:#e4572e;font-weight:900;'>\"คนที่เคยแตกสลาย ไม่เพียงแต่จะแข็งแกร่ง แต่ยังอ่อนโยนได้ด้วย\"</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>ผู้ก่อตั้ง: Ben<br/>21 พฤษภาคม 2025</div>"},vi:{title:"Chúng tôi là ai",subtitle:"🧬 Restarter™｜Chúng tôi là ai",story:`${"Mỗi người đều xứng đáng có một khởi đầu mới."}\nBạn có thể đến từ một cú sốc lớn, hoặc đang đi trên con đường cô đơn\nTrong thế giới bị chi phối bởi nhãn mác và dữ liệu, chúng tôi biết—có những cảm xúc không thể giải quyết chỉ bằng một câu "Cố lên"\n\nRestarter™ là nền tảng AI đồng hành dành cho những người từng mất nhịp sống\nChúng tôi không dạy bạn cách mạnh mẽ, không bảo bạn phải tích cực\nChúng tôi chỉ mang đến một không gian để bạn được thở, được nói thật, được chọn lại\n\nỞ đây không có phán xét xã hội, chỉ có những người từng đau đớn dùng công nghệ để đồng hành\nThông qua AI, mọi cuộc trò chuyện, mọi cảm xúc đều có người lắng nghe`,quote:"“Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại”",restart:"Restarter™ là điểm khởi đầu mới để bạn định nghĩa lại chính mình\nRestarter™ sẵn sàng hợp tác với các lĩnh vực khác nhau để tạo ra môi trường xã hội tốt đẹp hơn",founder:"Lời người sáng lập",founderStory:"Tôi đã từng mất tự do mười năm<br/>\nKhông phải là đi du lịch hay tu hành, mà là mười năm bị pháp luật và số phận giam giữ<br/>\nTrong một căn phòng nhỏ với những người cùng mặc đồng phục, ban đầu những ngày tháng như một giấc mơ dài, sau đó ngay cả mơ cũng không còn. Tôi nghĩ đời mình đã bị định nghĩa như thế.<br/><br/>\nNgày ra ngoài, bầu trời xám xịt chói mắt. Tôi mỉm cười bước ra, nhưng trong lòng trống rỗng.<br/>\nMặt trận không chờ bạn, gia đình không biết đối diện ra sao, bạn bè hỏi thăm cũng đầy khoảng cách.<br/>\nNhiều lần tôi không dám nhìn thẳng vào mắt thu ngân, vì <span style='color:#e4572e;font-weight:700;'>tôi đã quên cách làm \"người bình thường\"</span>.<br/><br/>\nTôi luôn tự hỏi:<br/>\n<span style='color:#614425;font-weight:900;'>Liệu tôi còn cơ hội để bắt đầu lại không?</span><br/><br/>\nSau này tôi mới hiểu——<br/>\n<span style='color:#e4572e;font-weight:900;'>Không phải thế giới không cho cơ hội, mà là chúng ta quên cách với lấy nó.</span><br/><br/>\nĐó là lý do <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> tồn tại<br/>\nKhông phải để sửa chữa bạn, không phải để luôn nói \"cố lên\"<br/>\nmà là để cho bạn một không gian, một nơi để từ từ xây dựng lại chính mình<br/>\nĐể bạn có thể cất tiếng nói trong nỗi mất mát, và có người lắng nghe giữa hỗn loạn<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> không chỉ là sản phẩm công nghệ<br/>\nmà là tia lửa tôi mang lên từ tận đáy cuộc đời mình<br/>\nTôi hy vọng nó sẽ thắp sáng cho bạn, và cho nhiều người khác<br/><br/>\n<span style='color:#614425;font-weight:900;'>Dù bạn là ai, đã trải qua điều gì, đến từ đâu—<br/>ở đây bạn có thể mạnh dạn bỏ đi mọi lớp vỏ bọc</span><br/>\nBởi vì chúng tôi tin rằng——<br/>\n<span style='color:#e4572e;font-weight:900;'>\"Những người từng vỡ vụn không chỉ mạnh mẽ mà còn rất dịu dàng.\"</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Người sáng lập: Ben<br/>21/05/2025</div>"},ms:{title:"Siapa Kami",subtitle:"🧬 Restarter™｜Siapa Kami",story:`${"Setiap orang layak mendapat permulaan semula."}\nAnda mungkin datang dari kejatuhan besar, atau sedang berjalan di jalan yang sunyi\nDalam dunia yang dikuasai label dan data, kami tahu—ada perasaan yang tidak dapat diselesaikan hanya dengan "semangat"\n\nRestarter™ ialah platform AI teman untuk mereka yang pernah kehilangan rentak hidup\nKami tidak mengajar anda menjadi kuat, tidak menyuruh anda sentiasa positif\nKami hanya menyediakan ruang untuk anda bernafas, berkata benar, dan memilih semula\n\nDi sini tiada penghakiman masyarakat, hanya mereka yang pernah sakit menggunakan teknologi untuk menemani\nMelalui AI, setiap perbualan, setiap emosi, sentiasa ada yang mendengar`,quote:"“Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula”",restart:"Restarter™ ialah permulaan baru untuk anda mentakrifkan diri sendiri\nRestarter™ lebih bersedia untuk bekerjasama dengan pelbagai bidang untuk mewujudkan persekitaran sosial yang lebih baik",founder:"Kata Pengasas",founderStory:"Saya pernah kehilangan kebebasan selama sepuluh tahun<br/>\nBukan melancong atau bertapa, tetapi sepuluh tahun dikurung oleh undang-undang dan takdir<br/>\nDalam bilik kecil bersama mereka yang berpakaian seragam sama, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>\nDie exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>\nSocietas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>\nSaepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo \"homo communis\" essem</span>.<br/><br/>\nMe semper interrogabam:<br/>\n<span style='color:#614425;font-weight:900;'>Adakah saya masih berpeluang untuk bermula semula?</span><br/><br/>\nAkhirnya saya faham——<br/>\n<span style='color:#e4572e;font-weight:900;'>Bukan dunia tidak memberi peluang, tetapi kita yang lupa cara untuk menggapainya.</span><br/><br/>\nItulah sebabnya <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> wujud<br/>\nBukan untuk membaiki anda, bukan untuk sentiasa berkata \"semangat\"<br/>\ntetapi untuk memberi anda ruang, satu wadah untuk perlahan-lahan membina semula diri<br/>\nAgar anda boleh bersuara dalam kehilangan, dan ada yang menyambut anda dalam kekacauan<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> bukan sekadar produk teknologi<br/>\ntetapi percikan api yang saya bawa dari dasar hidup saya<br/>\nSaya harap ia dapat menerangi anda, dan ramai lagi<br/><br/>\n<span style='color:#614425;font-weight:900;'>Siapa pun anda, apa pun yang anda lalui, dari mana pun anda datang—<br/>di sini anda boleh berani melepaskan semua topeng itu</span><br/>\nKerana kami percaya——<br/>\n<span style='color:#e4572e;font-weight:900;'>\"Orang yang pernah hancur bukan sahaja boleh menjadi kuat, tetapi juga sangat lembut.\"</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Pengasas: Ben<br/>21 Mei 2025</div>"},la:{title:"Quis sumus",subtitle:"🧬 Restarter™｜Quis sumus",story:`${"Omnis novum initium meretur."}\nForsitan ex gravi casu veneris, aut solus iter facias\nIn mundo titulis et notitiis imperato, scimus—sunt animi motus quos "bene age" solvere non potest\n\nRestarter™ est suggestum AI comitans iis qui cursum vitae amiserunt\nNon docemus quomodo fortis fias, nec dicimus te semper positivum esse\nPraebemus tantum spatium ut respirare possis, vera loqui, iterum eligere\n\nHic iudicium societatis non est, sed ii qui olim doluerunt technologia utuntur ad comitatum\nPer AI, omnis sermo, omnis affectus, ab aliquo auditur`,quote:"“Non te reficimus, sed tecum iterum incipimus”",restart:"Restarter™ initium novum est ad te ipsum denuo definiendum\nRestarter™ magis paratus est cum variis campis cooperari ad meliorem ambitum socialem creandum",founder:"Verba Conditoris",founderStory:"Decem annos libertatem amisi<br/>\nNon iter aut meditatio erat, sed decem anni lege et fato inclusi<br/>\nIn cella parva cum aliis eiusdem vestis, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>\nDie exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>\nSocietas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>\nSaepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo \"homo communis\" essem</span>.<br/><br/>\nMe semper interrogabam:<br/>\n<span style='color:#614425;font-weight:900;'>Num adhuc mihi occasio est iterum incipere?</span><br/><br/>\nPostea intellexi——<br/>\n<span style='color:#e4572e;font-weight:900;'>Non est quod mundus occasiones non praebeat, sed quod obliti sumus quomodo eas arripere.</span><br/><br/>\nHoc est cur <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> existat<br/>\nNon ut te reficiamus, non ut semper dicamus \"bene age\"<br/>\nsed ut tibi spatium demus, vas in quo te paulatim reficere possis<br/>\nUt in amissione tua loqui possis, et aliquis in confusione te excipiat<br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> non solum productum technologicum est<br/>\nsed scintilla quam ex imis vitae meae attuli<br/>\nSpero eam tibi et multis aliis lucem afferre<br/><br/>\n<span style='color:#614425;font-weight:900;'>Quisquis es, quidquid expertus es, undeque venis—<br/>hic audacter omnes personas deponere potes</span><br/>\nQuia credimus——<br/>\n<span style='color:#e4572e;font-weight:900;'>\"Qui fracti sunt, non solum fortes esse possunt, sed etiam valde mites.\"</span><br/><br/>\n<span style='color:#6B5BFF;font-weight:900;'>Non te reficimus, sed tecum iterum incipimus</span><br/>\n<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Conditor: Ben<br/>21 Maii 2025</div>"}},gI={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"돌아가기",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redi"};function fI(){const[t,n]=e.useState(localStorage.getItem("lang")||"zh-TW");e.useEffect(()=>{const e=()=>n(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),e.useEffect(()=>{const e=setInterval(()=>{const e=localStorage.getItem("lang")||"zh-TW";e!==t&&n(e)},300);return()=>clearInterval(e)},[t]);const i=mI[t],r=le();return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #b7cfff 0%, #e0e7ff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 0 0"},children:[f.jsx("button",{onClick:()=>r("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"2.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:12,padding:"10px 28px",fontWeight:900,fontSize:20,cursor:"pointer",boxShadow:"0 2px 8px #0001",letterSpacing:1},children:gI[t]||gI["zh-TW"]}),f.jsxs("div",{style:{maxWidth:680,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:48},children:[f.jsx("h1",{style:{fontSize:36,fontWeight:900,color:"#6B5BFF",marginBottom:12},children:i.subtitle}),f.jsx("div",{style:{fontSize:20,color:"#232946",fontWeight:700,marginBottom:24,whiteSpace:"pre-line"},children:i.story}),f.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,margin:"24px 0 8px 0",textAlign:"center"},children:i.quote}),f.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:700,marginBottom:32,textAlign:"center",whiteSpace:"pre-line"},children:i.restart}),f.jsx("h2",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:8},children:i.founder}),f.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:500,whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:i.founderStory}})]}),f.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>r("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"zh-TW"===t?"隱私權政策":"zh-CN"===t?"隐私政策":"en"===t?"Privacy Policy":"ja"===t?"プライバシーポリシー":"ko"===t?"개인정보 처리방침":"th"===t?"นโยบายความเป็นส่วนตัว":"vi"===t?"Chính sách bảo mật":"ms"===t?"Dasar Privasi":"Consilium de Privata"}),f.jsx("span",{onClick:()=>r("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"zh-TW"===t?"條款/聲明":"zh-CN"===t?"条款/声明":"en"===t?"Terms/Statement":"ja"===t?"規約/声明":"ko"===t?"약관/성명":"th"===t?"ข้อกำหนด/แถลงการณ์":"vi"===t?"Điều khoản/Tuyên bố":"ms"===t?"Terma/Pernyataan":"Termini/Declaratio"}),f.jsx("span",{onClick:()=>r("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"zh-TW"===t?"資料刪除說明":"zh-CN"===t?"数据删除说明":"en"===t?"Data Deletion":"ja"===t?"データ削除について":"ko"===t?"데이터 삭제 안내":"th"===t?"คำอธิบายการลบข้อมูล":"vi"===t?"Giải thích xóa dữ liệu":"ms"===t?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),f.jsx("span",{onClick:()=>r("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"zh-TW"===t?"🧬 Restarter™｜我們是誰":"zh-CN"===t?"🧬 Restarter™｜我们是谁":"en"===t?"🧬 Restarter™｜Who We Are":"ja"===t?"🧬 Restarter™｜私たちについて":"ko"===t?"🧬 Restarter™｜우리는 누구인가":"th"===t?"🧬 Restarter™｜เราเป็นใคร":"vi"===t?"🧬 Restarter™｜Chúng tôi là ai":"ms"===t?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("span",{onClick:()=>r("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"zh-TW"===t?"💬 意見箱｜我們想聽你說":"zh-CN"===t?"💬 意见箱｜我们想听你说":"en"===t?"💬 Feedback Box｜We Want to Hear From You":"ja"===t?"💬 ご意見箱｜私たちはあなたの声を聞きたい":"ko"===t?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":"th"===t?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":"vi"===t?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":"ms"===t?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const xI={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"数据删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보 처리방침",terms:"약관/성명",deletion:"데이터 삭제 안내"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/แถลงการณ์",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Pernyataan",deletion:"Penjelasan Penghapusan Data"},la:{privacy:"Consilium de Privata",terms:"Termini/Declaratio",deletion:"Explicatio Deletionis Datae"}},yI={"zh-TW":"🧬 Restarter™｜我們是誰","zh-CN":"🧬 Restarter™｜我们是谁",en:"🧬 Restarter™｜Who We Are",ja:"🧬 Restarter™｜私たちについて",ko:"🧬 Restarter™｜우리는 누구인가",th:"🧬 Restarter™｜เราเป็นใคร",vi:"🧬 Restarter™｜Chúng tôi là ai",ms:"🧬 Restarter™｜Siapa Kami",la:"🧬 Restarter™｜Quis sumus"},bI={"zh-TW":"💬 意見箱｜我們想聽你說","zh-CN":"💬 意见箱｜我们想听你说",en:"💬 Feedback｜We Want to Hear You",ja:"💬 ご意見箱｜あなたの声を聞かせて",ko:"💬 피드백｜여러분의 의견을 듣고 싶어요",th:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",vi:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",ms:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",la:"💬 Arca Consilii｜Te audire volumus"},vI=()=>{const{lang:t}=mw(),n=oe(),i=le(),r=xI[t]||xI["zh-TW"],[a,o]=e.useState(20),s="/feedback"===n.pathname,l="/"===n.pathname||"/home"===n.pathname;return e.useEffect(()=>{o(s?20:l?24:20)},[t,s,l]),l&&"undefined"!=typeof window&&window.innerWidth>768?null:f.jsxs("footer",{style:{width:"100%",margin:"0 auto",marginTop:0,background:l?"rgba(255,255,255,0.95)":"rgba(255,255,255,0.92)",borderRadius:l?16:0,padding:l?"16px":"8px 0",boxShadow:l?"0 2px 12px #6B5BFF22":"0 -2px 8px #0001",borderTop:l?"none":"1px solid #eee",position:s?"fixed":l?"relative":"static",bottom:s?0:"auto",top:s?"auto":l?`${a}px`:"auto",zIndex:10,transition:s?"none":l?"top 0.3s ease":"none"},children:[f.jsxs("div",{style:{width:"100%",maxWidth:800,margin:"0 auto",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:l?20:40,flexWrap:"wrap",padding:l?"0":"0 20px"},children:[f.jsx("span",{onClick:()=>i("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:r.privacy}),f.jsx("span",{onClick:()=>i("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:r.terms}),f.jsx("span",{onClick:()=>i("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:r.deletion}),f.jsx("span",{onClick:()=>i("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:yI[t]||yI["zh-TW"]}),f.jsx("span",{onClick:()=>i("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:bI[t]||bI["zh-TW"]})]}),f.jsx("style",{children:"\n        @media (max-width: 768px) {\n          footer {\n            padding: 4px 16px 24px 16px !important;\n            marginTop: 0 !important;\n            position: relative !important;\n            bottom: auto !important;\n            top: auto !important;\n          }\n          footer > div {\n            gap: 12px !important;\n            flex-direction: row !important;\n            justify-content: flex-start !important;\n            flex-wrap: wrap !important;\n            padding-left: 20px !important;\n          }\n          footer > div > a {\n            padding: 4px 6px !important;\n            fontSize: 12px !important;\n          }\n        }\n        @media (min-width: 700px) {\n          footer {\n            padding: 8px !important;\n          }\n          footer > div {\n            flex-direction: row !important;\n            gap: 40px !important;\n            justify-content: center !important;\n            flex-wrap: wrap !important;\n          }\n          footer > div > a {\n            padding: 4px 8px !important;\n          }\n        }\n      "})]})},kI={"zh-TW":["💡 你希望多一個什麼功能？","💬 有沒有讓你感動，或失望的使用時刻？","🔧 你覺得哪裡還不夠順、不夠暖、不夠真？","今天我想說...","如果我能改一件事，我會..."],"zh-CN":["💡 你希望多一个什么功能？","💬 有没有让你感动，或失望的使用时刻？","🔧 你觉得哪里还不够顺、不够暖、不够真？","今天我想说...","如果我能改一件事，我会..."],en:["💡 What feature do you wish for?","💬 Any moment that moved or disappointed you?","🔧 Where could we be smoother, warmer, or more real?","Today I want to say...","If I could change one thing, I would..."],ja:["💡 どんな機能が欲しいですか？","💬 感動した、またはがっかりした瞬間はありますか？","🔧 どこがもっとスムーズで、温かく、リアルになれると思いますか？","今日はこう言いたい...","もし一つ変えられるなら、私は..."],ko:["💡 어떤 기능이 더 있었으면 하나요?","💬 감동하거나 실망했던 순간이 있나요?","🔧 어디가 더 부드럽고, 따뜻하고, 진실해질 수 있을까요?","오늘 나는 이렇게 말하고 싶어요...","만약 한 가지를 바꿀 수 있다면, 나는..."],th:["💡 คุณอยากได้ฟีเจอร์อะไรเพิ่ม?","💬 มีช่วงเวลาไหนที่คุณประทับใจหรือผิดหวังไหม?","🔧 ตรงไหนที่คุณคิดว่ายังไม่ลื่นไหล ไม่อบอุ่น หรือไม่จริงใจ?","วันนี้ฉันอยากพูดว่า...","ถ้าฉันเปลี่ยนอะไรได้สักอย่าง ฉันจะ..."],vi:["💡 Bạn muốn có thêm tính năng gì?","💬 Có khoảnh khắc nào khiến bạn cảm động hoặc thất vọng không?","🔧 Bạn nghĩ chỗ nào chưa đủ mượt, chưa đủ ấm, chưa đủ thật?","Hôm nay tôi muốn nói...","Nếu tôi có thể thay đổi một điều, tôi sẽ..."],ms:["💡 Apa ciri yang anda inginkan?","💬 Ada detik yang menyentuh atau mengecewakan anda?","🔧 Di mana yang anda rasa belum cukup lancar, hangat, atau benar?","Hari ini saya ingin berkata...","Jika saya boleh ubah satu perkara, saya akan..."],la:["💡 Quam rem novam optas?","💬 Estne momentum quod te movit aut destituit?","🔧 Ubi putas nondum satis lenem, calidum, verum esse?","Hodie dicere volo...","Si unum mutare possem, id facerem..."]},wI={"zh-TW":{title:"💬 意見箱｜我們想聽你說",submit:"送出",success:"我們聽見你了，感謝你願意說出來。",subtitle:"你的建議，可能會成為下一版的靈魂！"},"zh-CN":{title:"💬 意见箱｜我们想听你说",submit:"提交",success:"我们听见你了，感谢你愿意说出来。",subtitle:"你的建议，可能会成为下一个版本的灵魂！"},en:{title:"💬 Feedback｜We Want to Hear You",submit:"Send",success:"We hear you. Thank you for sharing your thoughts.",subtitle:"Your suggestion could be the soul of our next update!"},ja:{title:"💬 ご意見箱｜あなたの声を聞かせて",submit:"送信",success:"あなたの声が届きました。伝えてくれてありがとう。",subtitle:"あなたの提案が次のアップデートの魂になるかも！"},ko:{title:"💬 의견함｜당신의 이야기를 듣고 싶어요",submit:"보내기",success:"당신의 목소리를 들었습니다. 말해줘서 고마워요.",subtitle:"당신의 제안이 다음 업데이트의 영혼이 될 수 있어요!"},th:{title:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",submit:"ส่ง",success:"เราได้รับข้อความของคุณแล้ว ขอบคุณที่แบ่งปันความคิดของคุณ",subtitle:"ข้อเสนอของคุณอาจเป็นหัวใจของอัปเดตถัดไป!"},vi:{title:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",submit:"Gửi",success:"Chúng tôi đã nghe bạn. Cảm ơn bạn đã chia sẻ.",subtitle:"Góp ý của bạn có thể là linh hồn của bản cập nhật tiếp theo!"},ms:{title:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",submit:"Hantar",success:"Kami telah mendengar anda. Terima kasih kerana berkongsi.",subtitle:"Cadangan anda mungkin menjadi jiwa kemas kini kami yang seterusnya!"},la:{title:"💬 Arca Consilii｜Te audire volumus",submit:"Mitte",success:"Te audivimus. Gratias quod communicasti.",subtitle:"Consilium tuum animam versionis proximæ efficere potest!"}};function jI(){const t=le(),n=Fv(),[i,r]=e.useState(""),[a,o]=e.useState(!1),[s,l]=e.useState(!1),[c,d]=e.useState(""),[u,h]=e.useState("zh-TW"),[p,m]=e.useState(0),g=wI[u]||wI["zh-TW"];e.useEffect(()=>{const e=()=>h(localStorage.getItem("lang")||"zh-TW");return e(),window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),e.useEffect(()=>{const e=setInterval(()=>{m(e=>(e+1)%kI[u].length)},3e3);return()=>clearInterval(e)},[u]);return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 120px 0"},children:[f.jsx("button",{onClick:()=>t("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回"}),f.jsxs("div",{style:{maxWidth:520,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:64,display:"flex",flexDirection:"column",alignItems:"center"},children:[f.jsx("h1",{style:{fontSize:32,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:g.title}),f.jsx("div",{style:{fontSize:18,color:"#614425",fontWeight:700,marginBottom:18,textAlign:"center"},children:g.subtitle}),a?f.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,marginTop:32,textAlign:"center",minHeight:80},children:g.success}):f.jsxs(f.Fragment,{children:[f.jsx("textarea",{value:i,onChange:e=>r(e.target.value),placeholder:kI[u][p],style:{width:"100%",minHeight:160,fontSize:20,border:"none",outline:"none",resize:"vertical",background:"#f7f8fa",borderRadius:12,padding:18,marginBottom:18,boxShadow:"0 2px 8px #6B5BFF11"}}),c&&f.jsx("div",{style:{color:"#ff4d4f",fontSize:14,marginBottom:12,textAlign:"center"},children:c}),f.jsx("button",{onClick:async()=>{if(i.trim()){l(!0),d("");try{const e=n.currentUser,t=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:i.trim(),userEmail:(null==e?void 0:e.email)||"",userNickname:(null==e?void 0:e.displayName)||"匿名",userLang:u})}),a=await t.json();t.ok?(o(!0),r("")):d(a.error||"提交失敗，請稍後再試")}catch(e){d("網路錯誤，請稍後再試")}finally{l(!1)}}},style:{background:s?"#ccc":"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"12px 32px",fontWeight:900,fontSize:20,cursor:s?"not-allowed":"pointer",boxShadow:"0 2px 8px #6B5BFF33",marginTop:8},disabled:!i.trim()||s,children:s?"送出中...":g.submit})]})]}),f.jsx(vI,{})]})}const SI=()=>{const[t,n]=e.useState([]),[i,r]=e.useState(!0),[a,o]=e.useState(""),[s,l]=e.useState(""),[c,d]=e.useState(!1),u=async()=>{try{const e=await YS.get(`/api/admin-feedback?adminKey=${s}`);n(e.data.feedbacks),r(!1)}catch(e){o("取得意見列表失敗"),r(!1)}},h=()=>{"restarter_admin_2024"===s?(d(!0),u()):o("管理員密碼錯誤")};return c?f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:f.jsx("div",{className:"max-w-6xl mx-auto",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"意見管理系統"}),f.jsxs("div",{className:"space-x-4",children:[f.jsx("button",{onClick:u,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"重新整理"}),f.jsx("button",{onClick:async()=>{try{const e=await YS.post("/api/admin-feedback/export",{adminKey:s});alert(`意見已匯出，共 ${e.data.totalExported} 條`)}catch(e){alert("匯出失敗")}},className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors",children:"匯出意見"})]})]}),i?f.jsxs("div",{className:"text-center py-8",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-gray-600",children:"載入中..."})]}):a?f.jsx("div",{className:"text-center py-8",children:f.jsx("p",{className:"text-red-500",children:a})}):f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["共 ",t.length," 條意見"]}),t.map(e=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-gray-800",children:e.userNickname||"匿名用戶"}),f.jsx("p",{className:"text-sm text-gray-500",children:e.userEmail||"未提供 Email"})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("span",{className:"text-xs text-gray-500",children:e.timestamp}),f.jsx("div",{className:"mt-1",children:f.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("local"===e.source?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:"local"===e.source?"本地儲存":"Firebase"})})]})]}),f.jsx("div",{className:"bg-gray-50 rounded-md p-3 mb-3",children:f.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:e.content})}),f.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[f.jsxs("span",{children:["語言: ",e.userLang]}),f.jsxs("span",{children:["狀態: ",e.status]})]}),e.adminNotes&&f.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-md",children:f.jsxs("p",{className:"text-sm text-blue-800",children:[f.jsx("strong",{children:"管理員備註:"})," ",e.adminNotes]})})]},e.id)),0===t.length&&f.jsx("div",{className:"text-center py-8 text-gray-500",children:"目前沒有意見"})]})]})})}):f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center",children:f.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[f.jsx("h1",{className:"text-2xl font-bold text-center mb-6 text-gray-800",children:"管理員登入"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理員密碼"}),f.jsx("input",{type:"password",value:s,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"輸入管理員密碼"})]}),f.jsx("button",{onClick:h,className:"w-full bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 transition-colors",children:"登入"}),a&&f.jsx("p",{className:"text-red-500 text-sm text-center",children:a})]})]})})},TI={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function CI(){const t=le(),n=Fv(),i=n.currentUser,r=localStorage.getItem("lang")||"zh-TW";e.useEffect(()=>{i||t("/register",{replace:!0})},[i,t]);const[a,o]=e.useState((null==i?void 0:i.displayName)||""),[s]=e.useState((null==i?void 0:i.email)||""),[l,c]=e.useState((null==i?void 0:i.photoURL)||""),[d,u]=e.useState(""),[h,p]=e.useState(""),[m,g]=e.useState(""),[x,y]=e.useState(""),[b,v]=e.useState(""),[k,w]=e.useState(""),[j,S]=e.useState(""),[T,C]=e.useState(""),[I,B]=e.useState(!1);e.useEffect(()=>{let e=!1;const i=async()=>{e||(e=!0,await bb(n),t("/register?needProfile=1",{replace:!0}))},r=e=>{e.preventDefault(),e.returnValue="",i()},a=e=>{var t;null==(t=null==e?void 0:e.preventDefault)||t.call(e),i(),window.history.pushState(null,"","/CompleteProfile")};return window.addEventListener("beforeunload",r),window.addEventListener("popstate",a),window.history.pushState(null,"","/CompleteProfile"),()=>{window.removeEventListener("beforeunload",r),window.removeEventListener("popstate",a)}},[n,t]);return e.useEffect(()=>{(async()=>{if(null==i?void 0:i.uid){const e=await vT(()=>Promise.resolve().then(()=>hx),void 0).then(e=>e.getDoc(e.doc(cw,"users",i.uid)));e.exists()&&e.data().completed&&(await bb(n),t("/register",{replace:!0}))}})()},[i,n,t]),f.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f7f7fa",position:"relative"},children:[f.jsxs("button",{onClick:()=>t("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",TI[r]||"返回"]}),f.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),C(""),a&&d&&h&&x&&b&&k&&j){B(!0);try{await Mf(hg(cw,"users",i.uid),{nickname:a,email:s,avatarUrl:l,gender:d,country:h,region:m,age:x,interest:b,eventType:k,improvement:j,completed:!0,updatedAt:new Date}),B(!1),t("/",{replace:!0})}catch(n){C(n.message),B(!1)}}else C("請填寫所有欄位")},style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0001",width:360,position:"relative"},children:[f.jsx("button",{type:"button",onClick:async()=>{await bb(n),t("/register?needProfile=1",{replace:!0})},style:{position:"absolute",top:16,right:16,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer"},children:"×"}),f.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"補充個人資料"}),T&&f.jsx("div",{style:{color:"red",marginBottom:12},children:T}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"暱稱："}),f.jsx("input",{value:a,onChange:e=>o(e.target.value),required:!0,style:{width:"100%"}})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"電子郵件："}),f.jsx("input",{value:s,disabled:!0,style:{width:"100%",background:"#eee"}})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"頭像網址："}),f.jsx("input",{value:l,onChange:e=>c(e.target.value),style:{width:"100%"}})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"性別："}),f.jsxs("select",{value:d,onChange:e=>u(e.target.value),required:!0,style:{width:"100%"},children:[f.jsx("option",{value:"",children:"請選擇"}),f.jsx("option",{value:"male",children:"男"}),f.jsx("option",{value:"female",children:"女"})]})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"國家/地區："}),f.jsxs("select",{value:h,onChange:e=>p(e.target.value),required:!0,style:{width:"100%"},children:[f.jsx("option",{value:"",children:"請選擇"}),(BT["zh-TW"]||[]).map(e=>f.jsx("option",{value:e,children:e},e))]})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"城市："}),f.jsx("input",{value:m,onChange:e=>g(e.target.value),style:{width:"100%"}})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"年齡："}),f.jsxs("select",{value:x,onChange:e=>y(e.target.value),required:!0,style:{width:"100%"},children:[f.jsx("option",{value:"",children:"請選擇"}),FT.map(e=>f.jsx("option",{value:e,children:e},e))]})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"興趣："}),f.jsxs("select",{value:b,onChange:e=>v(e.target.value),required:!0,style:{width:"100%"},children:[f.jsx("option",{value:"",children:"請選擇"}),(IT["zh-TW"]||[]).map(e=>f.jsx("option",{value:e,children:e},e))]})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"事件類別："}),f.jsxs("select",{value:k,onChange:e=>w(e.target.value),required:!0,style:{width:"100%"},children:[f.jsx("option",{value:"",children:"請選擇"}),(RT||[]).map(e=>f.jsx("option",{value:e,children:e},e))]})]}),f.jsxs("div",{style:{marginBottom:12},children:[f.jsx("label",{children:"想改善什麼："}),f.jsx("input",{value:j,onChange:e=>S(e.target.value),required:!0,style:{width:"100%"}})]}),f.jsx("button",{type:"submit",disabled:I,style:{width:"100%",padding:10,fontWeight:700,fontSize:18,background:"#4caf50",color:"#fff",border:"none",borderRadius:8},children:I?"儲存中...":"完成"})]})]})}const II={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"},BI={"zh-TW":f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ App 隱私權政策"}),f.jsx("p",{children:"本應用程式由 Restarter™ 團隊開發，致力於保護您的個人資料與隱私權。本政策說明我們如何收集、使用、儲存、保護及分享您的個人資料，並說明您對於個人資料的權利。"}),f.jsx("h2",{children:"一、我們收集的資料"}),f.jsxs("ul",{children:[f.jsx("li",{children:"電子郵件地址（Email）"}),f.jsx("li",{children:"使用者名稱/暱稱"}),f.jsx("li",{children:"頭像（如有上傳）"}),f.jsx("li",{children:"性別、年齡、國家/地區、城市（如用戶自願填寫）"}),f.jsx("li",{children:"興趣、經歷事件、個人描述等自願填寫的資料"}),f.jsx("li",{children:"登入紀錄、操作紀錄（僅用於安全與服務優化）"})]}),f.jsx("h2",{children:"二、資料用途"}),f.jsxs("ul",{children:[f.jsx("li",{children:"用於身份驗證、帳號管理與個人化服務"}),f.jsx("li",{children:"用於社群互動、配對、任務、花園等功能"}),f.jsx("li",{children:"用於服務安全、錯誤偵測與防止濫用"}),f.jsx("li",{children:"用於統計分析與產品優化（僅以匿名方式）"}),f.jsx("li",{children:"不會將您的個人資料出售、出租或未經授權分享給第三方"})]}),f.jsx("h2",{children:"三、第三方服務"}),f.jsxs("p",{children:["本應用程式使用 Google Firebase 作為後端服務平台，Firebase 可能會根據其 ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隱私政策"})," 處理技術資料（如裝置資訊、IP、操作紀錄等）。"]}),f.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方帳號登入，僅會取得必要的公開資訊（如 email、暱稱、頭像），不會取得您的密碼。"}),f.jsx("h2",{children:"四、Cookie 與追蹤技術"}),f.jsx("p",{children:"本應用程式可能使用 Cookie 或類似技術以提升用戶體驗與安全性。您可於瀏覽器設定中管理 Cookie 偏好。"}),f.jsx("h2",{children:"五、資料儲存與保護"}),f.jsxs("ul",{children:[f.jsx("li",{children:"所有個人資料均儲存於 Google Firebase 雲端，並採用業界標準的加密與安全措施。"}),f.jsx("li",{children:"僅授權人員可存取您的個人資料，且僅限於服務維護與法規要求。"})]}),f.jsx("h2",{children:"六、您的權利"}),f.jsxs("ul",{children:[f.jsx("li",{children:"您有權查詢、更正、下載或刪除您的個人資料。"}),f.jsx("li",{children:"您可隨時於 App 內或來信要求刪除帳號與所有資料，我們將於 3-5 個工作天內完成。"}),f.jsxs("li",{children:["聯絡信箱：",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"七、政策變更"}),f.jsx("p",{children:"如本政策有重大變更，將於 App 內公告並更新本頁內容。"})]}),"zh-CN":f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ App 隐私政策"}),f.jsx("p",{children:"本应用程序由 Restarter™ 团队开发，致力于保护您的个人资料与隐私权。本政策说明我们如何收集、使用、存储、保护及分享您的个人资料，并说明您对于个人资料的权利。"}),f.jsx("h2",{children:"一、我们收集的资料"}),f.jsxs("ul",{children:[f.jsx("li",{children:"电子邮件地址（Email）"}),f.jsx("li",{children:"用户名/昵称"}),f.jsx("li",{children:"头像（如有上传）"}),f.jsx("li",{children:"性别、年龄、国家/地区、城市（如用户自愿填写）"}),f.jsx("li",{children:"兴趣、经历事件、个人描述等自愿填写的资料"}),f.jsx("li",{children:"登录记录、操作记录（仅用于安全与服务优化）"})]}),f.jsx("h2",{children:"二、资料用途"}),f.jsxs("ul",{children:[f.jsx("li",{children:"用于身份验证、账号管理与个性化服务"}),f.jsx("li",{children:"用于社群互动、配对、任务、花园等功能"}),f.jsx("li",{children:"用于服务安全、错误检测与防止滥用"}),f.jsx("li",{children:"用于统计分析与产品优化（仅以匿名方式）"}),f.jsx("li",{children:"不会将您的个人资料出售、出租或未经授权分享给第三方"})]}),f.jsx("h2",{children:"三、第三方服务"}),f.jsxs("p",{children:["本应用程序使用 Google Firebase 作为后端服务平台，Firebase 可能会根据其 ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隐私政策"})," 处理技术资料（如设备信息、IP、操作记录等）。"]}),f.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方账号登录，仅会取得必要的公开信息（如 email、昵称、头像），不会取得您的密码。"}),f.jsx("h2",{children:"四、Cookie 与追踪技术"}),f.jsx("p",{children:"本应用程序可能使用 Cookie 或类似技术以提升用户体验与安全性。您可于浏览器设置中管理 Cookie 偏好。"}),f.jsx("h2",{children:"五、资料存储与保护"}),f.jsxs("ul",{children:[f.jsx("li",{children:"所有个人资料均存储于 Google Firebase 云端，并采用业界标准的加密与安全措施。"}),f.jsx("li",{children:"仅授权人员可存取您的个人资料，且仅限于服务维护与法规要求。"})]}),f.jsx("h2",{children:"六、您的权利"}),f.jsxs("ul",{children:[f.jsx("li",{children:"您有权查询、更正、下载或删除您的个人资料。"}),f.jsx("li",{children:"您可随时于 App 内或来信要求删除账号与所有资料，我们将于 3-5 个工作天内完成。"}),f.jsxs("li",{children:["联系邮箱：",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"七、政策变更"}),f.jsx("p",{children:"如本政策有重大变更，将于 App 内公告并更新本页内容。"})]}),en:f.jsxs("div",{children:[f.jsx("h1",{children:"Privacy Policy for Restarter™ App"}),f.jsx("p",{children:"Restarter™ is committed to protecting your privacy. This policy explains how we collect, use, store, and protect your personal information, and your rights regarding your data."}),f.jsx("h2",{children:"1. Information We Collect"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Email address"}),f.jsx("li",{children:"Username/Nickname"}),f.jsx("li",{children:"Avatar (if uploaded)"}),f.jsx("li",{children:"Gender, age, country/region, city (if provided)"}),f.jsx("li",{children:"Interests, life events, personal description (if provided)"}),f.jsx("li",{children:"Login and activity logs (for security and service improvement)"})]}),f.jsx("h2",{children:"2. Purpose of Collection"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Authentication, account management, and personalized services"}),f.jsx("li",{children:"Community interaction, matching, missions, garden features"}),f.jsx("li",{children:"Service security, error detection, and abuse prevention"}),f.jsx("li",{children:"Statistical analysis and product improvement (anonymized)"}),f.jsx("li",{children:"We do not sell, rent, or share your personal data with third parties without your consent"})]}),f.jsx("h2",{children:"3. Third-Party Services"}),f.jsxs("p",{children:["This app uses Google Firebase as its backend. Firebase may process technical data according to its ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," (e.g., device info, IP, activity logs)."]}),f.jsx("p",{children:"If you log in via Google, Apple, or Facebook, we only access your public info (email, nickname, avatar), never your password."}),f.jsx("h2",{children:"4. Cookies and Tracking"}),f.jsx("p",{children:"We may use cookies or similar technologies to enhance your experience and security. You can manage cookie preferences in your browser settings."}),f.jsx("h2",{children:"5. Data Storage and Protection"}),f.jsxs("ul",{children:[f.jsx("li",{children:"All personal data is stored on Google Firebase cloud with industry-standard encryption and security."}),f.jsx("li",{children:"Only authorized personnel can access your data, solely for service maintenance or legal compliance."})]}),f.jsx("h2",{children:"6. Your Rights"}),f.jsxs("ul",{children:[f.jsx("li",{children:"You have the right to access, correct, download, or delete your personal data."}),f.jsx("li",{children:"You may request account/data deletion at any time via the app or by email. We will process your request within 3-5 business days."}),f.jsxs("li",{children:["Contact: ",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"7. Policy Updates"}),f.jsx("p",{children:"We will notify users of major changes to this policy via in-app announcements and update this page accordingly."})]}),ja:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ アプリ プライバシーポリシー"}),f.jsx("p",{children:"本アプリはRestarter™チームによって開発され、ユーザーの個人情報とプライバシーの保護に努めています。本ポリシーは、どのように個人情報を収集・利用・保存・保護・共有するか、またユーザーの権利について説明します。"}),f.jsx("h2",{children:"1. 収集する情報"}),f.jsxs("ul",{children:[f.jsx("li",{children:"メールアドレス"}),f.jsx("li",{children:"ユーザー名/ニックネーム"}),f.jsx("li",{children:"アバター（アップロードした場合）"}),f.jsx("li",{children:"性別、年齢、国/地域、都市（任意）"}),f.jsx("li",{children:"興味、経験イベント、自己紹介（任意）"}),f.jsx("li",{children:"ログイン・操作履歴（セキュリティ・サービス向上のため）"})]}),f.jsx("h2",{children:"2. 利用目的"}),f.jsxs("ul",{children:[f.jsx("li",{children:"認証、アカウント管理、パーソナライズサービス"}),f.jsx("li",{children:"コミュニティ交流、マッチング、ミッション、ガーデン機能"}),f.jsx("li",{children:"サービスの安全性、エラー検出、不正防止"}),f.jsx("li",{children:"統計分析・製品改善（匿名化）"}),f.jsx("li",{children:"同意なく第三者に個人情報を販売・共有しません"})]}),f.jsx("h2",{children:"3. サードパーティサービス"}),f.jsxs("p",{children:["本アプリはGoogle Firebaseをバックエンドとして使用しています。Firebaseは ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"プライバシーポリシー"})," に従い技術情報（デバイス情報、IP、操作履歴など）を処理する場合があります。"]}),f.jsx("p",{children:"Google、Apple、Facebook等でログインした場合、公開情報（メール、ニックネーム、アバター）のみ取得し、パスワードは取得しません。"}),f.jsx("h2",{children:"4. Cookieとトラッキング技術"}),f.jsx("p",{children:"本アプリはユーザー体験と安全性向上のため コッキー または類似技術を使用する場合があります。ブラウザ設定でCookieの管理が可能です。"}),f.jsx("h2",{children:"5. データ保存と保護"}),f.jsxs("ul",{children:[f.jsx("li",{children:"全ての個人情報はGoogle Firebaseクラウドに保存され、業界標準の暗号化とセキュリティで保護されます。"}),f.jsx("li",{children:"認可された担当者のみがサービス保守や法令遵守のためにアクセス可能です。"})]}),f.jsx("h2",{children:"6. ユーザーの権利"}),f.jsxs("ul",{children:[f.jsx("li",{children:"個人情報の照会、訂正、ダウンロード、削除が可能です。"}),f.jsx("li",{children:"アプリ内またはメールでいつでも削除依頼ができ、3～5営業日以内に対応します。"}),f.jsxs("li",{children:["連絡先：",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"7. ポリシーの変更"}),f.jsx("p",{children:"本ポリシーに重大な変更がある場合、アプリ内で告知し本ページを更新します。"})]}),ko:f.jsxs("div",{children:[f.jsx("h1",{children:"Restarter™ 앱 개인정보처리방침"}),f.jsx("p",{children:"본 앱은 Restarter™ 팀이 개발하였으며, 사용자의 개인정보와 프라이버시 보호에 최선을 다합니다. 본 정책은 개인정보의 수집, 이용, 저장, 보호, 공유 방법과 사용자의 권리에 대해 설명합니다."}),f.jsx("h2",{children:"1. 수집하는 정보"}),f.jsxs("ul",{children:[f.jsx("li",{children:"이메일 주소"}),f.jsx("li",{children:"사용자명/닉네임"}),f.jsx("li",{children:"아바타(업로드한 경우)"}),f.jsx("li",{children:"성별, 나이, 국가/지역, 도시(선택사항)"}),f.jsx("li",{children:"관심사, 경험 이벤트, 자기소개(선택사항)"}),f.jsx("li",{children:"로그인 및 활동 기록(보안 및 서비스 개선 목적)"})]}),f.jsx("h2",{children:"2. 수집 목적"}),f.jsxs("ul",{children:[f.jsx("li",{children:"인증, 계정 관리, 개인화 서비스"}),f.jsx("li",{children:"커뮤니티 상호작용, 매칭, 미션, 가든 기능"}),f.jsx("li",{children:"서비스 보안, 오류 탐지, 오용 방지"}),f.jsx("li",{children:"통계 분석 및 제품 개선(익명화)"}),f.jsx("li",{children:"동의 없이 제3자에게 개인정보를 판매, 임대, 공유하지 않습니다"})]}),f.jsx("h2",{children:"3. 제3자 서비스"}),f.jsxs("p",{children:["본 앱은 Google Firebase를 백엔드로 사용합니다. Firebase는 ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"개인정보처리방침"}),"에 따라 기술 정보를 처리할 수 있습니다(예: 기기 정보, IP, 활동 기록 등)."]}),f.jsx("p",{children:"Google, Apple, Facebook 등으로 로그인 시 공개 정보(이메일, 닉네임, 아바타)만 수집하며, 비밀번호는 수집하지 않습니다."}),f.jsx("h2",{children:"4. 쿠키 및 추적 기술"}),f.jsx("p",{children:"본 앱은 사용자 경험 및 보안 향상을 위해 쿠키 또는 유사 기술을 사용할 수 있습니다. 브라우저 설정에서 쿠키 환경설정이 가능합니다."}),f.jsx("h2",{children:"5. 데이터 저장 및 보호"}),f.jsxs("ul",{children:[f.jsx("li",{children:"모든 개인정보는 Google Firebase 클라우드에 저장되며, 업계 표준 암호화 및 보안이 적용됩니다."}),f.jsx("li",{children:"서비스 유지보수 및 법적 요구에 한해 인가된 인원만 접근할 수 있습니다."})]}),f.jsx("h2",{children:"6. 사용자의 권리"}),f.jsxs("ul",{children:[f.jsx("li",{children:"개인정보의 조회, 수정, 다운로드, 삭제가 가능합니다."}),f.jsx("li",{children:"앱 내 또는 이메일로 언제든 삭제 요청이 가능하며, 3~5영업일 이내에 처리됩니다."}),f.jsxs("li",{children:["연락처: ",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"7. 정책 변경"}),f.jsx("p",{children:"정책에 중대한 변경이 있을 경우 앱 내 공지 및 본 페이지를 업데이트합니다."})]}),th:f.jsxs("div",{children:[f.jsx("h1",{children:"นโยบายความเป็นส่วนตัวของแอป Restarter™"}),f.jsx("p",{children:"แอปนี้พัฒนาโดยทีมงาน Restarter™ มุ่งมั่นในการปกป้องข้อมูลส่วนบุคคลและความเป็นส่วนตัวของคุณ นโยบายนี้อธิบายวิธีการเก็บรวบรวม ใช้ จัดเก็บ ปกป้อง และแบ่งปันข้อมูลส่วนบุคคลของคุณ รวมถึงสิทธิ์ของคุณ"}),f.jsx("h2",{children:"1. ข้อมูลที่เราเก็บรวบรวม"}),f.jsxs("ul",{children:[f.jsx("li",{children:"ที่อยู่อีเมล"}),f.jsx("li",{children:"ชื่อผู้ใช้/ชื่อเล่น"}),f.jsx("li",{children:"อวาตาร์ (ถ้าอัปโหลด)"}),f.jsx("li",{children:"เพศ อายุ ประเทศ/ภูมิภาค เมือง (ถ้าระบุ)"}),f.jsx("li",{children:"ความสนใจ เหตุการณ์ในชีวิต คำอธิบายส่วนตัว (ถ้าระบุ)"}),f.jsx("li",{children:"บันทึกการเข้าสู่ระบบและกิจกรรม (เพื่อความปลอดภัยและปรับปรุงบริการ)"})]}),f.jsx("h2",{children:"2. วัตถุประสงค์ของการเก็บข้อมูล"}),f.jsxs("ul",{children:[f.jsx("li",{children:"การยืนยันตัวตน การจัดการบัญชี และบริการส่วนบุคคล"}),f.jsx("li",{children:"การมีปฏิสัมพันธ์ในชุมชน การจับคู่ ภารกิจ ฟีเจอร์สวน"}),f.jsx("li",{children:"ความปลอดภัยของบริการ การตรวจจับข้อผิดพลาด และป้องกันการละเมิด"}),f.jsx("li",{children:"การวิเคราะห์สถิติและปรับปรุงผลิตภัณฑ์ (แบบไม่ระบุตัวตน)"}),f.jsx("li",{children:"จะไม่ขาย ให้เช่า หรือแบ่งปันข้อมูลส่วนบุคคลของคุณกับบุคคลที่สามโดยไม่ได้รับความยินยอม"})]}),f.jsx("h2",{children:"3. บริการของบุคคลที่สาม"}),f.jsxs("p",{children:["แอปนี้ใช้ Google Firebase เป็นแบ็กเอนด์ Firebase อาจประมวลผลข้อมูลทางเทคนิคตาม ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"นโยบายความเป็นส่วนตัว"})," (เช่น ข้อมูลอุปกรณ์ IP บันทึกกิจกรรม)"]}),f.jsx("p",{children:"หากคุณเข้าสู่ระบบผ่าน Google, Apple หรือ Facebook เราจะเข้าถึงเฉพาะข้อมูลสาธารณะ (อีเมล ชื่อเล่น อวาตาร์) ไม่เคยเข้าถึงรหัสผ่านของคุณ"}),f.jsx("h2",{children:"4. คุกกี้และการติดตาม"}),f.jsx("p",{children:"เราอาจใช้คุกกี้หรือเทคโนโลยีที่คล้ายกันเพื่อปรับปรุงประสบการณ์และความปลอดภัยของคุณ คุณสามารถจัดการคุกกี้ได้ในเบราว์เซอร์ของคุณ"}),f.jsx("h2",{children:"5. การจัดเก็บและปกป้องข้อมูล"}),f.jsxs("ul",{children:[f.jsx("li",{children:"ข้อมูลส่วนบุคคลทั้งหมดจะถูกจัดเก็บบนคลาวด์ Google Firebase ด้วยการเข้ารหัสและความปลอดภัยตามมาตรฐานอุตสาหกรรม"}),f.jsx("li",{children:"มีเพียงบุคลากรที่ได้รับอนุญาตเท่านั้นที่สามารถเข้าถึงข้อมูลของคุณเพื่อการบำรุงรักษาบริการหรือปฏิบัติตามกฎหมาย"})]}),f.jsx("h2",{children:"6. สิทธิ์ของคุณ"}),f.jsxs("ul",{children:[f.jsx("li",{children:"คุณมีสิทธิ์เข้าถึง แก้ไข ดาวน์โหลด หรือขอลบข้อมูลส่วนบุคคลของคุณ"}),f.jsx("li",{children:"คุณสามารถขอลบบัญชี/ข้อมูลได้ตลอดเวลาผ่านแอปหรืออีเมล เราจะดำเนินการภายใน 3-5 วันทำการ"}),f.jsxs("li",{children:["ติดต่อ: ",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"7. การอัปเดตนโยบาย"}),f.jsx("p",{children:"เราจะแจ้งให้ผู้ใช้ทราบถึงการเปลี่ยนแปลงที่สำคัญของนโยบายนี้ผ่านการประกาศในแอปและอัปเดตหน้านี้ตามความเหมาะสม"})]}),vi:f.jsxs("div",{children:[f.jsx("h1",{children:"Chính sách bảo mật cho ứng dụng Restarter™"}),f.jsx("p",{children:"Restarter™ cam kết bảo vệ quyền riêng tư của bạn. Chính sách này giải thích cách chúng tôi thu thập, sử dụng, lưu trữ và bảo vệ thông tin cá nhân của bạn, cũng như quyền của bạn đối với dữ liệu đó."}),f.jsx("h2",{children:"1. Thông tin chúng tôi thu thập"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Địa chỉ email"}),f.jsx("li",{children:"Tên người dùng/Biệt danh"}),f.jsx("li",{children:"Ảnh đại diện (nếu tải lên)"}),f.jsx("li",{children:"Giới tính, tuổi, quốc gia/khu vực, thành phố (nếu cung cấp)"}),f.jsx("li",{children:"Sở thích, sự kiện cuộc sống, mô tả cá nhân (nếu cung cấp)"}),f.jsx("li",{children:"Nhật ký đăng nhập và hoạt động (để bảo mật và cải thiện dịch vụ)"})]}),f.jsx("h2",{children:"2. Mục đích thu thập"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Xác thực, quản lý tài khoản và dịch vụ cá nhân hóa"}),f.jsx("li",{children:"Tương tác cộng đồng, ghép đôi, nhiệm vụ, tính năng vườn"}),f.jsx("li",{children:"Bảo mật dịch vụ, phát hiện lỗi và ngăn chặn lạm dụng"}),f.jsx("li",{children:"Phân tích thống kê và cải tiến sản phẩm (ẩn danh)"}),f.jsx("li",{children:"Chúng tôi không bán, cho thuê hoặc chia sẻ dữ liệu cá nhân của bạn với bên thứ ba nếu không có sự đồng ý của bạn"})]}),f.jsx("h2",{children:"3. Dịch vụ của bên thứ ba"}),f.jsxs("p",{children:["Ứng dụng này sử dụng Google Firebase làm backend. Firebase có thể xử lý dữ liệu kỹ thuật theo ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Chính sách bảo mật"})," (ví dụ: thông tin thiết bị, IP, nhật ký hoạt động)."]}),f.jsx("p",{children:"Nếu bạn đăng nhập qua Google, Apple hoặc Facebook, chúng tôi chỉ truy cập thông tin công khai của bạn (email, biệt danh, ảnh đại diện), không bao giờ truy cập mật khẩu của bạn."}),f.jsx("h2",{children:"4. Cookie và theo dõi"}),f.jsx("p",{children:"Chúng tôi có thể sử dụng cookie hoặc các công nghệ tương tự để nâng cao trải nghiệm và bảo mật của bạn. Bạn có thể quản lý cookie trong cài đặt trình duyệt của mình."}),f.jsx("h2",{children:"5. Lưu trữ và bảo vệ dữ liệu"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Tất cả dữ liệu cá nhân được lưu trữ trên đám mây Google Firebase với mã hóa và bảo mật tiêu chuẩn ngành."}),f.jsx("li",{children:"Chỉ những nhân viên được ủy quyền mới có thể truy cập dữ liệu của bạn, chỉ để bảo trì dịch vụ hoặc tuân thủ pháp luật."})]}),f.jsx("h2",{children:"6. Quyền của bạn"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Bạn có quyền truy cập, chỉnh sửa, tải xuống hoặc xóa dữ liệu cá nhân của mình."}),f.jsx("li",{children:"Bạn có thể yêu cầu xóa tài khoản/dữ liệu bất cứ lúc nào qua ứng dụng hoặc email. Chúng tôi sẽ xử lý yêu cầu của bạn trong vòng 3-5 ngày làm việc."}),f.jsxs("li",{children:["Liên hệ: ",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"7. Cập nhật chính sách"}),f.jsx("p",{children:"Chúng tôi sẽ thông báo cho người dùng về những thay đổi lớn đối với chính sách này qua thông báo trong ứng dụng và cập nhật trang này cho phù hợp."})]}),ms:f.jsxs("div",{children:[f.jsx("h1",{children:"Dasar Privasi untuk Aplikasi Restarter™"}),f.jsx("p",{children:"Restarter™ komited untuk melindungi privasi anda. Polisi ini menerangkan bagaimana kami mengumpul, menggunakan, menyimpan dan melindungi maklumat peribadi anda, serta hak anda terhadap data tersebut."}),f.jsx("h2",{children:"1. Maklumat yang Kami Kumpul"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Alamat emel"}),f.jsx("li",{children:"Nama pengguna/Nama samaran"}),f.jsx("li",{children:"Avatar (jika dimuat naik)"}),f.jsx("li",{children:"Jantina, umur, negara/wilayah, bandar (jika diberikan)"}),f.jsx("li",{children:"Minat, peristiwa hidup, keterangan peribadi (jika diberikan)"}),f.jsx("li",{children:"Log masuk dan aktiviti (untuk keselamatan dan penambahbaikan perkhidmatan)"})]}),f.jsx("h2",{children:"2. Tujuan Pengumpulan"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Pengesahan, pengurusan akaun dan perkhidmatan peribadi"}),f.jsx("li",{children:"Interaksi komuniti, padanan, misi, ciri taman"}),f.jsx("li",{children:"Keselamatan perkhidmatan, pengesanan ralat dan pencegahan penyalahgunaan"}),f.jsx("li",{children:"Analisis statistik dan penambahbaikan produk (tanpa nama)"}),f.jsx("li",{children:"Kami tidak akan menjual, menyewa atau berkongsi data peribadi anda dengan pihak ketiga tanpa kebenaran anda"})]}),f.jsx("h2",{children:"3. Perkhidmatan Pihak Ketiga"}),f.jsxs("p",{children:["Aplikasi ini menggunakan Google Firebase sebagai backend. Firebase mungkin memproses data teknikal mengikut ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Dasar Privasi"})," (cth: maklumat peranti, IP, log aktiviti)."]}),f.jsx("p",{children:"Jika anda log masuk melalui Google, Apple atau Facebook, kami hanya mengakses maklumat awam anda (emel, nama samaran, avatar), tidak pernah kata laluan anda."}),f.jsx("h2",{children:"4. Kuki dan Penjejakan"}),f.jsx("p",{children:"Kami mungkin menggunakan kuki atau teknologi serupa untuk meningkatkan pengalaman dan keselamatan anda. Anda boleh mengurus pilihan kuki dalam tetapan pelayar anda."}),f.jsx("h2",{children:"5. Penyimpanan dan Perlindungan Data"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Semua data peribadi disimpan di awan Google Firebase dengan penyulitan dan keselamatan piawaian industri."}),f.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),f.jsx("h2",{children:"6. Hak Anda"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Anda berhak untuk mengakses, membetulkan, memuat turun atau memadam data peribadi anda."}),f.jsx("li",{children:"Anda boleh meminta pemadaman akaun/data pada bila-bila masa melalui aplikasi atau e-mel. Kami akan memproses permintaan anda dalam masa 3-5 hari bekerja."}),f.jsxs("li",{children:["Hubungi: ",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"7. Kemas Kini Polisi"}),f.jsx("p",{children:"Kami akan memaklumkan pengguna tentang perubahan besar pada polisi ini melalui pengumuman dalam aplikasi dan mengemas kini halaman ini dengan sewajarnya."})]}),la:f.jsxs("div",{children:[f.jsx("h1",{children:"Consilium Privacy pro Restarter™ App"}),f.jsx("p",{children:"Restarter™ ad tuendam tuam privacy studet. Haec consilia explicat quomodo notitias personales colligamus, utamur, condamus, tueamur, et iura tua de notitiis exponat."}),f.jsx("h2",{children:"1. Quae colligimus"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Inscriptionem electronicam"}),f.jsx("li",{children:"Nomen usoris/Sobriquet"}),f.jsx("li",{children:"Avatar (si sublatus)"}),f.jsx("li",{children:"Sexus, aetas, regio/natio, urbs (si praebetur)"}),f.jsx("li",{children:"Studia, eventus vitae, descriptio personalis (si praebetur)"}),f.jsx("li",{children:"Acta login et actio (ad securitatem et emendationem servitii)"})]}),f.jsx("h2",{children:"2. Propositum collectionis"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Authenticatio, administratio rationis, officia personalia"}),f.jsx("li",{children:"Communitas, paria, missiones, hortus"}),f.jsx("li",{children:"Securitas servitii, errorum detectio, abusus praeventio"}),f.jsx("li",{children:"Analysis statistica et emendatio producti (anonymizata)"}),f.jsx("li",{children:"Notitias tuas non vendimus, locamus, nec sine consensu communicamus"})]}),f.jsx("h2",{children:"3. Officia tertiarum partium"}),f.jsxs("p",{children:["Haec app utitur Google Firebase ut backend. Firebase potest notitias technicas tractare secundum ",f.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Consilium Privacy"})," (ex. info de machina, IP, acta actionum)."]}),f.jsx("p",{children:"Si per Google, Apple, Facebook ingredieris, solum publicas notitias tuas accedimus (email, sobriquet, avatar), numquam tesseram tuam."}),f.jsx("h2",{children:"4. Cookies et vestigatio"}),f.jsx("p",{children:"Possumus uti cookies aut similibus technologiis ad experientiam et securitatem tuam augendam. Praeferentias cookies in navigatoris tuis regere potes."}),f.jsx("h2",{children:"5. Reconditio et tutela notitiarum"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Omnes notitiae personales in Google Firebase nube servantur, cum encryptione et securitate industriae."}),f.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),f.jsx("h2",{children:"6. Iura tua"}),f.jsxs("ul",{children:[f.jsx("li",{children:"Ius habes accedere, corrigere, extrahere, aut delere notitias tuas personales."}),f.jsx("li",{children:"Potes petere deletionem rationis/datae quovis tempore per app vel email. Processum intra 3-5 dies negotiales perficimus."}),f.jsxs("li",{children:["Contactus: ",f.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),f.jsx("h2",{children:"7. Renovatio consilii"}),f.jsx("p",{children:"De mutationibus maioribus huius consilii usores per nuntios in app certiorem faciemus et hanc paginam proinde renovabimus."})]})};function RI(){const e=localStorage.getItem("lang")||"zh-TW",t=le();return f.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[f.jsxs("button",{onClick:()=>t("/",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",II[e]||"返回"]}),f.jsx("div",{style:{flex:"1 0 auto"},children:f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[BI[e]||BI["zh-TW"],f.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),f.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>t("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),f.jsx("span",{onClick:()=>t("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),f.jsx("span",{onClick:()=>t("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),f.jsx("span",{onClick:()=>t("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),f.jsx("span",{onClick:()=>t("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const AI={"zh-TW":f.jsxs("div",{children:[f.jsx("h1",{children:"資料刪除說明"}),f.jsx("p",{children:"若您希望刪除在 Restarter App 中儲存的個人資料，請來信至："}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"我們會在 3-5 個工作天內完成資料刪除作業。"})]}),"zh-CN":f.jsxs("div",{children:[f.jsx("h1",{children:"资料删除说明"}),f.jsx("p",{children:"如需删除在 Restarter App 中存储的个人资料，请发送邮件至："}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"我们将在 3-5 个工作日内完成资料删除。"})]}),en:f.jsxs("div",{children:[f.jsx("h1",{children:"Data Deletion Policy"}),f.jsx("p",{children:"If you wish to delete your personal data stored in the Restarter App, please contact:"}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"We will complete the deletion process within 3-5 business days."})]}),ja:f.jsxs("div",{children:[f.jsx("h1",{children:"データ削除のご案内"}),f.jsx("p",{children:"Restarterアプリに保存されている個人データの削除をご希望の場合は、以下までご連絡ください："}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"3～5営業日以内に削除手続きを完了します。"})]}),ko:f.jsxs("div",{children:[f.jsx("h1",{children:"데이터 삭제 안내"}),f.jsx("p",{children:"Restarter 앱에 저장된 개인 데이터를 삭제하려면 다음으로 문의해 주세요:"}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"3~5 영업일 이내에 삭제를 완료해 드립니다."})]}),th:f.jsxs("div",{children:[f.jsx("h1",{children:"นโยบายการลบข้อมูล"}),f.jsx("p",{children:"หากคุณต้องการลบข้อมูลส่วนบุคคลที่จัดเก็บในแอป Restarter กรุณาติดต่อ:"}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"เราจะดำเนินการลบข้อมูลภายใน 3-5 วันทำการ"})]}),vi:f.jsxs("div",{children:[f.jsx("h1",{children:"Chính sách xóa dữ liệu"}),f.jsx("p",{children:"Nếu bạn muốn xóa dữ liệu cá nhân được lưu trữ trong ứng dụng Restarter, vui lòng liên hệ:"}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"Chúng tôi sẽ hoàn tất việc xóa dữ liệu trong vòng 3-5 ngày làm việc."})]}),ms:f.jsxs("div",{children:[f.jsx("h1",{children:"Dasar Pemadaman Data"}),f.jsx("p",{children:"Jika anda ingin memadam data peribadi yang disimpan dalam Aplikasi Restarter, sila hubungi:"}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"Kami akan menyelesaikan proses pemadaman dalam masa 3-5 hari bekerja."})]}),la:f.jsxs("div",{children:[f.jsx("h1",{children:"Norma Deletionis Datae"}),f.jsx("p",{children:"Si vis delere data personalia in Restarter App reposita, quaeso contactum:"}),f.jsx("p",{children:f.jsx("strong",{children:"rbben521@gmail.com"})}),f.jsx("p",{children:"Processum deletionis intra 3-5 dies negotiales perficimus."})]})},FI={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function zI(){const e=localStorage.getItem("lang")||"zh-TW",t=le();return f.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[f.jsxs("button",{onClick:()=>t("/",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",FI[e]||"返回"]}),f.jsx("div",{style:{flex:"1 0 auto"},children:f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[AI[e]||AI["zh-TW"],f.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),f.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>t("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),f.jsx("span",{onClick:()=>t("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),f.jsx("span",{onClick:()=>t("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),f.jsx("span",{onClick:()=>t("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),f.jsx("span",{onClick:()=>t("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const EI={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},_I={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",sections:{provide:{title:"我可提供幫助 & 合作室",desc:"分享你的專長、資源或想合作的領域，讓更多人找到你。",btn:"我要提供"},need:{title:"我需要幫助 or 合作屋",desc:"說出你目前遇到的困難或想找合作夥伴，讓社群支援你。",btn:"我需要幫助"},supply:{title:"幫助 & 合作供應圈",desc:"瀏覽大家能提供的幫助與合作資源，主動聯繫彼此。",btn:"探索供應圈"},room:{title:"進入互助房",desc:"即時交流，互助成長",btn:"進入互助房"}},modals:{provide:{title:"我可以提供幫助 & 合作",subtitle:"在重啟路上，我的經歷和優勢也許可以幫上忙！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要幫助",subtitle:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},messages:{messageSent:"留言發送成功！",messageFailed:"留言發送失敗，請稍後再試",noMessages:"暫無留言",markRead:"標記已讀",delete:"刪除",confirmDelete:"你確定要刪除這條留言嗎？（一旦刪除將無法復原）",inboxTitle:"站內訊息",messageFrom:"給你的留言：",contactUser:"聯絡對方"},date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{sections:{provide:{title:"我可提供帮助 & 合作室",desc:"分享你的专长、资源或想合作的领域，让更多人找到你。",btn:"我要提供"},need:{title:"我需要帮助 or 合作屋",desc:"说出你目前遇到的困难或想找合作伙伴，让社群支援你。",btn:"我需要帮助"},supply:{title:"帮助 & 合作供应圈",desc:"浏览大家能提供的帮助与合作资源，主动联系彼此。",btn:"探索供应圈"},room:{title:"进入互助房",desc:"即时交流，互助成长",btn:"进入互助房"}},modals:{provide:{title:"我可以提供帮助 & 合作",subtitle:"在重启路上，我的经历和优势也许可以帮上忙！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我想优先帮助的对象（可复选）：",helpType:"我可以提供帮助形式：",statement:"我的特别声明（50字内）：",frequency:"我可帮助的频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要帮助",subtitle:"请描述你遇到的困难或需要协助的地方，让社群伙伴能更好帮助你！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我遇到的困难/需求（可复选）：",helpType:"希望获得协助形式：",statement:"补充说明（50字内）：",frequency:"希望获得协助频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},messages:{messageSent:"留言发送成功！",messageFailed:"留言发送失败，请稍后再试",noMessages:"暂无留言",markRead:"标记已读",delete:"删除",confirmDelete:"你确定要删除这条留言吗？（一旦删除将无法复原）",inboxTitle:"站内消息",messageFrom:"给你的留言：",contactUser:"联络对方"},date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{sections:{provide:{title:"I can provide help & cooperation room",desc:"Share your expertise, resources or areas you want to collaborate on, so more people can find you.",btn:"I want to provide"},need:{title:"I need help or cooperation house",desc:"Tell us about the difficulties you're currently facing or partners you want to find, so the community can support you.",btn:"I need help"},supply:{title:"Help & cooperation supply circle",desc:"Browse the help and cooperation resources everyone can provide, actively contact each other.",btn:"Explore supply circle"},room:{title:"Enter mutual aid room",desc:"Real-time communication, mutual growth",btn:"Enter mutual aid room"}},modals:{provide:{title:"I can provide help & cooperation",subtitle:"On the restart journey, my experience and advantages might be helpful!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"},need:{title:"I need help",subtitle:"Please describe the difficulties you're facing or areas where you need assistance, so community partners can better help you!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"}},options:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},messages:{messageSent:"Message sent successfully!",messageFailed:"Message sending failed, please try again later",noMessages:"No messages yet",markRead:"Mark as read",delete:"Delete",confirmDelete:"Are you sure you want to delete this message? (Once deleted, it cannot be restored)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User"},date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{sections:{provide:{title:"私は助けと協力の部屋を提供できます",desc:"あなたの専門知識、リソース、または協力したい分野を共有して、より多くの人にあなたを見つけてもらいましょう。",btn:"提供したい"},need:{title:"私は助けまたは協力の家が必要です",desc:"現在直面している困難や見つけたいパートナーについて教えてください。コミュニティがあなたをサポートできるようにします。",btn:"助けが必要です"},supply:{title:"助けと協力の供給サークル",desc:"みんなが提供できる助けと協力のリソースを閲覧し、積極的にお互いに連絡を取り合いましょう。",btn:"供給サークルを探索"},room:{title:"相互扶助の部屋に入る",desc:"リアルタイムコミュニケーション、相互成長",btn:"相互扶助の部屋に入る"}},modals:{provide:{title:"私は助けと協力を提供できます",subtitle:"再出発の道のりで、私の経験と強みがお役に立てるかもしれません！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"},need:{title:"助けが必要です",subtitle:"直面している困難や支援が必要な領域を説明してください。コミュニティのパートナーがより良くあなたを助けられるようにします！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"}},options:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},messages:{messageSent:"メッセージが正常に送信されました！",messageFailed:"メッセージの送信に失敗しました。後でもう一度お試しください",noMessages:"まだメッセージがありません",markRead:"既読にする",delete:"削除",confirmDelete:"このメッセージを削除してもよろしいですか？（削除すると復元できません）",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"日付",avatar:"アイコン",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{sections:{provide:{title:"나는 도움과 협력 방을 제공할 수 있습니다",desc:"당신의 전문 지식, 자원 또는 협력하고 싶은 분야를 공유하여 더 많은 사람들이 당신을 찾을 수 있도록 하세요.",btn:"제공하고 싶습니다"},need:{title:"나는 도움이나 협력 집이 필요합니다",desc:"현재 직면한 어려움이나 찾고 싶은 파트너에 대해 말씀해 주세요. 커뮤니티가 당신을 지원할 수 있도록 합니다.",btn:"도움이 필요합니다"},supply:{title:"도움과 협력 공급 서클",desc:"모든 사람이 제공할 수 있는 도움과 협력 자원을 둘러보고, 적극적으로 서로 연락하세요.",btn:"공급 서클 탐색"},room:{title:"상호 원조 방에 들어가기",desc:"실시간 소통, 상호 성장",btn:"상호 원조 방에 들어가기"}},modals:{provide:{title:"나는 도움과 협력을 제공할 수 있습니다",subtitle:"재시작 여정에서 제 경험과 장점이 도움이 될 수 있습니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"},need:{title:"도움이 필요합니다",subtitle:"당신이 직면한 어려움이나 도움이 필요한 분야를 설명해 주세요. 커뮤니티 파트너가 더 잘 당신을 도울 수 있도록 합니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"}},options:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},messages:{messageSent:"메시지가 성공적으로 전송되었습니다!",messageFailed:"메시지 전송에 실패했습니다. 나중에 다시 시도해 주세요",noMessages:"아직 메시지가 없습니다",markRead:"읽음 표시",delete:"삭제",confirmDelete:"이 메시지를 삭제하시겠습니까? (삭제하면 복원할 수 없습니다)",inboxTitle:"받은 메시지",messageFrom:"님이 보낸 메시지:",contactUser:"사용자에게 연락",backToHome:"홈으로 돌아가기"},date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{sections:{provide:{title:"Tôi có thể cung cấp phòng trợ giúp & hợp tác",desc:"Chia sẻ chuyên môn, tài nguyên hoặc lĩnh vực bạn muốn hợp tác, để nhiều người có thể tìm thấy bạn.",btn:"Tôi muốn cung cấp"},need:{title:"Tôi cần trợ giúp hoặc nhà hợp tác",desc:"Hãy nói về những khó khăn bạn đang gặp phải hoặc đối tác bạn muốn tìm, để cộng đồng có thể hỗ trợ bạn.",btn:"Tôi cần trợ giúp"},supply:{title:"Vòng tròn cung cấp trợ giúp & hợp tác",desc:"Duyệt qua các tài nguyên trợ giúp và hợp tác mà mọi người có thể cung cấp, chủ động liên lạc với nhau.",btn:"Khám phá vòng tròn cung cấp"},room:{title:"Vào phòng hỗ trợ lẫn nhau",desc:"Giao tiếp thời gian thực, cùng nhau phát triển",btn:"Vào phòng hỗ trợ lẫn nhau"}},modals:{provide:{title:"Tôi có thể cung cấp trợ giúp & hợp tác",subtitle:"Trên hành trình khởi động lại, kinh nghiệm và lợi thế của tôi có thể hữu ích!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"},need:{title:"Tôi cần trợ giúp",subtitle:"Vui lòng mô tả những khó khăn bạn đang gặp phải hoặc những lĩnh vực cần hỗ trợ, để các đối tác cộng đồng có thể giúp bạn tốt hơn!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"}},options:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},messages:{messageSent:"Tin nhắn đã được gửi thành công!",messageFailed:"Gửi tin nhắn thất bại, vui lòng thử lại sau",noMessages:"Chưa có tin nhắn",markRead:"Đánh dấu đã đọc",delete:"Xóa",confirmDelete:"Bạn có chắc chắn muốn xóa tin nhắn này không? (Một khi xóa sẽ không thể khôi phục)",inboxTitle:"Tin nhắn đến",messageFrom:" đã gửi tin nhắn cho bạn:",contactUser:"Liên hệ người dùng",backToHome:"Về trang chủ"},date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{sections:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและห้องความร่วมมือ",desc:"แบ่งปันความเชี่ยวชาญ ทรัพยากร หรือพื้นที่ที่คุณต้องการร่วมมือ เพื่อให้คนอื่นๆ หาคุณเจอ",btn:"ฉันต้องการให้"},need:{title:"ฉันต้องการความช่วยเหลือหรือบ้านความร่วมมือ",desc:"บอกเราเกี่ยวกับความยากลำบากที่คุณกำลังเผชิญหรือคู่ค้าที่คุณต้องการหา เพื่อให้ชุมชนสามารถสนับสนุนคุณได้",btn:"ฉันต้องการความช่วยเหลือ"},supply:{title:"วงกลมอุปทานความช่วยเหลือและความร่วมมือ",desc:"เรียกดูทรัพยากรความช่วยเหลือและความร่วมมือที่ทุกคนสามารถให้ได้ ติดต่อกันอย่างกระตือรือร้น",btn:"สำรวจวงกลมอุปทาน"},room:{title:"เข้าห้องช่วยเหลือซึ่งกันและกัน",desc:"การสื่อสารแบบเรียลไทม์ การเติบโตร่วมกัน",btn:"เข้าห้องช่วยเหลือซึ่งกันและกัน"}},modals:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและความร่วมมือ",subtitle:"ในการเดินทางเริ่มต้นใหม่ ประสบการณ์และข้อได้เปรียบของฉันอาจเป็นประโยชน์!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"},need:{title:"ฉันต้องการความช่วยเหลือ",subtitle:"กรุณาอธิบายความยากลำบากที่คุณกำลังเผชิญหรือพื้นที่ที่ต้องการความช่วยเหลือ เพื่อให้คู่ค้าชุมชนสามารถช่วยคุณได้ดีขึ้น!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"}},options:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},messages:{messageSent:"ส่งข้อความสำเร็จแล้ว!",messageFailed:"การส่งข้อความล้มเหลว กรุณาลองใหม่อีกครั้ง",noMessages:"ยังไม่มีข้อความ",markRead:"ทำเครื่องหมายว่าอ่านแล้ว",delete:"ลบ",confirmDelete:"คุณแน่ใจหรือไม่ที่จะลบข้อความนี้? (เมื่อลบแล้วจะไม่สามารถกู้คืนได้)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"วันที่",avatar:"รูปภาพ",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{sections:{provide:{title:"Saya boleh menyediakan bilik bantuan & kerjasama",desc:"Kongsi kepakaran, sumber atau bidang yang anda ingin bekerjasama, supaya lebih ramai orang dapat mencari anda.",btn:"Saya ingin menyediakan"},need:{title:"Saya memerlukan bantuan atau rumah kerjasama",desc:"Beritahu kami tentang kesukaran yang anda hadapi atau rakan kongsi yang anda ingin cari, supaya komuniti dapat menyokong anda.",btn:"Saya memerlukan bantuan"},supply:{title:"Bulatan bekalan bantuan & kerjasama",desc:"Semak imbas sumber bantuan dan kerjasama yang semua orang boleh sediakan, hubungi antara satu sama lain secara aktif.",btn:"Jelajah bulatan bekalan"},room:{title:"Masuk bilik bantuan bersama",desc:"Komunikasi masa nyata, pertumbuhan bersama",btn:"Masuk bilik bantuan bersama"}},modals:{provide:{title:"Saya boleh menyediakan bantuan & kerjasama",subtitle:"Dalam perjalanan memulakan semula, pengalaman dan kelebihan saya mungkin boleh membantu!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"},need:{title:"Saya memerlukan bantuan",subtitle:"Sila terangkan kesukaran yang anda hadapi atau bidang yang memerlukan bantuan, supaya rakan kongsi komuniti dapat membantu anda dengan lebih baik!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"}},options:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},messages:{messageSent:"Mesej berjaya dihantar!",messageFailed:"Penghantaran mesej gagal, sila cuba lagi kemudian",noMessages:"Tiada mesej lagi",markRead:"Tandakan sebagai dibaca",delete:"Padam",confirmDelete:"Adakah anda pasti mahu memadamkan mesej ini? (Sebaik sahaja dipadamkan, ia tidak dapat dipulihkan)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{sections:{provide:{title:"Possum praebere auxilium & cooperationis cubiculum",desc:"Partiri peritiam, opes vel regiones quas cooperari vis, ut plures te invenire possint.",btn:"Volo praebere"},need:{title:"Egeo auxilii vel cooperationis domus",desc:"Dic nobis de difficultatibus quas nunc patieris vel sociis quos quaeris, ut communitas te sustentare possit.",btn:"Egeo auxilii"},supply:{title:"Auxilii & cooperationis copiae circulus",desc:"Perlustra auxilii et cooperationis opes quas omnes praebere possunt, active inter se communicare.",btn:"Explora copiae circulum"},room:{title:"Intra mutuum auxilium cubiculum",desc:"Temporis realis communicatio, mutuus incrementum",btn:"Intra mutuum auxilium cubiculum"}},modals:{provide:{title:"Possum praebere auxilium & cooperationem",subtitle:"In itinere redintegrationis, mea experientia et commoda forsitan prodesse possunt!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"},need:{title:"Egeo auxilii",subtitle:"Quaeso describe difficultates quas patieris vel regiones quae auxilio indigent, ut socii communitatis te melius adiuvare possint!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"}},options:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]},messages:{messageSent:"Nuntius feliciter missus est!",messageFailed:"Missio nuntii defecit, quaeso postea denuo tenta",noMessages:"Nondum nuntii",markRead:"Nota ut lectum",delete:"Dele",confirmDelete:"Esne certus hunc nuntium delere velle? (Semel deletus, restitui non potest)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User",backToHome:"Back to Home"},date:"Dies",avatar:"Imago",name:"Nomen",gender:"Genus",age:"Aetas",country:"Patria"}},NI=e=>{const t={"zh-TW":{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},"zh-CN":{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},en:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},ja:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},ko:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},vi:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},th:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},ms:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},la:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]}};return t[e]||t["zh-TW"]};function PI({open:t,onClose:n,userInfo:i,onSubmit:r}){var a,o,s,l,c,d,u,h,p,m,g,x,y,b,v,k,w,j,S,T,C,I,B,R,A,F,z,E,_,N,P,D,W,M,L,O,q,U,H,V,K,$,G,Q,Y,J,X,Z,ee,te,ne,ie,re,ae,oe,se,ce;const de=le(),{lang:ue}=mw();e.useEffect(()=>{t&&window.innerWidth<=768&&window.history.pushState({modal:"provide"},"",window.location.pathname)},[t]);const he=NI(ue),[pe,me]=e.useState([]),[ge,fe]=e.useState(""),[xe,ye]=e.useState([]),[be,ve]=e.useState(""),[ke,we]=e.useState([]),[je,Se]=e.useState(""),[Te,Ce]=e.useState(he.helpType[0]),[Ie,Be]=e.useState(""),[Re,Ae]=e.useState(he.frequency[0]),[Fe,ze]=e.useState(""),[Ee,_e]=e.useState(!1),[Ne,Pe]=e.useState(!1),[De,We]=e.useState("");if(!t)return null;const Me=(e,t,n)=>{t(e.includes(n)?e.filter(e=>e!==n):[...e,n])};return f.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:f.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{await r({exp:pe,expOther:ge,adv:xe,advOther:be,target:ke,targetOther:je,helpType:Te,statement:Ie,freq:Re,freqOther:Fe})}catch(t){}},style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)","@media (max-width: 768px)":{maxHeight:"calc(100vh - 16px)",margin:"8px",width:"calc(100% - 16px)",minWidth:"auto"}},children:[f.jsx("button",{type:"button",onClick:()=>{n(),window.innerWidth<=768&&de("/HelpLab")},style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),f.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)",WebkitOverflowScrolling:"touch",scrollBehavior:"smooth",overscrollBehavior:"contain"},children:[f.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:(null==(s=null==(o=null==(a=_I[ue])?void 0:a.modals)?void 0:o.provide)?void 0:s.title)||"我可以提供幫助 & 合作"}),f.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:(null==(d=null==(c=null==(l=_I[ue])?void 0:l.modals)?void 0:c.provide)?void 0:d.subtitle)||"在重啟路上，我的經歷和優勢也許可以幫上忙！"}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[f.jsx("img",{src:i.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[f.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>_e(!0),children:i.nickname}),f.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${i.email}`),children:i.email}),f.jsxs("span",{style:{color:"#555",fontSize:14},children:[i.country,"｜",i.gender,"｜",i.age]})]})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:(null==(p=null==(h=null==(u=_I[ue])?void 0:u.modals)?void 0:h.provide)?void 0:p.experience)||"我的經歷（可複選）："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[he.experience.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"checkbox",checked:pe.includes(e),onChange:()=>Me(pe,me,e)}),e]},e)),f.jsx("input",{placeholder:(null==(x=null==(g=null==(m=_I[ue])?void 0:m.modals)?void 0:g.provide)?void 0:x.other)||"其他...",value:ge,onChange:e=>fe(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:(null==(v=null==(b=null==(y=_I[ue])?void 0:y.modals)?void 0:b.provide)?void 0:v.current)||"我的現狀(可複選)："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[he.advantage.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"checkbox",checked:xe.includes(e),onChange:()=>Me(xe,ye,e)}),e]},e)),f.jsx("input",{placeholder:(null==(j=null==(w=null==(k=_I[ue])?void 0:k.modals)?void 0:w.provide)?void 0:j.other)||"其他...",value:be,onChange:e=>ve(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:(null==(C=null==(T=null==(S=_I[ue])?void 0:S.modals)?void 0:T.provide)?void 0:C.target)||"我想優先幫助的對象（可複選）："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[he.target.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"checkbox",checked:ke.includes(e),onChange:()=>Me(ke,we,e)}),e]},e)),f.jsx("input",{placeholder:(null==(R=null==(B=null==(I=_I[ue])?void 0:I.modals)?void 0:B.provide)?void 0:R.other)||"其他...",value:je,onChange:e=>Se(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:(null==(z=null==(F=null==(A=_I[ue])?void 0:A.modals)?void 0:F.provide)?void 0:z.helpType)||"我可以提供幫助形式："}),f.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:he.helpType.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"radio",name:"helptype",checked:Te===e,onChange:()=>Ce(e)}),e]},e))}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:(null==(N=null==(_=null==(E=_I[ue])?void 0:E.modals)?void 0:_.provide)?void 0:N.statement)||"我的特別聲明（50字內）："}),f.jsx("input",{maxLength:50,value:Ie,onChange:e=>Be(e.target.value),placeholder:(null==(W=null==(D=null==(P=_I[ue])?void 0:P.modals)?void 0:D.provide)?void 0:W.enterPlaceholder)||"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),f.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[Ie.length,"/50"]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:(null==(O=null==(L=null==(M=_I[ue])?void 0:M.modals)?void 0:L.provide)?void 0:O.frequency)||"我可幫助的頻率："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[he.frequency.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[f.jsx("input",{type:"radio",name:"freq",checked:Re===e,onChange:()=>Ae(e)}),e]},e)),f.jsx("input",{placeholder:(null==(H=null==(U=null==(q=_I[ue])?void 0:q.modals)?void 0:U.provide)?void 0:H.other)||"其他...",value:Fe,onChange:e=>ze(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0",position:"relative"},children:[f.jsx("button",{type:"button",onClick:()=>{n(),window.innerWidth<=768&&de("/HelpLab")},style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px",userSelect:"none"},children:(null==($=null==(K=null==(V=_I[ue])?void 0:V.modals)?void 0:K.provide)?void 0:$.cancel)||"取消"}),f.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px",userSelect:"none"},children:(null==(Y=null==(Q=null==(G=_I[ue])?void 0:G.modals)?void 0:Q.provide)?void 0:Y.submit)||"送出"})]}),f.jsx("div",{style:{height:"120px",width:"100%",background:"transparent",flexShrink:0}})]}),Ee&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[f.jsx("button",{type:"button",onClick:()=>_e(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),f.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[(null==(Z=null==(X=null==(J=_I[ue])?void 0:J.modals)?void 0:X.provide)?void 0:Z.messageTo)||"留言給：",i.nickname]}),f.jsx("textarea",{value:De,onChange:e=>We(e.target.value),rows:3,maxLength:100,placeholder:(null==(ne=null==(te=null==(ee=_I[ue])?void 0:ee.modals)?void 0:te.provide)?void 0:ne.messagePlaceholder)||"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),f.jsx("button",{onClick:async()=>{_e(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:De,toUid:i.uid,toEmail:i.email,toNickname:i.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),Pe(!0),setTimeout(()=>Pe(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:(null==(ae=null==(re=null==(ie=_I[ue])?void 0:ie.modals)?void 0:re.provide)?void 0:ae.sendMessage)||"送出留言"})]})}),Ne&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:(null==(ce=null==(se=null==(oe=_I[ue])?void 0:oe.modals)?void 0:se.provide)?void 0:ce.messageSent)||"需求已成功送出！"})})]})})}function DI({open:t,onClose:n,userInfo:i,onSubmit:r,showMsgSent:a}){le();const{lang:o}=mw(),s=NI(o);e.useEffect(()=>{t&&window.innerWidth<=768&&window.history.pushState({modal:"need"},"",window.location.pathname)},[t]);const[l,c]=e.useState([]),[d,u]=e.useState(""),[h,p]=e.useState([]),[m,g]=e.useState(""),[x,y]=e.useState([]),[b,v]=e.useState(""),[k,w]=e.useState(s.helpType[0]),[j,S]=e.useState(""),[T,C]=e.useState(s.frequency[0]),[I,B]=e.useState(""),[R,A]=e.useState(!1),[F,z]=e.useState(""),[E,_]=e.useState(!1);if(!t)return null;const N=(e,t,n)=>{t(e.includes(n)?e.filter(e=>e!==n):[...e,n])};return f.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:f.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{await r({exp:l,expOther:d,adv:h,advOther:m,target:x,targetOther:b,helpType:k,statement:j,freq:T,freqOther:I})}catch(t){}},style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)","@media (max-width: 768px)":{maxHeight:"calc(100vh - 16px)",margin:"8px",width:"calc(100% - 16px)",minWidth:"auto"}},children:[f.jsx("button",{type:"button",onClick:n,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),f.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)",WebkitOverflowScrolling:"touch",scrollBehavior:"smooth",overscrollBehavior:"contain"},children:[f.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#ff4d4f",textAlign:"center",marginBottom:2},children:"我需要幫助"}),f.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！"}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[f.jsx("img",{src:i.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[f.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>A(!0),children:i.nickname}),f.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${i.email}`),children:i.email}),f.jsxs("span",{style:{color:"#555",fontSize:14},children:[i.country,"｜",i.gender,"｜",i.age]})]})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的經歷（可複選）："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[s.experience.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"checkbox",checked:l.includes(e),onChange:()=>N(l,c,e)}),e]},e)),f.jsx("input",{placeholder:"其他...",value:d,onChange:e=>u(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的現狀(可複選)："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[s.advantage.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"checkbox",checked:h.includes(e),onChange:()=>N(h,p,e)}),e]},e)),f.jsx("input",{placeholder:"其他...",value:m,onChange:e=>g(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我遇到的困難/需求（可複選）："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[s.target.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"checkbox",checked:x.includes(e),onChange:()=>N(x,y,e)}),e]},e)),f.jsx("input",{placeholder:"其他...",value:b,onChange:e=>v(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助形式："}),f.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:s.helpType.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[f.jsx("input",{type:"radio",name:"helptype",checked:k===e,onChange:()=>w(e)}),e]},e))}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"補充說明（50字內）："}),f.jsx("input",{maxLength:50,value:j,onChange:e=>S(e.target.value),placeholder:"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),f.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[j.length,"/50"]}),f.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助頻率："}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[s.frequency.map(e=>f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[f.jsx("input",{type:"radio",name:"freq",checked:T===e,onChange:()=>C(e)}),e]},e)),f.jsx("input",{placeholder:"其他...",value:I,onChange:e=>B(e.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),f.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0",position:"relative"},children:[f.jsx("button",{type:"button",onClick:n,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px",userSelect:"none"},children:"取消"}),f.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px",userSelect:"none"},children:"送出"})]}),f.jsx("div",{style:{height:"120px",width:"100%",background:"transparent",flexShrink:0}})]}),R&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[f.jsx("button",{type:"button",onClick:()=>A(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),f.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:["留言給：",i.nickname]}),f.jsx("textarea",{value:F,onChange:e=>z(e.target.value),rows:3,maxLength:100,placeholder:"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),f.jsx("button",{onClick:async()=>{A(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:F,toUid:i.uid,toEmail:i.email,toNickname:i.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),_(!0),setTimeout(()=>_(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"送出留言"})]})}),E&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:"需求已成功送出！"})})]})})}function WI(){var t,n,r,a,o,s,l,c;const{lang:d,setLang:u}=mw(),h=le(),p=(e=>{const t=_I[e]||_I["zh-TW"];return[{emoji:"🤝",title:t.sections.provide.title,desc:t.sections.provide.desc,btn:t.sections.provide.btn,color:"#e0f7fa"},{emoji:"🆘",title:t.sections.need.title,desc:t.sections.need.desc,btn:t.sections.need.btn,color:"#fff3e0"},{emoji:"🌐",title:t.sections.supply.title,desc:t.sections.supply.desc,btn:t.sections.supply.btn,color:"#e8f5e9"},{emoji:"🏠",title:t.sections.room.title,desc:t.sections.room.desc,btn:t.sections.room.btn,color:"#f3e5f5"}]})(d),[m,g]=e.useState(null),[x,y]=e.useState(!1),[b,v]=e.useState(!1),k=e.useRef(null),w=e.useRef(null),{isTestMode:j}=CB();e.useEffect(()=>{const e=yb(N,e=>{g(e)});return()=>e()},[]),e.useEffect(()=>{const e=e=>{window.innerWidth<=768&&h("/HelpLab")};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[h]),e.useEffect(()=>{const e=e=>{k.current&&!k.current.contains(e.target)&&y(!1),w.current&&!w.current.contains(e.target)&&v(!1)};return(x||b)&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[x,b]);const S=e=>{var t;const n={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",back:"返回",date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{title:"互相帮助&合作实验室",provide:"提供帮助",supply:"供应圈",need:"需要帮助",room:"互助房",intro:"在重启的路上，我们都需要彼此的支持。请选择你想要参与的方式：",introNeed:"如果你正在经历困难，请告诉我们，社群伙伴会主动协助你。",needBtn:"我需要帮助",rule:"※ 所有信息仅供社群内部交流使用，请尊重彼此隐私",msgTo:"留言给：",msgPlaceholder:"请输入留言...",msgSent:"留言发送成功！",backToHome:"返回首页",back:"返回",date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{title:"Mutual Help & Cooperation Laboratory",provide:"Provide Help",supply:"Supply Circle",need:"Need Help",room:"Mutual Aid Room",intro:"On the restart journey, we all need each other's support. Please choose how you want to participate:",introNeed:"If you are experiencing difficulties, please tell us, and community partners will actively assist you.",needBtn:"I Need Help",rule:"※ All information is for internal community communication only, please respect each other's privacy",msgTo:"Message to:",msgPlaceholder:"Please enter message...",msgSent:"Message sent successfully!",backToHome:"Back to Home",back:"Back",date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{title:"相互支援&協力実験室",provide:"支援を提供",supply:"供給サークル",need:"支援が必要",room:"相互扶助の部屋",intro:"再出発の道のりで、私たちは皆お互いのサポートが必要です。参加したい方法を選択してください：",introNeed:"困難を経験している場合は、お知らせください。コミュニティのパートナーが積極的にサポートします。",needBtn:"支援が必要です",rule:"※ すべての情報はコミュニティ内の交流のみに使用され、お互いのプライバシーを尊重してください",msgTo:"メッセージを送る：",msgPlaceholder:"メッセージを入力してください...",msgSent:"メッセージが正常に送信されました！",backToHome:"ホームへ戻る",back:"戻る",date:"日付",avatar:"アバター",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{title:"상호 도움&협력 실험실",provide:"도움 제공",supply:"공급 서클",need:"도움 필요",room:"상호 원조 방",intro:"재시작 여정에서 우리 모두는 서로의 지원이 필요합니다. 참여하고 싶은 방법을 선택하세요:",introNeed:"어려움을 겪고 있다면 알려주세요. 커뮤니티 파트너가 적극적으로 도와드릴 것입니다.",needBtn:"도움이 필요합니다",rule:"※ 모든 정보는 커뮤니티 내부 교류용으로만 사용되며, 서로의 개인정보를 존중해 주세요",msgTo:"메시지 보내기:",msgPlaceholder:"메시지를 입력하세요...",msgSent:"메시지가 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기",back:"돌아가기",date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{title:"Phòng thí nghiệm trợ giúp",provide:"Cung cấp trợ giúp",supply:"Vòng tròn cung cấp",need:"Cần trợ giúp",room:"Phòng hỗ trợ lẫn nhau",intro:"Trên hành trình khởi động lại, tất cả chúng ta đều cần sự hỗ trợ của nhau. Vui lòng chọn cách bạn muốn tham gia:",introNeed:"Nếu bạn đang gặp khó khăn, hãy cho chúng tôi biết, các đối tác cộng đồng sẽ tích cực hỗ trợ bạn.",needBtn:"Tôi cần trợ giúp",rule:"※ Tất cả thông tin chỉ dành cho giao tiếp nội bộ cộng đồng, vui lòng tôn trọng quyền riêng tư của nhau",msgTo:"Nhắn tin cho:",msgPlaceholder:"Vui lòng nhập tin nhắn...",msgSent:"Tin nhắn đã được gửi thành công!",backToHome:"Về trang chủ",back:"Quay lại",date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{title:"ห้องทดลองช่วยเหลือ",provide:"ให้ความช่วยเหลือ",supply:"วงกลมอุปทาน",need:"ต้องการความช่วยเหลือ",room:"ห้องช่วยเหลือซึ่งกันและกัน",intro:"ในการเดินทางเริ่มต้นใหม่ เราทุกคนต้องการการสนับสนุนจากกันและกัน กรุณาเลือกวิธีที่คุณต้องการมีส่วนร่วม:",introNeed:"หากคุณกำลังประสบความยากลำบาก กรุณาบอกเรา คู่ค้าชุมชนจะช่วยเหลือคุณอย่างกระตือรือร้น",needBtn:"ฉันต้องการความช่วยเหลือ",rule:"※ ข้อมูลทั้งหมดใช้สำหรับการสื่อสารภายในชุมชนเท่านั้น กรุณาเคารพความเป็นส่วนตัวของกันและกัน",msgTo:"ส่งข้อความถึง:",msgPlaceholder:"กรุณาป้อนข้อความ...",msgSent:"ส่งข้อความสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก",back:"กลับ",date:"วันที่",avatar:"รูปโปรไฟล์",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{title:"Makmal Bantuan & Kerjasama Bersama",provide:"Sediakan Bantuan",supply:"Bulatan Bekalan",need:"Memerlukan Bantuan",room:"Bilik Bantuan Bersama",intro:"Dalam perjalanan memulakan semula, kita semua memerlukan sokongan antara satu sama lain. Sila pilih cara anda ingin mengambil bahagian:",introNeed:"Jika anda menghadapi kesukaran, sila beritahu kami, rakan kongsi komuniti akan membantu anda secara aktif.",needBtn:"Saya Memerlukan Bantuan",rule:"※ Semua maklumat adalah untuk komunikasi dalaman komuniti sahaja, sila hormati privasi antara satu sama lain",msgTo:"Mesej kepada:",msgPlaceholder:"Sila masukkan mesej...",msgSent:"Mesej berjaya dihantar!",backToHome:"Kembali ke Laman Utama",back:"Kembali",date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{title:"Laboratorium Auxilii",provide:"Praebere Auxilium",supply:"Copiae Circulus",need:"Egere Auxilii",room:"Mutuum Auxilium Cubiculum",intro:"In itinere redintegrationis, omnes indigemus sustentatione mutua. Quaeso elige quomodo participare vis:",introNeed:"Si difficultates patieris, quaeso nobis dic, socii communitatis te active adiuvabunt.",needBtn:"Egeo Auxilii",rule:"※ Omnia notitia ad communicationem internam communitatis tantum sunt, quaeso honora privaciam inter se",msgTo:"Nuntius ad:",msgPlaceholder:"Quaeso intra nuntium...",msgSent:"Nuntius feliciter missus est!",backToHome:"Ad domum redire",back:"Redire",date:"Dies",avatar:"Imago",name:"Nomen",gender:"Sexus",age:"Aetas",country:"Patria"}};return(null==(t=n[d])?void 0:t[e])||n["zh-TW"][e]||e},[T,C]=e.useState(!1),[I,B]=e.useState({avatarUrl:"/ctx-logo.png",nickname:"",email:"",country:"",gender:"",age:""}),[R,A]=e.useState("provide"),[F,z]=e.useState([]),[E,_]=e.useState(null),N=Fv(lw),[P,D]=e.useState(""),[W,M]=e.useState(!1),[L,O]=e.useState(null),[q,U]=e.useState(""),[H,V]=e.useState(!1),[K,$]=e.useState(!1),[G,Q]=e.useState([]),[Y,J]=e.useState(""),[X,Z]=e.useState(!1),[ee,te]=e.useState(!1),[ne,ie]=e.useState([]),[re,ae]=e.useState(!1),[oe,se]=e.useState({});async function ce(e){try{if(!m)return D("❌ 請先登入後再送出"),void setTimeout(()=>D(""),3e3);await qf(ug(cw,"helpSupplies"),{...e,type:"provide",avatarUrl:I.avatarUrl,nickname:I.nickname,email:I.email,country:I.country,gender:I.gender,age:I.age,createdAt:Ji.now(),uid:(null==m?void 0:m.uid)||""});C(!1),D("🎉 已成功送出，感謝你的溫暖分享！"),setTimeout(()=>D(""),3e3),de()}catch(t){D("❌ 保存失敗，請稍後再試"),setTimeout(()=>D(""),3e3)}}async function de(){try{const e=hf(ug(cw,"helpSupplies"),mf("type","==","provide")),t=await Wf(e),n=t.docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{var n,i,r,a;const o=(null==(i=null==(n=e.createdAt)?void 0:n.toDate)?void 0:i.call(n))||new Date(e.createdAt);return((null==(a=null==(r=t.createdAt)?void 0:r.toDate)?void 0:a.call(r))||new Date(t.createdAt))-o});z(n)}catch(e){D("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>D(""),3e3)}}async function ue(e,t){if(m)if(m.uid)if(null==e?void 0:e.uid)if(t.trim()){Z(!0),J("");try{await qf(ug(cw,"messages"),{toUid:e.uid,toEmail:e.email,toNickname:e.nickname,fromUid:m.uid,fromEmail:m.email,fromNickname:I.nickname,content:t,timestamp:Ji.now(),read:!1}),V(!0),setTimeout(()=>{M(!1),V(!1),U("")},1500)}catch(RB){J("留言發送失敗，請稍後再試 (偵錯: "+((null==RB?void 0:RB.message)||RB)+")")}finally{Z(!1)}}else J("請輸入留言內容");else J("偵錯：toUser.uid 為空");else J("偵錯：user.uid 為空");else J("偵錯：user 為 null，請確認已登入")}async function he(){if(!m)return;const e=hf(ug(cw,"messages"),mf("toUid","==",m.uid),mf("read","==",!1)),t=await Wf(e);Q(t.docs.map(e=>({id:e.id,...e.data()})))}async function pe(e){await Lf(hg(cw,"messages",e),{read:!0}),he()}async function me(e){try{if(!m)return D("❌ 請先登入後再送出"),void setTimeout(()=>D(""),3e3);await qf(ug(cw,"helpSupplies"),{...e,type:"need",avatarUrl:I.avatarUrl,nickname:I.nickname,email:I.email,country:I.country,gender:I.gender,age:I.age,createdAt:Ji.now(),uid:(null==m?void 0:m.uid)||""});ae(!0),setTimeout(()=>{ae(!1),te(!1)},1800),D("🎉 你的需求已送出，社群夥伴會看到！"),setTimeout(()=>D(""),3e3),ge()}catch(t){D("❌ 保存失敗，請稍後再試"),setTimeout(()=>D(""),3e3)}}async function ge(){try{const e=hf(ug(cw,"helpSupplies"),mf("type","==","need")),t=await Wf(e),n=t.docs.map(e=>({id:e.id,...e.data()})).sort((e,t)=>{var n,i,r,a;const o=(null==(i=null==(n=e.createdAt)?void 0:n.toDate)?void 0:i.call(n))||new Date(e.createdAt);return((null==(a=null==(r=t.createdAt)?void 0:r.toDate)?void 0:a.call(r))||new Date(t.createdAt))-o});ie(n)}catch(e){D("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>D(""),3e3)}}return e.useEffect(()=>{if(!m)return;(async()=>{try{const e=await Pf(hg(cw,"profiles",m.uid)),t=e.exists()?e.data():{};let n=!1;const i={};if(t.country||(i.country="台灣",n=!0),t.gender||(i.gender="男",n=!0),t.age||(i.age="30",n=!0),n){const{setDoc:e}=await vT(async()=>{const{setDoc:e}=await Promise.resolve().then(()=>hx);return{setDoc:e}},void 0);await e(hg(cw,"profiles",m.uid),{...t,...i},{merge:!0});const n=await Pf(hg(cw,"profiles",m.uid)),r=n.exists()?n.data():{};return void B({avatarUrl:r.avatar||m.photoURL||"/ctx-logo.png",nickname:r.nickname||m.displayName||"Restarter",email:r.email||m.email||"",country:r.country||"",gender:r.gender||"",age:r.age||""})}B({avatarUrl:t.avatar||m.photoURL||"/ctx-logo.png",nickname:t.nickname||m.displayName||"Restarter",email:t.email||m.email||"",country:t.country||"",gender:t.gender||"",age:t.age||""})}catch{B({avatarUrl:m.photoURL||"/ctx-logo.png",nickname:m.displayName||"Restarter",email:m.email||"",country:"",gender:"",age:""})}})()},[m]),e.useEffect(()=>{"supply"===R&&de()},[R]),e.useEffect(()=>{he()},[m,K]),e.useEffect(()=>{"room"===R&&ge()},[R]),f.jsx("div",{style:{width:"100vw",height:"100vh",overflow:"auto",position:"relative"},children:window.innerWidth<=768?f.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)"},children:[f.jsx(zw,{}),f.jsxs("div",{style:{marginTop:60,padding:"16px",flex:1,overflowY:"auto",minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",paddingBottom:"48px",position:"relative"},children:[K&&f.jsxs(f.Fragment,{children:[f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:1e4},onClick:()=>$(!1)}),f.jsxs("div",{style:{position:"fixed",top:70,right:36,background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:24,minWidth:320,zIndex:10001},children:[f.jsx("div",{style:{fontWeight:900,fontSize:20,color:"#6B5BFF",marginBottom:12},children:(null==(n=null==(t=_I[d])?void 0:t.messages)?void 0:n.inboxTitle)||"站內訊息"}),0===G.length&&f.jsx("div",{style:{color:"#888",fontSize:15},children:(null==(a=null==(r=_I[d])?void 0:r.messages)?void 0:a.noMessages)||"目前沒有新訊息"}),G.map(e=>{var t,n,i,r,a,o,s,l,c,u;return f.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:12,marginBottom:12,boxShadow:"0 2px 8px #6B5BFF11",cursor:"pointer"},onClick:()=>{se(t=>({...t,[e.id]:!t[e.id]}))},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[f.jsxs("div",{style:{fontWeight:700,color:"#1976d2"},children:[e.fromNickname," ",(null==(n=null==(t=_I[d])?void 0:t.messages)?void 0:n.messageFrom)||"給你的留言："]}),f.jsx("span",{style:{fontSize:12,color:"#888"},children:oe[e.id]?"收起":"展開"})]}),oe[e.id]&&f.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:8,padding:12,marginBottom:8,border:"1px solid #e0e7ff"},children:[f.jsx("div",{style:{color:"#232946",marginBottom:8,lineHeight:"1.5"},children:e.content}),f.jsx("div",{style:{color:"#888",fontSize:13,marginBottom:8},children:null==(o=null==(r=null==(i=e.timestamp)?void 0:i.toDate)?void 0:(a=r.call(i)).toLocaleString)?void 0:o.call(a)}),f.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>window.open(`mailto:${e.fromEmail}`),style:{color:"#6B5BFF",fontWeight:700,textDecoration:"underline",fontSize:13,cursor:"pointer"},children:(null==(l=null==(s=_I[d])?void 0:s.messages)?void 0:l.contactUser)||"聯絡對方"}),f.jsx("button",{onClick:t=>{t.stopPropagation(),pe(e.id)},style:{background:"#eee",color:"#6B5BFF",border:"none",borderRadius:6,padding:"4px 12px",fontWeight:700,fontSize:13,cursor:"pointer"},children:(null==(u=null==(c=_I[d])?void 0:c.messages)?void 0:u.markRead)||"標記已讀"})]})]}),!oe[e.id]&&f.jsx("div",{style:{color:"#666",fontSize:14,fontStyle:"italic"},children:e.content.length>30?`${e.content.substring(0,30)}...`:e.content})]},e.id)})]})]}),P&&f.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:P}),f.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center"},children:[f.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[f.jsx("span",{role:"img","aria-label":"helplab",children:"🧪"})," ",S("title")]}),f.jsxs("button",{onClick:()=>$(e=>!e),style:{background:"none",border:"none",cursor:"pointer",position:"relative",padding:"8px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:8},children:[f.jsx("span",{style:{fontSize:24,color:"#6B5BFF"},children:"🔔"}),G.length>0&&f.jsx("span",{style:{position:"absolute",top:0,right:0,minWidth:18,height:18,background:"#ff4d4f",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #fff",color:"#fff",fontWeight:900,fontSize:13,padding:"0 5px",boxShadow:"0 2px 8px #ff4d4f88",zIndex:1},children:G.length})]})]})}),f.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"20px 16px 0 16px",background:"#fff",borderRadius:32,boxShadow:"0 8px 40px #b6b6f633, 0 1.5px 8px #6B5BFF22",border:"1.5px solid #e0e7ff"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginBottom:24},children:[f.jsx("button",{onClick:()=>A("provide"),style:{fontWeight:900,fontSize:18,color:"provide"===R?"#6B5BFF":"#888",background:"#fff",border:"provide"===R?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("provide")}),f.jsx("button",{onClick:()=>A("supply"),style:{fontWeight:900,fontSize:18,color:"supply"===R?"#6B5BFF":"#888",background:"#fff",border:"supply"===R?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("supply")}),f.jsx("button",{onClick:()=>A("need"),style:{fontWeight:900,fontSize:18,color:"need"===R?"#ff4d4f":"#888",background:"#fff",border:"need"===R?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("need")}),f.jsx("button",{onClick:()=>A("room"),style:{fontWeight:900,fontSize:18,color:"room"===R?"#ff4d4f":"#888",background:"#fff",border:"room"===R?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("room")})]}),"provide"===R&&f.jsxs(f.Fragment,{children:[f.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:S("intro")}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:p.map((e,t)=>f.jsxs("div",{style:{background:e.color,borderRadius:20,boxShadow:"0 4px 24px #0001",padding:"32px 28px",minWidth:260,maxWidth:320,flex:"1 1 260px",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:12},children:[f.jsx("div",{style:{fontSize:48,marginBottom:12},children:e.emoji}),f.jsx("div",{style:{fontWeight:800,fontSize:22,marginBottom:8,color:"#333",letterSpacing:1},children:e.title}),f.jsx("div",{style:{color:"#666",fontSize:15,marginBottom:18,textAlign:"center",minHeight:44},children:e.desc}),0===t?f.jsx("button",{onClick:()=>{A("provide"),C(!0)},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:e.btn}):1===t?f.jsx("button",{onClick:()=>{A("need"),te(!0)},style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:e.btn}):2===t?f.jsx("button",{onClick:()=>A("supply"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:e.btn}):f.jsx("button",{onClick:()=>A("room"),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:e.btn})]},t))}),f.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:15,marginTop:40},children:S("rule")}),f.jsx(PI,{open:T,onClose:()=>{C(!1),window.innerWidth<=768&&h("/HelpLab")},userInfo:I,onSubmit:ce})]}),"supply"===R&&f.jsx("div",{style:{marginTop:24},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15,tableLayout:"fixed"},children:[f.jsxs("colgroup",{children:[f.jsx("col",{style:{width:"28%"}}),f.jsx("col",{style:{width:"14%"}}),f.jsx("col",{style:{width:"22%"}}),f.jsx("col",{style:{width:"12%"}}),f.jsx("col",{style:{width:"12%"}}),f.jsx("col",{style:{width:"12%"}})]}),f.jsx("thead",{children:f.jsxs("tr",{style:{background:"#f3f3ff",color:"#6B5BFF"},children:[f.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:S("date")}),f.jsx("th",{style:{textAlign:"center"},children:S("avatar")}),f.jsx("th",{style:{textAlign:"left"},children:S("name")}),f.jsx("th",{style:{textAlign:"center"},children:S("gender")}),f.jsx("th",{style:{textAlign:"center"},children:S("age")}),f.jsx("th",{style:{textAlign:"center"},children:S("country")})]})}),f.jsx("tbody",{children:F.map((e,t)=>{var n,r,a,o;return f.jsxs(i.Fragment,{children:[f.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>_(E===t?null:t),children:[f.jsx("td",{children:(null==(o=null==(a=null==(r=null==(n=e.createdAt)?void 0:n.toDate)?void 0:r.call(n))?void 0:a.toLocaleString)?void 0:o.call(a))||""}),f.jsx("td",{children:f.jsx("img",{src:e.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),f.jsx("td",{style:{color:"#1976d2",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{O(e),M(!0)},children:e.nickname}),f.jsx("td",{children:e.gender}),f.jsx("td",{children:e.age}),f.jsx("td",{children:e.country})]}),E===t&&f.jsx("tr",{children:f.jsxs("td",{colSpan:6,style:{background:"#f8f8ff",padding:18},children:[f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"【你的困難也是我們的困難，讓我們一起面對並解決】"}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"經歷："}),(e.exp||[]).join("、"),e.expOther?`、${e.expOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"優勢："}),(e.adv||[]).join("、"),e.advOther?`、${e.advOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"優先幫助對象："}),(e.target||[]).join("、"),e.targetOther?`、${e.targetOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"幫助形式："}),e.helpType]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"特別聲明："}),e.statement]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"幫助頻率："}),e.freq,e.freqOther?`、${e.freqOther}`:""]}),f.jsx("div",{style:{marginTop:12},children:f.jsx("span",{onClick:()=>window.open(`mailto:${e.email}`),style:{color:"#6B5BFF",textDecoration:"underline",marginLeft:12,cursor:"pointer"},children:e.email})})]})})]},e.id)})})]})}),"need"===R&&f.jsxs(f.Fragment,{children:[f.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:S("introNeed")}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:f.jsx("button",{onClick:()=>te(!0),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:S("needBtn")})}),f.jsx(DI,{open:ee,onClose:()=>te(!1),userInfo:I,onSubmit:me,showMsgSent:re})]}),"room"===R&&f.jsx("div",{style:{marginTop:24},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{background:"#fff3e0",color:"#ff4d4f"},children:[f.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:S("date")}),f.jsx("th",{style:{textAlign:"center"},children:S("avatar")}),f.jsx("th",{style:{textAlign:"left"},children:S("name")}),f.jsx("th",{style:{textAlign:"center"},children:S("gender")}),f.jsx("th",{style:{textAlign:"center"},children:S("age")}),f.jsx("th",{style:{textAlign:"center"},children:S("country")})]})}),f.jsx("tbody",{children:ne.map((e,t)=>{var n,r,a,o;return f.jsxs(i.Fragment,{children:[f.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>_(E===t?null:t),children:[f.jsx("td",{children:(null==(o=null==(a=null==(r=null==(n=e.createdAt)?void 0:n.toDate)?void 0:r.call(n))?void 0:a.toLocaleString)?void 0:o.call(a))||""}),f.jsx("td",{children:f.jsx("img",{src:e.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),f.jsx("td",{style:{color:"#ff4d4f",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{O(e),M(!0)},children:e.nickname}),f.jsx("td",{children:e.gender}),f.jsx("td",{children:e.age}),f.jsx("td",{children:e.country})]}),E===t&&f.jsx("tr",{children:f.jsxs("td",{colSpan:6,style:{background:"#fff8f0",padding:18},children:[f.jsx("div",{style:{fontWeight:700,color:"#ff4d4f",marginBottom:8},children:"【你的困難我們一起面對，社群夥伴會主動協助你】"}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"經歷："}),(e.exp||[]).join("、"),e.expOther?`、${e.expOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"優勢："}),(e.adv||[]).join("、"),e.advOther?`、${e.advOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"困難/需求："}),(e.target||[]).join("、"),e.targetOther?`、${e.targetOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"協助形式："}),e.helpType]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"補充說明："}),e.statement]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"協助頻率："}),e.freq,e.freqOther?`、${e.freqOther}`:""]}),f.jsx("div",{style:{marginTop:12},children:f.jsx("span",{onClick:()=>window.open(`mailto:${e.email}`),style:{color:"#ff4d4f",textDecoration:"underline",marginLeft:12,cursor:"pointer"},children:e.email})})]})})]},e.id)})})]})})]}),W&&L&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[f.jsx("button",{type:"button",onClick:()=>M(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),f.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[S("msgTo"),L.nickname]}),f.jsx("textarea",{value:q,onChange:e=>U(e.target.value),rows:3,maxLength:100,placeholder:S("msgPlaceholder"),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),Y&&f.jsx("div",{style:{color:"#ff4d4f",fontWeight:700,textAlign:"center",marginTop:4},children:Y}),f.jsx("button",{onClick:()=>ue(L,q),disabled:!q.trim()||X,style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:!q.trim()||X?"not-allowed":"pointer",alignSelf:"center",opacity:!q.trim()||X?.6:1},children:X?"送出中...":"送出留言"}),H&&f.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:S("msgSent")})]})})]})]}):f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",padding:"0 0 48px 0",position:"relative",overflow:"auto"},children:[f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsx("div",{style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>A("provide")})}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>h("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":"zh-TW"===d||"zh-CN"===d?"了解 Restarter 平台":"en"===d?"Learn about Restarter platform":"ja"===d?"Restarter プラットフォームについて":"ko"===d?"Restarter 플랫폼에 대해 알아보기":"th"===d?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":"vi"===d?"Tìm hiểu về nền tảng Restarter":"ms"===d?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:"zh-TW"===d?"🧬 Restarter™｜我們是誰":"zh-CN"===d?"🧬 Restarter™｜我们是谁":"en"===d?"🧬 Restarter™｜Who We Are":"ja"===d?"🧬 Restarter™｜私たちについて":"ko"===d?"🧬 Restarter™｜우리는 누구인가":"th"===d?"🧬 Restarter™｜เราเป็นใคร":"vi"===d?"🧬 Restarter™｜Chúng tôi là ai":"ms"===d?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>h("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":"zh-TW"===d?"提供意見和建議":"zh-CN"===d?"提供意见和建议":"en"===d?"Provide feedback and suggestions":"ja"===d?"ご意見やご提案を提供":"ko"===d?"의견과 제안 제공":"th"===d?"ให้ข้อเสนอแนะและคำแนะนำ":"vi"===d?"Cung cấp phản hồi và đề xuất":"ms"===d?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:"zh-TW"===d?"💬 意見箱｜我們想聽你說":"zh-CN"===d?"💬 意见箱｜我们想听你说":"en"===d?"💬 Feedback｜We Want to Hear You":"ja"===d?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===d?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===d?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===d?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===d?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),m?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:m.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:m.displayName||m.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(N)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:EI[d]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>h("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===d?"註冊/登入":"zh-CN"===d?"注册/登录":"en"===d?"Register / Login":"ja"===d?"登録/ログイン":"ko"===d?"가입/로그인":"th"===d?"สมัคร/เข้าสู่ระบบ":"vi"===d?"Đăng ký/Đăng nhập":"ms"===d?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{ref:w,style:{position:"relative",display:"inline-block"},className:"language-selector",children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>v(e=>!e),children:["zh-TW"===d?"繁中":"zh-CN"===d?"简中":"en"===d?"English":"ja"===d?"日本語":"ko"===d?"한국어":"th"===d?"ไทย":"vi"===d?"Tiếng Việt":"ms"===d?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),b&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===d?"#6B5BFF":"#232946",fontWeight:e===d?700:500,background:e===d?"#f3f0ff":"#fff"},onClick:()=>{u(e),v(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{ref:k,style:{position:"relative",display:"inline-block"},className:"legal-menu",children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:44,height:"44px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>y(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff"},onMouseOut:e=>{e.currentTarget.style.background="#fff"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),x&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:180,maxWidth:220,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===d||"zh-CN"===d?"法律文件":"en"===d?"Legal Documents":"ja"===d?"法的文書":"ko"===d?"법적 문서":"th"===d?"เอกสารทางกฎหมาย":"vi"===d?"Tài liệu pháp lý":"ms"===d?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:{"zh-TW":"隱私權政策","zh-CN":"隐私政策",en:"Privacy Policy",ja:"プライバシーポリシー",ko:"개인정보보호정책",th:"นโยบายความเป็นส่วนตัว",vi:"Chính sách bảo mật",ms:"Dasar Privasi",la:"Consilium de Privata"},path:"/privacy-policy"},{key:"terms",title:{"zh-TW":"條款/聲明","zh-CN":"条款/声明",en:"Terms/Statement",ja:"利用規約/声明",ko:"약관/성명",th:"ข้อกำหนด/คำแถลง",vi:"Điều khoản/Tuyên bố",ms:"Terma/Penyata",la:"Termini/Declaratio"},path:"/terms"},{key:"data",title:{"zh-TW":"資料刪除說明","zh-CN":"数据删除说明",en:"Data Deletion",ja:"データ削除について",ko:"데이터 삭제 설명",th:"คำอธิบายการลบข้อมูล",vi:"Giải thích xóa dữ liệu",ms:"Penerangan Pemadaman Data",la:"Explicatio Deletionis Datae"},path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"11px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{h(e.path),y(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title[d]||e.title["zh-TW"]},e.key))]})]})]}),f.jsx("div",{style:{position:"fixed",top:16,right:16,zIndex:10001},children:f.jsxs("button",{style:{background:j?"#ff4d4f":"#52c41a",color:"#fff",border:"none",borderRadius:6,padding:"6px 12px",fontSize:12,fontWeight:700,cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:["測試模式 ",j?"ON":"OFF"]})}),f.jsxs("div",{style:{padding:"120px 20px 20px 20px",maxWidth:1200,margin:"0 auto"},children:[K&&f.jsxs(f.Fragment,{children:[f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:1e4},onClick:()=>$(!1)}),f.jsxs("div",{style:{position:"fixed",top:70,right:36,background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:24,minWidth:320,zIndex:10001},children:[f.jsx("div",{style:{fontWeight:900,fontSize:20,color:"#6B5BFF",marginBottom:12},children:(null==(s=null==(o=_I[d])?void 0:o.messages)?void 0:s.inboxTitle)||"站內訊息"}),0===G.length&&f.jsx("div",{style:{color:"#888",fontSize:15},children:(null==(c=null==(l=_I[d])?void 0:l.messages)?void 0:c.noMessages)||"目前沒有新訊息"}),G.map(e=>{var t,n,i,r,a,o,s,l,c,u;return f.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:12,marginBottom:12,boxShadow:"0 2px 8px #6B5BFF11",cursor:"pointer"},onClick:()=>{se(t=>({...t,[e.id]:!t[e.id]}))},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[f.jsxs("div",{style:{fontWeight:700,color:"#1976d2"},children:[e.fromNickname," ",(null==(n=null==(t=_I[d])?void 0:t.messages)?void 0:n.messageFrom)||"給你的留言："]}),f.jsx("span",{style:{fontSize:12,color:"#888"},children:oe[e.id]?"收起":"展開"})]}),oe[e.id]&&f.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:8,padding:12,marginBottom:8,border:"1px solid #e0e7ff"},children:[f.jsx("div",{style:{color:"#232946",marginBottom:8,lineHeight:"1.5"},children:e.content}),f.jsx("div",{style:{color:"#888",fontSize:13,marginBottom:8},children:null==(o=null==(r=null==(i=e.timestamp)?void 0:i.toDate)?void 0:(a=r.call(i)).toLocaleString)?void 0:o.call(a)}),f.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[f.jsx("span",{onClick:()=>window.open(`mailto:${e.fromEmail}`),style:{color:"#6B5BFF",fontWeight:700,textDecoration:"underline",fontSize:13,cursor:"pointer"},children:(null==(l=null==(s=_I[d])?void 0:s.messages)?void 0:l.contactUser)||"聯絡對方"}),f.jsx("button",{onClick:t=>{t.stopPropagation(),pe(e.id)},style:{background:"#eee",color:"#6B5BFF",border:"none",borderRadius:6,padding:"4px 12px",fontWeight:700,fontSize:13,cursor:"pointer"},children:(null==(u=null==(c=_I[d])?void 0:c.messages)?void 0:u.markRead)||"標記已讀"})]})]}),!oe[e.id]&&f.jsx("div",{style:{color:"#666",fontSize:14,fontStyle:"italic"},children:e.content.length>30?`${e.content.substring(0,30)}...`:e.content})]},e.id)})]})]}),P&&f.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:P}),f.jsx("div",{style:{width:"fit-content",margin:"20px auto 20px auto",padding:"12px 20px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center"},children:[f.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[f.jsx("span",{role:"img","aria-label":"helplab",children:"🧪"})," ",S("title")]}),f.jsxs("button",{onClick:()=>$(e=>!e),style:{background:"none",border:"none",cursor:"pointer",position:"relative",padding:"8px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:8},children:[f.jsx("span",{style:{fontSize:24,color:"#6B5BFF"},children:"🔔"}),G.length>0&&f.jsx("span",{style:{position:"absolute",top:0,right:0,minWidth:18,height:18,background:"#ff4d4f",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #fff",color:"#fff",fontWeight:900,fontSize:13,padding:"0 5px",boxShadow:"0 2px 8px #ff4d4f88",zIndex:1},children:G.length})]})]})}),f.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"20px 16px 0 16px",background:"#fff",borderRadius:32,boxShadow:"0 8px 40px #b6b6f633, 0 1.5px 8px #6B5BFF22",border:"1.5px solid #e0e7ff"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginBottom:24},children:[f.jsx("button",{onClick:()=>A("provide"),style:{fontWeight:900,fontSize:18,color:"provide"===R?"#6B5BFF":"#888",background:"#fff",border:"provide"===R?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("provide")}),f.jsx("button",{onClick:()=>A("supply"),style:{fontWeight:900,fontSize:18,color:"supply"===R?"#6B5BFF":"#888",background:"#fff",border:"supply"===R?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("supply")}),f.jsx("button",{onClick:()=>A("need"),style:{fontWeight:900,fontSize:18,color:"need"===R?"#ff4d4f":"#888",background:"#fff",border:"need"===R?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("need")}),f.jsx("button",{onClick:()=>A("room"),style:{fontWeight:900,fontSize:18,color:"room"===R?"#ff4d4f":"#888",background:"#fff",border:"room"===R?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:S("room")})]}),"provide"===R&&f.jsxs(f.Fragment,{children:[f.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:S("intro")}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:p.map((e,t)=>f.jsxs("div",{style:{background:e.color,borderRadius:20,boxShadow:"0 4px 24px #0001",padding:"32px 28px",minWidth:260,maxWidth:320,flex:"1 1 260px",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:12},children:[f.jsx("div",{style:{fontSize:48,marginBottom:12},children:e.emoji}),f.jsx("div",{style:{fontWeight:800,fontSize:22,marginBottom:8,color:"#333",letterSpacing:1},children:e.title}),f.jsx("div",{style:{color:"#666",fontSize:15,marginBottom:18,textAlign:"center",minHeight:44},children:e.desc}),0===t?f.jsx("button",{onClick:()=>{A("provide"),C(!0)},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:e.btn}):1===t?f.jsx("button",{onClick:()=>{A("need"),te(!0)},style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:e.btn}):2===t?f.jsx("button",{onClick:()=>A("supply"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:e.btn}):f.jsx("button",{onClick:()=>A("room"),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:e.btn})]},t))}),f.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:15,marginTop:40},children:S("rule")}),f.jsx(PI,{open:T,onClose:()=>{C(!1),window.innerWidth<=768&&h("/HelpLab")},userInfo:I,onSubmit:ce})]}),"supply"===R&&f.jsx("div",{style:{marginTop:24},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15,tableLayout:"fixed"},children:[f.jsxs("colgroup",{children:[f.jsx("col",{style:{width:"28%"}}),f.jsx("col",{style:{width:"14%"}}),f.jsx("col",{style:{width:"22%"}}),f.jsx("col",{style:{width:"12%"}}),f.jsx("col",{style:{width:"12%"}}),f.jsx("col",{style:{width:"12%"}})]}),f.jsx("thead",{children:f.jsxs("tr",{style:{background:"#f3f3ff",color:"#6B5BFF"},children:[f.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:S("date")}),f.jsx("th",{style:{textAlign:"center"},children:S("avatar")}),f.jsx("th",{style:{textAlign:"left"},children:S("name")}),f.jsx("th",{style:{textAlign:"center"},children:S("gender")}),f.jsx("th",{style:{textAlign:"center"},children:S("age")}),f.jsx("th",{style:{textAlign:"center"},children:S("country")})]})}),f.jsx("tbody",{children:F.map((e,t)=>{var n,r,a,o;return f.jsxs(i.Fragment,{children:[f.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>_(E===t?null:t),children:[f.jsx("td",{children:(null==(o=null==(a=null==(r=null==(n=e.createdAt)?void 0:n.toDate)?void 0:r.call(n))?void 0:a.toLocaleString)?void 0:o.call(a))||""}),f.jsx("td",{children:f.jsx("img",{src:e.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),f.jsx("td",{style:{color:"#1976d2",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{O(e),M(!0)},children:e.nickname}),f.jsx("td",{children:e.gender}),f.jsx("td",{children:e.age}),f.jsx("td",{children:e.country})]}),E===t&&f.jsx("tr",{children:f.jsxs("td",{colSpan:6,style:{background:"#f8f8ff",padding:18},children:[f.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"【你的困難也是我們的困難，讓我們一起面對並解決】"}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"經歷："}),(e.exp||[]).join("、"),e.expOther?`、${e.expOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"優勢："}),(e.adv||[]).join("、"),e.advOther?`、${e.advOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"優先幫助對象："}),(e.target||[]).join("、"),e.targetOther?`、${e.targetOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"幫助形式："}),e.helpType]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"特別聲明："}),e.statement]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"幫助頻率："}),e.freq,e.freqOther?`、${e.freqOther}`:""]}),f.jsx("div",{style:{marginTop:12},children:f.jsx("span",{onClick:()=>window.open(`mailto:${e.email}`),style:{color:"#6B5BFF",textDecoration:"underline",marginLeft:12,cursor:"pointer"},children:e.email})})]})})]},e.id)})})]})}),"need"===R&&f.jsxs(f.Fragment,{children:[f.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:S("introNeed")}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:f.jsx("button",{onClick:()=>te(!0),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:S("needBtn")})}),f.jsx(DI,{open:ee,onClose:()=>te(!1),userInfo:I,onSubmit:me,showMsgSent:re})]}),"room"===R&&f.jsx("div",{style:{marginTop:24},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{background:"#fff3e0",color:"#ff4d4f"},children:[f.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:S("date")}),f.jsx("th",{style:{textAlign:"center"},children:S("avatar")}),f.jsx("th",{style:{textAlign:"left"},children:S("name")}),f.jsx("th",{style:{textAlign:"center"},children:S("gender")}),f.jsx("th",{style:{textAlign:"center"},children:S("age")}),f.jsx("th",{style:{textAlign:"center"},children:S("country")})]})}),f.jsx("tbody",{children:ne.map((e,t)=>{var n,r,a,o;return f.jsxs(i.Fragment,{children:[f.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>_(E===t?null:t),children:[f.jsx("td",{children:(null==(o=null==(a=null==(r=null==(n=e.createdAt)?void 0:n.toDate)?void 0:r.call(n))?void 0:a.toLocaleString)?void 0:o.call(a))||""}),f.jsx("td",{children:f.jsx("img",{src:e.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),f.jsx("td",{style:{color:"#ff4d4f",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{O(e),M(!0)},children:e.nickname}),f.jsx("td",{children:e.gender}),f.jsx("td",{children:e.age}),f.jsx("td",{children:e.country})]}),E===t&&f.jsx("tr",{children:f.jsxs("td",{colSpan:6,style:{background:"#fff8f0",padding:18},children:[f.jsx("div",{style:{fontWeight:700,color:"#ff4d4f",marginBottom:8},children:"【你的困難我們一起面對，社群夥伴會主動協助你】"}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"經歷："}),(e.exp||[]).join("、"),e.expOther?`、${e.expOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"優勢："}),(e.adv||[]).join("、"),e.advOther?`、${e.advOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"困難/需求："}),(e.target||[]).join("、"),e.targetOther?`、${e.targetOther}`:""]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"協助形式："}),e.helpType]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"補充說明："}),e.statement]}),f.jsxs("div",{style:{marginBottom:8},children:[f.jsx("b",{children:"協助頻率："}),e.freq,e.freqOther?`、${e.freqOther}`:""]}),f.jsx("div",{style:{marginTop:12},children:f.jsx("span",{onClick:()=>window.open(`mailto:${e.email}`),style:{color:"#ff4d4f",textDecoration:"underline",marginLeft:12,cursor:"pointer"},children:e.email})})]})})]},e.id)})})]})})]}),W&&L&&f.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[f.jsx("button",{type:"button",onClick:()=>M(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),f.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[S("msgTo"),L.nickname]}),f.jsx("textarea",{value:q,onChange:e=>U(e.target.value),rows:3,maxLength:100,placeholder:S("msgPlaceholder"),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),Y&&f.jsx("div",{style:{color:"#ff4d4f",fontWeight:700,textAlign:"center",marginTop:4},children:Y}),f.jsx("button",{onClick:()=>ue(L,q),disabled:!q.trim()||X,style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:!q.trim()||X?"not-allowed":"pointer",alignSelf:"center",opacity:!q.trim()||X?.6:1},children:X?"送出中...":"送出留言"}),H&&f.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:S("msgSent")})]})})]})]})})}const MI={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},LI=(e,t)=>{try{localStorage.setItem(`emotionRelease_${e}`,JSON.stringify(t))}catch(n){}},OI=e=>{try{const t=localStorage.getItem(`emotionRelease_${e}`);return t?JSON.parse(t):null}catch(t){return null}};function qI(){const t=le(),{lang:n,setLang:i}=mw(),[r,a]=e.useState(null),[o,s]=e.useState(!1),[l,c]=e.useState(null),[d,u]=e.useState(!1),[h,p]=e.useState(!1),m=e.useRef(null),g=e.useRef(null),x=Fv(lw);e.useEffect(()=>{const e=yb(x,e=>{c(e)});return()=>e()},[]),e.useEffect(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&u(!1),g.current&&!g.current.contains(e.target)&&p(!1)};return(d||h)&&document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[d,h]),e.useEffect(()=>{const e=new Image;e.onload=()=>s(!0),e.onerror=()=>s(!0);const t=setTimeout(()=>{s(!0)},3e3);return e.src="/stress.png",()=>clearTimeout(t)},[]);const y=e=>{var t;const i={"zh-TW":{title:"情緒發洩區",subtitle:"簡單遊戲，不複雜，輕鬆釋放你的情緒。",farm:"生活農場",farmDesc:"點擊種植，感受成長的喜悅",whackAMole:"打地鼠",whackAMoleDesc:"快速點擊，釋放壓力",fruitPicking:"採水果",fruitPickingDesc:"點擊收集，享受豐收",targetShooting:"情緒泡泡爆破",targetShootingDesc:"戳破情緒泡泡，釋放內心壓力",racing:"極速賽車",racingDesc:"駕駛賽車，體驗速度與激情",rhythm:"音樂節奏",rhythmDesc:"跟隨節奏，釋放音樂能量",rules:"遊戲規則",back:"返回",start:"開始遊戲",close:"關閉"},"zh-CN":{title:"情绪发泄区",subtitle:"简单游戏，不复杂，轻松释放你的情绪。",farm:"生活农场",farmDesc:"点击种植，感受成长的喜悦",whackAMole:"打地鼠",whackAMoleDesc:"快速点击，释放压力",fruitPicking:"采水果",fruitPickingDesc:"点击收集，享受丰收",targetShooting:"飞靶射击",targetShootingDesc:"瞄准射击，提升专注力",racing:"极速赛车",racingDesc:"驾驶赛车，体验速度与激情",rhythm:"音乐节奏",rhythmDesc:"跟随节奏，释放音乐能量",rules:"游戏规则",back:"返回",start:"开始游戏",close:"关闭"},en:{title:"Emotion Release Zone",subtitle:"Simple games, not complicated, easily release your emotions.",farm:"Life Farm",farmDesc:"Click to plant, feel the joy of growth",whackAMole:"Whack-a-Mole",whackAMoleDesc:"Quick clicks to release stress",fruitPicking:"Fruit Picking",fruitPickingDesc:"Click to collect, enjoy the harvest",targetShooting:"Target Shooting",targetShootingDesc:"Aim and shoot, improve focus",racing:"Speed Racing",racingDesc:"Drive racing cars, experience speed and excitement",rhythm:"Music Rhythm",rhythmDesc:"Follow the rhythm, release musical energy",rules:"Game Rules",back:"Back",start:"Start Game",close:"Close"},ja:{title:"感情発散エリア",subtitle:"シンプルなゲーム、複雑ではなく、簡単に感情を解放。",farm:"ライフファーム",farmDesc:"クリックして植える、成長の喜びを感じる",whackAMole:"モグラたたき",whackAMoleDesc:"素早くクリックしてストレスを解放",fruitPicking:"フルーツ収穫",fruitPickingDesc:"クリックして収穫、収穫を楽しむ",targetShooting:"ターゲット射撃",targetShootingDesc:"狙って撃つ、集中力を向上",racing:"スピードレーシング",racingDesc:"レーシングカーを運転、スピードと興奮を体験",rhythm:"音楽リズム",rhythmDesc:"リズムに合わせて、音楽エネルギーを解放",rules:"ゲームルール",back:"戻る",start:"ゲーム開始",close:"閉じる"},ko:{title:"감정 발산 구역",subtitle:"간단한 게임, 복잡하지 않고, 쉽게 감정을 해방하세요.",farm:"라이프 팜",farmDesc:"클릭하여 심고, 성장의 기쁨을 느끼세요",whackAMole:"두더지 잡기",whackAMoleDesc:"빠르게 클릭하여 스트레스를 해방하세요",fruitPicking:"과일 수확",fruitPickingDesc:"클릭하여 수확하고, 수확의 기쁨을 누리세요",targetShooting:"타겟 사격",targetShootingDesc:"조준하고 쏘기, 집중력 향상",racing:"스피드 레이싱",racingDesc:"레이싱카 운전, 속도와 흥분을 경험",rhythm:"음악 리듬",rhythmDesc:"리듬에 맞춰 음악 에너지를 해방",rules:"게임 규칙",back:"돌아가기",start:"게임 시작",close:"닫기"},vi:{title:"Khu Vực Giải Tỏa Cảm Xúc",subtitle:"Trò chơi đơn giản, không phức tạp, dễ dàng giải tỏa cảm xúc của bạn.",farm:"Nông Trại Cuộc Sống",farmDesc:"Nhấp để trồng, cảm nhận niềm vui của sự phát triển",whackAMole:"Đập Chuột",whackAMoleDesc:"Nhấp nhanh để giải tỏa căng thẳng",fruitPicking:"Hái Trái Cây",fruitPickingDesc:"Nhấp để thu hoạch, tận hưởng mùa màng",targetShooting:"Bắn Bia",targetShootingDesc:"Nhắm và bắn, cải thiện sự tập trung",racing:"Đua Xe Tốc Độ",racingDesc:"Lái xe đua, trải nghiệm tốc độ và sự phấn khích",rhythm:"Nhịp Điệu Âm Nhạc",rhythmDesc:"Theo nhịp điệu, giải phóng năng lượng âm nhạc",rules:"Luật Chơi",back:"Quay Lại",start:"Bắt Đầu Trò Chơi",close:"Đóng"},th:{title:"พื้นที่ระบายอารมณ์",subtitle:"เกมง่ายๆ ไม่ซับซ้อน ปลดปล่อยอารมณ์ของคุณได้อย่างง่ายดาย",farm:"ฟาร์มชีวิต",farmDesc:"คลิกเพื่อปลูก รู้สึกถึงความสุขของการเติบโต",whackAMole:"ตีตุ่น",whackAMoleDesc:"คลิกเร็วเพื่อระบายความเครียด",fruitPicking:"เก็บผลไม้",fruitPickingDesc:"คลิกเพื่อเก็บเกี่ยว สนุกกับการเก็บเกี่ยว",targetShooting:"ยิงเป้า",targetShootingDesc:"เล็งและยิง ปรับปรุงสมาธิ",racing:"แข่งรถความเร็ว",racingDesc:"ขับรถแข่ง ประสบการณ์ความเร็วและความตื่นเต้น",rhythm:"จังหวะดนตรี",rhythmDesc:"ตามจังหวะ ปลดปล่อยพลังงานดนตรี",rules:"กฎเกม",back:"กลับ",start:"เริ่มเกม",close:"ปิด"},la:{title:"Zona Emotio Liberationis",subtitle:"Ludi simplices, non complicati, facile libera emotiones tuas.",farm:"Villa Vitae",farmDesc:"Clicca ad plantandum, senti gaudium incrementi",whackAMole:"Talpa Percutere",whackAMoleDesc:"Clicca celeriter ad liberationem tensionis",fruitPicking:"Fructus Colligere",fruitPickingDesc:"Clicca ad colligendum, fruere messe",targetShooting:"Scopum Iaculare",targetShootingDesc:"Intende et iacula, meliora attentionem",racing:"Cursus Velocitatis",racingDesc:"Guberna currus cursus, experire velocitatem et excitationem",rhythm:"Rhythmus Musicae",rhythmDesc:"Sequere rhythmum, libera energiam musicam",rules:"Regulae Ludi",back:"Regredi",start:"Ludum Incipere",close:"Claudere"},ms:{title:"Zon Pelepasan Emosi",subtitle:"Permainan mudah, tidak rumit, mudah melepaskan emosi anda.",farm:"Ladang Kehidupan",farmDesc:"Klik untuk menanam, rasakan kegembiraan pertumbuhan",whackAMole:"Pukul Tikus",whackAMoleDesc:"Klik pantas untuk melepaskan tekanan",fruitPicking:"Kutip Buah",fruitPickingDesc:"Klik untuk mengutip, nikmati hasil tuaian",targetShooting:"Tembak Sasaran",targetShootingDesc:"Arah dan tembak, tingkatkan fokus",racing:"Lumba Kereta Laju",racingDesc:"Pandu kereta lumba, alami kelajuan dan keseronokan",rhythm:"Irama Muzik",rhythmDesc:"Ikut irama, lepaskan tenaga muzik",rules:"Peraturan Permainan",back:"Kembali",start:"Mulakan Permainan",close:"Tutup"}};return(null==(t=i[n])?void 0:t[e])||i["zh-TW"][e]||e},b=[{id:"farm",title:y("farm"),description:y("farmDesc"),icon:"🌱",color:"#4CAF50"},{id:"whackAMole",title:y("whackAMole"),description:y("whackAMoleDesc"),icon:"🔨",color:"#FF5722"},{id:"fruitPicking",title:y("fruitPicking"),description:y("fruitPickingDesc"),icon:"🍎",color:"#FF9800"},{id:"targetShooting",title:y("targetShooting"),description:y("targetShootingDesc"),icon:"🫧",color:"#9C27B0"},{id:"racing",title:y("racing"),description:y("racingDesc"),icon:"🏎️",color:"#E91E63"},{id:"rhythm",title:y("rhythm"),description:y("rhythmDesc"),icon:"🎵",color:"#00BCD4"}];return f.jsxs("div",{style:{minHeight:"100vh",background:o?"linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%), url('/stress.png')":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"clamp(10px, 2vw, 20px)",fontFamily:"Arial, sans-serif",boxSizing:"border-box",position:"relative"},children:[window.innerWidth<=768&&f.jsx(zw,{}),window.innerWidth>768&&f.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[f.jsx("div",{style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:f.jsx("img",{src:"/ctx-logo.png",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>t("/")})}),f.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[f.jsx("button",{className:"topbar-btn",onClick:()=>t("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":"zh-TW"===n||"zh-CN"===n?"了解 Restarter 平台":"en"===n?"Learn about Restarter platform":"ja"===n?"Restarter プラットフォームについて":"ko"===n?"Restarter 플랫폼에 대해 알아보기":"th"===n?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":"vi"===n?"Tìm hiểu về nền tảng Restarter":"ms"===n?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:"zh-TW"===n?"🧬 Restarter™｜我們是誰":"zh-CN"===n?"🧬 Restarter™｜我们是谁":"en"===n?"🧬 Restarter™｜Who We Are":"ja"===n?"🧬 Restarter™｜私たちについて":"ko"===n?"🧬 Restarter™｜우리는 누구인가":"th"===n?"🧬 Restarter™｜เราเป็นใคร":"vi"===n?"🧬 Restarter™｜Chúng tôi là ai":"ms"===n?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),f.jsx("button",{className:"topbar-btn",onClick:()=>t("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":"zh-TW"===n?"提供意見和建議":"zh-CN"===n?"提供意见和建议":"en"===n?"Provide feedback and suggestions":"ja"===n?"ご意見やご提案を提供":"ko"===n?"의견과 제안 제공":"th"===n?"ให้ข้อเสนอแนะและคำแนะนำ":"vi"===n?"Cung cấp phản hồi và đề xuất":"ms"===n?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:"zh-TW"===n?"💬 意見箱｜我們想聽你說":"zh-CN"===n?"💬 意见箱｜我们想听你说":"en"===n?"💬 Feedback｜We Want to Hear You":"ja"===n?"💬 ご意見箱｜あなたの声を聞かせて":"ko"===n?"💬 피드백｜여러분의 의견을 듣고 싶어요":"th"===n?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":"vi"===n?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":"ms"===n?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),l?f.jsx(f.Fragment,{children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[f.jsx("img",{src:l.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),f.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:l.displayName||l.email||"用戶"}),f.jsx("button",{className:"topbar-btn",onClick:async()=>{await bb(x)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:MI[n]})]})}):f.jsx("button",{className:"topbar-btn",onClick:()=>t("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:"zh-TW"===n?"註冊/登入":"zh-CN"===n?"注册/登录":"en"===n?"Register / Login":"ja"===n?"登録/ログイン":"ko"===n?"가입/로그인":"th"===n?"สมัคร/เข้าสู่ระบบ":"vi"===n?"Đăng ký/Đăng nhập":"ms"===n?"Daftar / Log Masuk":"Registrare / Login"})]}),f.jsxs("div",{ref:g,style:{position:"relative",display:"inline-block"},className:"language-selector",children:[f.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>p(e=>!e),children:["zh-TW"===n?"繁中":"zh-CN"===n?"简中":"en"===n?"English":"ja"===n?"日本語":"ko"===n?"한국어":"th"===n?"ไทย":"vi"===n?"Tiếng Việt":"ms"===n?"Bahasa Melayu":"Latin",f.jsx("span",{style:{marginLeft:6},children:"▼"})]}),h&&f.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(e=>f.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:e===n?"#6B5BFF":"#232946",fontWeight:e===n?700:500,background:e===n?"#f3f0ff":"#fff"},onClick:()=>{i(e),p(!1)},children:"zh-TW"===e?"繁中":"zh-CN"===e?"简中":"en"===e?"English":"ja"===e?"日本語":"ko"===e?"한국어":"th"===e?"ไทย":"vi"===e?"Tiếng Việt":"ms"===e?"Bahasa Melayu":"Latin"},e))})]}),f.jsxs("div",{ref:m,style:{position:"relative",display:"inline-block"},className:"legal-menu",children:[f.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:44,height:"44px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>u(e=>!e),onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff"},onMouseOut:e=>{e.currentTarget.style.background="#fff"},children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),f.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),d&&f.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:180,maxWidth:220,padding:"8px 0"},children:[f.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:f.jsx("span",{style:{fontSize:"12px",fontWeight:700,color:"#6B5BFF"},children:"zh-TW"===n||"zh-CN"===n?"法律文件":"en"===n?"Legal Documents":"ja"===n?"法的文書":"ko"===n?"법적 문서":"th"===n?"เอกสารทางกฎหมาย":"vi"===n?"Tài liệu pháp lý":"ms"===n?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:{"zh-TW":"隱私權政策","zh-CN":"隐私政策",en:"Privacy Policy",ja:"プライバシーポリシー",ko:"개인정보보호정책",th:"นโยบายความเป็นส่วนตัว",vi:"Chính sách bảo mật",ms:"Dasar Privasi",la:"Consilium de Privata"},path:"/privacy-policy"},{key:"terms",title:{"zh-TW":"條款/聲明","zh-CN":"条款/声明",en:"Terms/Statement",ja:"利用規約/声明",ko:"약관/성명",th:"ข้อกำหนด/คำแถลง",vi:"Điều khoản/Tuyên bố",ms:"Terma/Penyata",la:"Termini/Declaratio"},path:"/terms"},{key:"data",title:{"zh-TW":"資料刪除說明","zh-CN":"数据删除说明",en:"Data Deletion",ja:"データ削除について",ko:"데이터 삭제 설명",th:"คำอธิบายการลบข้อมูล",vi:"Giải thích xóa dữ liệu",ms:"Penerangan Pemadaman Data",la:"Explicatio Deletionis Datae"},path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(e=>f.jsx("div",{style:{padding:"8px 12px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"11px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{t(e.path),u(!1)},onMouseOver:e=>{e.currentTarget.style.background="#f3f0ff",e.currentTarget.style.color="#6B5BFF"},onMouseOut:e=>{e.currentTarget.style.background="#fff",e.currentTarget.style.color="#232946"},children:e.title[n]||e.title["zh-TW"]},e.key))]})]})]}),!o&&f.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.9)",padding:"20px",borderRadius:"10px",zIndex:2e3,textAlign:"center"},children:[f.jsx("div",{style:{fontSize:"18px",marginBottom:"10px"},children:"載入中..."}),f.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #667eea",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),f.jsx("style",{children:"\n            @keyframes spin {\n              0% { transform: rotate(0deg); }\n              100% { transform: rotate(360deg); }\n            }\n          "})]}),r?f.jsx("div",{style:{position:"relative",height:"100vh"},children:(()=>{switch(r){case"farm":return f.jsx(UI,{onClose:()=>a(null)});case"whackAMole":return f.jsx(HI,{onClose:()=>a(null)});case"fruitPicking":return f.jsx(VI,{onClose:()=>a(null)});case"targetShooting":return f.jsx(KI,{onClose:()=>a(null)});case"racing":return f.jsx($I,{onClose:()=>a(null)});case"rhythm":return f.jsx(GI,{onClose:()=>a(null)});default:return null}})()}):f.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[f.jsxs("div",{style:{textAlign:"center",marginBottom:"clamp(20px, 4vw, 40px)",marginTop:window.innerWidth<=768?"clamp(80px, 12vw, 100px)":"clamp(60px, 8vw, 80px)"},children:[f.jsx("h1",{style:{color:"#fff",fontSize:"clamp(1.5rem, 4vw, 2.5rem)",fontWeight:"bold",marginBottom:"10px",textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:y("title")}),f.jsx("p",{style:{color:"#fff",fontSize:"clamp(0.8rem, 2vw, 1rem)",opacity:.9,textShadow:"1px 1px 2px rgba(0,0,0,0.3)"},children:y("subtitle")})]}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"clamp(15px, 3vw, 30px)",padding:"clamp(10px, 2vw, 20px)"},children:b.map(e=>f.jsxs("div",{onClick:()=>a(e.id),style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",border:`3px solid ${e.color}`,position:"relative",overflow:"hidden"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-5px)",e.currentTarget.style.boxShadow="0 12px 40px rgba(0,0,0,0.2)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 8px 32px rgba(0,0,0,0.1)"},children:[f.jsx("div",{style:{fontSize:"clamp(3rem, 8vw, 4rem)",marginBottom:"20px",filter:"drop-shadow(2px 2px 4px rgba(0,0,0,0.2))"},children:e.icon}),f.jsx("h3",{style:{color:e.color,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",marginBottom:"15px"},children:e.title}),f.jsx("p",{style:{color:"#666",fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.5"},children:e.description}),f.jsx("button",{style:{background:e.color,color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(20px, 4vw, 30px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",fontWeight:"bold",marginTop:"20px",cursor:"pointer",transition:"all 0.3s ease"},children:y("start")})]},e.id))})]})]})}function UI({onClose:t}){const{lang:n}=mw(),[i,r]=e.useState([]),[a,o]=e.useState(0),[s,l]=e.useState("carrot"),[c,d]=e.useState(!1),u=e=>{var t;const i={"zh-TW":{title:"生活農場",rules:"遊戲規則",hideRules:"隱藏規則",seedSelection:"種子選擇：",score:"分數",gameRules:"遊戲規則",plantStage:"種植階段：",harvestStage:"收穫階段：",plantStep1:"1. 選擇種子（6種作物可選）",plantStep2:"2. 點擊空地種植 → 獲得種植分數",plantStep3:"3. 作物會自動生長（幼苗→成熟）",harvestStep1:"1. 點擊成熟的作物進行收穫",harvestStep2:"2. 收穫後獲得更高分數",harvestStep3:"3. 空地可以重新種植",scoring:"計分系統：",scoring1:"• 種植分數：10-25分（根據作物類型）",scoring2:"• 收穫分數：50-125分（根據作物類型）",scoring3:"• 作物生長時間：3-8秒",plant:"種植",harvest:"收穫",growthTime:"生長時間",seconds:"秒",carrot:"胡蘿蔔",tomato:"番茄",corn:"玉米",potato:"馬鈴薯",strawberry:"草莓",watermelon:"西瓜"},"zh-CN":{title:"生活农场",rules:"游戏规则",hideRules:"隐藏规则",seedSelection:"种子选择：",score:"分数",gameRules:"游戏规则",plantStage:"种植阶段：",harvestStage:"收获阶段：",plantStep1:"1. 选择种子（6种作物可选）",plantStep2:"2. 点击空地种植 → 获得种植分数",plantStep3:"3. 作物会自动生长（幼苗→成熟）",harvestStep1:"1. 点击成熟的作物进行收获",harvestStep2:"2. 收获后获得更高分数",harvestStep3:"3. 空地可以重新种植",scoring:"计分系统：",scoring1:"• 种植分数：10-25分（根据作物类型）",scoring2:"• 收获分数：50-125分（根据作物类型）",scoring3:"• 作物生长时间：3-8秒",plant:"种植",harvest:"收获",growthTime:"生长时间",seconds:"秒",carrot:"胡萝卜",tomato:"番茄",corn:"玉米",potato:"马铃薯",strawberry:"草莓",watermelon:"西瓜"},en:{title:"Life Farm",rules:"Game Rules",hideRules:"Hide Rules",seedSelection:"Seed Selection:",score:"Score",gameRules:"Game Rules",plantStage:"Planting Stage:",harvestStage:"Harvest Stage:",plantStep1:"1. Select seeds (6 crop types available)",plantStep2:"2. Click empty plots to plant → Get planting score",plantStep3:"3. Crops grow automatically (seedling→mature)",harvestStep1:"1. Click mature crops to harvest",harvestStep2:"2. Get higher score after harvest",harvestStep3:"3. Empty plots can be replanted",scoring:"Scoring System:",scoring1:"• Planting score: 10-25 points (by crop type)",scoring2:"• Harvest score: 50-125 points (by crop type)",scoring3:"• Growth time: 3-8 seconds",plant:"Plant",harvest:"Harvest",growthTime:"Growth Time",seconds:"seconds",carrot:"Carrot",tomato:"Tomato",corn:"Corn",potato:"Potato",strawberry:"Strawberry",watermelon:"Watermelon"},ja:{title:"ライフファーム",rules:"ゲームルール",hideRules:"ルールを隠す",seedSelection:"種子選択：",score:"スコア",gameRules:"ゲームルール",plantStage:"植栽段階：",harvestStage:"収穫段階：",plantStep1:"1. 種子を選択（6種類の作物）",plantStep2:"2. 空き地をクリックして植栽 → 植栽スコア獲得",plantStep3:"3. 作物は自動で成長（苗→成熟）",harvestStep1:"1. 成熟した作物をクリックして収穫",harvestStep2:"2. 収穫後により高いスコア獲得",harvestStep3:"3. 空き地は再植栽可能",scoring:"スコアシステム：",scoring1:"• 植栽スコア：10-25ポイント（作物タイプ別）",scoring2:"• 収穫スコア：50-125ポイント（作物タイプ別）",scoring3:"• 成長時間：3-8秒",plant:"植栽",harvest:"収穫",growthTime:"成長時間",seconds:"秒",carrot:"ニンジン",tomato:"トマト",corn:"トウモロコシ",potato:"ジャガイモ",strawberry:"イチゴ",watermelon:"スイカ"},ko:{title:"라이프 팜",rules:"게임 규칙",hideRules:"규칙 숨기기",seedSelection:"씨앗 선택:",score:"점수",gameRules:"게임 규칙",plantStage:"심기 단계:",harvestStage:"수확 단계:",plantStep1:"1. 씨앗 선택 (6가지 작물)",plantStep2:"2. 빈 땅 클릭하여 심기 → 심기 점수 획득",plantStep3:"3. 작물 자동 성장 (묘목→성숙)",harvestStep1:"1. 성숙한 작물 클릭하여 수확",harvestStep2:"2. 수확 후 더 높은 점수 획득",harvestStep3:"3. 빈 땅 재심기 가능",scoring:"점수 시스템:",scoring1:"• 심기 점수: 10-25점 (작물 타입별)",scoring2:"• 수확 점수: 50-125점 (작물 타입별)",scoring3:"• 성장 시간: 3-8초",plant:"심기",harvest:"수확",growthTime:"성장 시간",seconds:"초",carrot:"당근",tomato:"토마토",corn:"옥수수",potato:"감자",strawberry:"딸기",watermelon:"수박"},vi:{title:"Nông Trại Cuộc Sống",rules:"Luật Chơi",hideRules:"Ẩn Luật",seedSelection:"Chọn Hạt Giống:",score:"Điểm",gameRules:"Luật Chơi",plantStage:"Giai Đoạn Trồng:",harvestStage:"Giai Đoạn Thu Hoạch:",plantStep1:"1. Chọn hạt giống (6 loại cây trồng)",plantStep2:"2. Nhấp vào ô trống để trồng → Nhận điểm trồng",plantStep3:"3. Cây trồng tự động phát triển (mầm→trưởng thành)",harvestStep1:"1. Nhấp vào cây trưởng thành để thu hoạch",harvestStep2:"2. Nhận điểm cao hơn sau thu hoạch",harvestStep3:"3. Ô trống có thể trồng lại",scoring:"Hệ Thống Điểm:",scoring1:"• Điểm trồng: 10-25 điểm (theo loại cây)",scoring2:"• Điểm thu hoạch: 50-125 điểm (theo loại cây)",scoring3:"• Thời gian phát triển: 3-8 giây",plant:"Trồng",harvest:"Thu hoạch",growthTime:"Thời gian phát triển",seconds:"giây",carrot:"Cà Rốt",tomato:"Cà Chua",corn:"Ngô",potato:"Khoai Tây",strawberry:"Dâu Tây",watermelon:"Dưa Hấu"},th:{title:"ฟาร์มชีวิต",rules:"กฎเกม",hideRules:"ซ่อนกฎ",seedSelection:"เลือกเมล็ด:",score:"คะแนน",gameRules:"กฎเกม",plantStage:"ขั้นตอนปลูก:",harvestStage:"ขั้นตอนเก็บเกี่ยว:",plantStep1:"1. เลือกเมล็ด (6 ชนิดพืช)",plantStep2:"2. คลิกที่แปลงว่างเพื่อปลูก → ได้คะแนนปลูก",plantStep3:"3. พืชเติบโตอัตโนมัติ (ต้นกล้า→สุก)",harvestStep1:"1. คลิกพืชที่สุกแล้วเพื่อเก็บเกี่ยว",harvestStep2:"2. ได้คะแนนสูงขึ้นหลังเก็บเกี่ยว",harvestStep3:"3. แปลงว่างสามารถปลูกใหม่ได้",scoring:"ระบบคะแนน:",scoring1:"• คะแนนปลูก: 10-25 คะแนน (ตามชนิดพืช)",scoring2:"• คะแนนเก็บเกี่ยว: 50-125 คะแนน (ตามชนิดพืช)",scoring3:"• เวลาเติบโต: 3-8 วินาที",plant:"ปลูก",harvest:"เก็บเกี่ยว",growthTime:"เวลาเติบโต",seconds:"วินาที",carrot:"แครอท",tomato:"มะเขือเทศ",corn:"ข้าวโพด",potato:"มันฝรั่ง",strawberry:"สตรอเบอร์รี่",watermelon:"แตงโม"},la:{title:"Villa Vitae",rules:"Regulae Ludi",hideRules:"Occulta Regulas",seedSelection:"Selectio Seminis:",score:"Puncta",gameRules:"Regulae Ludi",plantStage:"Stadium Plantandi:",harvestStage:"Stadium Messis:",plantStep1:"1. Elige semina (6 genera culturarum)",plantStep2:"2. Clicca in agros vacuos ad plantandum → Accipe puncta",plantStep3:"3. Culturae crescunt automatice (plantula→maturus)",harvestStep1:"1. Clicca culturas maturas ad messem",harvestStep2:"2. Accipe puncta altiora post messem",harvestStep3:"3. Agri vacui possunt replantari",scoring:"Systema Punctorum:",scoring1:"• Puncta plantandi: 10-25 (secundum genus)",scoring2:"• Puncta messis: 50-125 (secundum genus)",scoring3:"• Tempus crescendi: 3-8 secundis",plant:"Planta",harvest:"Messis",growthTime:"Tempus Crescendi",seconds:"secundis",carrot:"Daucus",tomato:"Lycopersicum",corn:"Zea",potato:"Solanum",strawberry:"Fragaria",watermelon:"Citrullus"},ms:{title:"Ladang Kehidupan",rules:"Peraturan Permainan",hideRules:"Sembunyikan Peraturan",seedSelection:"Pilihan Benih:",score:"Markah",gameRules:"Peraturan Permainan",plantStage:"Peringkat Menanam:",harvestStage:"Peringkat Menuai:",plantStep1:"1. Pilih benih (6 jenis tanaman)",plantStep2:"2. Klik plot kosong untuk menanam → Dapat markah menanam",plantStep3:"3. Tanaman tumbuh secara automatik (anak benih→matang)",harvestStep1:"1. Klik tanaman matang untuk menuai",harvestStep2:"2. Dapat markah lebih tinggi selepas menuai",harvestStep3:"3. Plot kosong boleh ditanam semula",scoring:"Sistem Markah:",scoring1:"• Markah menanam: 10-25 mata (mengikut jenis tanaman)",scoring2:"• Markah menuai: 50-125 mata (mengikut jenis tanaman)",scoring3:"• Masa tumbuh: 3-8 saat",plant:"Tanam",harvest:"Tuai",growthTime:"Masa Tumbuh",seconds:"saat",carrot:"Lobak Merah",tomato:"Tomato",corn:"Jagung",potato:"Kentang",strawberry:"Strawberi",watermelon:"Tembikai"}};return(null==(t=i[n])?void 0:t[e])||i["zh-TW"][e]||e};e.useEffect(()=>{const e=OI("farm");e&&(r(e.plants||[]),o(e.score||0))},[]),e.useEffect(()=>{LI("farm",{plants:i,score:a})},[i,a]);const h=[{id:"carrot",name:"胡蘿蔔",emoji:"🥕",growthTime:3e3,color:"#FF6B35",plantScore:10,harvestScore:50},{id:"tomato",name:"番茄",emoji:"🍅",growthTime:5e3,color:"#FF4444",plantScore:15,harvestScore:75},{id:"corn",name:"玉米",emoji:"🌽",growthTime:7e3,color:"#FFD700",plantScore:20,harvestScore:100},{id:"potato",name:"馬鈴薯",emoji:"🥔",growthTime:4e3,color:"#8B4513",plantScore:12,harvestScore:60},{id:"strawberry",name:"草莓",emoji:"🍓",growthTime:6e3,color:"#FF69B4",plantScore:18,harvestScore:90},{id:"watermelon",name:"西瓜",emoji:"🍉",growthTime:8e3,color:"#FF6347",plantScore:25,harvestScore:125}];return f.jsx("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #90EE90 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",display:"flex",flexDirection:"column",overflow:"hidden"},children:f.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"clamp(200px, 25vw, 250px) 1fr",gap:"clamp(10px, 2vw, 20px)",height:"calc(100% - 60px)",marginTop:"60px",overflow:"visible",minHeight:"0",width:"100%"},children:[f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"15px",padding:"clamp(15px, 3vw, 20px)",height:"fit-content",maxHeight:window.innerWidth<=768?"200px":"100%",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",alignSelf:"start",display:window.innerWidth<=768?"none":"block"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",color:"#333"},children:["🌱 ",u("title")]}),f.jsx("button",{onClick:()=>d(!c),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"4px 12px",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",cursor:"pointer"},children:u(c?"hideRules":"rules")})]}),f.jsxs("div",{style:{marginBottom:"20px"},children:[f.jsx("h4",{style:{marginBottom:"10px",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:u("seedSelection")}),h.map(e=>f.jsxs("div",{onClick:()=>l(e.id),style:{padding:"clamp(8px, 2vw, 10px)",margin:"5px 0",borderRadius:"8px",cursor:"pointer",background:s===e.id?"#e8f5e8":"#f5f5f5",border:s===e.id?"2px solid #4CAF50":"2px solid transparent",fontSize:"clamp(0.9rem, 2vw, 1rem)",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.3s ease"},children:[f.jsx("span",{style:{fontSize:"1.2em"},children:e.emoji}),f.jsx("span",{children:u(e.id)})]},e.id))]}),f.jsx("div",{style:{marginBottom:"20px"},children:f.jsxs("h4",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:[u("score"),"：",a]})}),c&&f.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"12px",marginBottom:"15px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[f.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",u("gameRules"),"："]}),f.jsx("p",{style:{marginBottom:"6px"},children:f.jsx("strong",{children:u("plantStage")})}),f.jsx("p",{style:{marginBottom:"6px"},children:u("plantStep1")}),f.jsx("p",{style:{marginBottom:"6px"},children:u("plantStep2")}),f.jsx("p",{style:{marginBottom:"6px"},children:u("plantStep3")}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsx("strong",{children:u("harvestStage")})}),f.jsx("p",{style:{marginBottom:"6px"},children:u("harvestStep1")}),f.jsx("p",{style:{marginBottom:"6px"},children:u("harvestStep2")}),f.jsx("p",{style:{marginBottom:"6px"},children:u("harvestStep3")}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsx("strong",{children:u("scoring")})}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",u("carrot"),"：",u("plant"),"+10 ",u("harvest"),"+50"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",u("tomato"),"：",u("plant"),"+15 ",u("harvest"),"+75"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",u("corn"),"：",u("plant"),"+20 ",u("harvest"),"+100"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",u("potato"),"：",u("plant"),"+12 ",u("harvest"),"+60"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",u("strawberry"),"：",u("plant"),"+18 ",u("harvest"),"+90"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",u("watermelon"),"：",u("plant"),"+25 ",u("harvest"),"+125"]}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsxs("strong",{children:[u("growthTime"),"："]})}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",u("carrot"),"：3",u("seconds")]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",u("tomato"),"：5",u("seconds")]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",u("corn"),"：7",u("seconds")]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",u("potato"),"：4",u("seconds")]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",u("strawberry"),"：6",u("seconds")]}),f.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",u("watermelon"),"：8",u("seconds")]})]})]}),f.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:window.innerWidth<=768?"clamp(5px, 1vw, 10px)":"clamp(10px, 2vw, 20px)",position:"relative",overflow:"visible",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",zIndex:1,minHeight:"0",width:"100%"},children:[window.innerWidth<=768&&f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",background:"rgba(255,255,255,0.8)",borderRadius:"10px",fontSize:"14px",position:"relative",zIndex:1},children:[f.jsxs("div",{style:{fontWeight:"bold"},children:[u("score"),"：",a]}),f.jsx("div",{style:{display:"flex",gap:"8px"},children:h.map(e=>f.jsx("button",{onClick:()=>l(e.id),style:{padding:"4px 8px",borderRadius:"6px",border:s===e.id?"2px solid #4CAF50":"1px solid #ddd",background:s===e.id?"#e8f5e8":"#fff",cursor:"pointer",fontSize:"12px"},children:e.emoji},e.id))})]}),f.jsx("div",{style:{display:"flex",justifyContent:"center"},children:f.jsx("button",{onClick:()=>d(!c),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"6px 16px",fontSize:"12px",cursor:"pointer"},children:u(c?"hideRules":"rules")})}),c&&f.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"10px",padding:"12px",fontSize:"11px",lineHeight:"1.3",textAlign:"left"},children:[f.jsxs("h4",{style:{marginBottom:"6px",color:"#333"},children:["🎯 ",u("gameRules"),"："]}),f.jsxs("p",{style:{marginBottom:"4px"},children:[f.jsx("strong",{children:"種植："}),"選擇種子 → 點擊空地種植"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:[f.jsx("strong",{children:"收穫："}),"點擊成熟作物收穫"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:[f.jsx("strong",{children:"分數："}),"種植+10~25分，收穫+50~125分"]}),f.jsxs("p",{style:{marginBottom:"4px"},children:[f.jsx("strong",{children:"時間："}),"3~8秒成熟"]})]})]}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(10, 1fr)",gridTemplateRows:"repeat(7, 1fr)",gap:"clamp(5px, 1vw, 10px)",width:"100%",height:"fit-content",minHeight:"0",overflow:"visible"},children:Array.from({length:70},(e,t)=>{const n=t%10,a=Math.floor(t/10),l=((e,t)=>i.find(n=>n.x===e&&n.y===t))(n,a),c=l?h.find(e=>e.id===l.type):null,d=l&&l.growth>=100;return f.jsx("div",{onClick:()=>{l&&d?(e=>{const t=i.find(t=>t.id===e);if(t&&t.growth>=100){const n=h.find(e=>e.id===t.type);r(t=>t.filter(t=>t.id!==e)),o(e=>e+((null==n?void 0:n.harvestScore)||50))}})(l.id):l||((e,t)=>{const n=i.find(n=>n.x===e&&n.y===t);if(n)return;const a=h.find(e=>e.id===s);if(!a)return;const l={id:Date.now(),type:s,growth:0,planted:Date.now(),x:e,y:t};r(e=>[...e,l]),o(e=>e+a.plantScore),setTimeout(()=>{r(e=>e.map(e=>e.id===l.id?{...e,growth:50}:e))},a.growthTime/2),setTimeout(()=>{r(e=>e.map(e=>e.id===l.id?{...e,growth:100}:e))},a.growthTime)})(n,a)},style:{background:l?d?"#4CAF50":"#8BC34A":"#DEB887",border:"2px solid #A0522D",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:l&&!d?"not-allowed":"pointer",fontSize:l?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",transition:"all 0.3s ease",position:"relative",aspectRatio:"1",boxShadow:l?"0 2px 8px rgba(0,0,0,0.2)":"none",opacity:l&&!d?.7:1},children:l?f.jsx("div",{style:{fontSize:d?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",opacity:l.growth/100},children:null==c?void 0:c.emoji}):f.jsx("span",{style:{color:"#8B4513",fontSize:"1.5em"},children:"+"})},t)})})]})]})})}function HI({onClose:t}){const{lang:n}=mw(),[i,r]=e.useState(0),[a,o]=e.useState(30),[s,l]=e.useState(!1),[c,d]=e.useState(null),u=e.useRef({}),h=e=>{var t;const i={"zh-TW":{start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",hits:"擊中",accuracy:"準確率",combo:"連擊",highScore:"最高分",highCombo:"最高連擊",title:"打地鼠",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",finalScore:"最終分數",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",clickMole:"點擊出現的地鼠",getScore:"獲得分數",gameTime:"遊戲時間",seconds:"秒",moleSpeed:"地鼠出現時間會隨等級縮短",baseScore:"基礎分數",points:"分",levelBonus:"等級獎勵",perLevel:"每級",comboBonus:"連擊獎勵",per3Combo:"每3連擊",level1:"1級",level2:"2級",level3:"3級",level4:"4級",molesFaster:"地鼠更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度"},"zh-CN":{start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",hits:"击中",accuracy:"准确率",combo:"连击",highScore:"最高分",highCombo:"最高连击",title:"打地鼠",rules:"游戏规则",close:"关闭",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",clickMole:"点击出现的地鼠",getScore:"获得分数",gameTime:"游戏时间",seconds:"秒",moleSpeed:"地鼠出现时间会随等级缩短",baseScore:"基础分数",points:"分",levelBonus:"等级奖励",perLevel:"每级",comboBonus:"连击奖励",per3Combo:"每3连击",level1:"1级",level2:"2级",level3:"3级",level4:"4级",molesFaster:"地鼠更快",moreFrequent:"更频繁",extremeSpeed:"极限速度"},en:{start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",hits:"Hits",accuracy:"Accuracy",combo:"Combo",highScore:"High Score",highCombo:"High Combo",title:"Whack-a-Mole",rules:"Game Rules",close:"Close",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",clickMole:"Click appearing moles",getScore:"to get points",gameTime:"Game Time",seconds:"seconds",moleSpeed:"Mole appearance time shortens with level",baseScore:"Base Score",points:"points",levelBonus:"Level Bonus",perLevel:"per level",comboBonus:"Combo Bonus",per3Combo:"per 3 combos",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",molesFaster:"moles faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed"},ja:{start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",hits:"ヒット",accuracy:"精度",combo:"コンボ",highScore:"ハイスコア",highCombo:"ハイコンボ",title:"モグラたたき",rules:"ゲームルール",close:"閉じる",basicGameplay:"基本プレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",clickMole:"現れるモグラをクリック",getScore:"してポイントを獲得",gameTime:"ゲーム時間",seconds:"秒",moleSpeed:"モグラの出現時間はレベルに応じて短縮",baseScore:"ベーススコア",points:"ポイント",levelBonus:"レベルボーナス",perLevel:"レベルごと",comboBonus:"コンボボーナス",per3Combo:"3コンボごと",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",molesFaster:"モグラがより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度"},ko:{start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",hits:"타격",accuracy:"정확도",combo:"콤보",highScore:"최고 점수",highCombo:"최고 콤보",title:"두더지 잡기",rules:"게임 규칙",close:"닫기",basicGameplay:"기본 플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",clickMole:"나타나는 두더지를 클릭",getScore:"하여 점수 획득",gameTime:"게임 시간",seconds:"초",moleSpeed:"두더지 출현 시간은 레벨에 따라 단축",baseScore:"기본 점수",points:"점",levelBonus:"레벨 보너스",perLevel:"레벨당",comboBonus:"콤보 보너스",per3Combo:"3콤보당",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",molesFaster:"두더지가 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도"},vi:{start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",hits:"Trúng",accuracy:"Độ Chính Xác",combo:"Combo",highScore:"Điểm Cao Nhất",highCombo:"Combo Cao Nhất",title:"Đập Chuột",rules:"Luật Chơi",close:"Đóng",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",clickMole:"Nhấp vào chuột xuất hiện",getScore:"để nhận điểm",gameTime:"Thời Gian Chơi",seconds:"giây",moleSpeed:"Thời gian xuất hiện chuột rút ngắn theo cấp độ",baseScore:"Điểm Cơ Bản",points:"điểm",levelBonus:"Thưởng Cấp Độ",perLevel:"mỗi cấp",comboBonus:"Thưởng Combo",per3Combo:"mỗi 3 combo",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",molesFaster:"chuột nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn"},th:{start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",hits:"ตีถูก",accuracy:"ความแม่นยำ",combo:"คอมโบ",highScore:"คะแนนสูงสุด",highCombo:"คอมโบสูงสุด",title:"ตีตุ่น",rules:"กฎเกม",close:"ปิด",basicGameplay:"วิธีเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",clickMole:"คลิกตุ่นที่ปรากฏ",getScore:"เพื่อได้คะแนน",gameTime:"เวลาเกม",seconds:"วินาที",moleSpeed:"เวลาปรากฏของตุ่นจะสั้นลงตามระดับ",baseScore:"คะแนนพื้นฐาน",points:"คะแนน",levelBonus:"โบนัสระดับ",perLevel:"ต่อระดับ",comboBonus:"โบนัสคอมโบ",per3Combo:"ต่อ 3 คอมโบ",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",molesFaster:"ตุ่นเร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด"},la:{start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",hits:"Ictus",accuracy:"Accuratio",combo:"Combo",highScore:"Puncta Maxima",highCombo:"Combo Maxima",title:"Talpa Percutere",rules:"Regulae Ludi",close:"Claudere",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Gradus",clickMole:"Clicca talpam apparentem",getScore:"ut puncta accipias",gameTime:"Tempus Ludi",seconds:"secundis",moleSpeed:"Tempus apparentiae talpae cum gradu brevior fit",baseScore:"Puncta Basica",points:"puncta",levelBonus:"Bonus Gradus",perLevel:"per gradum",comboBonus:"Bonus Combo",per3Combo:"per 3 combos",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",molesFaster:"talpae velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema"},ms:{start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",hits:"Pukulan",accuracy:"Ketepatan",combo:"Combo",highScore:"Markah Tertinggi",highCombo:"Combo Tertinggi",title:"Pukul Tikus",rules:"Peraturan Permainan",close:"Tutup",basicGameplay:"Cara Bermain Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",clickMole:"Klik tikus yang muncul",getScore:"untuk dapat markah",gameTime:"Masa Permainan",seconds:"saat",moleSpeed:"Masa kemunculan tikus memendek dengan tahap",baseScore:"Markah Asas",points:"markah",levelBonus:"Bonus Tahap",perLevel:"setiap tahap",comboBonus:"Bonus Combo",per3Combo:"setiap 3 combo",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",molesFaster:"tikus lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau"}};return(null==(t=i[n])?void 0:t[e])||i["zh-TW"][e]||e},[p,m]=e.useState(0),[g,x]=e.useState(1),[y,b]=e.useState(0),[v,k]=e.useState(0),[w,j]=e.useState(!1),[S,T]=e.useState(0),[C,I]=e.useState(0),[B,R]=e.useState(0);e.useEffect(()=>{const e=OI("whackAMole");e&&m(e.highScore||0)},[]),e.useEffect(()=>{i>p&&(m(i),LI("whackAMole",{highScore:i}))},[i,p]),e.useEffect(()=>{const e=y+v;if(e>0){const t=y/e;1===g&&t>=.7?x(2):2===g&&t>=.6?x(3):3===g&&t>=.5&&x(4)}},[y,v,g]);e.useEffect(()=>{},[g]),e.useEffect(()=>{const e=y+v;e>0&&R(Math.round(y/e*100))},[y,v]);return f.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #8B4513 0%, #A0522D 100%)",padding:"clamp(10px, 2vw, 20px)",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[f.jsx("button",{onClick:t,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),f.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px)",marginTop:"clamp(60px, 12vw, 80px)",marginBottom:"clamp(8px, 1.5vw, 15px)",textAlign:"center",width:"100%",maxWidth:"300px"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[f.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",margin:0},children:["🔨 ",h("title")]}),f.jsx("button",{onClick:()=>j(!w),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer"},children:h(w?"close":"rules")})]}),w&&f.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[f.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",h("rules"),"："]}),f.jsx("p",{style:{marginBottom:"6px"},children:f.jsxs("strong",{children:[h("basicGameplay"),"："]})}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",h("clickMole")," 🐹 ",h("getScore")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",h("gameTime"),"：30",h("seconds")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",h("moleSpeed")]}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsxs("strong",{children:[h("scoreSystem"),"："]})}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊到地鼠身上 → +1分"}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失時沒有點擊 → -1分"}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失後才點擊 → -1分"}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊地鼠坑但沒點擊到地鼠 → -1分"}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 從0分開始，無正負限制"}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsxs("strong",{children:[h("levelSystem"),"："]})}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 1級：70%成功 → 2級（地鼠更快）"}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 2級：60%成功 → 3級（更頻繁）"}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 3級：50%成功 → 4級（極限速度）"}),f.jsx("p",{style:{marginBottom:"6px"},children:"• 成功率基於30秒內的成功比率計算"})]}),!w&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[h("score"),"：",i]}),f.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[h("time"),"：",a,"秒"]}),f.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[h("level"),"：",g]})]}),f.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[h("hits"),"：",y]}),f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[h("accuracy"),"：",B,"%"]}),f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[h("combo"),"：",S]})]}),f.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[h("highScore"),"：",p]}),f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[h("highCombo"),"：",C]})]}),f.jsx("div",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",color:"#FF5722",fontWeight:"bold",marginTop:"8px",textAlign:"center"},children:i<0?"😅 負分？地鼠在笑你！":i<50?"🐹 新手地鼠獵人！":i<100?"🎯 有點手感了！":i<200?"⚡ 地鼠殺手！":i<300?"🔥 地鼠剋星！":i<500?"💪 地鼠終結者！":"👑 地鼠之王！"}),!s&&f.jsx("button",{onClick:()=>{let e,t;l(!0),r(0),o(30),x(1),b(0),k(0),T(0),I(0),R(0),d(null),e=setInterval(()=>{o(n=>n<=1?(clearInterval(e),clearInterval(t),l(!1),0):n-1)},1e3),setTimeout(()=>{const e=Math.floor(9*Math.random());d(e);const t=setTimeout(()=>{d(null),k(e=>e+1),r(e=>e-1),T(0)},1===g?900:2===g?700:3===g?500:350);u.current[e]=t},300),t=setInterval(()=>{const e=Math.floor(9*Math.random());d(e);const t=setTimeout(()=>{d(null),k(e=>e+1),r(e=>e-1),T(0)},1===g?900:2===g?700:3===g?500:350);u.current[e]=t},1===g?1100:2===g?900:3===g?700:500)},style:{background:"#FF5722",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(6px, 1.5vw, 8px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2.2vw, 1rem)",fontWeight:"bold",marginTop:"10px",cursor:"pointer",transition:"all 0.3s ease"},children:h(30===a?"start":"restart")})]})]}),!w&&f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"clamp(8px, 1.5vw, 15px)",maxWidth:"300px",width:"100%",marginTop:"10px",padding:"clamp(10px, 2vw, 15px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",boxSizing:"border-box"},children:Array.from({length:9},(e,t)=>f.jsx("div",{onClick:()=>{var e;c===(e=t)?(r(e=>e+1),b(e=>e+1),T(e=>{const t=e+1;return t>C&&I(t),t}),d(null),u.current[e]&&(clearTimeout(u.current[e]),u.current[e]=null)):(r(e=>e-1),T(0))},style:{width:"clamp(60px, 10vw, 80px)",height:"clamp(60px, 10vw, 80px)",background:"#654321",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"3px solid #8B4513",position:"relative",overflow:"hidden"},children:c===t&&f.jsx("div",{style:{position:"absolute",bottom:"0",width:"100%",height:"60%",background:"#8B4513",borderRadius:"50% 50% 0 0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",animation:"molePop 0.3s ease-out",cursor:"pointer"},children:"🐹"})},t))}),f.jsx("style",{children:"\n        @keyframes molePop {\n          0% { transform: translateY(100%); }\n          100% { transform: translateY(0); }\n        }\n        \n        @keyframes whack {\n          0% { transform: scale(1); }\n          50% { transform: scale(0.8); }\n          100% { transform: scale(1); }\n        }\n        \n        @keyframes scorePop {\n          0% { opacity: 0; transform: translateY(0); }\n          50% { opacity: 1; transform: translateY(-20px); }\n          100% { opacity: 0; transform: translateY(-40px); }\n        }\n      "})]})}function VI({onClose:t}){const{lang:n}=mw(),[i,r]=e.useState(0),[a,o]=e.useState([]),s=e=>{var t;const i={"zh-TW":{title:"採水果",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",collected:"收集",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",tips:"技巧提示",newFeatures:"新增功能",gameOver:"遊戲結束",clickFruit:"點擊掉落的水果收集分數",putFruitInBasket:"把採到的水果裝進下面的水果籃裡",gameTime:"遊戲時間",seconds:"秒",fruitSpeed:"水果會不定向掉落且速度加快",apple:"蘋果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1級",level2:"2級",level3:"3級",level4:"4級",fruitFaster:"水果更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度",prioritizeHighScore:"優先收集高分水果",stayFocused:"保持專注，快速反應",buildHighScore:"建立高分記錄",fruitFromFourDirections:"水果會從四個方向隨機出現",curvedTrajectory:"水果掉落時會呈現彎曲動線",realTimeFeedback:"遊戲中會顯示即時收集反饋",detailedStats:"遊戲結束時顯示詳細統計",fixedBasketPosition:"籃子位置完全固定不震動",increasedFrequency:"水果出現頻率大幅提升"},"zh-CN":{title:"采水果",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",collected:"收集",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",tips:"技巧提示",newFeatures:"新增功能",clickFruit:"点击掉落的水果收集分数",putFruitInBasket:"把采到的水果装进下面的水果篮里",gameTime:"游戏时间",seconds:"秒",fruitSpeed:"水果会不定向掉落且速度加快",apple:"苹果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1级",level2:"2级",level3:"3级",level4:"4级",fruitFaster:"水果更快",moreFrequent:"更频繁",extremeSpeed:"极限速度",prioritizeHighScore:"优先收集高分水果",stayFocused:"保持专注，快速反应",buildHighScore:"建立高分记录",fruitFromFourDirections:"水果会从四个方向随机出现",curvedTrajectory:"水果掉落时会呈现弯曲动线",realTimeFeedback:"游戏中会显示即时收集反馈",detailedStats:"游戏结束时显示详细统计",fixedBasketPosition:"篮子位置完全固定不震动",increasedFrequency:"水果出现频率大幅提升"},en:{title:"Fruit Picking",start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",collected:"Collected",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",tips:"Tips",newFeatures:"New Features",clickFruit:"Click falling fruit to collect points",putFruitInBasket:"Put collected fruit into the basket below",gameTime:"Game Time",seconds:"seconds",fruitSpeed:"Fruit will fall randomly and speed up",apple:"Apple",orange:"Orange",banana:"Banana",strawberry:"Strawberry",grape:"Grape",peach:"Peach",points:"points",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",fruitFaster:"fruit faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed",prioritizeHighScore:"Prioritize high-score fruits",stayFocused:"Stay focused, react quickly",buildHighScore:"Build high score records",fruitFromFourDirections:"Fruit appears from four directions randomly",curvedTrajectory:"Fruit falls with curved trajectories",realTimeFeedback:"Real-time collection feedback during game",detailedStats:"Detailed statistics when game ends",fixedBasketPosition:"Basket position completely fixed without vibration",increasedFrequency:"Significantly increased fruit appearance frequency"},ja:{title:"フルーツ収穫",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",collected:"収穫",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",basicGameplay:"基本ゲームプレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",tips:"ヒント",newFeatures:"新機能",clickFruit:"落ちる果物をクリックしてポイントを獲得",putFruitInBasket:"収穫した果物を下のバスケットに入れる",gameTime:"ゲーム時間",seconds:"秒",fruitSpeed:"果物はランダムに落ちて速度が上がる",apple:"りんご",orange:"みかん",banana:"バナナ",strawberry:"いちご",grape:"ぶどう",peach:"もも",points:"ポイント",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",fruitFaster:"果物がより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度",prioritizeHighScore:"高得点の果物を優先",stayFocused:"集中して素早く反応",buildHighScore:"高得点記録を築く",fruitFromFourDirections:"果物は4方向からランダムに出現",curvedTrajectory:"果物は曲線軌道で落下",realTimeFeedback:"ゲーム中のリアルタイム収穫フィードバック",detailedStats:"ゲーム終了時の詳細統計",fixedBasketPosition:"バスケット位置は完全固定で震動なし",increasedFrequency:"果物出現頻度が大幅に向上"},ko:{title:"과일 수확",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",collected:"수확",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",basicGameplay:"기본 게임플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",tips:"팁",newFeatures:"새 기능",clickFruit:"떨어지는 과일을 클릭하여 점수 획득",putFruitInBasket:"수확한 과일을 아래 바구니에 넣기",gameTime:"게임 시간",seconds:"초",fruitSpeed:"과일이 무작위로 떨어지고 속도가 빨라짐",apple:"사과",orange:"귤",banana:"바나나",strawberry:"딸기",grape:"포도",peach:"복숭아",points:"점",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",fruitFaster:"과일이 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도",prioritizeHighScore:"고점수 과일 우선 수집",stayFocused:"집중하고 빠르게 반응",buildHighScore:"고점수 기록 구축",fruitFromFourDirections:"과일이 네 방향에서 무작위로 나타남",curvedTrajectory:"과일이 곡선 궤적으로 떨어짐",realTimeFeedback:"게임 중 실시간 수확 피드백",detailedStats:"게임 종료 시 상세 통계",fixedBasketPosition:"바구니 위치 완전 고정으로 진동 없음",increasedFrequency:"과일 출현 빈도 대폭 증가"},vi:{title:"Hái Trái Cây",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",collected:"Thu Hoạch",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",tips:"Mẹo",newFeatures:"Tính Năng Mới",clickFruit:"Nhấp vào trái cây rơi để nhận điểm",putFruitInBasket:"Đặt trái cây thu hoạch vào giỏ bên dưới",gameTime:"Thời Gian Chơi",seconds:"giây",fruitSpeed:"Trái cây sẽ rơi ngẫu nhiên và tăng tốc",apple:"Táo",orange:"Cam",banana:"Chuối",strawberry:"Dâu tây",grape:"Nho",peach:"Đào",points:"điểm",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",fruitFaster:"trái cây nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn",prioritizeHighScore:"Ưu tiên trái cây điểm cao",stayFocused:"Tập trung, phản ứng nhanh",buildHighScore:"Xây dựng kỷ lục điểm cao",fruitFromFourDirections:"Trái cây xuất hiện từ bốn hướng ngẫu nhiên",curvedTrajectory:"Trái cây rơi theo quỹ đạo cong",realTimeFeedback:"Phản hồi thu hoạch thời gian thực trong game",detailedStats:"Thống kê chi tiết khi kết thúc game",fixedBasketPosition:"Vị trí giỏ hoàn toàn cố định không rung",increasedFrequency:"Tần suất xuất hiện trái cây tăng đáng kể"},th:{title:"เก็บผลไม้",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",collected:"เก็บ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",basicGameplay:"การเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",tips:"เคล็ดลับ",newFeatures:"คุณสมบัติใหม่",clickFruit:"คลิกผลไม้ที่ตกลงมาเพื่อได้คะแนน",putFruitInBasket:"ใส่ผลไม้ที่เก็บได้ลงในตะกร้าข้างล่าง",gameTime:"เวลาเกม",seconds:"วินาที",fruitSpeed:"ผลไม้จะตกลงมาแบบสุ่มและเร็วขึ้น",apple:"แอปเปิ้ล",orange:"ส้ม",banana:"กล้วย",strawberry:"สตรอเบอร์รี่",grape:"องุ่น",peach:"พีช",points:"คะแนน",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",fruitFaster:"ผลไม้เร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด",prioritizeHighScore:"ให้ความสำคัญกับผลไม้คะแนนสูง",stayFocused:"มีสมาธิและตอบสนองเร็ว",buildHighScore:"สร้างสถิติคะแนนสูง",fruitFromFourDirections:"ผลไม้ปรากฏจากสี่ทิศทางแบบสุ่ม",curvedTrajectory:"ผลไม้ตกลงมาด้วยวิถีโค้ง",realTimeFeedback:"การตอบสนองการเก็บเกี่ยวแบบเรียลไทม์ในเกม",detailedStats:"สถิติรายละเอียดเมื่อเกมจบ",fixedBasketPosition:"ตำแหน่งตะกร้าคงที่โดยไม่สั่น",increasedFrequency:"ความถี่การปรากฏของผลไม้เพิ่มขึ้นอย่างมาก"},la:{title:"Fructus Colligere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",collected:"Collecta",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Graduum",tips:"Consilia",newFeatures:"Facultates Novae",clickFruit:"Clicca fructus cadentes ut puncta accipias",putFruitInBasket:"Pone fructus collectos in corbem infra",gameTime:"Tempus Ludi",seconds:"secundis",fruitSpeed:"Fructus cadent temere et velocitate crescente",apple:"Malum",orange:"Aurantium",banana:"Musa",strawberry:"Fragum",grape:"Uva",peach:"Persicum",points:"puncta",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",fruitFaster:"fructus velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema",prioritizeHighScore:"Prioritiza fructus punctis altis",stayFocused:"Mane attentus, reage celeriter",buildHighScore:"Aedifica puncta alta",fruitFromFourDirections:"Fructus apparent ex quattuor directionibus temere",curvedTrajectory:"Fructus cadunt cum trajectoriis curvis",realTimeFeedback:"Feedback collectionis tempore reali in ludo",detailedStats:"Statisticae detaillatae cum ludus finitur",fixedBasketPosition:"Positio corbis omnino fixa sine vibratione",increasedFrequency:"Frequentia fructuum apparendi multum aucta"},ms:{title:"Kutip Buah",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",collected:"Kutip",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",basicGameplay:"Permainan Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",tips:"Petua",newFeatures:"Ciri Baharu",clickFruit:"Klik buah yang jatuh untuk dapat markah",putFruitInBasket:"Letakkan buah yang dikutip ke dalam bakul di bawah",gameTime:"Masa Permainan",seconds:"saat",fruitSpeed:"Buah akan jatuh secara rawak dan laju bertambah",apple:"Epal",orange:"Oren",banana:"Pisang",strawberry:"Strawberi",grape:"Anggur",peach:"Pic",points:"markah",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",fruitFaster:"buah lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau",prioritizeHighScore:"Utamakan buah markah tinggi",stayFocused:"Kekal fokus, bertindak pantas",buildHighScore:"Bina rekod markah tinggi",fruitFromFourDirections:"Buah muncul dari empat arah secara rawak",curvedTrajectory:"Buah jatuh dengan trajektori melengkung",realTimeFeedback:"Maklum balas kutipan masa nyata semasa permainan",detailedStats:"Statistik terperinci apabila permainan tamat",fixedBasketPosition:"Kedudukan bakul tetap sepenuhnya tanpa getaran",increasedFrequency:"Kekerapan kemunculan buah meningkat dengan ketara"}};return(null==(t=i[n])?void 0:t[e])||i["zh-TW"][e]||e},[l,c]=e.useState([]),[d,u]=e.useState({}),[h,p]=e.useState([]),[m,g]=e.useState(0),[x,y]=e.useState(!1),[b,v]=e.useState(30),[k,w]=e.useState(!1),[j,S]=e.useState(1),[T,C]=e.useState(0);e.useEffect(()=>{const e=OI("fruitPicking");e&&g(e.highScore||0)},[]),e.useEffect(()=>{if(!k||0===a.length)return;const e=setInterval(()=>{o(e=>e.map(e=>{const t=e.curveOffset||0,n=e.curveSpeed||.05,i=.001*Date.now(),r=4*Math.sin(i*n+t),a=2*Math.cos(i*n+t),o=2*Math.sin(i*n*2+t),s=1*Math.cos(i*n*1.5+t),l=r+o+3*Math.sin(i*n*.5+t),c=a+s;return{...e,y:e.y+(e.directionY||e.speed||1)+c,x:e.x+(e.directionX||e.direction||0)+l}}).filter(e=>e.y>-20&&e.y<120&&e.x>-20&&e.x<120))},100);return()=>clearInterval(e)},[k,a.length]),e.useEffect(()=>{i>m&&(g(i),LI("fruitPicking",{highScore:i}))},[i,m]),e.useEffect(()=>{i>=100&&1===j?S(2):i>=250&&2===j?S(3):i>=500&&3===j&&S(4)},[i,j]);const I=[{type:"apple",emoji:"🍎",points:10},{type:"orange",emoji:"🍊",points:15},{type:"banana",emoji:"🍌",points:20},{type:"strawberry",emoji:"🍓",points:25},{type:"grape",emoji:"🍇",points:30},{type:"peach",emoji:"🍑",points:35}],B=()=>{const e=I[Math.floor(Math.random()*I.length)],t=1===j?1:2===j?1.5:3===j?2:2.5,n=Math.floor(4*Math.random()),i=Math.random()<.3;let r,a,s,l;switch(n){case 0:default:r=80*Math.random()+10,a=-10,s=.3*(Math.random()-.5),l=t;break;case 1:r=80*Math.random()+10,a=110,s=.3*(Math.random()-.5),l=-t;break;case 2:r=-10,a=80*Math.random()+10,s=t,l=.3*(Math.random()-.5);break;case 3:r=110,a=80*Math.random()+10,s=-t,l=.3*(Math.random()-.5)}const c={id:Date.now()+Math.random(),x:r,y:a,type:e.type,emoji:e.emoji,speed:t,direction:0,directionX:s,directionY:l,curveOffset:Math.random()*Math.PI*2,curveSpeed:.15*Math.random()+.08};if(o(e=>[...e,c]),i){const e=I[Math.floor(Math.random()*I.length)],n=80*Math.random()+10,i=-10,r={id:Date.now()+Math.random()+1,x:n,y:i,type:e.type,emoji:e.emoji,speed:t,direction:0,directionX:.3*(Math.random()-.5),directionY:t,curveOffset:Math.random()*Math.PI*2,curveSpeed:.15*Math.random()+.08};o(e=>[...e,r])}},R=e=>{const t=a.find(t=>t.id===e);if(t){const n=I.find(e=>e.type===t.type);o(t=>t.filter(t=>t.id!==e)),r(e=>{const t=e+((null==n?void 0:n.points)||10);return t>m&&g(t),t}),C(e=>e+1),c(e=>[...e,{type:t.type,emoji:t.emoji}]),u(e=>{const n={...e};return n[t.type]=(n[t.type]||0)+1,n}),p(e=>e.find(e=>e.type===t.type)?e.map(e=>e.type===t.type?{...e,count:e.count+1}:e):[...e,{type:t.type,emoji:t.emoji,count:1}])}};return e.useEffect(()=>{if(h.length>0&&k){const e=setTimeout(()=>{p([])},3e3);return()=>clearTimeout(e)}},[h,k]),f.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",overflow:"hidden",isolation:"isolate"},children:[f.jsx("button",{onClick:t,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:window.innerWidth>=768?"clamp(10px, 2vw, 15px)":"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),f.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(60px, 12vw, 70px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:10,maxWidth:"180px"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[f.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🍎 ",s("title")]}),f.jsx("button",{onClick:()=>y(!x),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:s(x?"hideRules":"rules")})]}),x&&f.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3",maxHeight:"clamp(200px, 40vh, 300px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"#4CAF50 #f0f0f0"},children:[f.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🍎 ",s("rules"),"："]}),f.jsx("p",{style:{marginBottom:"6px"},children:f.jsxs("strong",{children:[s("basicGameplay"),"："]})}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("clickFruit")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("putFruitInBasket")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("gameTime"),"：30",s("seconds")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("fruitSpeed")]}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsxs("strong",{children:[s("scoreSystem"),"："]})}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍎 ",s("apple"),"：10",s("points")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍊 ",s("orange"),"：15",s("points")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍌 ",s("banana"),"：20",s("points")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍓 ",s("strawberry"),"：25",s("points")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍇 ",s("grape"),"：30",s("points")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍑 ",s("peach"),"：35",s("points")]}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsxs("strong",{children:[s("levelSystem"),"："]})}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("level1"),"：100",s("points")," → ",s("level2"),"（",s("fruitFaster"),"）"]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("level2"),"：250",s("points")," → ",s("level3"),"（",s("moreFrequent"),"）"]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("level3"),"：500",s("points")," → ",s("level4"),"（",s("extremeSpeed"),"）"]}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsxs("strong",{children:[s("tips"),"："]})}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("prioritizeHighScore")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("stayFocused")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("buildHighScore")]}),f.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:f.jsxs("strong",{children:[s("newFeatures"),"："]})}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("fruitFromFourDirections")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("curvedTrajectory")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("realTimeFeedback")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("detailedStats")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("fixedBasketPosition")]}),f.jsxs("p",{style:{marginBottom:"6px"},children:["• ",s("increasedFrequency")]})]}),!x&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[s("score"),"：",i]}),f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[s("time"),"：",b,"秒"]}),f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[s("level"),"：",j]})]}),f.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[s("collected"),"：",T,"個"]}),f.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[s("highScore"),"：",m]})]}),f.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:T<5?"😅 新手採果者！":T<10?"🍎 有點手感了！":T<15?"🍊 水果獵人！":T<20?"🍌 採果高手！":T<25?"🍓 水果大師！":"👑 採果之王！"}),!k&&f.jsx("button",{onClick:()=>{let e,t;w(!0),r(0),v(30),S(1),C(0),c([]),o([]),u({}),p([]),e=setInterval(()=>{v(n=>n<=1?(clearInterval(e),clearInterval(t),w(!1),0):n-1)},1e3),setTimeout(()=>{B();t=setInterval(()=>{B(),j>=3&&setTimeout(()=>B(),200),j>=4&&setTimeout(()=>B(),400)},1===j?1200:2===j?800:3===j?600:400)},100)},style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:s(30===b?"start":"restart")})]})]}),!k&&0===b&&f.jsx("div",{style:{position:"absolute",bottom:"clamp(120px, 20vw, 140px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"15px",flexWrap:"wrap",justifyContent:"center",zIndex:10},children:Object.entries(d).map(([e,t])=>{const n=I.find(t=>t.type===e);return f.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[f.jsx("span",{style:{fontSize:"clamp(2rem, 5vw, 3rem)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:null==n?void 0:n.emoji}),f.jsx("span",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(20px, 4vw, 25px)",height:"clamp(20px, 4vw, 25px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:t})]},e)})}),f.jsx("div",{style:{position:"fixed",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:5,width:"clamp(200px, 30vw, 250px)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden",contain:"layout style paint",isolation:"isolate"},children:f.jsx("div",{style:{background:"#8B4513",width:"clamp(150px, 25vw, 200px)",height:"clamp(75px, 12vw, 100px)",borderRadius:"50% 50% 0 0",border:"4px solid #654321",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",overflow:"hidden",position:"relative",zIndex:6,pointerEvents:"none",transform:"translateZ(0)",willChange:"auto",userSelect:"none",touchAction:"none",backfaceVisibility:"hidden",perspective:"none",transformStyle:"flat",contain:"layout style paint",isolation:"isolate"},children:l.length>0?f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:"2px",maxWidth:"90%",maxHeight:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden"},children:[h.slice(-4).map((e,t)=>f.jsxs("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",position:"relative"},children:[e.emoji,f.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(12px, 2.5vw, 16px)",height:"clamp(12px, 2.5vw, 16px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.5rem, 1.2vw, 0.7rem)",fontWeight:"bold"},children:e.count})]},t)),0===h.length&&l.slice(-6).map((e,t)=>f.jsx("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)"},children:e.emoji},t)),l.length>6&&0===h.length&&f.jsxs("span",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",color:"#fff"},children:["+",l.length-6]})]}):f.jsx("span",{style:{color:"#654321"},children:"🧺"})})}),a.map(e=>f.jsx("div",{onClick:t=>{t.stopPropagation(),t.preventDefault(),R(e.id)},onTouchStart:t=>{t.stopPropagation(),t.preventDefault(),R(e.id)},style:{position:"absolute",left:`${e.x}%`,top:`${e.y}%`,fontSize:"clamp(1.5rem, 4vw, 2rem)",cursor:"pointer",userSelect:"none",transition:"all 0.1s ease",zIndex:20,touchAction:"manipulation",willChange:"transform",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:e.emoji},e.id))]})}function KI({onClose:t}){const{lang:n}=mw(),[i,r]=e.useState(!1),[a,o]=e.useState(0),s=e=>{var t;const i={"zh-TW":{title:"情緒泡泡爆破",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",combo:"連擊",accuracy:"準確率",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",gameOver:"遊戲結束",soundOn:"音效開",soundOff:"音效關",rhythmGame:"音樂節奏",gameplay:"遊戲玩法",clickStartButton:"點擊「開始遊戲」按鈕",preciseBubblePop:"精準戳破泡泡",computer:"電腦",preciseClickCenter:"精準點擊泡泡中心戳破",mobile:"手機",preciseTouchCenter:"精準觸摸泡泡中心戳破",highAccuracyRequired:"需要高精準度，點擊泡泡邊緣無效",fastBubbles:"快速泡泡",harderToPop:"更難戳破，需要更高精準度",slowBubbles:"慢速泡泡",easierToPop:"相對容易戳破",emotionBubbleScore:"情緒泡泡分數",angryBubble:"憤怒泡泡",anxiousBubble:"焦慮泡泡",depressedBubble:"憂鬱泡泡",stressedBubble:"壓力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮喪泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸彈泡泡",clearAllNearby:"清除周圍所有泡泡",goldenBubble:"金色泡泡",doubleScore:"雙倍分數",ghostBubble:"幽靈泡泡",clickTwice:"需要點擊兩次",chainBubble:"連鎖泡泡",clearSameType:"清除同類型泡泡",timeBubble:"時間泡泡",add5Seconds:"增加5秒時間",accuracySystem:"精準度系統",above:"以上",triggerPowerMode:"觸發能量模式",goodAccuracy:"良好精準度",below:"以下",needImproveAccuracy:"需要提高精準度",powerMode:"能量模式",autoTrigger:"自動觸發",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持續10秒後自動結束",comboSystem:"連擊系統",continuousPopExtraScore:"連續戳破泡泡可獲得額外分數",timeLimit:"時間限制",sixtySecondsHighestScore:"60秒內獲得最高分數",gameGoal:"遊戲目標",precisePopEmotionBubbles:"精準戳破情緒泡泡，釋放內心壓力",accuracyChallenge:"精準度挑戰",onlyClickCenterToPop:"只有點擊泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精準度"},"zh-CN":{title:"情绪泡泡爆破",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",combo:"连击",accuracy:"准确率",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",gameplay:"游戏玩法",clickStartButton:"点击「开始游戏」按钮",preciseBubblePop:"精准戳破泡泡",computer:"电脑",preciseClickCenter:"精准点击泡泡中心戳破",mobile:"手机",preciseTouchCenter:"精准触摸泡泡中心戳破",highAccuracyRequired:"需要高精准度，点击泡泡边缘无效",fastBubbles:"快速泡泡",harderToPop:"更难戳破，需要更高精准度",slowBubbles:"慢速泡泡",easierToPop:"相对容易戳破",emotionBubbleScore:"情绪泡泡分数",angryBubble:"愤怒泡泡",anxiousBubble:"焦虑泡泡",depressedBubble:"忧郁泡泡",stressedBubble:"压力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮丧泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸弹泡泡",clearAllNearby:"清除周围所有泡泡",goldenBubble:"金色泡泡",doubleScore:"双倍分数",ghostBubble:"幽灵泡泡",clickTwice:"需要点击两次",chainBubble:"连锁泡泡",clearSameType:"清除同类型泡泡",timeBubble:"时间泡泡",add5Seconds:"增加5秒时间",accuracySystem:"精准度系统",above:"以上",triggerPowerMode:"触发能量模式",goodAccuracy:"良好精准度",below:"以下",needImproveAccuracy:"需要提高精准度",powerMode:"能量模式",autoTrigger:"自动触发",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持续10秒后自动结束",comboSystem:"连击系统",continuousPopExtraScore:"连续戳破泡泡可获得额外分数",timeLimit:"时间限制",sixtySecondsHighestScore:"60秒内获得最高分数",gameGoal:"游戏目标",precisePopEmotionBubbles:"精准戳破情绪泡泡，释放内心压力",accuracyChallenge:"精准度挑战",onlyClickCenterToPop:"只有点击泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精准度"},en:{title:"Bubble Pop",start:"Start Game",restart:"Restart",score:"Score",time:"Time",combo:"Combo",accuracy:"Accuracy",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",gameplay:"Gameplay",clickStartButton:'Click "Start Game" button',preciseBubblePop:"Precise Bubble Pop",computer:"Computer",preciseClickCenter:"Precisely click bubble center to pop",mobile:"Mobile",preciseTouchCenter:"Precisely touch bubble center to pop",highAccuracyRequired:"High accuracy required, clicking bubble edge is invalid",fastBubbles:"Fast bubbles",harderToPop:"Harder to pop, requires higher accuracy",slowBubbles:"Slow bubbles",easierToPop:"Relatively easier to pop",emotionBubbleScore:"Emotion Bubble Score",angryBubble:"Angry bubble",anxiousBubble:"Anxious bubble",depressedBubble:"Depressed bubble",stressedBubble:"Stressed bubble",irritatedBubble:"Irritated bubble",frustratedBubble:"Frustrated bubble",points:"points",specialBubbles:"Special Bubbles",bombBubble:"Bomb bubble",clearAllNearby:"Clear all nearby bubbles",goldenBubble:"Golden bubble",doubleScore:"Double score",ghostBubble:"Ghost bubble",clickTwice:"Need to click twice",chainBubble:"Chain bubble",clearSameType:"Clear same type bubbles",timeBubble:"Time bubble",add5Seconds:"Add 5 seconds",accuracySystem:"Accuracy System",above:"above",triggerPowerMode:"Trigger power mode",goodAccuracy:"Good accuracy",below:"below",needImproveAccuracy:"Need to improve accuracy",powerMode:"Power Mode",autoTrigger:"Auto trigger",powerModeEasier:"Easier to pop bubbles in power mode",last10Seconds:"Last 10 seconds then auto end",comboSystem:"Combo System",continuousPopExtraScore:"Continuous pop for extra score",timeLimit:"Time Limit",sixtySecondsHighestScore:"60 seconds to get highest score",gameGoal:"Game Goal",precisePopEmotionBubbles:"Precisely pop emotion bubbles, release inner pressure",accuracyChallenge:"Accuracy Challenge",onlyClickCenterToPop:"Only by clicking the center of the bubble can you pop it",fastBubblesNeedHigherAccuracy:"Fast bubbles require higher accuracy"},ja:{title:"バブルポップ",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",combo:"コンボ",accuracy:"精度",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",gameplay:"ゲームプレイ",clickStartButton:"「ゲーム開始」ボタンをクリック",preciseBubblePop:"精密バブルポップ",computer:"パソコン",preciseClickCenter:"バブルの中心を精密にクリックしてポップ",mobile:"モバイル",preciseTouchCenter:"バブルの中心を精密にタッチしてポップ",highAccuracyRequired:"高精度が必要、バブルの端をクリックは無効",fastBubbles:"高速バブル",harderToPop:"ポップしにくい、より高い精度が必要",slowBubbles:"低速バブル",easierToPop:"比較的ポップしやすい",emotionBubbleScore:"感情バブルスコア",angryBubble:"怒りバブル",anxiousBubble:"不安バブル",depressedBubble:"憂鬱バブル",stressedBubble:"ストレスバブル",irritatedBubble:"イライラバブル",frustratedBubble:"フラストレーションバブル",points:"ポイント",specialBubbles:"特殊バブル",bombBubble:"爆弾バブル",clearAllNearby:"周辺のすべてのバブルをクリア",goldenBubble:"ゴールデンバブル",doubleScore:"ダブルスコア",ghostBubble:"ゴーストバブル",clickTwice:"2回クリックが必要",chainBubble:"チェーンバブル",clearSameType:"同じタイプのバブルをクリア",timeBubble:"タイムバブル",add5Seconds:"5秒追加",accuracySystem:"精度システム",above:"以上",triggerPowerMode:"パワーモード発動",goodAccuracy:"良好な精度",below:"以下",needImproveAccuracy:"精度向上が必要",powerMode:"パワーモード",autoTrigger:"自動発動",powerModeEasier:"パワーモードでバブルがポップしやすい",last10Seconds:"10秒間続いて自動終了",comboSystem:"コンボシステム",continuousPopExtraScore:"連続ポップでボーナススコア",timeLimit:"時間制限",sixtySecondsHighestScore:"60秒で最高スコアを獲得",gameGoal:"ゲーム目標",precisePopEmotionBubbles:"感情バブルを精密にポップして、内なる圧力を解放",accuracyChallenge:"精度チャレンジ",onlyClickCenterToPop:"バブルの中心をクリックするだけでポップできる",fastBubblesNeedHigherAccuracy:"高速バブルはより高い精度が必要"},ko:{title:"버블 팝",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",combo:"콤보",accuracy:"정확도",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",gameplay:"게임 플레이",clickStartButton:"「게임 시작」버튼 클릭",preciseBubblePop:"정밀 버블 팝",computer:"컴퓨터",preciseClickCenter:"버블 중심을 정밀하게 클릭하여 팝",mobile:"모바일",preciseTouchCenter:"버블 중심을 정밀하게 터치하여 팝",highAccuracyRequired:"높은 정확도 필요, 버블 가장자리 클릭은 무효",fastBubbles:"빠른 버블",harderToPop:"팝하기 어려움, 더 높은 정확도 필요",slowBubbles:"느린 버블",easierToPop:"상대적으로 팝하기 쉬움",emotionBubbleScore:"감정 버블 점수",angryBubble:"분노 버블",anxiousBubble:"불안 버블",depressedBubble:"우울 버블",stressedBubble:"스트레스 버블",irritatedBubble:"짜증 버블",frustratedBubble:"좌절 버블",points:"점",specialBubbles:"특수 버블",bombBubble:"폭탄 버블",clearAllNearby:"주변 모든 버블 제거",goldenBubble:"골든 버블",doubleScore:"더블 점수",ghostBubble:"고스트 버블",clickTwice:"두 번 클릭 필요",chainBubble:"체인 버블",clearSameType:"같은 타입 버블 제거",timeBubble:"타임 버블",add5Seconds:"5초 추가",accuracySystem:"정확도 시스템",above:"이상",triggerPowerMode:"파워 모드 발동",goodAccuracy:"좋은 정확도",below:"이하",needImproveAccuracy:"정확도 향상 필요",powerMode:"파워 모드",autoTrigger:"자동 발동",powerModeEasier:"파워 모드에서 버블이 팝하기 쉬움",last10Seconds:"10초간 지속 후 자동 종료",comboSystem:"콤보 시스템",continuousPopExtraScore:"연속 팝으로 보너스 점수",timeLimit:"시간 제한",sixtySecondsHighestScore:"60초 내 최고 점수 획득",gameGoal:"게임 목표",precisePopEmotionBubbles:"감정 버블을 정밀하게 팝하여 내면의 압력을 해방",accuracyChallenge:"정확도 챌린지",onlyClickCenterToPop:"버블의 중심을 클릭해야만 팝할 수 있다",fastBubblesNeedHigherAccuracy:"빠른 버블은 더 높은 정확도가 필요하다"},vi:{title:"Bong Bóng Nổ",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",combo:"Combo",accuracy:"Độ Chính Xác",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",gameplay:"Cách Chơi",clickStartButton:'Nhấp vào nút "Bắt Đầu Trò Chơi"',preciseBubblePop:"Bong Bóng Nổ Chính Xác",computer:"Máy tính",preciseClickCenter:"Nhấp chính xác vào trung tâm bong bóng để nổ",mobile:"Điện thoại",preciseTouchCenter:"Chạm chính xác vào trung tâm bong bóng để nổ",highAccuracyRequired:"Cần độ chính xác cao, nhấp vào cạnh bong bóng không hiệu quả",fastBubbles:"Bong bóng nhanh",harderToPop:"Khó nổ hơn, cần độ chính xác cao hơn",slowBubbles:"Bong bóng chậm",easierToPop:"Tương đối dễ nổ",emotionBubbleScore:"Điểm Bong Bóng Cảm Xúc",angryBubble:"Bong bóng giận dữ",anxiousBubble:"Bong bóng lo lắng",depressedBubble:"Bong bóng trầm cảm",stressedBubble:"Bong bóng căng thẳng",irritatedBubble:"Bong bóng khó chịu",frustratedBubble:"Bong bóng thất vọng",points:"điểm",specialBubbles:"Bong Bóng Đặc Biệt",bombBubble:"Bong bóng bom",clearAllNearby:"Xóa tất cả bong bóng gần đó",goldenBubble:"Bong bóng vàng",doubleScore:"Điểm gấp đôi",ghostBubble:"Bong bóng ma",clickTwice:"Cần nhấp hai lần",chainBubble:"Bong bóng chuỗi",clearSameType:"Xóa bong bóng cùng loại",timeBubble:"Bong bóng thời gian",add5Seconds:"Thêm 5 giây",accuracySystem:"Hệ Thống Chính Xác",above:"trên",triggerPowerMode:"Kích hoạt chế độ năng lượng",goodAccuracy:"Độ chính xác tốt",below:"dưới",needImproveAccuracy:"Cần cải thiện độ chính xác",powerMode:"Chế Độ Năng Lượng",autoTrigger:"Tự động kích hoạt",powerModeEasier:"Dễ nổ bong bóng hơn trong chế độ năng lượng",last10Seconds:"Kéo dài 10 giây rồi tự động kết thúc",comboSystem:"Hệ Thống Combo",continuousPopExtraScore:"Nổ liên tục để có điểm thêm",timeLimit:"Giới Hạn Thời Gian",sixtySecondsHighestScore:"60 giây để đạt điểm cao nhất",gameGoal:"Mục Tiêu Trò Chơi",precisePopEmotionBubbles:"Nổ chính xác bong bóng cảm xúc, giải phóng áp lực bên trong",accuracyChallenge:"Thử Thách Độ Chính Xác",onlyClickCenterToPop:"Chỉ bằng cách nhấp vào trung tâm bong bóng mới có thể nổ",fastBubblesNeedHigherAccuracy:"Bong bóng nhanh cần độ chính xác cao hơn"},th:{title:"ป๊อปบับเบิล",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",combo:"คอมโบ",accuracy:"ความแม่นยำ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",gameplay:"วิธีเล่น",clickStartButton:'คลิกปุ่ม "เริ่มเกม"',preciseBubblePop:"ป๊อปบับเบิลอย่างแม่นยำ",computer:"คอมพิวเตอร์",preciseClickCenter:"คลิกตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",mobile:"มือถือ",preciseTouchCenter:"แตะตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",highAccuracyRequired:"ต้องการความแม่นยำสูง การคลิกขอบบับเบิลไม่นับ",fastBubbles:"บับเบิลเร็ว",harderToPop:"ป๊อปยากขึ้น ต้องการความแม่นยำสูงขึ้น",slowBubbles:"บับเบิลช้า",easierToPop:"ค่อนข้างป๊อปง่าย",emotionBubbleScore:"คะแนนบับเบิลอารมณ์",angryBubble:"บับเบิลโกรธ",anxiousBubble:"บับเบิลกังวล",depressedBubble:"บับเบิลเศร้า",stressedBubble:"บับเบิลเครียด",irritatedBubble:"บับเบิลหงุดหงิด",frustratedBubble:"บับเบิลหงุดหงิด",points:"คะแนน",specialBubbles:"บับเบิลพิเศษ",bombBubble:"บับเบิลระเบิด",clearAllNearby:"ลบบับเบิลใกล้เคียงทั้งหมด",goldenBubble:"บับเบิลทอง",doubleScore:"คะแนนสองเท่า",ghostBubble:"บับเบิลผี",clickTwice:"ต้องคลิกสองครั้ง",chainBubble:"บับเบิลโซ่",clearSameType:"ลบบับเบิลประเภทเดียวกัน",timeBubble:"บับเบิลเวลา",add5Seconds:"เพิ่ม 5 วินาที",accuracySystem:"ระบบความแม่นยำ",above:"ขึ้นไป",triggerPowerMode:"เปิดโหมดพลัง",goodAccuracy:"ความแม่นยำดี",below:"ลงมา",needImproveAccuracy:"ต้องปรับปรุงความแม่นยำ",powerMode:"โหมดพลัง",autoTrigger:"เปิดอัตโนมัติ",powerModeEasier:"ป๊อปบับเบิลง่ายขึ้นในโหมดพลัง",last10Seconds:"คงอยู่ 10 วินาทีแล้วปิดอัตโนมัติ",comboSystem:"ระบบคอมโบ",continuousPopExtraScore:"ป๊อปต่อเนื่องเพื่อคะแนนเพิ่ม",timeLimit:"จำกัดเวลา",sixtySecondsHighestScore:"60 วินาทีเพื่อคะแนนสูงสุด",gameGoal:"เป้าหมายเกม",precisePopEmotionBubbles:"ป๊อปบับเบิลอารมณ์อย่างแม่นยำ ปลดปล่อยแรงกดดันภายใน",accuracyChallenge:"ความท้าทายความแม่นยำ",onlyClickCenterToPop:"เฉพาะการคลิกตรงกลางบับเบิลเท่านั้นที่สามารถป๊อปได้",fastBubblesNeedHigherAccuracy:"บับเบิลเร็วต้องการความแม่นยำสูงขึ้น"},la:{title:"Bulla Explodere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",combo:"Combo",accuracy:"Accuratio",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",gameplay:"Ludus",clickStartButton:'Clicca "Ludum Incipere" pugnum',preciseBubblePop:"Bulla Accurata Explodere",computer:"Computatrum",preciseClickCenter:"Clicca accurate centrum bullae ut explodat",mobile:"Mobile",preciseTouchCenter:"Tange accurate centrum bullae ut explodat",highAccuracyRequired:"Accuratio alta requiritur, cliccare marginem bullae invalidum est",fastBubbles:"Bullae veloces",harderToPop:"Difficilius explodere, accuratio altior requiritur",slowBubbles:"Bullae tardae",easierToPop:"Relativiter facilius explodere",emotionBubbleScore:"Puncta Bullae Emotionis",angryBubble:"Bulla irata",anxiousBubble:"Bulla anxia",depressedBubble:"Bulla depressa",stressedBubble:"Bulla pressa",irritatedBubble:"Bulla irritata",frustratedBubble:"Bulla frustrata",points:"puncta",specialBubbles:"Bullae Speciales",bombBubble:"Bulla bomba",clearAllNearby:"Clara omnes bullas proximas",goldenBubble:"Bulla aurea",doubleScore:"Puncta dupla",ghostBubble:"Bulla phantasma",clickTwice:"Opus est bis cliccare",chainBubble:"Bulla catena",clearSameType:"Clara bullas eiusdem generis",timeBubble:"Bulla temporis",add5Seconds:"Adde 5 secundis",accuracySystem:"Systema Accurationis",above:"supra",triggerPowerMode:"Activa modum potentiae",goodAccuracy:"Accuratio bona",below:"infra",needImproveAccuracy:"Opus est accuratio meliorare",powerMode:"Modus Potentiae",autoTrigger:"Auto activa",powerModeEasier:"Facilius explodere bullas in modo potentiae",last10Seconds:"Dura 10 secundis deinde auto finis",comboSystem:"Systema Combo",continuousPopExtraScore:"Explodere continuum pro punctis extra",timeLimit:"Finis Temporis",sixtySecondsHighestScore:"60 secundis pro punctis maximis",gameGoal:"Finis Ludi",precisePopEmotionBubbles:"Explodere accurate bullas emotionis, libera pressionem internam",accuracyChallenge:"Provocatio Accurationis",onlyClickCenterToPop:"Solum cliccare centrum bullae potest explodere",fastBubblesNeedHigherAccuracy:"Bullae veloces accuratio altior requiritur"},ms:{title:"Letup Buih",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",combo:"Combo",accuracy:"Ketepatan",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",gameplay:"Cara Bermain",clickStartButton:'Klik butang "Mulakan Permainan"',preciseBubblePop:"Letup Buih Tepat",computer:"Komputer",preciseClickCenter:"Klik tepat di tengah buih untuk meletup",mobile:"Mudah alih",preciseTouchCenter:"Sentuh tepat di tengah buih untuk meletup",highAccuracyRequired:"Ketepatan tinggi diperlukan, mengklik tepi buih tidak sah",fastBubbles:"Buih pantas",harderToPop:"Lebih sukar untuk meletup, memerlukan ketepatan lebih tinggi",slowBubbles:"Buih perlahan",easierToPop:"Relatif lebih mudah untuk meletup",emotionBubbleScore:"Markah Buih Emosi",angryBubble:"Buih marah",anxiousBubble:"Buih cemas",depressedBubble:"Buih tertekan",stressedBubble:"Buih tertekan",irritatedBubble:"Buih jengkel",frustratedBubble:"Buih kecewa",points:"markah",specialBubbles:"Buih Khas",bombBubble:"Buih bom",clearAllNearby:"Kosongkan semua buih berdekatan",goldenBubble:"Buih emas",doubleScore:"Markah berganda",ghostBubble:"Buih hantu",clickTwice:"Perlu klik dua kali",chainBubble:"Buih rantai",clearSameType:"Kosongkan buih jenis sama",timeBubble:"Buih masa",add5Seconds:"Tambah 5 saat",accuracySystem:"Sistem Ketepatan",above:"ke atas",triggerPowerMode:"Pencetus mod kuasa",goodAccuracy:"Ketepatan baik",below:"ke bawah",needImproveAccuracy:"Perlu tingkatkan ketepatan",powerMode:"Mod Kuasa",autoTrigger:"Pencetus automatik",powerModeEasier:"Lebih mudah meletup buih dalam mod kuasa",last10Seconds:"Bertahan 10 saat kemudian tamat automatik",comboSystem:"Sistem Combo",continuousPopExtraScore:"Letup berterusan untuk markah tambahan",timeLimit:"Had Masa",sixtySecondsHighestScore:"60 saat untuk markah tertinggi",gameGoal:"Matlamat Permainan",precisePopEmotionBubbles:"Letup tepat buih emosi, lepaskan tekanan dalaman",accuracyChallenge:"Cabaran Ketepatan",onlyClickCenterToPop:"Hanya dengan mengklik pusat buih boleh meletup",fastBubblesNeedHigherAccuracy:"Buih pantas memerlukan ketepatan lebih tinggi"}};return(null==(t=i[n])?void 0:t[e])||i["zh-TW"][e]||e},[l,c]=e.useState(60),[d,u]=e.useState(0),[h,p]=e.useState(0),[m,g]=e.useState(!1),[x,y]=e.useState(0),[b,v]=e.useState(!1),[k,w]=e.useState(0),[j,S]=e.useState(0),[T,C]=e.useState(0),[I,B]=e.useState(!1),[R,A]=e.useState(0),[F,z]=e.useState([]),[E,_]=e.useState([]);e.useEffect(()=>{const e=localStorage.getItem("bubblePopHighScore");e&&p(parseInt(e))},[]);const N=[{color:"#ff6b6b",emotion:"😠",points:10,name:"憤怒"},{color:"#4ecdc4",emotion:"😰",points:15,name:"焦慮"},{color:"#ffe66d",emotion:"😔",points:20,name:"憂鬱"},{color:"#a8e6cf",emotion:"😤",points:25,name:"壓力"},{color:"#ff8a80",emotion:"😡",points:30,name:"暴躁"},{color:"#9575cd",emotion:"😞",points:35,name:"沮喪"}],[P]=e.useState((()=>{const e=["戳破煩惱，釋放心情！","泡泡爆破，壓力全消！","情緒泡泡，一戳就爆！","連擊模式，心情舒暢！","泡泡療法，治癒心靈！"];return e[Math.floor(Math.random()*e.length)]})()),D=()=>{r(!0),o(0),c(60),u(0),z([]),_([]),w(0),S(0),C(0),B(!1),A(0)},W=e=>{const t=F.find(t=>t.id===e);if(!t)return;const n=5*Math.floor(d/5);let i=t.points+n;if("bomb"===t.type){const n=F.filter(n=>n.id!==e&&Math.sqrt((n.x-t.x)**2+(n.y-t.y)**2)<15);n.forEach(e=>{i+=e.points,u(e=>e+1)}),z(t=>t.filter(t=>t.id!==e&&!n.find(e=>e.id===t.id)))}else if("golden"===t.type)i*=2,z(t=>t.filter(t=>t.id!==e));else if("ghost"===t.type){if(t.health&&t.health>1)return void z(t=>t.map(t=>t.id===e?{...t,health:t.health-1}:t));z(t=>t.filter(t=>t.id!==e))}else if("chain"===t.type){const n=F.filter(n=>n.id!==e&&n.chainId===t.chainId);n.forEach(e=>{i+=e.points,u(e=>e+1)}),z(t=>t.filter(t=>t.id!==e&&!n.find(e=>e.id===t.id)))}else"time"===t.type?(c(e=>e+(t.timeBonus||5)),z(t=>t.filter(t=>t.id!==e))):z(t=>t.filter(t=>t.id!==e));o(e=>e+i),u(e=>e+1),y(3),d>=4&&(v(!0),H(),setTimeout(()=>v(!1),1e3));const r="bomb"===t.type?15:8,a=[];for(let o=0;o<r;o++){const e=o/r*Math.PI*2,n=2+3*Math.random();a.push({id:Date.now()+o,x:t.x,y:t.y,vx:Math.cos(e)*n,vy:Math.sin(e)*n,color:t.color,life:1})}_(e=>[...e,...a])};e.useEffect(()=>{if(!i)return;const e=setInterval(()=>{const e=.03+.001*(60-l),t=Math.min(.15,1.8*e);Math.random()<t&&(()=>{if(!i)return;const e=N[Math.floor(Math.random()*N.length)],t=80*Math.random()+10,n=80*Math.random()+10,r=Math.random();let a;a=r<.3?10*Math.random()+15:r<.6?15*Math.random()+25:r<.85?20*Math.random()+40:25*Math.random()+60;const o=Math.random();let s="normal",l=e.points,c=e.color,d=e.emotion;if(o<.05)s="bomb",l=50,c="#ff4757",d="💣",a=15*Math.random()+45;else if(o<.1)s="golden",l=100,c="#ffa502",d="⭐",a=20*Math.random()+50;else{if(o<.15)return s="ghost",l=30,c="#a4b0be",d="👻",a=10*Math.random()+20,{id:Date.now(),x:t,y:n,size:a,color:c,emotion:d,points:l,speed:3*Math.random()+2,opacity:.8+.2*Math.random(),type:s,health:2};o<.2?(s="chain",l=40,c="#2ed573",d="🔗",a=15*Math.random()+35):o<.25&&(s="time",l=25,c="#3742fa",d="⏰",a=12*Math.random()+25)}const u={id:Date.now(),x:t,y:n,size:a,color:c,emotion:d,points:l,speed:3*Math.random()+1.5,opacity:.8+.2*Math.random(),type:s,chainId:"chain"===s?Math.floor(1e3*Math.random()):void 0,timeBonus:"time"===s?5:void 0};z(e=>[...e,u])})(),z(e=>e.map(e=>({...e,y:e.y-1.2*e.speed,opacity:e.opacity-.003,x:e.x+.4*(Math.random()-.5)})).filter(e=>e.y>-10&&e.opacity>.1)),_(e=>e.map(e=>({...e,x:e.x+e.vx,y:e.y+e.vy,vy:e.vy+.1,life:e.life-.02})).filter(e=>e.life>0)),x>0?y(e=>e-.05):d>0&&u(0),R>0?A(e=>e-.05):I&&B(!1)},30);return()=>clearInterval(e)},[i]),e.useEffect(()=>{if(!i||l<=0)return;const e=setInterval(()=>{c(e=>e<=1?(r(!1),a>h&&(p(a),localStorage.setItem("bubblePopHighScore",a.toString())),0):e-1)},1e3);return()=>clearInterval(e)},[i,l]),e.useEffect(()=>{},[i,F]);const[M,L]=e.useState(null),[O,q]=e.useState(!0);e.useEffect(()=>{if("undefined"!=typeof window&&window.AudioContext){const e=new AudioContext;L(e)}},[]);const U=()=>{if(M&&O)try{const e=M.createOscillator(),t=M.createGain();e.connect(t),t.connect(M.destination),e.type="sine",e.frequency.setValueAtTime(800,M.currentTime),e.frequency.exponentialRampToValueAtTime(200,M.currentTime+.1),t.gain.setValueAtTime(.3,M.currentTime),t.gain.exponentialRampToValueAtTime(.01,M.currentTime+.1),e.start(M.currentTime),e.stop(M.currentTime+.1)}catch(e){}},H=()=>{if(M&&O)try{const e=M.createOscillator(),t=M.createGain();e.connect(t),t.connect(M.destination),e.type="square",e.frequency.setValueAtTime(1e3,M.currentTime),e.frequency.exponentialRampToValueAtTime(400,M.currentTime+.2),t.gain.setValueAtTime(.2,M.currentTime),t.gain.exponentialRampToValueAtTime(.01,M.currentTime+.2),e.start(M.currentTime),e.stop(M.currentTime+.2)}catch(e){}},V=()=>{if(M&&O)try{const e=M.createOscillator(),t=M.createGain();e.connect(t),t.connect(M.destination),e.type="sawtooth",e.frequency.setValueAtTime(600,M.currentTime),e.frequency.exponentialRampToValueAtTime(1200,M.currentTime+.3),t.gain.setValueAtTime(.15,M.currentTime),t.gain.exponentialRampToValueAtTime(.01,M.currentTime+.3),e.start(M.currentTime),e.stop(M.currentTime+.3)}catch(e){}};return f.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"auto",cursor:i?"pointer":"default",touchAction:"pan-y",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onClick:e=>{e.preventDefault(),e.stopPropagation()},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},children:[f.jsx("style",{children:"\n          @keyframes float {\n            0%, 100% { transform: translate(-50%, -50%) translateY(0px); }\n            50% { transform: translate(-50%, -50%) translateY(-10px); }\n          }\n          @keyframes comboEffect {\n            0% { \n              transform: translate(-50%, -50%) scale(0.5);\n              opacity: 0;\n            }\n            50% { \n              transform: translate(-50%, -50%) scale(1.2);\n              opacity: 1;\n            }\n            100% { \n              transform: translate(-50%, -50%) scale(1);\n              opacity: 0;\n            }\n          }\n          @keyframes powerMode {\n            0% { \n              opacity: 0.7;\n              textShadow: 0 0 5px #FF5722;\n            }\n            100% { \n              opacity: 1;\n              textShadow: 0 0 15px #FF5722, 0 0 25px #FF5722;\n            }\n          }\n          @keyframes popEffect {\n            0% { \n              transform: translate(-50%, -50%) scale(1);\n              opacity: 1;\n            }\n            50% { \n              transform: translate(-50%, -50%) scale(1.3);\n              opacity: 0.8;\n            }\n            100% { \n              transform: translate(-50%, -50%) scale(0);\n              opacity: 0;\n            }\n          }\n        "}),f.jsx("button",{onClick:t,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:10,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),f.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:5,maxWidth:"180px"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[f.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🫧 ",s("title")]}),f.jsx("button",{onClick:()=>g(!m),style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:s(m?"hideRules":"rules")})]}),!m&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[s("score"),"：",a]}),f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[s("time"),"：",l,"秒"]}),f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:d>=5?"#ff6b6b":d>=3?"#ffa502":"#333",fontWeight:d>=3?"bold":"normal"},children:[s("combo"),"：",d]})]}),f.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:k>=80?"#4CAF50":k>=60?"#FF9800":"#F44336"},children:[s("accuracy"),"：",k.toFixed(1),"%"]}),I&&f.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",animation:"powerMode 0.5s ease-in-out infinite alternate"},children:"⚡能量模式"})]}),f.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[f.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:["泡泡：",F.length]}),f.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[s("highScore"),"：",h]}),f.jsx("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)",color:F.some(e=>e.speed>=3)?"#ff6b6b":F.some(e=>e.speed>=2)?"#ffa502":"#4CAF50"},children:F.some(e=>e.speed>=3)?"🚀 快速":F.some(e=>e.speed>=2)?"⚡ 中速":"🐌 慢速"})]}),f.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"clamp(4px, 1vw, 8px)",gap:"clamp(4px, 1vw, 8px)"},children:f.jsxs("button",{onClick:()=>q(!O),style:{background:O?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"8px",padding:"clamp(2px, 0.5vw, 4px) clamp(6px, 1.5vw, 8px)",fontSize:"clamp(0.5rem, 1.2vw, 0.6rem)",cursor:"pointer",display:"flex",alignItems:"center",gap:"2px"},children:[O?"🔊":"🔇"," ",s(O?"soundOn":"soundOff")]})}),f.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#9C27B0",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:P}),!i&&f.jsx("button",{onClick:D,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:s("start")})]}),m&&f.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",lineHeight:"1.4"},children:[f.jsxs("h4",{style:{margin:"0 0 8px 0",color:"#9C27B0"},children:[s("gameplay"),"："]}),f.jsxs("ul",{style:{margin:"0",paddingLeft:"15px"},children:[f.jsxs("li",{children:[f.jsx("strong",{children:s("start")}),"：",s("clickStartButton")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("preciseBubblePop")}),"：",f.jsx("br",{}),s("computer"),"：",s("preciseClickCenter"),f.jsx("br",{}),s("mobile"),"：",s("preciseTouchCenter"),f.jsx("br",{}),"⚠️ ",s("highAccuracyRequired"),f.jsx("br",{}),"🚀 ",s("fastBubbles"),"：",s("harderToPop"),f.jsx("br",{}),"🐌 ",s("slowBubbles"),"：",s("easierToPop")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("emotionBubbleScore")}),"：",f.jsx("br",{}),"😠 ",s("angryBubble"),"：10",s("points"),f.jsx("br",{}),"😰 ",s("anxiousBubble"),"：15",s("points"),f.jsx("br",{}),"😔 ",s("depressedBubble"),"：20",s("points"),f.jsx("br",{}),"😤 ",s("stressedBubble"),"：25",s("points"),f.jsx("br",{}),"😡 ",s("irritatedBubble"),"：30",s("points"),f.jsx("br",{}),"😞 ",s("frustratedBubble"),"：35",s("points")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("specialBubbles")}),"：",f.jsx("br",{}),"💣 ",s("bombBubble"),"：50",s("points"),"，",s("clearAllNearby"),f.jsx("br",{}),"⭐ ",s("goldenBubble"),"：100",s("points"),"，",s("doubleScore"),f.jsx("br",{}),"👻 ",s("ghostBubble"),"：30",s("points"),"，",s("clickTwice"),f.jsx("br",{}),"🔗 ",s("chainBubble"),"：40",s("points"),"，",s("clearSameType"),f.jsx("br",{}),"⏰ ",s("timeBubble"),"：25",s("points"),"，",s("add5Seconds")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("accuracySystem")}),"：",f.jsx("br",{}),"🟢 80%",s("above"),"：",s("triggerPowerMode"),f.jsx("br",{}),"🟡 60-79%：",s("goodAccuracy"),f.jsx("br",{}),"🔴 60%",s("below"),"：",s("needImproveAccuracy")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("powerMode")}),"：",f.jsx("br",{}),"⚡ 80%",s("above"),s("autoTrigger"),f.jsx("br",{}),"🎯 ",s("powerModeEasier"),f.jsx("br",{}),"⏱️ ",s("last10Seconds")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("comboSystem")}),"：",s("continuousPopExtraScore")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("timeLimit")}),"：",s("60SecondsHighestScore")]}),f.jsxs("li",{children:[f.jsx("strong",{children:s("gameGoal")}),"：",s("precisePopEmotionBubbles"),"！"]})]})]})]}),F.map(e=>{const t="bomb"===e.type?{animation:"float 2s ease-in-out infinite",boxShadow:"0 0 20px #ff4757"}:"golden"===e.type?{animation:"float 1.5s ease-in-out infinite",boxShadow:"0 0 25px #ffa502"}:"ghost"===e.type?{animation:"float 1s ease-in-out infinite",opacity:.6}:"chain"===e.type?{animation:"float 1.8s ease-in-out infinite",boxShadow:"0 0 15px #2ed573"}:"time"===e.type?{animation:"float 1.2s ease-in-out infinite",boxShadow:"0 0 18px #3742fa"}:{};return f.jsx("div",{style:{position:"absolute",left:`${e.x}%`,top:`${e.y}%`,transform:"translate(-50%, -50%)",width:1.8*e.size+"px",height:1.8*e.size+"px",background:`radial-gradient(circle at 30% 30%, ${e.color}40, ${e.color})`,borderRadius:"50%",border:`2px solid ${e.color}80`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${Math.max(12,.4*e.size)}px`,opacity:e.opacity,cursor:"pointer",transition:"all 0.2s ease",zIndex:20,...t},onMouseEnter:e=>{e.currentTarget.style.transform="translate(-50%, -50%) scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.transform="translate(-50%, -50%) scale(1)"},onClick:t=>{if(t.preventDefault(),t.stopPropagation(),i){const n=t.currentTarget;n.style.animation="popEffect 0.4s ease-out forwards";const i=n.getBoundingClientRect(),r=i.left+i.width/2,a=i.top+i.height/2;for(let t=0;t<12;t++){const n=document.createElement("div");n.style.position="fixed",n.style.left=r+"px",n.style.top=a+"px",n.style.width="6px",n.style.height="6px",n.style.background=e.color,n.style.borderRadius="50%",n.style.pointerEvents="none",n.style.zIndex="1000",n.style.boxShadow=`0 0 8px ${e.color}`,n.style.transition="all 0.6s ease",document.body.appendChild(n);const i=30*t*Math.PI/180,o=60+40*Math.random(),s=r+Math.cos(i)*o,l=a+Math.sin(i)*o;setTimeout(()=>{n.style.left=s+"px",n.style.top=l+"px",n.style.opacity="0",n.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(n)&&document.body.removeChild(n)},600)}S(e=>e+1),C(e=>e+1),W(e.id),U(),k>=80&&!I&&(B(!0),A(10),V()),w(j>0?T/j*100:0)}},onTouchStart:t=>{t.preventDefault(),t.stopPropagation();const n=t.currentTarget;if(n.style.transform="translate(-50%, -50%) scale(1.2)",n.style.transition="transform 0.1s ease",setTimeout(()=>{n.style.transform="translate(-50%, -50%) scale(1)"},100),i){const n=t.currentTarget;n.style.animation="popEffect 0.4s ease-out forwards";const i=n.getBoundingClientRect(),r=i.left+i.width/2,a=i.top+i.height/2;for(let t=0;t<12;t++){const n=document.createElement("div");n.style.position="fixed",n.style.left=r+"px",n.style.top=a+"px",n.style.width="6px",n.style.height="6px",n.style.background=e.color,n.style.borderRadius="50%",n.style.pointerEvents="none",n.style.zIndex="1000",n.style.boxShadow=`0 0 8px ${e.color}`,n.style.transition="all 0.6s ease",document.body.appendChild(n);const i=30*t*Math.PI/180,o=60+40*Math.random(),s=r+Math.cos(i)*o,l=a+Math.sin(i)*o;setTimeout(()=>{n.style.left=s+"px",n.style.top=l+"px",n.style.opacity="0",n.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(n)&&document.body.removeChild(n)},600)}S(e=>e+1),C(e=>e+1),W(e.id),U(),k>=80&&!I&&(B(!0),A(10),V()),w(j>0?T/j*100:0)}},children:e.emotion},e.id)}),E.map(e=>f.jsx("div",{style:{position:"absolute",left:`${e.x}%`,top:`${e.y}%`,transform:"translate(-50%, -50%)",width:"4px",height:"4px",background:e.color,borderRadius:"50%",opacity:e.life,pointerEvents:"none"}},e.id)),b&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#ff6b6b",textShadow:"0 0 20px #ff6b6b",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",d,"!"]}),!i&&f.jsxs("div",{style:{position:"absolute",bottom:"clamp(20px, 4vw, 40px)",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.7)",color:"#fff",padding:"clamp(8px, 2vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",textAlign:"center",zIndex:100},children:["🎯 ",s("accuracyChallenge"),"：",s("onlyClickCenterToPop"),"！",f.jsx("br",{}),"🚀 ",s("fastBubblesNeedHigherAccuracy"),"！"]}),!i&&a>0&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001,minWidth:"clamp(250px, 50vw, 350px)"},children:[f.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#9C27B0"},children:"遊戲結束！"}),f.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:["最終分數：",a]}),f.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:["最高分數：",h]}),f.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[f.jsx("button",{onClick:D,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"再玩一次"}),f.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"返回"})]})]})]})}function $I({onClose:t}){const{lang:n}=mw(),[i,r]=e.useState(0),[a,o]=e.useState(0),[s,l]=e.useState(!1),[c,d]=e.useState(60),[u,h]=e.useState(50),[p,m]=e.useState([]),[g,x]=e.useState(3),[y,b]=e.useState(1),[v,k]=e.useState(0),[w,j]=e.useState(!1),[S,T]=e.useState(!1),[C,I]=e.useState(!1),[B,R]=e.useState(!1),[A,F]=e.useState(!1),[z,E]=e.useState({x:0,y:0}),_=e=>{var t;const i={"zh-TW":{score:"分數",time:"時間",level:"等級",combo:"連擊",title:"極速賽車",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向鍵 ← → 或螢幕按鈕控制賽車",moveLeftRightToAvoid:"左右移動避開障礙物",gameObjective:"遊戲目標",avoidAllObstacles:"避開所有障礙物（石頭、汽車、卡車）",successfulAvoidance:"成功避開獲得5分 + 連擊獎勵",collisionPenalty:"碰撞障礙物扣10分並重置連擊",scoringSystem:"計分系統",baseScore:"基礎分數：避開障礙物 +5分",comboBonus:"連擊獎勵：每次連擊額外 +1分",levelUp:"等級提升：每100分提升一個等級",speedIncrease:"速度增加：等級越高，障礙物移動越快",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數"},"zh-CN":{score:"分数",time:"时间",level:"等级",combo:"连击",title:"极速赛车",rules:"游戏规则",close:"关闭",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向键 ← → 或屏幕按钮控制赛车",moveLeftRightToAvoid:"左右移动避开障碍物",gameObjective:"游戏目标",avoidAllObstacles:"避开所有障碍物（石头、汽车、卡车）",successfulAvoidance:"成功避开获得5分 + 连击奖励",collisionPenalty:"碰撞障碍物扣10分并重置连击",scoringSystem:"计分系统",baseScore:"基础分数：避开障碍物 +5分",comboBonus:"连击奖励：每次连击额外 +1分",levelUp:"等级提升：每100分提升一个等级",speedIncrease:"速度增加：等级越高，障碍物移动越快",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数"},en:{score:"Score",time:"Time",level:"Level",combo:"Combo",title:"Speed Racing",rules:"Game Rules",close:"Close",controlMethod:"Control Method",useArrowKeysOrButtons:"Use arrow keys ← → or screen buttons to control the race car",moveLeftRightToAvoid:"Move left and right to avoid obstacles",gameObjective:"Game Objective",avoidAllObstacles:"Avoid all obstacles (stones, cars, trucks)",successfulAvoidance:"Successfully avoid to get 5 points + combo bonus",collisionPenalty:"Colliding with obstacles deducts 10 points and resets combo",scoringSystem:"Scoring System",baseScore:"Base score: avoid obstacles +5 points",comboBonus:"Combo bonus: +1 point for each combo",levelUp:"Level up: gain one level every 100 points",speedIncrease:"Speed increase: the higher the level, the faster obstacles move",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up"},ja:{score:"スコア",time:"時間",level:"レベル",combo:"コンボ",title:"スピードレーシング",rules:"ゲームルール",close:"閉じる",controlMethod:"操作方法",useArrowKeysOrButtons:"矢印キー ← → または画面ボタンでレーシングカーを操作",moveLeftRightToAvoid:"左右に移動して障害物を避ける",gameObjective:"ゲーム目標",avoidAllObstacles:"すべての障害物（石、車、トラック）を避ける",successfulAvoidance:"成功して避けると5ポイント + コンボボーナス",collisionPenalty:"障害物に衝突すると10ポイント減点しコンボリセット",scoringSystem:"スコアシステム",baseScore:"基本スコア：障害物を避けると +5ポイント",comboBonus:"コンボボーナス：各コンボで +1ポイント",levelUp:"レベルアップ：100ポイントごとに1レベルアップ",speedIncrease:"速度増加：レベルが高いほど障害物が速く動く",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア"},ko:{score:"점수",time:"시간",level:"레벨",combo:"콤보",title:"스피드 레이싱",rules:"게임 규칙",close:"닫기",controlMethod:"조작 방법",useArrowKeysOrButtons:"화살표 키 ← → 또는 화면 버튼으로 레이싱카 조작",moveLeftRightToAvoid:"좌우로 이동하여 장애물 피하기",gameObjective:"게임 목표",avoidAllObstacles:"모든 장애물（돌、자동차、트럭）피하기",successfulAvoidance:"성공적으로 피하면 5점 + 콤보 보너스",collisionPenalty:"장애물과 충돌하면 10점 감점하고 콤보 리셋",scoringSystem:"점수 시스템",baseScore:"기본 점수：장애물 피하기 +5점",comboBonus:"콤보 보너스：각 콤보마다 +1점",levelUp:"레벨 업：100점마다 1레벨 상승",speedIncrease:"속도 증가：레벨이 높을수록 장애물이 빨리 움직임",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수"},vi:{score:"Điểm",time:"Thời Gian",level:"Cấp Độ",combo:"Combo",title:"Đua Xe Tốc Độ",rules:"Luật Chơi",close:"Đóng",controlMethod:"Phương Pháp Điều Khiển",useArrowKeysOrButtons:"Sử dụng phím mũi tên ← → hoặc nút màn hình để điều khiển xe đua",moveLeftRightToAvoid:"Di chuyển trái phải để tránh chướng ngại vật",gameObjective:"Mục Tiêu Trò Chơi",avoidAllObstacles:"Tránh tất cả chướng ngại vật (đá, xe hơi, xe tải)",successfulAvoidance:"Tránh thành công được 5 điểm + phần thưởng combo",collisionPenalty:"Va chạm với chướng ngại vật trừ 10 điểm và reset combo",scoringSystem:"Hệ Thống Điểm",baseScore:"Điểm cơ bản: tránh chướng ngại vật +5 điểm",comboBonus:"Phần thưởng combo: +1 điểm cho mỗi combo",levelUp:"Tăng cấp: tăng 1 cấp mỗi 100 điểm",speedIncrease:"Tăng tốc độ: cấp càng cao, chướng ngại vật di chuyển càng nhanh",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian"},th:{score:"คะแนน",time:"เวลา",level:"ระดับ",combo:"คอมโบ",title:"แข่งรถความเร็ว",rules:"กฎเกม",close:"ปิด",controlMethod:"วิธีการควบคุม",useArrowKeysOrButtons:"ใช้ปุ่มลูกศร ← → หรือปุ่มหน้าจอควบคุมรถแข่ง",moveLeftRightToAvoid:"เคลื่อนที่ซ้ายขวาเพื่อหลบหลีกสิ่งกีดขวาง",gameObjective:"เป้าหมายเกม",avoidAllObstacles:"หลบหลีกสิ่งกีดขวางทั้งหมด（หิน、รถยนต์、รถบรรทุก）",successfulAvoidance:"หลบหลีกสำเร็จได้ 5 คะแนน + โบนัสคอมโบ",collisionPenalty:"ชนสิ่งกีดขวางหัก 10 คะแนนและรีเซ็ตคอมโบ",scoringSystem:"ระบบคะแนน",baseScore:"คะแนนพื้นฐาน：หลบหลีกสิ่งกีดขวาง +5 คะแนน",comboBonus:"โบนัสคอมโบ：+1 คะแนนสำหรับแต่ละคอมโบ",levelUp:"เลเวลอัพ：เพิ่ม 1 เลเวลทุก 100 คะแนน",speedIncrease:"เพิ่มความเร็ว：เลเวลสูงขึ้นสิ่งกีดขวางเคลื่อนที่เร็วขึ้น",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา"},la:{score:"Puncta",time:"Tempus",level:"Gradus",combo:"Combo",title:"Cursus Velocitatis",rules:"Regulae Ludi",close:"Claudere",controlMethod:"Methodus Controllandi",useArrowKeysOrButtons:"Utere clavis sagittarum ← → vel pugnis scaenae ad currum regendum",moveLeftRightToAvoid:"Move sinistra dextraque ad impedimenta vitanda",gameObjective:"Finis Ludi",avoidAllObstacles:"Vita omnia impedimenta (lapides, currus, plaustra)",successfulAvoidance:"Vitando feliciter accipe 5 puncta + praemium combo",collisionPenalty:"Collidendo cum impedimentis minus 10 puncta et reset combo",scoringSystem:"Systema Punctandi",baseScore:"Puncta fundamentalia: vitando impedimenta +5 puncta",comboBonus:"Praemium combo: +1 punctum pro quaque combo",levelUp:"Gradus sursum: accipe unum gradum pro quaque 100 punctis",speedIncrease:"Auctio velocitatis: altior gradus, velocius impedimenta moventur",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est"},ms:{score:"Markah",time:"Masa",level:"Tahap",combo:"Combo",title:"Lumba Kereta Laju",rules:"Peraturan Permainan",close:"Tutup",controlMethod:"Kaedah Kawalan",useArrowKeysOrButtons:"Gunakan kekunci anak panah ← → atau butang skrin untuk mengawal kereta lumba",moveLeftRightToAvoid:"Gerakkan kiri kanan untuk mengelakkan halangan",gameObjective:"Objektif Permainan",avoidAllObstacles:"Elakkan semua halangan (batu, kereta, lori)",successfulAvoidance:"Berjaya elakkan dapat 5 markah + bonus combo",collisionPenalty:"Berlanggar dengan halangan tolak 10 markah dan reset combo",scoringSystem:"Sistem Markah",baseScore:"Markah asas: elakkan halangan +5 markah",comboBonus:"Bonus combo: +1 markah untuk setiap combo",levelUp:"Naik tahap: dapat 1 tahap setiap 100 markah",speedIncrease:"Tambah kelajuan: tahap lebih tinggi, halangan bergerak lebih pantas",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis"}};return(null==(t=i[n])?void 0:t[e])||i["zh-TW"][e]||e};e.useEffect(()=>{const e=OI("racing");e&&o(e.highScore||0)},[]),e.useEffect(()=>{a>0&&LI("racing",{highScore:a})},[a]);const N=()=>{r(0),d(60),h(50),m([]),x(3),b(1),k(0),l(!0)},P=e=>{s&&h(t=>{const n="left"===e?t-8:t+8;return Math.max(10,Math.min(90,n))})};e.useEffect(()=>{if(!s)return;const e=setInterval(()=>{d(e=>e<=.1?(l(!1),i>a&&o(i),0):e-.1),Math.random()<.9+.15*y&&(()=>{if(!s)return;const e=["rock","car","truck"],t=e[Math.floor(Math.random()*e.length)],n=[15,50,85],i=n[Math.floor(Math.random()*n.length)]+20*(Math.random()-.5);m(e=>[...e,{id:Date.now(),x:i,y:0,type:t}])})(),m(e=>{const t=e.map(e=>({...e,y:e.y+g})).filter(e=>e.y<100);let n=!1;return t.filter(e=>{if(e.y>70&&e.y<85){if(t=u,i=e.x,Math.abs(t-i)<10)return n||(k(0),r(e=>Math.max(0,e-10)),R(!0),I(!0),E({x:u,y:75}),F(!0),setTimeout(()=>{R(!1),I(!1),F(!1)},800),n=!0),!1;k(e=>e+1),r(e=>e+5+v),v>=5&&(j(!0),setTimeout(()=>j(!1),1e3))}var t,i;return!0})}),i>100*y&&(b(e=>e+1),x(e=>Math.min(8,e+.5)))},100);return()=>clearInterval(e)},[s,g,y,u,v]),e.useEffect(()=>{const e=e=>{s&&("ArrowLeft"===e.key||"a"===e.key?P("left"):"ArrowRight"!==e.key&&"d"!==e.key||P("right"))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s]);const D=e=>{const t={rock:{background:"#8B4513",borderRadius:"50%"},car:{background:"#FF4444",borderRadius:"5px"},truck:{background:"#FF8800",borderRadius:"8px"}};return t[e]||t.rock};return f.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",position:"relative",overflow:"auto",fontFamily:"Arial, sans-serif",touchAction:"pan-y"},onTouchStart:e=>{if(!s)return;e.preventDefault();const t=e.touches[0],n=window.innerWidth,i=t.clientX;P(i<n/2?"left":"right")},children:[f.jsx("button",{onClick:t,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),f.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[f.jsxs("div",{children:[_("score"),": ",i]}),f.jsxs("div",{children:[_("time"),": ",c,"s"]}),f.jsxs("div",{children:[_("level"),": ",y]}),f.jsxs("div",{children:[_("combo"),": ",v]})]}),f.jsx("div",{style:{position:"absolute",bottom:"20%",left:"0",right:"0",height:"60%",background:"linear-gradient(90deg, #696969 0%, #A9A9A9 20%, #696969 40%, #A9A9A9 60%, #696969 80%, #A9A9A9 100%)",borderTop:"4px solid #FFD700",borderBottom:"4px solid #FFD700"}}),f.jsx("div",{style:{position:"absolute",bottom:"25%",left:`${u}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(20px, 4vw, 30px)",background:B?"linear-gradient(45deg, #FF0000, #FF4444)":"linear-gradient(45deg, #FF4444, #FF6666)",borderRadius:"8px",border:B?"3px solid #FF0000":"2px solid #CC0000",zIndex:10,transition:"left 0.1s ease",animation:B?"collisionShake 0.5s ease-in-out":"none"},children:f.jsx("div",{style:{position:"absolute",top:"-8px",left:"50%",transform:"translateX(-50%)",width:"clamp(20px, 4vw, 30px)",height:"clamp(8px, 1.5vw, 12px)",background:"#444",borderRadius:"4px"}})}),p.map(e=>f.jsx("div",{style:{position:"absolute",top:`${e.y}%`,left:`${e.x}%`,transform:"translateX(-50%)",width:"clamp(30px, 6vw, 45px)",height:"clamp(15px, 3vw, 22px)",...D(e.type),zIndex:5}},e.id)),w&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FFD700",textShadow:"0 0 20px #FFD700",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",v,"!"]}),C&&f.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FF0000",textShadow:"0 0 20px #FF0000",animation:"collisionEffect 0.5s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:"BOOM!"}),A&&f.jsx("div",{style:{position:"absolute",left:`${z.x}%`,top:`${z.y}%`,transform:"translate(-50%, -50%)",width:"clamp(60px, 12vw, 80px)",height:"clamp(60px, 12vw, 80px)",animation:"explosionEffect 0.8s ease-out forwards",pointerEvents:"none",zIndex:999},children:f.jsx("div",{style:{width:"100%",height:"100%",background:"radial-gradient(circle, #FFD700 0%, #FF8800 30%, #FF4444 60%, #FF0000 100%)",borderRadius:"50%",boxShadow:"0 0 30px #FFD700, 0 0 60px #FF8800, 0 0 90px #FF4444"}})}),f.jsx("style",{children:"\n          @keyframes collisionShake {\n            0%, 100% { transform: translateX(-50%) translateY(0px); }\n            25% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }\n            50% { transform: translateX(-50%) translateY(0px) translateX(3px); }\n            75% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }\n          }\n          @keyframes collisionEffect {\n            0% { \n              transform: translate(-50%, -50%) scale(0.5);\n              opacity: 0;\n            }\n            50% { \n              transform: translate(-50%, -50%) scale(1.2);\n              opacity: 1;\n            }\n            100% { \n              transform: translate(-50%, -50%) scale(1);\n              opacity: 0;\n            }\n          }\n          @keyframes explosionEffect {\n            0% { \n              transform: translate(-50%, -50%) scale(0.1);\n              opacity: 1;\n            }\n            50% { \n              transform: translate(-50%, -50%) scale(1.5);\n              opacity: 1;\n            }\n            100% { \n              transform: translate(-50%, -50%) scale(2);\n              opacity: 0;\n            }\n          }\n        "}),f.jsxs("div",{style:{position:"absolute",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"clamp(10px, 2vw, 20px)",zIndex:100},children:[f.jsx("button",{onClick:()=>P("left"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"←"}),f.jsx("button",{onClick:()=>P("right"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"→"})]}),!s&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[f.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:_("title")}),f.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:"使用方向鍵或按鈕控制賽車，避開障礙物！"}),f.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[f.jsx("button",{onClick:N,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:_("start")}),f.jsx("button",{onClick:()=>T(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:_("rules")})]})]}),S&&f.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[f.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#E91E63",textAlign:"center"},children:[_("title")," - ",_("rules")]}),f.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[f.jsx("p",{children:f.jsxs("strong",{children:["🎮 ",_("controlMethod"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:_("useArrowKeysOrButtons")}),f.jsx("li",{children:_("moveLeftRightToAvoid")})]}),f.jsx("p",{children:f.jsxs("strong",{children:["🎯 ",_("gameObjective"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:_("avoidAllObstacles")}),f.jsx("li",{children:_("successfulAvoidance")}),f.jsx("li",{children:_("collisionPenalty")})]}),f.jsx("p",{children:f.jsxs("strong",{children:["🏆 ",_("scoringSystem"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:_("baseScore")}),f.jsx("li",{children:_("comboBonus")}),f.jsx("li",{children:_("levelUp")}),f.jsx("li",{children:_("speedIncrease")})]}),f.jsx("p",{children:f.jsxs("strong",{children:["⏰ ",_("gameTime"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:_("sixtySecondsPerGame")}),f.jsx("li",{children:_("autoScoreWhenTimeUp")})]})]}),f.jsx("button",{onClick:()=>T(!1),style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:_("close")})]})}),!s&&i>0&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[f.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:[_("gameOver"),"！"]}),f.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[_("finalScore"),"：",i]}),f.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[_("highScore"),"：",a]}),f.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[f.jsx("button",{onClick:N,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:_("restart")}),f.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:_("back")})]})]})]})}function GI({onClose:t}){const{lang:n}=mw(),[i,r]=e.useState(0),[a,o]=e.useState(0),[s,l]=e.useState(!1),[c,d]=e.useState(60),[u,h]=e.useState([]),[p,m]=e.useState(0),[g,x]=e.useState(!1),[y,b]=e.useState(null),[v,k]=e.useState(!0),[w,j]=e.useState(!1),S=e=>{var t;const i={"zh-TW":{score:"分數",time:"時間",combo:"連擊",title:"音樂節奏",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",gameplay:"遊戲玩法",clickMovingRhythmPoints:"點擊從上往下移動的節奏點",fourColorsCorrespondToDifferentAudio:"四種顏色的節奏點對應不同音頻",redBlueGreenYellowFrequencies:"紅色(440Hz)、藍色(523Hz)、綠色(659Hz)、黃色(784Hz)",accuracyScoring:"精準度計分",perfect100ms:"Perfect (100ms內)：+10分",good200ms:"Good (200ms內)：+5分",ok300ms:"OK (300ms內)：+2分",missOver300ms:"Miss (超過300ms)：0分",scoring:"計分",eachSuccessfulClickIncreasesCombo:"每次成功點擊增加連擊數",combo5TimesTriggersEffect:"連擊5次以上觸發特效",missingRhythmPointResetsCombo:"錯過節奏點重置連擊",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效開關控制",clickRhythmPointPlaysAudio:"點擊節奏點會播放對應音頻",canTurnSoundOnOffAnytime:"可隨時開啟/關閉音效",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數",clickRhythmPointsFollowMusic:"點擊節奏點，跟隨音樂節奏！"},"zh-CN":{score:"分数",time:"时间",combo:"连击",title:"音乐节奏",rules:"游戏规则",close:"关闭",gameplay:"游戏玩法",clickMovingRhythmPoints:"点击从上往下移动的节奏点",fourColorsCorrespondToDifferentAudio:"四种颜色的节奏点对应不同音频",redBlueGreenYellowFrequencies:"红色(440Hz)、蓝色(523Hz)、绿色(659Hz)、黄色(784Hz)",accuracyScoring:"精准度计分",perfect100ms:"Perfect (100ms内)：+10分",good200ms:"Good (200ms内)：+5分",ok300ms:"OK (300ms内)：+2分",missOver300ms:"Miss (超过300ms)：0分",scoring:"计分",eachSuccessfulClickIncreasesCombo:"每次成功点击增加连击数",combo5TimesTriggersEffect:"连击5次以上触发特效",missingRhythmPointResetsCombo:"错过节奏点重置连击",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效开关控制",clickRhythmPointPlaysAudio:"点击节奏点会播放对应音频",canTurnSoundOnOffAnytime:"可随时开启/关闭音效",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数",clickRhythmPointsFollowMusic:"点击节奏点，跟随音乐节奏！"},en:{score:"Score",time:"Time",combo:"Combo",title:"Music Rhythm",rules:"Game Rules",close:"Close",gameplay:"Gameplay",clickMovingRhythmPoints:"Click rhythm points moving from top to bottom",fourColorsCorrespondToDifferentAudio:"Four colors of rhythm points correspond to different audio",redBlueGreenYellowFrequencies:"Red (440Hz), Blue (523Hz), Green (659Hz), Yellow (784Hz)",accuracyScoring:"Accuracy Scoring",perfect100ms:"Perfect (within 100ms): +10 points",good200ms:"Good (within 200ms): +5 points",ok300ms:"OK (within 300ms): +2 points",missOver300ms:"Miss (over 300ms): 0 points",scoring:"Scoring",eachSuccessfulClickIncreasesCombo:"Each successful click increases combo count",combo5TimesTriggersEffect:"Combo 5 times or more triggers special effects",missingRhythmPointResetsCombo:"Missing rhythm point resets combo",soundControl:"Sound Control",soundSwitchInTopRight:"Sound switch control in top right corner",clickRhythmPointPlaysAudio:"Clicking rhythm points plays corresponding audio",canTurnSoundOnOffAnytime:"Can turn sound on/off anytime",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up",clickRhythmPointsFollowMusic:"Click rhythm points, follow the music rhythm!"},ja:{score:"スコア",time:"時間",combo:"コンボ",title:"音楽リズム",rules:"ゲームルール",close:"閉じる",gameplay:"ゲームプレイ",clickMovingRhythmPoints:"上から下に移動するリズムポイントをクリック",fourColorsCorrespondToDifferentAudio:"4色のリズムポイントが異なる音声に対応",redBlueGreenYellowFrequencies:"赤(440Hz)、青(523Hz)、緑(659Hz)、黄(784Hz)",accuracyScoring:"精度スコアリング",perfect100ms:"Perfect (100ms以内)：+10ポイント",good200ms:"Good (200ms以内)：+5ポイント",ok300ms:"OK (300ms以内)：+2ポイント",missOver300ms:"Miss (300ms超過)：0ポイント",scoring:"スコアリング",eachSuccessfulClickIncreasesCombo:"各成功クリックでコンボ数増加",combo5TimesTriggersEffect:"コンボ5回以上でエフェクト発動",missingRhythmPointResetsCombo:"リズムポイントを逃すとコンボリセット",soundControl:"サウンドコントロール",soundSwitchInTopRight:"右上のサウンドスイッチ制御",clickRhythmPointPlaysAudio:"リズムポイントクリックで対応音声再生",canTurnSoundOnOffAnytime:"いつでもサウンドオン/オフ可能",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア",clickRhythmPointsFollowMusic:"リズムポイントをクリックして、音楽のリズムに従ってください！"},ko:{score:"점수",time:"시간",combo:"콤보",title:"음악 리듬",rules:"게임 규칙",close:"닫기",gameplay:"게임 플레이",clickMovingRhythmPoints:"위에서 아래로 이동하는 리듬 포인트 클릭",fourColorsCorrespondToDifferentAudio:"4가지 색상의 리듬 포인트가 다른 오디오에 대응",redBlueGreenYellowFrequencies:"빨강(440Hz)、파랑(523Hz)、초록(659Hz)、노랑(784Hz)",accuracyScoring:"정확도 점수",perfect100ms:"Perfect (100ms 이내)：+10점",good200ms:"Good (200ms 이내)：+5점",ok300ms:"OK (300ms 이내)：+2점",missOver300ms:"Miss (300ms 초과)：0점",scoring:"점수",eachSuccessfulClickIncreasesCombo:"각 성공 클릭마다 콤보 수 증가",combo5TimesTriggersEffect:"콤보 5회 이상 시 특수 효과 발동",missingRhythmPointResetsCombo:"리듬 포인트 놓치면 콤보 리셋",soundControl:"사운드 제어",soundSwitchInTopRight:"우상단 사운드 스위치 제어",clickRhythmPointPlaysAudio:"리듬 포인트 클릭 시 해당 오디오 재생",canTurnSoundOnOffAnytime:"언제든지 사운드 켜기/끄기 가능",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수",clickRhythmPointsFollowMusic:"리듬 포인트를 클릭하고 음악 리듬을 따라가세요!"},vi:{score:"Điểm",time:"Thời Gian",combo:"Combo",title:"Nhịp Điệu Âm Nhạc",rules:"Luật Chơi",close:"Đóng",gameplay:"Cách Chơi",clickMovingRhythmPoints:"Nhấp vào các điểm nhịp điệu di chuyển từ trên xuống dưới",fourColorsCorrespondToDifferentAudio:"Bốn màu của điểm nhịp điệu tương ứng với âm thanh khác nhau",redBlueGreenYellowFrequencies:"Đỏ (440Hz), Xanh dương (523Hz), Xanh lá (659Hz), Vàng (784Hz)",accuracyScoring:"Điểm Độ Chính Xác",perfect100ms:"Perfect (trong 100ms): +10 điểm",good200ms:"Good (trong 200ms): +5 điểm",ok300ms:"OK (trong 300ms): +2 điểm",missOver300ms:"Miss (trên 300ms): 0 điểm",scoring:"Điểm Số",eachSuccessfulClickIncreasesCombo:"Mỗi lần nhấp thành công tăng số combo",combo5TimesTriggersEffect:"Combo 5 lần trở lên kích hoạt hiệu ứng đặc biệt",missingRhythmPointResetsCombo:"Bỏ lỡ điểm nhịp điệu reset combo",soundControl:"Điều Khiển Âm Thanh",soundSwitchInTopRight:"Công tắc âm thanh ở góc trên bên phải",clickRhythmPointPlaysAudio:"Nhấp điểm nhịp điệu phát âm thanh tương ứng",canTurnSoundOnOffAnytime:"Có thể bật/tắt âm thanh bất cứ lúc nào",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian",clickRhythmPointsFollowMusic:"Nhấp vào điểm nhịp điệu, theo nhịp điệu âm nhạc!"},th:{score:"คะแนน",time:"เวลา",combo:"คอมโบ",title:"จังหวะดนตรี",rules:"กฎเกม",close:"ปิด",gameplay:"วิธีเล่น",clickMovingRhythmPoints:"คลิกจุดจังหวะที่เคลื่อนที่จากบนลงล่าง",fourColorsCorrespondToDifferentAudio:"สี่สีของจุดจังหวะสอดคล้องกับเสียงที่แตกต่างกัน",redBlueGreenYellowFrequencies:"แดง (440Hz)、น้ำเงิน (523Hz)、เขียว (659Hz)、เหลือง (784Hz)",accuracyScoring:"คะแนนความแม่นยำ",perfect100ms:"Perfect (ภายใน 100ms)：+10 คะแนน",good200ms:"Good (ภายใน 200ms)：+5 คะแนน",ok300ms:"OK (ภายใน 300ms)：+2 คะแนน",missOver300ms:"Miss (เกิน 300ms)：0 คะแนน",scoring:"คะแนน",eachSuccessfulClickIncreasesCombo:"แต่ละการคลิกที่สำเร็จเพิ่มจำนวนคอมโบ",combo5TimesTriggersEffect:"คอมโบ 5 ครั้งขึ้นไปกระตุ้นเอฟเฟกต์พิเศษ",missingRhythmPointResetsCombo:"พลาดจุดจังหวะรีเซ็ตคอมโบ",soundControl:"ควบคุมเสียง",soundSwitchInTopRight:"สวิตช์เสียงควบคุมที่มุมขวาบน",clickRhythmPointPlaysAudio:"คลิกจุดจังหวะเล่นเสียงที่สอดคล้องกัน",canTurnSoundOnOffAnytime:"สามารถเปิด/ปิดเสียงได้ทุกเมื่อ",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา",clickRhythmPointsFollowMusic:"คลิกจุดจังหวะและตามจังหวะดนตรี!"},la:{score:"Puncta",time:"Tempus",combo:"Combo",title:"Rhythmus Musicae",rules:"Regulae Ludi",close:"Claudere",gameplay:"Ludus",clickMovingRhythmPoints:"Clicca puncta rhythmi moventia de superiore ad inferiorem",fourColorsCorrespondToDifferentAudio:"Quattuor colores punctorum rhythmi correspondent diversis auditis",redBlueGreenYellowFrequencies:"Rubrum (440Hz), Caeruleum (523Hz), Viride (659Hz), Flavum (784Hz)",accuracyScoring:"Punctatio Accurationis",perfect100ms:"Perfect (intra 100ms): +10 puncta",good200ms:"Good (intra 200ms): +5 puncta",ok300ms:"OK (intra 300ms): +2 puncta",missOver300ms:"Miss (super 300ms): 0 puncta",scoring:"Punctatio",eachSuccessfulClickIncreasesCombo:"Quaelibet felix cliccatio auget numerum combo",combo5TimesTriggersEffect:"Combo 5 vicibus vel plus activat effectus speciales",missingRhythmPointResetsCombo:"Amittendo punctum rhythmi reset combo",soundControl:"Controllatio Sonorum",soundSwitchInTopRight:"Sonorum commutator in angulo superiore dextro",clickRhythmPointPlaysAudio:"Cliccando puncta rhythmi ludit auditum correspondentem",canTurnSoundOnOffAnytime:"Potest sonos aperire/claudere quandocumque",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est",clickRhythmPointsFollowMusic:"Puncta rhythmi preme et musicam sequere!"},ms:{score:"Markah",time:"Masa",combo:"Combo",title:"Irama Muzik",rules:"Peraturan Permainan",close:"Tutup",gameplay:"Cara Bermain",clickMovingRhythmPoints:"Klik titik irama yang bergerak dari atas ke bawah",fourColorsCorrespondToDifferentAudio:"Empat warna titik irama sepadan dengan audio berbeza",redBlueGreenYellowFrequencies:"Merah (440Hz), Biru (523Hz), Hijau (659Hz), Kuning (784Hz)",accuracyScoring:"Penilaian Ketepatan",perfect100ms:"Perfect (dalam 100ms): +10 markah",good200ms:"Good (dalam 200ms): +5 markah",ok300ms:"OK (dalam 300ms): +2 markah",missOver300ms:"Miss (melebihi 300ms): 0 markah",scoring:"Penilaian",eachSuccessfulClickIncreasesCombo:"Setiap klik berjaya menambah bilangan combo",combo5TimesTriggersEffect:"Combo 5 kali atau lebih mencetuskan kesan khas",missingRhythmPointResetsCombo:"Terlepas titik irama reset combo",soundControl:"Kawalan Bunyi",soundSwitchInTopRight:"Suis bunyi kawalan di sudut kanan atas",clickRhythmPointPlaysAudio:"Klik titik irama memainkan audio sepadan",canTurnSoundOnOffAnytime:"Boleh hidupkan/matikan bunyi bila-bila masa",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis",clickRhythmPointsFollowMusic:"Klik titik irama, ikut rentak muzik!"}};return(null==(t=i[n])?void 0:t[e])||i["zh-TW"][e]||e};e.useEffect(()=>{const e=OI("rhythm");e&&o(e.highScore||0)},[]),e.useEffect(()=>{a>0&&LI("rhythm",{highScore:a})},[a]),e.useEffect(()=>{"undefined"!=typeof window&&window.AudioContext&&b(new AudioContext)},[]);const T=()=>{r(0),d(60),h([]),m(0),l(!0)};e.useEffect(()=>{if(!s)return;const e=setInterval(()=>{d(e=>e<=1?(l(!1),i>a&&o(i),0):e-1),Math.random()<.03&&(()=>{if(!s)return;const e=["red","blue","green","yellow"],t=e[Math.floor(Math.random()*e.length)],n=80*Math.random()+10;h(e=>[...e,{id:Date.now(),x:n,y:-10,type:t,timing:Date.now()}])})(),h(e=>{const t=e.map(e=>({...e,y:e.y+2})).filter(e=>e.y<110);return t.forEach(e=>{e.y>90&&(m(0),h(t=>t.filter(t=>t.id!==e.id)))}),t})},50);return()=>clearInterval(e)},[s]);const C=e=>({red:"#FF4444",blue:"#4444FF",green:"#44FF44",yellow:"#FFFF44"}[e]||"#FF4444");return f.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"hidden",fontFamily:"Arial, sans-serif"},children:[f.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[f.jsxs("div",{children:[S("score"),": ",i]}),f.jsxs("div",{children:[S("time"),": ",c,"s"]}),f.jsxs("div",{children:[S("combo"),": ",p]})]}),f.jsx("button",{onClick:()=>k(!v),style:{position:"absolute",top:"clamp(10px, 2vw, 20px)",right:"clamp(10px, 2vw, 20px)",background:v?"#4CAF50":"#f44336",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer",zIndex:100},children:v?"🔊":"🔇"}),f.jsx("div",{style:{position:"absolute",bottom:"20%",left:"10%",right:"10%",height:"60%",background:"rgba(0,0,0,0.3)",borderRadius:"20px",border:"2px solid rgba(255,255,255,0.3)"}}),u.map(e=>f.jsx("div",{onClick:()=>(e=>{const t=u.find(t=>t.id===e);if(!t)return;const n=Date.now()-t.timing;let i=0;if(i=n<100?10:n<200?5:n<300?2:0,r(e=>e+i),m(e=>e+1),p>=5&&(x(!0),setTimeout(()=>x(!1),1e3)),y&&v){const e=y.createOscillator(),n=y.createGain();e.connect(n),n.connect(y.destination);const i={red:440,blue:523,green:659,yellow:784};e.frequency.setValueAtTime(i[t.type],y.currentTime),e.type="sine",n.gain.setValueAtTime(.3,y.currentTime),n.gain.exponentialRampToValueAtTime(.01,y.currentTime+.1),e.start(y.currentTime),e.stop(y.currentTime+.1)}h(t=>t.filter(t=>t.id!==e))})(e.id),style:{position:"absolute",bottom:`${e.y}%`,left:`${e.x}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(40px, 8vw, 60px)",background:C(e.type),borderRadius:"50%",cursor:"pointer",zIndex:10,boxShadow:`0 0 20px ${C(e.type)}`,animation:"pulse 0.5s ease-in-out infinite alternate"}},e.id)),g&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#00BCD4",textShadow:"0 0 20px #00BCD4",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",p,"!"]}),!s&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[f.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:S("title")}),f.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:S("clickRhythmPointsFollowMusic")}),f.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[f.jsx("button",{onClick:T,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:S("start")}),f.jsx("button",{onClick:()=>j(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:S("rules")})]})]}),w&&f.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[f.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#00BCD4",textAlign:"center"},children:[S("rhythmGame")," - ",S("rules")]}),f.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[f.jsx("p",{children:f.jsxs("strong",{children:["🎵 ",S("gameplay"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:S("clickMovingRhythmPoints")}),f.jsx("li",{children:S("fourColorsCorrespondToDifferentAudio")}),f.jsx("li",{children:S("redBlueGreenYellowFrequencies")})]}),f.jsx("p",{children:f.jsxs("strong",{children:["🎯 ",S("accuracyScoring"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:S("perfect100ms")}),f.jsx("li",{children:S("good200ms")}),f.jsx("li",{children:S("ok300ms")}),f.jsx("li",{children:S("missOver300ms")})]}),f.jsx("p",{children:f.jsxs("strong",{children:["🏆 ",S("scoring"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:S("eachSuccessfulClickIncreasesCombo")}),f.jsx("li",{children:S("combo5TimesTriggersEffect")}),f.jsx("li",{children:S("missingRhythmPointResetsCombo")})]}),f.jsx("p",{children:f.jsxs("strong",{children:["🔊 ",S("soundControl"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:S("soundSwitchInTopRight")}),f.jsx("li",{children:S("clickRhythmPointPlaysAudio")}),f.jsx("li",{children:S("canTurnSoundOnOffAnytime")})]}),f.jsx("p",{children:f.jsxs("strong",{children:["⏰ ",S("gameTime"),"："]})}),f.jsxs("ul",{children:[f.jsx("li",{children:S("sixtySecondsPerGame")}),f.jsx("li",{children:S("autoScoreWhenTimeUp")})]})]}),f.jsx("button",{onClick:()=>j(!1),style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:S("close")})]})}),!s&&i>0&&f.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[f.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:[S("gameOver"),"！"]}),f.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[S("finalScore"),"：",i]}),f.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[S("highScore"),"：",a]}),f.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[f.jsx("button",{onClick:T,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:S("restart")}),f.jsx("button",{onClick:t,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:S("back")})]})]}),f.jsx("style",{children:"\n        @keyframes pulse {\n          0% { transform: translateX(-50%) scale(1); }\n          100% { transform: translateX(-50%) scale(1.1); }\n        }\n        @keyframes comboEffect {\n          0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }\n          50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }\n          100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }\n        }\n      "})]})}const QI={"zh-TW":{title:"社會融入度評估",subtitle:"評估您的社會融入度，獲得專業建議",subtitle2:"勇敢面對並定期檢測自身社會融入程度進步狀況，每一次評估都是成長的機會",backToHome:"返回",startAssessment:"開始評估",submitAssessment:"提交評估",cancelAssessment:"取消",closeAssessment:"關閉",assessmentComplete:"評估完成",viewReport:"查看報告",closeReport:"關閉報告",q1Title:"人際關係",q1Desc:"最近3個月，您與他人的互動和社交能力如何？包括與同事、朋友、鄰居的日常交流，以及在新環境中建立關係的能力。您是否能夠主動與他人溝通，建立信任關係，並在社交場合中感到自在？",q2Title:"就業狀況",q2Desc:"最近1年，您的工作穩定性和發展前景如何？包括工作滿意度、薪資待遇、職業發展機會、工作環境適應性，以及對未來職業規劃的清晰度。您是否對當前工作感到滿意，並有明確的職業發展目標？",q3Title:"家庭關係",q3Desc:"最近6個月，您與家人的相處和溝通狀況如何？包括與配偶、子女、父母或其他家庭成員的關係質量，溝通頻率和效果，以及家庭氛圍的和諧程度。您是否能夠有效處理家庭衝突，並為家庭成員提供情感支持？",q4Title:"未來信心",q4Desc:"您對未來1年的樂觀程度和規劃如何？包括對個人發展的信心，對生活目標的清晰度，以及面對挑戰時的積極態度。您是否對未來有明確的規劃，並相信自己能夠實現目標？",q5Title:"社會接納",q5Desc:"最近6個月，您感覺被社會接受和認可的程度如何？包括在社區中的融入度，社會地位的認同感，以及對社會規範的適應能力。您是否感到被社會接納，並對自己的社會角色感到滿意？",q6Title:"情緒管理",q6Desc:"最近3個月，您處理壓力和負面情緒的能力如何？包括面對挫折時的情緒反應，壓力調節方法，以及心理健康維護的意識。您是否能夠有效管理負面情緒，並在壓力下保持冷靜？",q7Title:"生活規律",q7Desc:"最近6個月，您的生活作息和規律性如何？包括日常作息時間，飲食習慣，運動頻率，以及生活節奏的穩定性。您是否能夠維持健康的生活習慣，並建立規律的日常生活？",q8Title:"學習成長",q8Desc:"最近1年，您在技能學習和個人成長方面的投入如何？包括新技能學習，知識更新，自我提升的積極性，以及對個人發展的投資。您是否持續學習新知識，並主動尋求個人成長機會？",q9Title:"財務管理",q9Desc:"最近1年，您的財務規劃和理財能力如何？包括收入支出管理，儲蓄習慣，投資理財意識，以及對未來財務安全的規劃。您是否能夠有效管理個人財務，並為未來做好財務準備？",q10Title:"健康狀況",q10Desc:"最近6個月，您的身體和心理健康狀況如何？包括身體健康狀況，心理健康狀態，醫療保健意識，以及對健康問題的預防和處理能力。您是否重視健康管理，並採取積極的健康維護措施？",q11Title:"社交網絡",q11Desc:"最近3個月，您建立和維護社交關係的能力如何？包括朋友數量，社交活動參與度，人際關係質量，以及社交網絡的廣度和深度。您是否擁有穩定的社交圈，並能夠與他人建立有意義的關係？",q12Title:"目標設定",q12Desc:"最近1年，您設定和追求個人目標的能力如何？包括目標的明確性，計劃的可行性，執行力，以及對目標達成度的評估。您是否能夠設定清晰的目標，並有效執行計劃？",q13Title:"適應能力",q13Desc:"最近6個月，您適應環境變化和挑戰的能力如何？包括面對新環境的適應速度，應對變化的靈活性，以及從挫折中恢復的能力。您是否能夠快速適應新環境，並在變化中保持穩定？",q14Title:"責任感",q14Desc:"最近1年，您對自己和他人負責的態度如何？包括對個人行為的責任感，對他人承諾的履行，以及對社會責任的認知。您是否能夠承擔個人責任，並對他人和社會負責？",q15Title:"自我認同",q15Desc:"最近6個月，您對自我價值和身份的認同感如何？包括對個人價值的認知，自我接納程度，以及對個人身份的滿意度。您是否對自己有清晰的認知，並能夠接納自己的優缺點？",q16Title:"社區參與",q16Desc:"最近1年，您參與社區活動和公益服務的情況如何？包括志願服務參與度，社區活動貢獻，以及對社會公益的關注和參與。您是否積極參與社區活動，並為社會做出貢獻？",q17Title:"職業發展",q17Desc:"最近1年，您在職業技能提升和職涯規劃方面的表現如何？包括專業技能發展，職業規劃清晰度，以及對職業發展機會的把握。您是否持續提升職業技能，並有明確的職業發展路徑？",q18Title:"人際衝突處理",q18Desc:"最近3個月，您處理人際衝突和分歧的能力如何？包括衝突解決技巧，溝通協調能力，以及維護關係的智慧。您是否能夠有效處理人際衝突，並在分歧中尋求共識？",q19Title:"時間管理",q19Desc:"最近1年，您合理安排時間和優先級的能力如何？包括時間規劃效率，任務優先級設定，以及工作生活平衡的維持。您是否能夠有效管理時間，並在多重任務中保持效率？",q20Title:"整體滿意度",q20Desc:"最近6個月，您對整體生活狀況的滿意度如何？包括對生活質量的整體評價，對個人成就的滿意度，以及對未來生活前景的樂觀程度。您是否對當前的生活狀況感到滿意，並對未來充滿希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"評估分數",resultLabel:"評估結果",descriptionLabel:"詳細分析",recommendationsLabel:"改善建議",analysisLabel:"專業分析",privacyPolicy:"隱私權政策",terms:"條款/聲明",dataDeletion:"資料刪除說明",about:"🧬 Restarter™｜我們是誰",feedback:"💬 意見箱｜我們想聽你說"},"zh-CN":{title:"社会融入度评估",subtitle:"评估您的社会融入度，获得专业建议",subtitle2:"勇敢面对并定期检测自身社会融入程度进步状况，每一次评估都是成长的机会",backToHome:"返回",startAssessment:"开始评估",submitAssessment:"提交评估",cancelAssessment:"取消",closeAssessment:"关闭",assessmentComplete:"评估完成",viewReport:"查看报告",closeReport:"关闭报告",q1Title:"人际关系",q1Desc:"最近3个月，您与他人的互动和社交能力如何？包括与同事、朋友、邻居的日常交流，以及在新环境中建立关系的能力。您是否能够主动与他人沟通，建立信任关系，并在社交场合中感到自在？",q2Title:"就业状况",q2Desc:"最近1年，您的工作稳定性和发展前景如何？包括工作满意度、薪资待遇、职业发展机会、工作环境适应性，以及对未来职业规划的清晰度。您是否对当前工作感到满意，并有明确的职业发展目标？",q3Title:"家庭关系",q3Desc:"最近6个月，您与家人的相处和沟通状况如何？包括与配偶、子女、父母或其他家庭成员的关系质量，沟通频率和效果，以及家庭氛围的和谐程度。您是否能够有效处理家庭冲突，并为家庭成员提供情感支持？",q4Title:"未来信心",q4Desc:"您对未来1年的乐观程度和规划如何？包括对个人发展的信心，对生活目标的清晰度，以及面对挑战时的积极态度。您是否对未来有明确的规划，并相信自己能够实现目标？",q5Title:"社会接纳",q5Desc:"最近6个月，您感觉被社会接受和认可的程度如何？包括在社区中的融入度，社会地位的认同感，以及对社会规范的适应能力。您是否感到被社会接纳，并对自己的社会角色感到满意？",q6Title:"情绪管理",q6Desc:"最近3个月，您处理压力和负面情绪的能力如何？包括面对挫折时的情绪反应，压力调节方法，以及心理健康维护的意识。您是否能够有效管理负面情绪，并在压力下保持冷静？",q7Title:"生活规律",q7Desc:"最近6个月，您的生活作息和规律性如何？包括日常作息时间，饮食习惯，运动频率，以及生活节奏的稳定性。您是否能够维持健康的生活习惯，并建立规律的日常生活？",q8Title:"学习成长",q8Desc:"最近1年，您在技能学习和个人成长方面的投入如何？包括新技能学习，知识更新，自我提升的积极性，以及对个人发展的投资。您是否持续学习新知识，并主动寻求个人成长机会？",q9Title:"财务管理",q9Desc:"最近1年，您的财务规划和理财能力如何？包括收入支出管理，储蓄习惯，投资理财意识，以及对未来财务安全的规划。您是否能够有效管理个人财务，并为未来做好财务准备？",q10Title:"健康状况",q10Desc:"最近6个月，您的身体和心理健康状况如何？包括身体健康状况，心理健康状态，医疗保健意识，以及对健康问题的预防和处理能力。您是否重视健康管理，并采取积极的健康维护措施？",q11Title:"社交网络",q11Desc:"最近3个月，您建立和维护社交关系的能力如何？包括朋友数量，社交活动参与度，人际关系质量，以及社交网络的广度和深度。您是否拥有稳定的社交圈，并能够与他人建立有意义的关系？",q12Title:"目标设定",q12Desc:"最近1年，您设定和追求个人目标的能力如何？包括目标的明确性，计划的可行性，执行力，以及对目标达成度的评估。您是否能够设定清晰的目标，并有效执行计划？",q13Title:"适应能力",q13Desc:"最近6个月，您适应环境变化和挑战的能力如何？包括面对新环境的适应速度，应对变化的灵活性，以及从挫折中恢复的能力。您是否能够快速适应新环境，并在变化中保持稳定？",q14Title:"责任感",q14Desc:"最近1年，您对自己和他人负责的态度如何？包括对个人行为的责任感，对他人承诺的履行，以及对社会责任的认识。您是否能够承担个人责任，并对他人和社会负责？",q15Title:"自我认同",q15Desc:"最近6个月，您对自我价值和身份的认同感如何？包括对个人价值的认知，自我接纳程度，以及对个人身份的满意度。您是否对自己有清晰的认知，并能够接纳自己的优缺点？",q16Title:"社区参与",q16Desc:"最近1年，您参与社区活动和公益服务的情况如何？包括志愿服务参与度，社区活动贡献，以及对社会公益的关注和参与。您是否积极参与社区活动，并为社会做出贡献？",q17Title:"职业发展",q17Desc:"最近1年，您在职业技能提升和职涯规划方面的表现如何？包括专业技能发展，职业规划清晰度，以及对职业发展机会的把握。您是否持续提升职业技能，并有明确的职业发展路径？",q18Title:"人际冲突处理",q18Desc:"最近3个月，您处理人际冲突和分歧的能力如何？包括冲突解决技巧，沟通协调能力，以及维护关系的智慧。您是否能够有效处理人际冲突，并在分歧中寻求共识？",q19Title:"时间管理",q19Desc:"最近1年，您合理安排时间和优先级的能力如何？包括时间规划效率，任务优先级设定，以及工作生活平衡的维持。您是否能够有效管理时间，并在多重任务中保持效率？",q20Title:"整体满意度",q20Desc:"最近6个月，您对整体生活状况的满意度如何？包括对生活质量的整体评价，对个人成就的满意度，以及对未来生活前景的乐观程度。您是否对当前的生活状况感到满意，并对未来充满希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"评估分数",resultLabel:"评估结果",descriptionLabel:"详细分析",recommendationsLabel:"改善建议",analysisLabel:"专业分析",privacyPolicy:"隐私权政策",terms:"条款/声明",dataDeletion:"资料删除说明",about:"🧬 Restarter™｜我们是谁",feedback:"💬 意见箱｜我们想听你说"},en:{title:"Social Integration Assessment",subtitle:"Assess your social integration and get professional advice",subtitle2:"Face challenges bravely and regularly monitor your social integration progress, every assessment is an opportunity for growth",backToHome:"Back",startAssessment:"Start Assessment",submitAssessment:"Submit Assessment",cancelAssessment:"Cancel",closeAssessment:"Close",assessmentComplete:"Assessment Complete",viewReport:"View Report",closeReport:"Close Report",q1Title:"Interpersonal Relationships",q1Desc:"In the past 3 months, how is your interaction and social ability with others? Including daily communication with colleagues, friends, and neighbors, as well as the ability to build relationships in new environments. Are you able to actively communicate with others, build trust relationships, and feel comfortable in social situations?",q2Title:"Employment Status",q2Desc:"In the past year, how is your job stability and development prospects? Including job satisfaction, salary benefits, career development opportunities, work environment adaptability, and clarity of future career planning. Are you satisfied with your current job and have clear career development goals?",q3Title:"Family Relationships",q3Desc:"In the past 6 months, how is your relationship and communication with family? Including relationship quality with spouse, children, parents or other family members, communication frequency and effectiveness, and family atmosphere harmony. Are you able to effectively handle family conflicts and provide emotional support to family members?",q4Title:"Future Confidence",q4Desc:"In the past year, how optimistic are you about the future and your planning? Including confidence in personal development, clarity of life goals, and positive attitude when facing challenges. Do you have clear plans for the future and believe you can achieve your goals?",q5Title:"Social Acceptance",q5Desc:"In the past 6 months, how accepted and recognized do you feel by society? Including community integration, social status recognition, and adaptation to social norms. Do you feel accepted by society and satisfied with your social role?",q6Title:"Emotional Management",q6Desc:"In the past 3 months, how well do you handle stress and negative emotions? Including emotional responses when facing setbacks, stress regulation methods, and awareness of mental health maintenance. Are you able to effectively manage negative emotions and stay calm under pressure?",q7Title:"Life Routine",q7Desc:"In the past year, how regular is your daily routine and lifestyle? Including daily schedule, eating habits, exercise frequency, and stability of life rhythm. Are you able to maintain healthy living habits and establish regular daily life?",q8Title:"Learning & Growth",q8Desc:"In the past year, how much have you invested in skill learning and personal growth? Including new skill learning, knowledge updates, self-improvement initiative, and investment in personal development. Do you continuously learn new knowledge and actively seek personal growth opportunities?",q9Title:"Financial Management",q9Desc:"In the past year, how is your financial planning and money management? Including income and expense management, saving habits, investment awareness, and planning for future financial security. Are you able to effectively manage personal finances and prepare for the future?",q10Title:"Health Status",q10Desc:"In the past 6 months, how is your physical and mental health? Including physical health condition, mental health status, healthcare awareness, and ability to prevent and handle health issues. Do you value health management and take active health maintenance measures?",q11Title:"Social Network",q11Desc:"In the past 3 months, how well do you build and maintain social relationships? Including number of friends, social activity participation, relationship quality, and breadth and depth of social network. Do you have a stable social circle and can build meaningful relationships with others?",q12Title:"Goal Setting",q12Desc:"In the past year, how well do you set and pursue personal goals? Including goal clarity, plan feasibility, execution ability, and assessment of goal achievement. Are you able to set clear goals and effectively execute plans?",q13Title:"Adaptability",q13Desc:"In the past 6 months, how well do you adapt to environmental changes and challenges? Including adaptation speed to new environments, flexibility in coping with changes, and ability to recover from setbacks. Are you able to quickly adapt to new environments and maintain stability in changes?",q14Title:"Responsibility",q14Desc:"In the past year, how responsible are you towards yourself and others? Including personal behavior responsibility, fulfillment of commitments to others, and awareness of social responsibility. Are you able to take personal responsibility and be responsible for others and society?",q15Title:"Self-Identity",q15Desc:"In the past 6 months, how strong is your sense of self-worth and identity? Including awareness of personal value, self-acceptance level, and satisfaction with personal identity. Do you have a clear understanding of yourself and can accept your strengths and weaknesses?",q16Title:"Community Participation",q16Desc:"In the past 3 years, how involved are you in community activities and public service? Including volunteer service participation, community activity contribution, and attention and participation in social welfare. Do you actively participate in community activities and contribute to society?",q17Title:"Career Development",q17Desc:"In the past year, how well have you performed in skill enhancement and career planning? Including professional skill development, career planning clarity, and grasp of career development opportunities. Do you continuously improve professional skills and have clear career development paths?",q18Title:"Conflict Resolution",q18Desc:"In the past 3 months, how well do you handle interpersonal conflicts and disagreements? Including conflict resolution skills, communication coordination ability, and wisdom in maintaining relationships. Are you able to effectively handle interpersonal conflicts and seek consensus in disagreements?",q19Title:"Time Management",q19Desc:"In the past year, how well do you manage time and prioritize tasks? Including time planning efficiency, task priority setting, and maintenance of work-life balance. Are you able to effectively manage time and maintain efficiency in multiple tasks?",q20Title:"Overall Satisfaction",q20Desc:"In the past 6 months, how satisfied are you with your overall life situation? Including overall evaluation of life quality, satisfaction with personal achievements, and optimism about future life prospects. Are you satisfied with your current life situation and hopeful about the future?",excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement",terrible:"Very Poor",scoreLabel:"Assessment Score",resultLabel:"Assessment Result",descriptionLabel:"Detailed Analysis",recommendationsLabel:"Improvement Suggestions",analysisLabel:"Professional Analysis",privacyPolicy:"Privacy Policy",terms:"Terms/Statement",dataDeletion:"Data Deletion Guide",about:"🧬 Restarter™｜Who We Are",feedback:"💬 Feedback｜We Want to Hear You"},ko:{title:"사회 통합도 평가",subtitle:"사회 통합도를 평가하고 전문적인 조언을 받으세요",subtitle2:"용감하게 직면하고 정기적으로 자신의 사회 통합도 진전 상황을 점검하세요. 모든 평가는 성장의 기회입니다",backToHome:"돌아가기",startAssessment:"평가 시작",submitAssessment:"평가 제출",cancelAssessment:"취소",closeAssessment:"닫기",assessmentComplete:"평가 완료",viewReport:"보고서 보기",closeReport:"보고서 닫기",q1Title:"인간관계",q1Desc:"최근 3개월간 타인과의 상호작용과 사회적 능력은 어떠한가요? 동료, 친구, 이웃과의 일상적 교류와 새로운 환경에서 관계를 구축하는 능력을 포함합니다. 적극적으로 타인과 소통하고 신뢰 관계를 구축하며 사회적 상황에서 편안함을 느낄 수 있나요?",q2Title:"고용 상황",q2Desc:"최근 1년간 직업의 안정성과 발전 전망은 어떠한가요? 직업 만족도, 급여 대우, 직업 발전 기회, 직장 환경 적응성, 그리고 미래 직업 계획의 명확성을 포함합니다. 현재 직업에 만족하며 명확한 직업 발전 목표가 있나요?",q3Title:"가족 관계",q3Desc:"최근 6개월간 가족과의 생활과 소통 상황은 어떠한가요? 배우자, 자녀, 부모 또는 다른 가족 구성원과의 관계 품질, 소통 빈도와 효과, 그리고 가족 분위기의 조화를 포함합니다. 가족 갈등을 효과적으로 처리하고 가족 구성원에게 감정적 지원을 제공할 수 있나요?",q4Title:"미래에 대한 신뢰",q4Desc:"미래 1년에 대한 낙관적 정도와 계획은 어떠한가요? 개인 발전에 대한 신뢰, 삶의 목표에 대한 명확성, 그리고 도전에 직면할 때의 적극적 태도를 포함합니다. 미래에 대한 명확한 계획이 있으며 목표를 달성할 수 있다고 믿나요?",q5Title:"사회적 수용",q5Desc:"최근 6개월간 사회로부터 받아들여지고 인정받는다고 느끼는 정도는 어떠한가요? 지역사회에서의 통합도, 사회적 지위에 대한 동일시, 그리고 사회적 규범에 대한 적응 능력을 포함합니다. 사회로부터 받아들여진다고 느끼며 자신의 사회적 역할에 만족하나요?",q6Title:"감정 관리",q6Desc:"최근 3개월간 스트레스와 부정적 감정을 처리하는 능력은 어떠한가요? 좌절에 직면할 때의 감정적 반응, 스트레스 조절 방법, 그리고 정신 건강 유지에 대한 의식을 포함합니다. 부정적 감정을 효과적으로 관리하고 스트레스 하에서도 침착함을 유지할 수 있나요?",q7Title:"생활 규칙",q7Desc:"최근 6개월간 생활 습관과 규칙성은 어떠한가요? 일상 생활 시간, 식습관, 운동 빈도, 그리고 생활 리듬의 안정성을 포함합니다. 건강한 생활 습관을 유지하고 규칙적인 일상 생활을 구축할 수 있나요?",q8Title:"학습 성장",q8Desc:"최근 1년간 기술 학습과 개인 성장에 대한 투자는 어떠한가요? 새로운 기술 학습, 지식 업데이트, 자기 향상에 대한 적극성, 그리고 개인 발전에 대한 투자를 포함합니다. 새로운 지식을 지속적으로 학습하고 개인 성장 기회를 적극적으로 찾나요?",q9Title:"재정 관리",q9Desc:"최근 1년간 재정 계획과 재정 관리 능력은 어떠한가요? 수입 지출 관리, 저축 습관, 투자 재정 의식, 그리고 미래 재정 안전에 대한 계획을 포함합니다. 개인 재정을 효과적으로 관리하고 미래를 위한 재정 준비를 할 수 있나요?",q10Title:"건강 상태",q10Desc:"최근 6개월간 신체적, 정신적 건강 상태는 어떠한가요? 신체 건강 상태, 정신 건강 상태, 의료 보건 의식, 그리고 건강 문제에 대한 예방과 처리 능력을 포함합니다. 건강 관리에 중점을 두고 적극적인 건강 유지 조치를 취하나요?",q11Title:"사회적 네트워크",q11Desc:"최근 3개월간 사회적 관계를 구축하고 유지하는 능력은 어떠한가요? 친구 수, 사회적 활동 참여도, 인간관계 품질, 그리고 사회적 네트워크의 폭과 깊이를 포함합니다. 안정적인 사회적 서클을 가지고 타인과 의미 있는 관계를 구축할 수 있나요?",q12Title:"목표 설정",q12Desc:"최근 1년간 개인 목표를 설정하고 추구하는 능력은 어떠한가요? 목표의 명확성, 계획의 실현 가능성, 실행력, 그리고 목표 달성도에 대한 평가를 포함합니다. 명확한 목표를 설정하고 계획을 효과적으로 실행할 수 있나요?",q13Title:"적응 능력",q13Desc:"최근 6개월간 환경 변화와 도전에 적응하는 능력은 어떠한가요? 새로운 환경에 대한 적응 속도, 변화에 대응하는 유연성, 그리고 좌절에서 회복하는 능력을 포함합니다. 새로운 환경에 빠르게 적응하고 변화 속에서도 안정을 유지할 수 있나요?",q14Title:"책임감",q14Desc:"최근 1년간 자신과 타인에 대한 책임감 있는 태도는 어떠한가요? 개인 행동에 대한 책임감, 타인에 대한 약속 이행, 그리고 사회적 책임에 대한 인식을 포함합니다. 개인적 책임을 질 수 있고 타인과 사회에 대해 책임을 질 수 있나요?",q15Title:"자아 정체성",q15Desc:"최근 6개월간 자아 가치와 정체성에 대한 동일시는 어떠한가요? 개인 가치에 대한 인식, 자기 수용 정도, 그리고 개인 정체성에 대한 만족도를 포함합니다. 자신에 대한 명확한 인식이 있으며 자신의 장단점을 받아들일 수 있나요?",q16Title:"지역사회 참여",q16Desc:"최근 1년간 지역사회 활동과 공익 서비스 참여 상황은 어떠한가요? 자원봉사 참여도, 지역사회 활동 기여, 그리고 사회 복지에 대한 관심과 참여를 포함합니다. 지역사회 활동에 적극적으로 참여하고 사회에 기여하나요?",q17Title:"직업 발전",q17Desc:"최근 1년간 직업 기술 향상과 경력 계획 측면에서의 성과는 어떠한가요? 전문 기술 발전, 경력 계획 명확성, 그리고 경력 발전 기회에 대한 파악을 포함합니다. 직업 기술을 지속적으로 향상시키고 명확한 경력 발전 경로가 있나요?",q18Title:"인간관계 갈등 처리",q18Desc:"최근 3개월간 인간관계 갈등과 의견 차이를 처리하는 능력은 어떠한가요? 갈등 해결 기술, 소통 조정 능력, 그리고 관계 유지의 지혜를 포함합니다. 인간관계 갈등을 효과적으로 처리하고 의견 차이에서 합의를 찾을 수 있나요?",q19Title:"시간 관리",q19Desc:"최근 1년간 시간을 합리적으로 배치하고 우선순위를 설정하는 능력은 어떠한가요? 시간 계획 효율성, 작업 우선순위 설정, 그리고 업무와 생활의 균형 유지를 포함합니다. 시간을 효과적으로 관리하고 다중 작업에서도 효율성을 유지할 수 있나요?",q20Title:"전체 만족도",q20Desc:"최근 6개월간 전체적인 생활 상황에 대한 만족도는 어떠한가요? 생활 품질에 대한 전체적 평가, 개인 성취에 대한 만족도, 그리고 미래 생활 전망에 대한 낙관적 정도를 포함합니다. 현재의 생활 상황에 만족하며 미래에 대한 희망을 가지고 있나요?",excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요",terrible:"매우 나쁨",scoreLabel:"평가 점수",resultLabel:"평가 결과",descriptionLabel:"상세 분석",recommendationsLabel:"개선 제안",analysisLabel:"전문 분석",privacyPolicy:"개인정보 보호정책",terms:"약관/성명",dataDeletion:"데이터 삭제 안내",about:"🧬 Restarter™｜우리는 누구인가",feedback:"💬 의견함｜우리는 당신의 말을 듣고 싶습니다"}};function YI(){const{lang:t}=mw();le();const{isTestMode:n}=CB(),[i,r]=e.useState(0),a=QI[t]||QI["zh-TW"];e.useEffect(()=>{r(e=>e+1)},[t]);const[o,s]=e.useState(!1),[l,c]=e.useState(!1),[d,u]=e.useState({q1:"",q2:"",q3:"",q4:"",q5:"",q6:"",q7:"",q8:"",q9:"",q10:"",q11:"",q12:"",q13:"",q14:"",q15:"",q16:"",q17:"",q18:"",q19:"",q20:""}),[h,p]=e.useState(null),m=[{key:"q1",title:a.q1Title,desc:a.q1Desc},{key:"q2",title:a.q2Title,desc:a.q2Desc},{key:"q3",title:a.q3Title,desc:a.q3Desc},{key:"q4",title:a.q4Title,desc:a.q4Desc},{key:"q5",title:a.q5Title,desc:a.q5Desc},{key:"q6",title:a.q6Title,desc:a.q6Desc},{key:"q7",title:a.q7Title,desc:a.q7Desc},{key:"q8",title:a.q8Title,desc:a.q8Desc},{key:"q9",title:a.q9Title,desc:a.q9Desc},{key:"q10",title:a.q10Title,desc:a.q10Desc},{key:"q11",title:a.q11Title,desc:a.q11Desc},{key:"q12",title:a.q12Title,desc:a.q12Desc},{key:"q13",title:a.q13Title,desc:a.q13Desc},{key:"q14",title:a.q14Title,desc:a.q14Desc},{key:"q15",title:a.q15Title,desc:a.q15Desc},{key:"q16",title:a.q16Title,desc:a.q16Desc},{key:"q17",title:a.q17Title,desc:a.q17Desc},{key:"q18",title:a.q18Title,desc:a.q18Desc},{key:"q19",title:a.q19Title,desc:a.q19Desc},{key:"q20",title:a.q20Title,desc:a.q20Desc}],g=[{value:"excellent",label:a.excellent},{value:"good",label:a.good},{value:"fair",label:a.fair},{value:"poor",label:a.poor},{value:"terrible",label:a.terrible}];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",display:"flex",flexDirection:"column"},children:[f.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"30px"},children:f.jsxs("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0,textAlign:"center"},children:["📊 ",a.title]})}),f.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"30px"},children:f.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",maxWidth:"500px",width:"calc(100% - 80px)",margin:"0 40px",textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[f.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:"📊"}),f.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"#333",marginBottom:"16px"},children:a.title}),f.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",marginBottom:"20px"},children:a.subtitle}),f.jsx("p",{style:{fontSize:"14px",color:"#888",lineHeight:"1.5",marginBottom:"30px",fontStyle:"italic"},children:a.subtitle2}),f.jsx("button",{onClick:()=>s(!0),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"16px",padding:"16px 32px",fontSize:"18px",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)"},children:a.startAssessment})]})}),o&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:f.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto",position:"relative"},children:[f.jsx("button",{onClick:()=>s(!1),style:{position:"absolute",top:"15px",right:"20px",background:"none",border:"none",fontSize:"24px",color:"#666",cursor:"pointer",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#f0f0f0",e.currentTarget.style.color="#333"},onMouseLeave:e=>{e.currentTarget.style.background="none",e.currentTarget.style.color="#666"},children:"×"}),f.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"20px",textAlign:"center",paddingRight:"40px"},children:a.title}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:m.map((e,t)=>f.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[f.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:[t+1,". ",e.title]}),f.jsx("p",{style:{fontSize:"14px",color:"#666",marginBottom:"16px"},children:e.desc}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:g.map(t=>f.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"10px",borderRadius:"8px",cursor:"pointer",background:d[e.key]===t.value?"#6B5BFF":"white",color:d[e.key]===t.value?"white":"#333",border:"2px solid "+(d[e.key]===t.value?"#6B5BFF":"#ddd"),transition:"all 0.2s ease",fontSize:"13px"},children:[f.jsx("input",{type:"radio",name:e.key,value:t.value,checked:d[e.key]===t.value,onChange:t=>u({...d,[e.key]:t.target.value}),style:{marginRight:"10px"}}),t.label]},t.value))})]},e.key))}),f.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"30px",justifyContent:"center"},children:[f.jsx("button",{onClick:()=>s(!1),style:{background:"#f0f0f0",color:"#666",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.cancelAssessment}),f.jsx("button",{onClick:()=>{if(!Object.values(d).every(e=>""!==e))return void alert("請回答所有問題");const e=(e=>{const t={excellent:5,good:4,fair:3,poor:2,terrible:1},n=[t[e.q1]||3,t[e.q2]||3,t[e.q3]||3,t[e.q4]||3,t[e.q5]||3,t[e.q6]||3,t[e.q7]||3,t[e.q8]||3,t[e.q9]||3,t[e.q10]||3,t[e.q11]||3,t[e.q12]||3,t[e.q13]||3,t[e.q14]||3,t[e.q15]||3,t[e.q16]||3,t[e.q17]||3,t[e.q18]||3,t[e.q19]||3,t[e.q20]||3],i=n.reduce((e,t)=>e+t,0)/20,r={interpersonal:(n[0]+n[10]+n[17])/3,career:(n[1]+n[16])/2,family:n[2],emotional:(n[5]+n[14])/2,lifestyle:(n[6]+n[9]+n[18])/3,learning:(n[7]+n[11]+n[12])/3,financial:n[8],responsibility:n[13],community:n[15],satisfaction:n[19]},a=Object.entries(r).filter(([e,t])=>t>=4).map(([e,t])=>e),o=Object.entries(r).filter(([e,t])=>t<=2).map(([e,t])=>e);if(i>=4.5){const e=[{condition:a.includes("interpersonal")&&a.includes("career"),description:"你的社會融入度表現卓越！在人際關係和職業發展方面表現特別突出，顯示出優秀的社交能力和職業素養。",recommendations:["繼續保持優秀的人際交往能力","可以考慮擔任職場導師幫助其他更生人","分享你的職業成功經驗","參與專業社群擴大影響力"],analysis:"你在人際關係和職業發展方面的優秀表現，表明你已經完全融入社會。建議繼續發揮這些優勢，並幫助其他需要支持的人。"},{condition:a.includes("emotional")&&a.includes("family"),description:"你的社會融入度表現優秀！在情緒管理和家庭關係方面表現特別突出，顯示出良好的心理素質和家庭和諧。",recommendations:["繼續保持穩定的情緒狀態","可以擔任家庭關係諮詢志工","分享你的家庭和諧經驗","參與心理健康推廣活動"],analysis:"你在情緒管理和家庭關係方面的優秀表現，表明你具備良好的心理素質和家庭責任感。建議繼續保持這種狀態。"},{condition:a.includes("lifestyle")&&a.includes("learning"),description:"你的社會融入度表現優秀！在生活規律和學習成長方面表現特別突出，顯示出良好的自律能力和進取精神。",recommendations:["繼續保持規律的生活習慣","可以擔任學習輔導志工","分享你的學習方法和經驗","參與教育推廣活動"],analysis:"你在生活規律和學習成長方面的優秀表現，表明你具備良好的自律能力和進取精神。建議繼續發揮這些優勢。"},{condition:a.includes("financial")&&a.includes("responsibility"),description:"你的社會融入度表現優秀！在財務管理和責任感方面表現特別突出，顯示出良好的理財能力和社會責任感。",recommendations:["繼續保持穩健的財務管理","可以擔任財務規劃志工","分享你的理財經驗","參與社會責任活動"],analysis:"你在財務管理和責任感方面的優秀表現，表明你具備良好的理財能力和社會責任感。建議繼續發揮這些優勢。"},{condition:a.includes("community")&&a.includes("satisfaction"),description:"你的社會融入度表現優秀！在社區參與和整體滿意度方面表現特別突出，顯示出良好的社會參與度和生活滿意度。",recommendations:["繼續積極參與社區活動","可以擔任社區志工領袖","分享你的社區參與經驗","參與更多公益活動"],analysis:"你在社區參與和整體滿意度方面的優秀表現，表明你已經完全融入社會並對生活感到滿意。建議繼續保持這種狀態。"}].find(e=>e.condition)||{description:`恭喜您！您的社會融入度評估結果顯示您已經達到了優秀水平。在${a.length>0?a.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"多個重要維度"}方面，您展現出了卓越的能力和積極的態度。這表明您已經成功建立了穩定的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來充滿信心。您的表現不僅為自己創造了美好的生活，也為其他更生人樹立了積極的榜樣。`,recommendations:["繼續保持現有的優秀表現，定期進行自我評估以維持高水準","考慮擔任更生人互助團體的導師或志工，分享您的成功經驗","參與專業社群和行業交流，進一步提升職業技能和社會影響力","建立個人品牌，成為更生人融入社會的典範","定期參與公益活動，回饋社會並擴大正面影響力","考慮擔任職場導師，幫助其他更生人提升就業競爭力","建立個人發展檔案，記錄成長歷程並分享給需要支持的人"],analysis:`基於您完成的20項詳細評估，我們發現您在${a.length>0?a.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"各個關鍵維度"}都表現出色。這表明您已經完全融入了社會，具備了優秀的社會適應能力、職業素養和生活技能。您的成功不僅體現在個人成就上，更重要的是您展現出了積極的生活態度和對未來的清晰規劃。建議您繼續保持這種優秀狀態，並考慮將您的經驗分享給其他需要支持的人，成為更生人融入社會的典範。您的表現證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:i,result:"優秀",description:e.description,recommendations:e.recommendations,analysis:e.analysis}}if(i>=3.5){const e=[{condition:o.includes("interpersonal")&&a.includes("career"),description:"你的社會融入度良好，在職業發展方面表現不錯，但人際關係需要改善。",recommendations:["參加人際溝通技巧培訓","主動參與社交活動","尋求人際關係諮詢","繼續保持職業發展優勢"],analysis:"你在職業發展方面表現良好，但人際關係需要改善。建議重點提升社交能力，同時保持職業優勢。"},{condition:o.includes("emotional")&&a.includes("family"),description:"你的社會融入度良好，在家庭關係方面表現不錯，但情緒管理需要改善。",recommendations:["參加情緒管理課程","尋求心理諮商服務","學習壓力調節技巧","繼續維護良好的家庭關係"],analysis:"你在家庭關係方面表現良好，但情緒管理需要改善。建議重點提升情緒管理能力。"},{condition:o.includes("lifestyle")&&a.includes("learning"),description:"你的社會融入度良好，在學習成長方面表現不錯，但生活規律需要改善。",recommendations:["制定規律的作息時間表","建立健康的生活習慣","參加時間管理課程","繼續保持學習熱情"],analysis:"你在學習成長方面表現良好，但生活規律需要改善。建議重點建立規律的生活習慣。"},{condition:o.includes("financial")&&a.includes("responsibility"),description:"你的社會融入度良好，在責任感方面表現不錯，但財務管理需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","學習理財知識","繼續保持責任感"],analysis:"你在責任感方面表現良好，但財務管理需要改善。建議重點提升財務管理能力。"},{condition:o.includes("community")&&a.includes("satisfaction"),description:"你的社會融入度良好，對生活滿意度不錯，但社區參與需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","參與公益活動","繼續保持積極的生活態度"],analysis:"你對生活滿意度不錯，但社區參與需要改善。建議重點提升社會參與度。"}].find(e=>e.condition)||{description:`您的社會融入度評估結果顯示您達到了良好水平。在${a.length>0?a.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"多個重要維度"}方面，您展現出了穩定的能力和積極的態度。這表明您已經建立了基本的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來有一定的規劃。雖然在某些方面還有提升空間，但您的整體表現已經為進一步發展奠定了堅實的基礎。`,recommendations:["繼續保持現有的良好狀態，建立定期自我評估機制",o.length>0?`制定${o.join("、")}方面的具體改善計劃，設定明確的目標和時間表`:"進一步提升各方面能力，設定更具挑戰性的目標","參加專業技能培訓和認證課程，提升職業競爭力","加強與社區的互動和參與，擴大社交網絡","尋求導師指導，學習成功人士的經驗和方法","建立個人發展檔案，記錄進步歷程和成就","參與更生人互助團體，與同路人分享經驗和互相支持"],analysis:`基於您完成的20項詳細評估，我們發現您在${a.length>0?a.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"多個關鍵維度"}表現良好，具備了基本的社會適應能力和生活技能。${o.length>0?`特別是在${o.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}您的整體表現表明您已經成功融入了社會，並且具備了進一步發展的潛力。建議您繼續保持積極的態度，設定更具挑戰性的目標，並尋求更多學習和成長的機會。您的進步證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:i,result:"良好",description:e.description,recommendations:e.recommendations,analysis:e.analysis}}if(i>=2.5){const e=[{condition:o.includes("interpersonal")&&o.includes("career"),description:"你的社會融入度一般，在人際關係和職業發展方面都需要改善。",recommendations:["參加人際溝通技巧培訓","尋求職業技能培訓","參加更生人互助團體","建立職業發展計劃","尋求專業輔導師幫助"],analysis:"你在人際關係和職業發展方面都需要改善。建議同時提升社交能力和職業技能，尋求專業支持。"},{condition:o.includes("emotional")&&o.includes("family"),description:"你的社會融入度一般，在情緒管理和家庭關係方面都需要改善。",recommendations:["尋求心理諮商服務","參加情緒管理課程","改善家庭溝通方式","建立家庭支持系統","尋求專業輔導師幫助"],analysis:"你在情緒管理和家庭關係方面都需要改善。建議重點提升心理健康和家庭關係。"},{condition:o.includes("lifestyle")&&o.includes("learning"),description:"你的社會融入度一般，在生活規律和學習成長方面都需要改善。",recommendations:["制定規律的作息時間表","參加時間管理課程","建立學習計劃","尋找學習夥伴","尋求專業輔導師幫助"],analysis:"你在生活規律和學習成長方面都需要改善。建議重點建立規律的生活習慣和學習計劃。"},{condition:o.includes("financial")&&o.includes("responsibility"),description:"你的社會融入度一般，在財務管理和責任感方面都需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","提升責任感意識","建立財務目標","尋求專業輔導師幫助"],analysis:"你在財務管理和責任感方面都需要改善。建議重點提升理財能力和責任感。"},{condition:o.includes("community")&&o.includes("satisfaction"),description:"你的社會融入度一般，在社區參與和整體滿意度方面都需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","提升生活滿意度","建立社交網絡","尋求專業輔導師幫助"],analysis:"你在社區參與和整體滿意度方面都需要改善。建議重點提升社會參與度和生活滿意度。"}].find(e=>e.condition)||{description:`您的社會融入度評估結果顯示您目前處於一般水平。在${o.length>0?o.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"某些重要維度"}方面，您需要更多的支持和改善。這表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗，而是需要更多專業指導和支持的表現。${a.length>0?`同時，您在${a.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}建議您積極尋求專業支持，制定系統性的改善計劃。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃","參加更生人支持計劃和互助團體，獲得同路人支持","建立穩定的生活規律，包括作息時間、飲食習慣和運動計劃","加強人際關係建設，學習有效的溝通技巧",a.length>0?`充分發揮${a.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、")}方面的優勢，建立自信心`:"尋找個人優勢並加以發揮，建立自信心","參加職業技能培訓，提升就業競爭力","建立支持網絡，包括家人、朋友和專業人士","制定短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度"],analysis:`基於您完成的20項詳細評估，我們發現您在${o.length>0?o.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"某些關鍵維度"}需要更多支持。${o.length>0?`特別是在${o.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}${a.length>0?`同時，您在${a.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}您的評估結果表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並尋求幫助。建議您積極尋求專業支持，制定系統性的改善計劃，並相信通過持續的努力，您一定能夠取得進步。`};return{score:i,result:"一般",description:e.description,recommendations:e.recommendations,analysis:e.analysis}}{const e=[{condition:o.includes("interpersonal")&&o.includes("emotional"),description:"你的社會融入度需要改善，在人際關係和情緒管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","尋求心理諮商服務","參加人際溝通技巧培訓","參加情緒管理課程","建立支持網絡"],analysis:"你在人際關係和情緒管理方面都需要專業支持。建議立即尋求專業幫助，逐步改善這些方面。"},{condition:o.includes("career")&&o.includes("financial"),description:"你的社會融入度需要改善，在職業發展和財務管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","參加職業技能培訓","參加財務規劃課程","制定職業發展計劃","建立財務目標"],analysis:"你在職業發展和財務管理方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:o.includes("family")&&o.includes("lifestyle"),description:"你的社會融入度需要改善，在家庭關係和生活規律方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","改善家庭溝通方式","制定規律的作息時間表","建立家庭支持系統","參加家庭關係諮詢"],analysis:"你在家庭關係和生活規律方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"},{condition:o.includes("learning")&&o.includes("responsibility"),description:"你的社會融入度需要改善，在學習成長和責任感方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","制定學習計劃","提升責任感意識","尋找學習夥伴","建立目標管理系統"],analysis:"你在學習成長和責任感方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:o.includes("community")&&o.includes("satisfaction"),description:"你的社會融入度需要改善，在社區參與和整體滿意度方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","主動參與社區活動","提升生活滿意度","加入志願服務團體","建立社交網絡"],analysis:"你在社區參與和整體滿意度方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"}].find(e=>e.condition)||{description:`您的社會融入度評估結果顯示您目前面臨較大的挑戰，在${o.length>0?o.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"多個重要維度"}都需要專業支持和改善。這表明您在社會融入過程中遇到了較多的困難，但這絕對不是失敗，而是需要更多專業幫助的表現。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。建議您立即聯繫專業輔導師，制定系統性的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃和時間表","參加更生人支持計劃和互助團體，獲得同路人支持和理解","尋求專業心理諮商服務，處理可能的情緒和心理問題","建立穩定的生活規律，包括規律的作息、健康的飲食和適度的運動","尋求家人和朋友的支持，建立穩定的支持網絡","參加職業技能培訓和就業輔導，提升就業競爭力","建立短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度並調整計劃","學習有效的壓力管理和情緒調節技巧","參與社區活動，逐步建立社交網絡"],analysis:`基於您完成的20項詳細評估，我們發現您在${o.length>0?o.map(e=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"}[e]||e)).join("、"):"多個關鍵維度"}需要專業支持。您的評估結果表明您目前在社會融入過程中遇到了較多的挑戰，但這絕對不是失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。專業輔導師可以幫助您制定適合的改善計劃，提供系統性的支持和指導。建議您立即聯繫專業輔導師，制定個人化的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。記住，尋求幫助是勇敢的表現，也是成功改善的第一步。`};return{score:i,result:"需要改善",description:e.description,recommendations:e.recommendations,analysis:e.analysis}}})(d),t={score:e.score,result:e.result,description:e.description,recommendations:e.recommendations,analysis:e.analysis,details:{relationships:d.q1,employment:d.q2,family:d.q3,confidence:d.q4,acceptance:d.q5,emotional:d.q6,routine:d.q7,learning:d.q8,financial:d.q9,health:d.q10,social:d.q11,goals:d.q12,adaptability:d.q13,responsibility:d.q14,identity:d.q15,community:d.q16,career:d.q17,conflict:d.q18,time:d.q19,satisfaction:d.q20}};p(t),s(!1),c(!0)},style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.submitAssessment})]})]})}),l&&h&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:f.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[f.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[f.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📊"}),f.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"8px"},children:a.assessmentComplete})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[f.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",borderRadius:"16px",padding:"24px",textAlign:"center"},children:[f.jsxs("div",{style:{fontSize:"36px",fontWeight:"700",marginBottom:"8px"},children:[h.score.toFixed(1),"/5.0"]}),f.jsx("div",{style:{fontSize:"20px",fontWeight:"600"},children:h.result})]}),f.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[f.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:a.descriptionLabel}),f.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:h.description})]}),f.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[f.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:a.analysisLabel}),f.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:h.analysis})]}),f.jsxs("div",{style:{border:"2px solid #FFE4E1",borderRadius:"16px",padding:"20px",background:"linear-gradient(135deg, #FFF5F5, #FFE4E1)",boxShadow:"0 4px 12px rgba(255, 182, 193, 0.2)"},children:[f.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#D63384",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:["💡 ",a.recommendationsLabel]}),f.jsx("ul",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",paddingLeft:"20px"},children:h.recommendations.map((e,t)=>f.jsx("li",{style:{marginBottom:"8px"},children:e},t))})]})]}),f.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"30px"},children:f.jsx("button",{onClick:()=>c(!1),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.closeReport})})]})})]})}const JI=Fv(lw),XI={"zh-TW":{title:"確認註冊",confirming:"正在確認註冊...",success:"註冊成功！",error:"確認失敗",invalidToken:"確認連結無效或已過期",networkError:"網路連線失敗，請稍後再試",redirecting:"正在跳轉到首頁..."},"zh-CN":{title:"确认注册",confirming:"正在确认注册...",success:"注册成功！",error:"确认失败",invalidToken:"确认链接无效或已过期",networkError:"网络连接失败，请稍后再试",redirecting:"正在跳转到首页..."},en:{title:"Confirm Registration",confirming:"Confirming registration...",success:"Registration successful!",error:"Confirmation failed",invalidToken:"Confirmation link is invalid or expired",networkError:"Network connection failed, please try again later",redirecting:"Redirecting to homepage..."}};function ZI(){const t=le(),[n]=Re(),{lang:i}=mw(),r=XI[i]||XI["zh-TW"],[a,o]=e.useState("confirming"),[s,l]=e.useState("");return e.useEffect(()=>{const e=n.get("token");if(!e)return o("error"),void l(r.invalidToken);(async()=>{var n,i;try{const n=await fetch(ww("/email-verification/confirm-registration"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),i=await n.json();if(i.success){const{email:e,registrationData:n}=i,a=await pb(JI,e,n.password);await gb(a.user,{displayName:n.nickname}),await Mf(hg(cw,"profiles",a.user.uid),{nickname:n.nickname,email:e,avatar:"",gender:n.gender,country:n.country,region:n.region,age:n.age,interest:n.interest,eventType:n.eventType,improvement:n.improvement,createdAt:new Date,updatedAt:new Date}),o("success"),l(r.success),setTimeout(()=>{t("/")},3e3)}else o("error"),l(i.error||r.error)}catch(a){o("error"),(null==(n=null==a?void 0:a.message)?void 0:n.includes("Failed to fetch"))||(null==(i=null==a?void 0:a.message)?void 0:i.includes("NetworkError"))?l(r.networkError):l((null==a?void 0:a.message)||r.error)}})()},[n,t,r]),f.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:f.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"40px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",textAlign:"center",maxWidth:"400px",width:"90%"},children:[f.jsxs("div",{style:{marginBottom:"24px"},children:["confirming"===a&&f.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"⏳"}),"success"===a&&f.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"✅"}),"error"===a&&f.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"❌"}),f.jsxs("h1",{style:{color:"success"===a?"#10b981":"error"===a?"#ef4444":"#6B5BFF",fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:["confirming"===a&&r.confirming,"success"===a&&r.success,"error"===a&&r.error]}),f.jsx("p",{style:{color:"#666",fontSize:"16px",lineHeight:"1.5"},children:s})]}),"success"===a&&f.jsx("div",{style:{background:"#f0f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #0ea5e9",marginTop:"16px"},children:f.jsx("p",{style:{color:"#0c4a6e",fontSize:"14px"},children:r.redirecting})}),"error"===a&&f.jsx("button",{onClick:()=>t("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",marginTop:"16px"},children:"返回註冊頁面"})]})})}const eB={"zh-TW":{title:"AI使用聲明",subtitle:"關於Restarter™中AI功能的使用說明",back:"返回",logout:"登出",sections:{intro:{title:"引言",content:"Restarter™使用人工智能技術來提供個性化的心理健康支援服務。本聲明旨在向您說明我們如何使用AI技術，以及您在使用這些功能時的權利和責任。"},aiFeatures:{title:"AI功能說明",content:"我們的AI功能包括：智能對話、情緒分析、個性化建議、內容生成等。這些功能旨在提供輔助性的心理健康支援，而非替代專業醫療服務。"},dataUsage:{title:"數據使用",content:"為了提供更好的AI服務，我們可能會收集和分析您與AI的互動數據。所有數據都經過加密處理，並嚴格遵守隱私保護規定。"},limitations:{title:"使用限制",content:"AI功能僅供輔助使用，不應作為專業醫療建議的替代。在緊急情況下，請立即聯繫專業醫療人員或撥打緊急求助電話。"},accuracy:{title:"準確性聲明",content:"雖然我們致力於提供準確的AI回應，但AI技術仍存在局限性。我們建議您對AI提供的建議保持批判性思考。"},userRights:{title:"用戶權利",content:"您有權了解AI如何處理您的數據，有權要求更正或刪除相關數據，也有權選擇不使用AI功能。"},updates:{title:"更新通知",content:"我們會定期更新AI功能和相關政策。重要更新會通過應用程式內通知或電子郵件告知用戶。"},contact:{title:"聯繫我們",content:"如果您對AI功能有任何疑問或建議，請通過應用程式內的意見箱或客服系統與我們聯繫。"}}},"zh-CN":{title:"AI使用声明",subtitle:"关于Restarter™中AI功能的使用说明",back:"返回",logout:"登出",sections:{intro:{title:"引言",content:"Restarter™使用人工智能技术来提供个性化的心理健康支持服务。本声明旨在向您说明我们如何使用AI技术，以及您在使用这些功能时的权利和责任。"},aiFeatures:{title:"AI功能说明",content:"我们的AI功能包括：智能对话、情绪分析、个性化建议、内容生成等。这些功能旨在提供辅助性的心理健康支持，而非替代专业医疗服务。"},dataUsage:{title:"数据使用",content:"为了提供更好的AI服务，我们可能会收集和分析您与AI的互动数据。所有数据都经过加密处理，并严格遵守隐私保护规定。"},limitations:{title:"使用限制",content:"AI功能仅供辅助使用，不应作为专业医疗建议的替代。在紧急情况下，请立即联系专业医疗人员或拨打紧急求助电话。"},accuracy:{title:"准确性声明",content:"虽然我们致力于提供准确的AI回应，但AI技术仍存在局限性。我们建议您对AI提供的建议保持批判性思考。"},userRights:{title:"用户权利",content:"您有权了解AI如何处理您的数据，有权要求更正或删除相关数据，也有权选择不使用AI功能。"},updates:{title:"更新通知",content:"我们会定期更新AI功能和相关政策。重要更新会通过应用程序内通知或电子邮件告知用户。"},contact:{title:"联系我们",content:"如果您对AI功能有任何疑问或建议，请通过应用程序内的意见箱或客服系统与我们联系。"}}},en:{title:"AI Usage Statement",subtitle:"Information about AI features in Restarter™",back:"Back",logout:"Logout",sections:{intro:{title:"Introduction",content:"Restarter™ uses artificial intelligence technology to provide personalized mental health support services. This statement aims to explain how we use AI technology and your rights and responsibilities when using these features."},aiFeatures:{title:"AI Features",content:"Our AI features include: intelligent conversations, emotion analysis, personalized recommendations, content generation, etc. These features are designed to provide辅助mental health support, not as a substitute for professional medical services."},dataUsage:{title:"Data Usage",content:"To provide better AI services, we may collect and analyze your interaction data with AI. All data is encrypted and strictly complies with privacy protection regulations."},limitations:{title:"Usage Limitations",content:"AI features are for辅助use only and should not be used as a substitute for professional medical advice. In emergency situations, please contact professional medical personnel or call emergency numbers immediately."},accuracy:{title:"Accuracy Statement",content:"While we strive to provide accurate AI responses, AI technology still has limitations. We recommend maintaining critical thinking about AI-provided suggestions."},userRights:{title:"User Rights",content:"You have the right to understand how AI processes your data, request correction or deletion of related data, and choose not to use AI features."},updates:{title:"Update Notifications",content:"We regularly update AI features and related policies. Important updates will be notified to users through in-app notifications or email."},contact:{title:"Contact Us",content:"If you have any questions or suggestions about AI features, please contact us through the feedback box or customer service system in the app."}}},ja:{title:"AI利用声明",subtitle:"Restarter™におけるAI機能の利用に関する説明",back:"戻る",logout:"ログアウト",sections:{intro:{title:"はじめに",content:"Restarter™は人工知能技術を使用して、パーソナライズされたメンタルヘルスサポートサービスを提供しています。この声明は、AI技術の使用方法と、これらの機能を使用する際の権利と責任について説明することを目的としています。"},aiFeatures:{title:"AI機能",content:"当社のAI機能には、インテリジェントな会話、感情分析、パーソナライズされた推奨事項、コンテンツ生成などが含まれます。これらの機能は、専門的な医療サービスの代替ではなく、補助的なメンタルヘルスサポートを提供することを目的としています。"},dataUsage:{title:"データ使用",content:"より良いAIサービスを提供するために、AIとの対話データを収集・分析する場合があります。すべてのデータは暗号化され、プライバシー保護規定を厳格に遵守しています。"},limitations:{title:"利用制限",content:"AI機能は補助的な使用のみを目的としており、専門的な医療アドバイスの代替として使用すべきではありません。緊急時には、専門医療従事者に連絡するか、緊急電話番号に電話してください。"},accuracy:{title:"正確性声明",content:"正確なAI応答を提供することに努めていますが、AI技術にはまだ限界があります。AIが提供する提案について批判的思考を保つことをお勧めします。"},userRights:{title:"ユーザー権利",content:"AIがデータをどのように処理するかを理解する権利、関連データの修正や削除を要求する権利、AI機能を使用しないことを選択する権利があります。"},updates:{title:"更新通知",content:"AI機能と関連ポリシーを定期的に更新します。重要な更新は、アプリ内通知またはメールでユーザーに通知されます。"},contact:{title:"お問い合わせ",content:"AI機能についてご質問やご提案がございましたら、アプリ内のフィードバックボックスまたはカスタマーサービスシステムを通じてお問い合わせください。"}}},ko:{title:"AI 사용 성명",subtitle:"Restarter™의 AI 기능 사용에 대한 설명",back:"뒤로",logout:"로그아웃",sections:{intro:{title:"소개",content:"Restarter™는 개인화된 정신 건강 지원 서비스를 제공하기 위해 인공지능 기술을 사용합니다. 이 성명은 AI 기술을 어떻게 사용하는지, 그리고 이러한 기능을 사용할 때의 권리와 책임에 대해 설명하는 것을 목적으로 합니다."},aiFeatures:{title:"AI 기능",content:"우리의 AI 기능에는 지능형 대화, 감정 분석, 개인화된 추천, 콘텐츠 생성 등이 포함됩니다. 이러한 기능은 전문 의료 서비스의 대체가 아닌 보조적인 정신 건강 지원을 제공하기 위해 설계되었습니다."},dataUsage:{title:"데이터 사용",content:"더 나은 AI 서비스를 제공하기 위해 AI와의 상호작용 데이터를 수집하고 분석할 수 있습니다. 모든 데이터는 암호화되며 개인정보 보호 규정을 엄격히 준수합니다."},limitations:{title:"사용 제한",content:"AI 기능은 보조적 사용만을 목적으로 하며 전문 의료 조언의 대체로 사용되어서는 안 됩니다. 긴급 상황에서는 즉시 전문 의료진에 연락하거나 긴급 전화번호로 전화하세요."},accuracy:{title:"정확성 성명",content:"정확한 AI 응답을 제공하기 위해 노력하고 있지만, AI 기술에는 여전히 한계가 있습니다. AI가 제공하는 제안에 대해 비판적 사고를 유지하는 것을 권장합니다."},userRights:{title:"사용자 권리",content:"AI가 데이터를 어떻게 처리하는지 이해할 권리, 관련 데이터의 수정이나 삭제를 요청할 권리, AI 기능을 사용하지 않을 권리가 있습니다."},updates:{title:"업데이트 알림",content:"AI 기능과 관련 정책을 정기적으로 업데이트합니다. 중요한 업데이트는 앱 내 알림이나 이메일로 사용자에게 알려집니다."},contact:{title:"연락처",content:"AI 기능에 대한 질문이나 제안이 있으시면 앱 내 피드백 상자나 고객 서비스 시스템을 통해 문의해 주세요."}}},th:{title:"คำแถลงการใช้ AI",subtitle:"ข้อมูลเกี่ยวกับฟีเจอร์ AI ใน Restarter™",back:"กลับ",logout:"ออกจากระบบ",sections:{intro:{title:"บทนำ",content:"Restarter™ ใช้เทคโนโลยีปัญญาประดิษฐ์เพื่อให้บริการสนับสนุนสุขภาพจิตส่วนบุคคล คำแถลงนี้มีวัตถุประสงค์เพื่ออธิบายวิธีที่เราใช้เทคโนโลยี AI และสิทธิ์และความรับผิดชอบของคุณเมื่อใช้ฟีเจอร์เหล่านี้"},aiFeatures:{title:"ฟีเจอร์ AI",content:"ฟีเจอร์ AI ของเรารวมถึง: การสนทนาอัจฉริยะ การวิเคราะห์อารมณ์ คำแนะนำส่วนบุคคล การสร้างเนื้อหา เป็นต้น ฟีเจอร์เหล่านี้ได้รับการออกแบบมาเพื่อให้การสนับสนุนสุขภาพจิตแบบเสริม ไม่ใช่เป็นทางเลือกแทนบริการทางการแพทย์มืออาชีพ"},dataUsage:{title:"การใช้ข้อมูล",content:"เพื่อให้บริการ AI ที่ดีขึ้น เราอาจเก็บรวบรวมและวิเคราะห์ข้อมูลการโต้ตอบของคุณกับ AI ข้อมูลทั้งหมดได้รับการเข้ารหัสและปฏิบัติตามระเบียบการคุ้มครองความเป็นส่วนตัวอย่างเคร่งครัด"},limitations:{title:"ข้อจำกัดการใช้งาน",content:"ฟีเจอร์ AI มีไว้สำหรับการใช้งานเสริมเท่านั้นและไม่ควรใช้เป็นทางเลือกแทนคำแนะนำทางการแพทย์มืออาชีพ ในสถานการณ์ฉุกเฉิน กรุณาติดต่อบุคลากรทางการแพทย์มืออาชีพหรือโทรหาหมายเลขฉุกเฉินทันที"},accuracy:{title:"คำแถลงความถูกต้อง",content:"ในขณะที่เราพยายามให้การตอบสนอง AI ที่ถูกต้อง แต่เทคโนโลยี AI ยังมีข้อจำกัด เราขอแนะนำให้รักษาการคิดเชิงวิพากษ์เกี่ยวกับข้อเสนอแนะที่ AI ให้"},userRights:{title:"สิทธิ์ผู้ใช้",content:"คุณมีสิทธิ์ที่จะเข้าใจว่า AI ประมวลผลข้อมูลของคุณอย่างไร ขอให้แก้ไขหรือลบข้อมูลที่เกี่ยวข้อง และเลือกที่จะไม่ใช้ฟีเจอร์ AI"},updates:{title:"การแจ้งเตือนการอัปเดต",content:"เราอัปเดตฟีเจอร์ AI และนโยบายที่เกี่ยวข้องเป็นประจำ การอัปเดตที่สำคัญจะแจ้งให้ผู้ใช้ทราบผ่านการแจ้งเตือนในแอปหรืออีเมล"},contact:{title:"ติดต่อเรา",content:"หากคุณมีคำถามหรือข้อเสนอแนะเกี่ยวกับฟีเจอร์ AI กรุณาติดต่อเราผ่านกล่องข้อเสนอแนะหรือระบบบริการลูกค้าในแอป"}}},vi:{title:"Tuyên bố sử dụng AI",subtitle:"Thông tin về tính năng AI trong Restarter™",back:"Quay lại",logout:"Đăng xuất",sections:{intro:{title:"Giới thiệu",content:"Restarter™ sử dụng công nghệ trí tuệ nhân tạo để cung cấp dịch vụ hỗ trợ sức khỏe tâm thần cá nhân hóa. Tuyên bố này nhằm giải thích cách chúng tôi sử dụng công nghệ AI và quyền lợi cũng như trách nhiệm của bạn khi sử dụng các tính năng này."},aiFeatures:{title:"Tính năng AI",content:"Các tính năng AI của chúng tôi bao gồm: hội thoại thông minh, phân tích cảm xúc, đề xuất cá nhân hóa, tạo nội dung, v.v. Những tính năng này được thiết kế để cung cấp hỗ trợ sức khỏe tâm thần bổ sung, không phải là thay thế cho dịch vụ y tế chuyên nghiệp."},dataUsage:{title:"Sử dụng dữ liệu",content:"Để cung cấp dịch vụ AI tốt hơn, chúng tôi có thể thu thập và phân tích dữ liệu tương tác của bạn với AI. Tất cả dữ liệu đều được mã hóa và tuân thủ nghiêm ngặt các quy định bảo vệ quyền riêng tư."},limitations:{title:"Hạn chế sử dụng",content:"Tính năng AI chỉ dành cho mục đích sử dụng bổ sung và không nên được sử dụng như một thay thế cho lời khuyên y tế chuyên nghiệp. Trong tình huống khẩn cấp, vui lòng liên hệ nhân viên y tế chuyên nghiệp hoặc gọi số điện thoại khẩn cấp ngay lập tức."},accuracy:{title:"Tuyên bố về độ chính xác",content:"Mặc dù chúng tôi cố gắng cung cấp phản hồi AI chính xác, nhưng công nghệ AI vẫn có những hạn chế. Chúng tôi khuyến nghị duy trì tư duy phản biện về các đề xuất do AI cung cấp."},userRights:{title:"Quyền của người dùng",content:"Bạn có quyền hiểu cách AI xử lý dữ liệu của mình, yêu cầu sửa đổi hoặc xóa dữ liệu liên quan, và chọn không sử dụng các tính năng AI."},updates:{title:"Thông báo cập nhật",content:"Chúng tôi thường xuyên cập nhật các tính năng AI và chính sách liên quan. Những cập nhật quan trọng sẽ được thông báo cho người dùng thông qua thông báo trong ứng dụng hoặc email."},contact:{title:"Liên hệ chúng tôi",content:"Nếu bạn có bất kỳ câu hỏi hoặc đề xuất nào về tính năng AI, vui lòng liên hệ với chúng tôi thông qua hộp phản hồi hoặc hệ thống dịch vụ khách hàng trong ứng dụng."}}},ms:{title:"Penyata Penggunaan AI",subtitle:"Maklumat tentang ciri AI dalam Restarter™",back:"Kembali",logout:"Log keluar",sections:{intro:{title:"Pengenalan",content:"Restarter™ menggunakan teknologi kecerdasan buatan untuk menyediakan perkhidmatan sokongan kesihatan mental yang diperibadikan. Penyata ini bertujuan untuk menjelaskan bagaimana kami menggunakan teknologi AI dan hak serta tanggungjawab anda semasa menggunakan ciri-ciri ini."},aiFeatures:{title:"Ciri AI",content:"Ciri AI kami termasuk: perbualan pintar, analisis emosi, cadangan diperibadikan, penjanaan kandungan, dll. Ciri-ciri ini direka untuk menyediakan sokongan kesihatan mental tambahan, bukan sebagai pengganti untuk perkhidmatan perubatan profesional."},dataUsage:{title:"Penggunaan Data",content:"Untuk menyediakan perkhidmatan AI yang lebih baik, kami mungkin mengumpul dan menganalisis data interaksi anda dengan AI. Semua data disulitkan dan mematuhi peraturan perlindungan privasi dengan ketat."},limitations:{title:"Batasan Penggunaan",content:"Ciri AI adalah untuk kegunaan tambahan sahaja dan tidak sepatutnya digunakan sebagai pengganti untuk nasihat perubatan profesional. Dalam situasi kecemasan, sila hubungi kakitangan perubatan profesional atau panggil nombor kecemasan dengan segera."},accuracy:{title:"Penyata Ketepatan",content:"Walaupun kami berusaha untuk menyediakan respons AI yang tepat, teknologi AI masih mempunyai batasan. Kami mengesyorkan mengekalkan pemikiran kritikal tentang cadangan yang disediakan oleh AI."},userRights:{title:"Hak Pengguna",content:"Anda mempunyai hak untuk memahami bagaimana AI memproses data anda, meminta pembetulan atau penghapusan data berkaitan, dan memilih untuk tidak menggunakan ciri AI."},updates:{title:"Pemberitahuan Kemas Kini",content:"Kami kerap mengemas kini ciri AI dan polisi berkaitan. Kemas kini penting akan diberitahu kepada pengguna melalui pemberitahuan dalam aplikasi atau e-mel."},contact:{title:"Hubungi Kami",content:"Jika anda mempunyai sebarang soalan atau cadangan tentang ciri AI, sila hubungi kami melalui kotak maklum balas atau sistem perkhidmatan pelanggan dalam aplikasi."}}},la:{title:"Declaratio Usus AI",subtitle:"Informatio de functionibus AI in Restarter™",back:"Redire",logout:"Exire",sections:{intro:{title:"Introductio",content:"Restarter™ technologia intelligentiae artificialis utitur ad praebendum servitium auxilii sanitatis mentalis personalizatum. Haec declaratio intendit explicare quomodo technologiam AI utamur et iura tua ac responsabilitates cum his functionibus utaris."},aiFeatures:{title:"Functiones AI",content:"Functiones AI nostrae includunt: colloquia intelligentes, analysis emotionum, commendationes personalizatae, generatio contenti, etc. Hae functiones designatae sunt ad praebendum auxilium sanitatis mentalis supplementarium, non substitutum pro servitiis medicis professionalibus."},dataUsage:{title:"Usus Datorum",content:"Ad praebendum servitia AI meliora, possumus colligere et analysare data interactionis tuae cum AI. Omnia data encryptata sunt et stricte observant regulas protectionis privatae."},limitations:{title:"Limitationes Usus",content:"Functiones AI sunt ad usum supplementarium tantum et non debent uti ut substitutum pro consilio medico professionale. In circumstantiis urgentibus, quaeso contacta personalem medicum professionalem vel voca numerum urgentem statim."},accuracy:{title:"Declaratio Accuratiae",content:"Etsi conamur praebere responsiones AI accuratas, technologia AI adhuc habet limitationes. Commendamus conservare cogitationem criticam de commendationibus ab AI praebitis."},userRights:{title:"Iura Usuarii",content:"Habet ius intelligere quomodo AI processat data tua, petere correctionem vel deletionem datorum relatorum, et eligere non uti functionibus AI."},updates:{title:"Notificationes Renovationis",content:"Regulariter renovamus functiones AI et politicas relatas. Renovationes importantes notificabuntur usuariis per notificationes in app vel email."},contact:{title:"Contacta Nos",content:"Si habes quaestiones vel commendationes de functionibus AI, quaeso contacta nos per cistam feedback vel systema servitii clientis in app."}}}};function tB(){const e=le(),{lang:t}=mw(),n=eB[t]||eB["zh-TW"];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[f.jsx("button",{onClick:()=>e("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:n.back}),f.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:n.title}),f.jsx("div",{style:{width:80}})]}),f.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:n.subtitle}),f.jsx("div",{style:{lineHeight:1.6},children:Object.entries(n.sections).map(([e,t])=>f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:t.title}),f.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:t.content})]},e))})]}),f.jsx(vI,{})]})}const nB={"zh-TW":{title:"心理健康免責聲明",subtitle:"關於Restarter™心理健康支援服務的重要聲明",back:"返回",logout:"登出",sections:{intro:{title:"重要聲明",content:"Restarter™提供的是輔助性的心理健康支援服務，並非專業的心理治療或醫療服務。本平台旨在幫助用戶進行自我探索和情緒管理，但不能替代專業的心理健康治療。"},serviceScope:{title:"服務範圍",content:"我們的服務包括：情緒記錄、AI對話輔助、社群支援、自我反思工具等。這些功能設計用於日常的情緒管理和心理健康維護，而非處理嚴重的心理健康問題。"},limitations:{title:"服務限制",content:"Restarter™不提供緊急心理危機干預、專業診斷或治療服務。如果您正在經歷嚴重的心理健康問題，請立即尋求專業醫療幫助。"},emergency:{title:"緊急情況",content:"如果您有自殺念頭、嚴重抑鬱、急性焦慮或其他緊急心理健康問題，請立即：1) 撥打緊急求助電話 2) 聯繫專業心理醫生 3) 前往最近的急診室。"},professionalHelp:{title:"專業幫助",content:"我們強烈建議在以下情況尋求專業心理健康服務：持續的抑鬱或焦慮、創傷後應激障礙、人格障礙、物質濫用問題等。"},userResponsibility:{title:"用戶責任",content:"使用本平台時，您需要對自己的心理健康狀況負責。如果您發現症狀惡化或出現新的問題，請立即停止使用並尋求專業幫助。"},privacy:{title:"隱私保護",content:"我們嚴格保護您的隱私，但請注意：在緊急情況下，我們可能會根據法律要求分享必要信息以保護您的安全。"},contact:{title:"聯繫我們",content:"如果您對我們的服務有任何疑問或建議，請通過應用程式內的意見箱與我們聯繫。我們會盡快回覆您的問題。"}}},"zh-CN":{title:"心理健康免责声明",subtitle:"关于Restarter™心理健康支持服务的重要声明",back:"返回",logout:"登出",sections:{intro:{title:"重要声明",content:"Restarter™提供的是辅助性的心理健康支持服务，并非专业的心理治疗或医疗服务。本平台旨在帮助用户进行自我探索和情绪管理，但不能替代专业的心理健康治疗。"},serviceScope:{title:"服务范围",content:"我们的服务包括：情绪记录、AI对话辅助、社群支持、自我反思工具等。这些功能设计用于日常的情绪管理和心理健康维护，而非处理严重的心理健康问题。"},limitations:{title:"服务限制",content:"Restarter™不提供紧急心理危机干预、专业诊断或治疗服务。如果您正在经历严重的心理健康问题，请立即寻求专业医疗帮助。"},emergency:{title:"紧急情况",content:"如果您有自杀念头、严重抑郁、急性焦虑或其他紧急心理健康问题，请立即：1) 拨打紧急求助电话 2) 联系专业心理医生 3) 前往最近的急诊室。"},professionalHelp:{title:"专业帮助",content:"我们强烈建议在以下情况寻求专业心理健康服务：持续的抑郁或焦虑、创伤后应激障碍、人格障碍、物质滥用问题等。"},userResponsibility:{title:"用户责任",content:"使用本平台时，您需要对自己的心理健康状况负责。如果您发现症状恶化或出现新的问题，请立即停止使用并寻求专业帮助。"},privacy:{title:"隐私保护",content:"我们严格保护您的隐私，但请注意：在紧急情况下，我们可能会根据法律要求分享必要信息以保护您的安全。"},contact:{title:"联系我们",content:"如果您对我们的服务有任何疑问或建议，请通过应用程序内的意见箱与我们联系。我们会尽快回复您的问题。"}}},en:{title:"Mental Health Disclaimer",subtitle:"Important statement about Restarter™ mental health support services",back:"Back",logout:"Logout",sections:{intro:{title:"Important Statement",content:"Restarter™ provides辅助mental health support services, not professional psychological therapy or medical services. This platform is designed to help users with self-exploration and emotion management, but cannot replace professional mental health treatment."},serviceScope:{title:"Service Scope",content:"Our services include: emotion recording, AI conversation assistance, community support, self-reflection tools, etc. These features are designed for daily emotion management and mental health maintenance, not for handling serious mental health issues."},limitations:{title:"Service Limitations",content:"Restarter™ does not provide emergency psychological crisis intervention, professional diagnosis, or treatment services. If you are experiencing serious mental health issues, please seek professional medical help immediately."},emergency:{title:"Emergency Situations",content:"If you have suicidal thoughts, severe depression, acute anxiety, or other emergency mental health issues, please immediately: 1) Call emergency hotlines 2) Contact professional psychologists 3) Go to the nearest emergency room."},professionalHelp:{title:"Professional Help",content:"We strongly recommend seeking professional mental health services in the following situations: persistent depression or anxiety, post-traumatic stress disorder, personality disorders, substance abuse issues, etc."},userResponsibility:{title:"User Responsibility",content:"When using this platform, you are responsible for your own mental health condition. If you find symptoms worsening or new problems arising, please stop using immediately and seek professional help."},privacy:{title:"Privacy Protection",content:"We strictly protect your privacy, but please note: in emergency situations, we may share necessary information according to legal requirements to protect your safety."},contact:{title:"Contact Us",content:"If you have any questions or suggestions about our services, please contact us through the feedback box in the app. We will respond to your questions as soon as possible."}}},ja:{title:"メンタルヘルス免責事項",subtitle:"Restarter™メンタルヘルスサポートサービスに関する重要な声明",back:"戻る",logout:"ログアウト",sections:{intro:{title:"重要な声明",content:"Restarter™は補助的なメンタルヘルスサポートサービスを提供しており、専門的な心理療法や医療サービスではありません。このプラットフォームは自己探求と感情管理を支援することを目的としていますが、専門的なメンタルヘルス治療の代替とはなりません。"},serviceScope:{title:"サービス範囲",content:"当社のサービスには、感情記録、AI会話支援、コミュニティサポート、自己反省ツールなどが含まれます。これらの機能は日常的な感情管理とメンタルヘルス維持のために設計されており、深刻なメンタルヘルス問題の処理のためではありません。"},limitations:{title:"サービス制限",content:"Restarter™は緊急心理危機介入、専門診断、または治療サービスを提供しません。深刻なメンタルヘルス問題を経験している場合は、すぐに専門医療の助けを求めてください。"},emergency:{title:"緊急事態",content:"自殺念慮、重度のうつ病、急性不安、またはその他の緊急メンタルヘルス問題がある場合は、すぐに：1) 緊急ホットラインに電話 2) 専門心理学者に連絡 3) 最寄りの救急室に行ってください。"},professionalHelp:{title:"専門的支援",content:"以下の状況では専門メンタルヘルスサービスを求めることを強く推奨します：持続的なうつ病や不安、心的外傷後ストレス障害、人格障害、物質乱用問題など。"},userResponsibility:{title:"ユーザーの責任",content:"このプラットフォームを使用する際は、自分のメンタルヘルス状態に責任を持つ必要があります。症状が悪化したり新しい問題が発生した場合は、すぐに使用を停止し専門的支援を求めてください。"},privacy:{title:"プライバシー保護",content:"プライバシーを厳格に保護していますが、緊急事態では、あなたの安全を守るために法的要件に従って必要な情報を共有する場合があることにご注意ください。"},contact:{title:"お問い合わせ",content:"当社のサービスについてご質問やご提案がございましたら、アプリ内のフィードバックボックスを通じてお問い合わせください。できるだけ早くご返信いたします。"}}},ko:{title:"정신건강 면책조항",subtitle:"Restarter™ 정신건강 지원 서비스에 대한 중요한 성명",back:"뒤로",logout:"로그아웃",sections:{intro:{title:"중요한 성명",content:"Restarter™는 보조적인 정신건강 지원 서비스를 제공하며, 전문적인 심리 치료나 의료 서비스가 아닙니다. 이 플랫폼은 사용자의 자기 탐구와 감정 관리를 돕기 위해 설계되었지만, 전문적인 정신건강 치료의 대체가 될 수 없습니다."},serviceScope:{title:"서비스 범위",content:"우리의 서비스에는 감정 기록, AI 대화 지원, 커뮤니티 지원, 자기 성찰 도구 등이 포함됩니다. 이러한 기능들은 일상적인 감정 관리와 정신건강 유지를 위해 설계되었으며, 심각한 정신건강 문제를 처리하기 위한 것이 아닙니다."},limitations:{title:"서비스 제한",content:"Restarter™는 긴급 심리 위기 개입, 전문 진단 또는 치료 서비스를 제공하지 않습니다. 심각한 정신건강 문제를 경험하고 있다면 즉시 전문 의료 도움을 구하세요."},emergency:{title:"긴급 상황",content:"자살 생각, 심각한 우울증, 급성 불안 또는 기타 긴급 정신건강 문제가 있다면 즉시: 1) 긴급 도움 전화 2) 전문 심리학자 연락 3) 가장 가까운 응급실로 이동하세요."},professionalHelp:{title:"전문적 도움",content:"다음과 같은 상황에서는 전문 정신건강 서비스를 구하는 것을 강력히 권장합니다: 지속적인 우울증이나 불안, 외상 후 스트레스 장애, 인격 장애, 물질 남용 문제 등."},userResponsibility:{title:"사용자 책임",content:"이 플랫폼을 사용할 때는 자신의 정신건강 상태에 책임을 져야 합니다. 증상이 악화되거나 새로운 문제가 발생한다면 즉시 사용을 중단하고 전문적 도움을 구하세요."},privacy:{title:"개인정보 보호",content:"개인정보를 엄격히 보호하지만, 긴급 상황에서는 안전을 보호하기 위해 법적 요구사항에 따라 필요한 정보를 공유할 수 있다는 점에 유의하세요."},contact:{title:"연락처",content:"서비스에 대한 질문이나 제안이 있으시면 앱 내 피드백 상자를 통해 문의해 주세요. 가능한 한 빨리 답변드리겠습니다."}}},th:{title:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",subtitle:"คำแถลงสำคัญเกี่ยวกับบริการสนับสนุนสุขภาพจิตของ Restarter™",back:"กลับ",logout:"ออกจากระบบ",sections:{intro:{title:"คำแถลงสำคัญ",content:"Restarter™ ให้บริการสนับสนุนสุขภาพจิตแบบเสริม ไม่ใช่การบำบัดทางจิตวิทยาหรือบริการทางการแพทย์แบบมืออาชีพ แพลตฟอร์มนี้ได้รับการออกแบบมาเพื่อช่วยผู้ใช้ในการสำรวจตนเองและการจัดการอารมณ์ แต่ไม่สามารถแทนที่การรักษาสุขภาพจิตแบบมืออาชีพได้"},serviceScope:{title:"ขอบเขตบริการ",content:"บริการของเรารวมถึง: การบันทึกอารมณ์ การสนทนา AI แบบเสริม การสนับสนุนชุมชน เครื่องมือการสะท้อนตนเอง เป็นต้น ฟีเจอร์เหล่านี้ได้รับการออกแบบมาเพื่อการจัดการอารมณ์ประจำวันและการบำรุงรักษาสุขภาพจิต ไม่ใช่สำหรับการจัดการปัญหาสุขภาพจิตที่ร้ายแรง"},limitations:{title:"ข้อจำกัดบริการ",content:"Restarter™ ไม่ให้บริการการแทรกแซงวิกฤตทางจิตวิทยาแบบฉุกเฉิน การวินิจฉัยแบบมืออาชีพ หรือบริการการรักษา หากคุณกำลังประสบปัญหาสุขภาพจิตที่ร้ายแรง กรุณาแสวงหาความช่วยเหลือทางการแพทย์แบบมืออาชีพทันที"},emergency:{title:"สถานการณ์ฉุกเฉิน",content:"หากคุณมีความคิดฆ่าตัวตาย ภาวะซึมเศร้าอย่างร้ายแรง ความวิตกกังวลแบบเฉียบพลัน หรือปัญหาสุขภาพจิตฉุกเฉินอื่นๆ กรุณาทันที: 1) โทรสายด่วนฉุกเฉิน 2) ติดต่อนักจิตวิทยามืออาชีพ 3) ไปห้องฉุกเฉินที่ใกล้ที่สุด"},professionalHelp:{title:"ความช่วยเหลือแบบมืออาชีพ",content:"เราแนะนำอย่างยิ่งให้แสวงหาบริการสุขภาพจิตแบบมืออาชีพในสถานการณ์ต่อไปนี้: ภาวะซึมเศร้าหรือความวิตกกังวลที่ต่อเนื่อง โรคเครียดหลังเหตุการณ์สะเทือนขวัญ โรคบุคลิกภาพ การใช้สารเสพติด เป็นต้น"},userResponsibility:{title:"ความรับผิดชอบของผู้ใช้",content:"เมื่อใช้แพลตฟอร์มนี้ คุณต้องรับผิดชอบต่อสภาพสุขภาพจิตของตนเอง หากคุณพบว่าอาการแย่ลงหรือเกิดปัญหาต่างๆ ใหม่ กรุณาหยุดใช้ทันทีและแสวงหาความช่วยเหลือแบบมืออาชีพ"},privacy:{title:"การคุ้มครองความเป็นส่วนตัว",content:"เราให้ความคุ้มครองความเป็นส่วนตัวอย่างเข้มงวด แต่โปรดทราบ: ในสถานการณ์ฉุกเฉิน เราอาจแบ่งปันข้อมูลที่จำเป็นตามข้อกำหนดทางกฎหมายเพื่อปกป้องความปลอดภัยของคุณ"},contact:{title:"ติดต่อเรา",content:"หากคุณมีคำถามหรือข้อเสนอแนะเกี่ยวกับบริการของเรา กรุณาติดต่อเราผ่านกล่องข้อเสนอแนะในแอป เราจะตอบกลับคำถามของคุณโดยเร็วที่สุด"}}},vi:{title:"Tuyên bố miễn trừ sức khỏe tâm thần",subtitle:"Tuyên bố quan trọng về dịch vụ hỗ trợ sức khỏe tâm thần của Restarter™",back:"Quay lại",logout:"Đăng xuất",sections:{intro:{title:"Tuyên bố quan trọng",content:"Restarter™ cung cấp dịch vụ hỗ trợ sức khỏe tâm thần bổ sung, không phải là liệu pháp tâm lý chuyên nghiệp hoặc dịch vụ y tế. Nền tảng này được thiết kế để giúp người dùng tự khám phá và quản lý cảm xúc, nhưng không thể thay thế điều trị sức khỏe tâm thần chuyên nghiệp."},serviceScope:{title:"Phạm vi dịch vụ",content:"Dịch vụ của chúng tôi bao gồm: ghi lại cảm xúc, hỗ trợ hội thoại AI, hỗ trợ cộng đồng, công cụ tự phản ánh, v.v. Những tính năng này được thiết kế để quản lý cảm xúc hàng ngày và duy trì sức khỏe tâm thần, không phải để xử lý các vấn đề sức khỏe tâm thần nghiêm trọng."},limitations:{title:"Hạn chế dịch vụ",content:"Restarter™ không cung cấp can thiệp khủng hoảng tâm lý khẩn cấp, chẩn đoán chuyên nghiệp hoặc dịch vụ điều trị. Nếu bạn đang gặp các vấn đề sức khỏe tâm thần nghiêm trọng, vui lòng tìm kiếm sự giúp đỡ y tế chuyên nghiệp ngay lập tức."},emergency:{title:"Tình huống khẩn cấp",content:"Nếu bạn có ý nghĩ tự tử, trầm cảm nghiêm trọng, lo lắng cấp tính hoặc các vấn đề sức khỏe tâm thần khẩn cấp khác, vui lòng ngay lập tức: 1) Gọi đường dây nóng khẩn cấp 2) Liên hệ nhà tâm lý học chuyên nghiệp 3) Đến phòng cấp cứu gần nhất."},professionalHelp:{title:"Sự giúp đỡ chuyên nghiệp",content:"Chúng tôi khuyến nghị mạnh mẽ tìm kiếm dịch vụ sức khỏe tâm thần chuyên nghiệp trong các tình huống sau: trầm cảm hoặc lo lắng dai dẳng, rối loạn căng thẳng sau chấn thương, rối loạn nhân cách, vấn đề lạm dụng chất, v.v."},userResponsibility:{title:"Trách nhiệm của người dùng",content:"Khi sử dụng nền tảng này, bạn cần chịu trách nhiệm về tình trạng sức khỏe tâm thần của mình. Nếu bạn thấy các triệu chứng xấu đi hoặc xuất hiện vấn đề mới, vui lòng ngừng sử dụng ngay lập tức và tìm kiếm sự giúp đỡ chuyên nghiệp."},privacy:{title:"Bảo vệ quyền riêng tư",content:"Chúng tôi bảo vệ quyền riêng tư của bạn một cách nghiêm ngặt, nhưng vui lòng lưu ý: trong tình huống khẩn cấp, chúng tôi có thể chia sẻ thông tin cần thiết theo yêu cầu pháp lý để bảo vệ sự an toàn của bạn."},contact:{title:"Liên hệ chúng tôi",content:"Nếu bạn có bất kỳ câu hỏi hoặc đề xuất nào về dịch vụ của chúng tôi, vui lòng liên hệ với chúng tôi thông qua hộp phản hồi trong ứng dụng. Chúng tôi sẽ trả lời câu hỏi của bạn càng sớm càng tốt."}}},ms:{title:"Penafian Kesihatan Mental",subtitle:"Penyata penting tentang perkhidmatan sokongan kesihatan mental Restarter™",back:"Kembali",logout:"Log keluar",sections:{intro:{title:"Penyata Penting",content:"Restarter™ menyediakan perkhidmatan sokongan kesihatan mental tambahan, bukan terapi psikologi profesional atau perkhidmatan perubatan. Platform ini direka untuk membantu pengguna dengan penerokaan diri dan pengurusan emosi, tetapi tidak boleh menggantikan rawatan kesihatan mental profesional."},serviceScope:{title:"Skop Perkhidmatan",content:"Perkhidmatan kami termasuk: rakaman emosi, bantuan perbualan AI, sokongan komuniti, alat refleksi diri, dll. Ciri-ciri ini direka untuk pengurusan emosi harian dan penyelenggaraan kesihatan mental, bukan untuk menangani isu kesihatan mental yang serius."},limitations:{title:"Batasan Perkhidmatan",content:"Restarter™ tidak menyediakan campur tangan krisis psikologi kecemasan, diagnosis profesional, atau perkhidmatan rawatan. Jika anda mengalami isu kesihatan mental yang serius, sila dapatkan bantuan perubatan profesional dengan segera."},emergency:{title:"Situasi Kecemasan",content:"Jika anda mempunyai pemikiran membunuh diri, kemurungan teruk, kebimbangan akut, atau isu kesihatan mental kecemasan lain, sila segera: 1) Panggil talian panas kecemasan 2) Hubungi ahli psikologi profesional 3) Pergi ke bilik kecemasan terdekat."},professionalHelp:{title:"Bantuan Profesional",content:"Kami sangat mengesyorkan mendapatkan perkhidmatan kesihatan mental profesional dalam situasi berikut: kemurungan atau kebimbangan berterusan, gangguan tekanan pasca trauma, gangguan personaliti, isu penyalahgunaan bahan, dll."},userResponsibility:{title:"Tanggungjawab Pengguna",content:"Apabila menggunakan platform ini, anda bertanggungjawab untuk keadaan kesihatan mental anda sendiri. Jika anda mendapati simptom bertambah teruk atau masalah baru timbul, sila berhenti menggunakan dengan segera dan dapatkan bantuan profesional."},privacy:{title:"Perlindungan Privasi",content:"Kami melindungi privasi anda dengan ketat, tetapi sila ambil perhatian: dalam situasi kecemasan, kami mungkin berkongsi maklumat yang diperlukan mengikut keperluan undang-undang untuk melindungi keselamatan anda."},contact:{title:"Hubungi Kami",content:"Jika anda mempunyai sebarang soalan atau cadangan tentang perkhidmatan kami, sila hubungi kami melalui kotak maklum balas dalam aplikasi. Kami akan menjawab soalan anda secepat mungkin."}}},la:{title:"Renuntiatio Salutis Mentalis",subtitle:"Declaratio magna de servitiis auxilii salutis mentalis Restarter™",back:"Redire",logout:"Exire",sections:{intro:{title:"Declaratio Magna",content:"Restarter™ praebet servitia auxilii salutis mentalis supplementaria, non therapiam psychologicam professionalem vel servitia medica. Haec platforma designata est ad iuvandum usuarios cum exploratione sui et administratione emotionum, sed non potest substituere curationem salutis mentalis professionalem."},serviceScope:{title:"Scopus Servitii",content:"Servitia nostra includunt: recordationem emotionum, auxilium colloquii AI, sustentationem communitatis, instrumenta reflexionis sui, etc. Hae functiones designatae sunt ad administrationem emotionum quotidianam et sustentationem salutis mentalis, non ad tractandas quaestiones salutis mentalis graves."},limitations:{title:"Limitationes Servitii",content:"Restarter™ non praebet interventionem crisis psychologicae urgentis, diagnosis professionalem, vel servitia curationis. Si experiris quaestiones salutis mentalis graves, quaeso pete auxilium medicum professionalem statim."},emergency:{title:"Circumstantiae Urgentes",content:"Si habes cogitationes suicidales, depressionem gravem, anxietatem acutam, vel alias quaestiones salutis mentalis urgentes, quaeso statim: 1) Voca lineas calidas urgentes 2) Contacta psychologos professionales 3) I ad cubiculum urgentium proximum."},professionalHelp:{title:"Auxilium Professionale",content:"Valde commendamus petere servitia salutis mentalis professionalia in circumstantiis sequentibus: depressio vel anxietas persistens, perturbatio post-traumatica, perturbationes personalitatis, quaestiones abusus substantiarum, etc."},userResponsibility:{title:"Responsabilitas Usuarii",content:"Cum utaris hac platforma, es responsabilis pro conditione salutis mentalis tuae. Si invenis symptomata deteriorantia vel problemata nova oriuntur, quaeso desine uti statim et pete auxilium professionale."},privacy:{title:"Protectio Privatae",content:"Stricte protegitur privata tua, sed quaeso nota: in circumstantiis urgentibus, possumus communicare informationem necessariam secundum requisita legalia ad protegendum securitatem tuam."},contact:{title:"Contacta Nos",content:"Si habes quaestiones vel commendationes de servitiis nostris, quaeso contacta nos per cistam feedback in app. Respondebimus quaestionibus tuis quam celerrime."}}}};function iB(){const e=le(),{lang:t}=mw(),n=nB[t]||nB["zh-TW"];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[f.jsx("button",{onClick:()=>e("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:n.back}),f.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:n.title}),f.jsx("div",{style:{width:80}})]}),f.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:n.subtitle}),f.jsx("div",{style:{lineHeight:1.6},children:Object.entries(n.sections).map(([e,t])=>f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:t.title}),f.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:t.content})]},e))})]}),f.jsx(vI,{})]})}const rB={"zh-TW":{title:"Cookie政策",subtitle:"關於Restarter™使用Cookie的說明",back:"返回",sections:{intro:{title:"什麼是Cookie",content:"Cookie是存儲在您設備上的小型文本文件，用於改善您的瀏覽體驗。當您訪問我們的網站時，我們可能會在您的設備上放置Cookie。"},purpose:{title:"Cookie的用途",content:"我們使用Cookie來：記住您的偏好設置、分析網站使用情況、提供個性化內容、改善網站性能、確保安全性。"},types:{title:"Cookie類型",content:"我們使用以下類型的Cookie：必要Cookie（網站基本功能）、性能Cookie（分析使用情況）、功能Cookie（記住偏好）、廣告Cookie（個性化內容）。"},control:{title:"控制Cookie",content:"您可以通過瀏覽器設置控制Cookie。大多數瀏覽器允許您阻止或刪除Cookie，但這可能影響網站功能。"},thirdParty:{title:"第三方Cookie",content:"我們可能使用第三方服務，如分析工具，這些服務可能會設置自己的Cookie。我們無法控制這些第三方Cookie。"},updates:{title:"政策更新",content:"我們可能會更新此Cookie政策。重要變更會通過網站通知或電子郵件告知用戶。"}}},"zh-CN":{title:"Cookie政策",subtitle:"关于Restarter™使用Cookie的说明",back:"返回",sections:{intro:{title:"什么是Cookie",content:"Cookie是存储在您设备上的小型文本文件，用于改善您的浏览体验。当您访问我们的网站时，我们可能会在您的设备上放置Cookie。"},purpose:{title:"Cookie的用途",content:"我们使用Cookie来：记住您的偏好设置、分析网站使用情况、提供个性化内容、改善网站性能、确保安全性。"},types:{title:"Cookie类型",content:"我们使用以下类型的Cookie：必要Cookie（网站基本功能）、性能Cookie（分析使用情况）、功能Cookie（记住偏好）、广告Cookie（个性化内容）。"},control:{title:"控制Cookie",content:"您可以通过浏览器设置控制Cookie。大多数浏览器允许您阻止或删除Cookie，但这可能影响网站功能。"},thirdParty:{title:"第三方Cookie",content:"我们可能使用第三方服务，如分析工具，这些服务可能会设置自己的Cookie。我们无法控制这些第三方Cookie。"},updates:{title:"政策更新",content:"我们可能会更新此Cookie政策。重要变更会通过网站通知或电子邮件告知用户。"}}},en:{title:"Cookie Policy",subtitle:"Information about Cookie usage in Restarter™",back:"Back",sections:{intro:{title:"What are Cookies",content:"Cookies are small text files stored on your device to improve your browsing experience. When you visit our website, we may place cookies on your device."},purpose:{title:"Purpose of Cookies",content:"We use cookies to: remember your preferences, analyze website usage, provide personalized content, improve website performance, ensure security."},types:{title:"Types of Cookies",content:"We use the following types of cookies: essential cookies (basic website functions), performance cookies (usage analytics), functional cookies (preference memory), advertising cookies (personalized content)."},control:{title:"Controlling Cookies",content:"You can control cookies through browser settings. Most browsers allow you to block or delete cookies, but this may affect website functionality."},thirdParty:{title:"Third-party Cookies",content:"We may use third-party services such as analytics tools that may set their own cookies. We cannot control these third-party cookies."},updates:{title:"Policy Updates",content:"We may update this Cookie Policy. Important changes will be notified to users through website notifications or email."}}},ja:{title:"Cookieポリシー",subtitle:"Restarter™でのCookie使用に関する説明",back:"戻る",sections:{intro:{title:"Cookieとは",content:"Cookieは、ブラウジング体験を向上させるためにデバイスに保存される小さなテキストファイルです。当サイトを訪問する際、デバイスにCookieを配置する場合があります。"},purpose:{title:"Cookieの目的",content:"Cookieは以下の目的で使用されます：設定の記憶、ウェブサイト使用状況の分析、パーソナライズされたコンテンツの提供、ウェブサイトパフォーマンスの向上、セキュリティの確保。"},types:{title:"Cookieの種類",content:"以下の種類のCookieを使用します：必須Cookie（基本的なウェブサイト機能）、パフォーマンスCookie（使用状況分析）、機能Cookie（設定の記憶）、広告Cookie（パーソナライズされたコンテンツ）。"},control:{title:"Cookieの制御",content:"ブラウザ設定でCookieを制御できます。ほとんどのブラウザでCookieのブロックや削除が可能ですが、ウェブサイトの機能に影響する場合があります。"},thirdParty:{title:"第三者Cookie",content:"分析ツールなどの第三者サービスを使用する場合があり、それらが独自のCookieを設定する可能性があります。これらの第三者Cookieは制御できません。"},updates:{title:"ポリシーの更新",content:"このCookieポリシーを更新する場合があります。重要な変更はウェブサイト通知またはメールでユーザーに通知されます。"}}},ko:{title:"쿠키 정책",subtitle:"Restarter™에서 쿠키 사용에 대한 설명",back:"뒤로",sections:{intro:{title:"쿠키란",content:"쿠키는 브라우징 경험을 향상시키기 위해 기기에 저장되는 작은 텍스트 파일입니다. 당사 웹사이트를 방문할 때 기기에 쿠키를 배치할 수 있습니다."},purpose:{title:"쿠키의 목적",content:"쿠키는 다음 목적으로 사용됩니다: 설정 기억, 웹사이트 사용 분석, 개인화된 콘텐츠 제공, 웹사이트 성능 향상, 보안 보장."},types:{title:"쿠키 유형",content:"다음 유형의 쿠키를 사용합니다: 필수 쿠키(기본 웹사이트 기능), 성능 쿠키(사용 분석), 기능 쿠키(설정 기억), 광고 쿠키(개인화된 콘텐츠)."},control:{title:"쿠키 제어",content:"브라우저 설정을 통해 쿠키를 제어할 수 있습니다. 대부분의 브라우저에서 쿠키를 차단하거나 삭제할 수 있지만 웹사이트 기능에 영향을 줄 수 있습니다."},thirdParty:{title:"제3자 쿠키",content:"분석 도구와 같은 제3자 서비스를 사용할 수 있으며, 이들이 자체 쿠키를 설정할 수 있습니다. 이러한 제3자 쿠키는 제어할 수 없습니다."},updates:{title:"정책 업데이트",content:"이 쿠키 정책을 업데이트할 수 있습니다. 중요한 변경사항은 웹사이트 알림 또는 이메일로 사용자에게 알려집니다."}}},th:{title:"นโยบายคุกกี้",subtitle:"ข้อมูลเกี่ยวกับการใช้คุกกี้ใน Restarter™",back:"กลับ",sections:{intro:{title:"คุกกี้คืออะไร",content:"คุกกี้เป็นไฟล์ข้อความขนาดเล็กที่เก็บไว้ในอุปกรณ์ของคุณเพื่อปรับปรุงประสบการณ์การท่องเว็บ เมื่อคุณเยี่ยมชมเว็บไซต์ของเรา เราอาจวางคุกกี้ในอุปกรณ์ของคุณ"},purpose:{title:"วัตถุประสงค์ของคุกกี้",content:"เราใช้คุกกี้เพื่อ: จำการตั้งค่าของคุณ วิเคราะห์การใช้เว็บไซต์ ให้เนื้อหาส่วนบุคคล ปรับปรุงประสิทธิภาพเว็บไซต์ รับประกันความปลอดภัย"},types:{title:"ประเภทของคุกกี้",content:"เราใช้คุกกี้ประเภทต่อไปนี้: คุกกี้ที่จำเป็น (ฟังก์ชันพื้นฐานของเว็บไซต์) คุกกี้ประสิทธิภาพ (การวิเคราะห์การใช้งาน) คุกกี้ฟังก์ชัน (จำการตั้งค่า) คุกกี้โฆษณา (เนื้อหาส่วนบุคคล)"},control:{title:"การควบคุมคุกกี้",content:"คุณสามารถควบคุมคุกกี้ผ่านการตั้งค่าเบราว์เซอร์ เบราว์เซอร์ส่วนใหญ่อนุญาตให้คุณบล็อกหรือลบคุกกี้ได้ แต่อาจส่งผลต่อฟังก์ชันของเว็บไซต์"},thirdParty:{title:"คุกกี้ของบุคคลที่สาม",content:"เราอาจใช้บริการของบุคคลที่สาม เช่น เครื่องมือวิเคราะห์ ที่อาจตั้งค่าคุกกี้ของตัวเอง เราไม่สามารถควบคุมคุกกี้ของบุคคลที่สามเหล่านี้ได้"},updates:{title:"การอัปเดตนโยบาย",content:"เราอาจอัปเดตนโยบายคุกกี้นี้ การเปลี่ยนแปลงที่สำคัญจะแจ้งให้ผู้ใช้ทราบผ่านการแจ้งเตือนเว็บไซต์หรืออีเมล"}}},vi:{title:"Chính sách Cookie",subtitle:"Thông tin về việc sử dụng Cookie trong Restarter™",back:"Quay lại",sections:{intro:{title:"Cookie là gì",content:"Cookie là các tệp văn bản nhỏ được lưu trữ trên thiết bị của bạn để cải thiện trải nghiệm duyệt web. Khi bạn truy cập trang web của chúng tôi, chúng tôi có thể đặt cookie trên thiết bị của bạn."},purpose:{title:"Mục đích của Cookie",content:"Chúng tôi sử dụng cookie để: ghi nhớ tùy chọn của bạn, phân tích việc sử dụng trang web, cung cấp nội dung cá nhân hóa, cải thiện hiệu suất trang web, đảm bảo bảo mật."},types:{title:"Các loại Cookie",content:"Chúng tôi sử dụng các loại cookie sau: cookie cần thiết (chức năng cơ bản của trang web), cookie hiệu suất (phân tích sử dụng), cookie chức năng (ghi nhớ tùy chọn), cookie quảng cáo (nội dung cá nhân hóa)."},control:{title:"Kiểm soát Cookie",content:"Bạn có thể kiểm soát cookie thông qua cài đặt trình duyệt. Hầu hết các trình duyệt cho phép bạn chặn hoặc xóa cookie, nhưng điều này có thể ảnh hưởng đến chức năng trang web."},thirdParty:{title:"Cookie của bên thứ ba",content:"Chúng tôi có thể sử dụng các dịch vụ bên thứ ba như công cụ phân tích có thể đặt cookie riêng của họ. Chúng tôi không thể kiểm soát các cookie bên thứ ba này."},updates:{title:"Cập nhật chính sách",content:"Chúng tôi có thể cập nhật chính sách Cookie này. Những thay đổi quan trọng sẽ được thông báo cho người dùng thông qua thông báo trang web hoặc email."}}},ms:{title:"Dasar Cookie",subtitle:"Maklumat tentang penggunaan Cookie dalam Restarter™",back:"Kembali",sections:{intro:{title:"Apa itu Cookie",content:"Cookie adalah fail teks kecil yang disimpan pada peranti anda untuk meningkatkan pengalaman melayari. Apabila anda melawat laman web kami, kami mungkin meletakkan cookie pada peranti anda."},purpose:{title:"Tujuan Cookie",content:"Kami menggunakan cookie untuk: mengingati pilihan anda, menganalisis penggunaan laman web, menyediakan kandungan peribadi, meningkatkan prestasi laman web, memastikan keselamatan."},types:{title:"Jenis Cookie",content:"Kami menggunakan jenis cookie berikut: cookie penting (fungsi asas laman web), cookie prestasi (analisis penggunaan), cookie fungsi (ingatan pilihan), cookie iklan (kandungan peribadi)."},control:{title:"Mengawal Cookie",content:"Anda boleh mengawal cookie melalui tetapan pelayar. Kebanyakan pelayar membolehkan anda menyekat atau memadamkan cookie, tetapi ini mungkin menjejaskan fungsi laman web."},thirdParty:{title:"Cookie Pihak Ketiga",content:"Kami mungkin menggunakan perkhidmatan pihak ketiga seperti alat analisis yang mungkin menetapkan cookie sendiri. Kami tidak boleh mengawal cookie pihak ketiga ini."},updates:{title:"Kemas Kini Dasar",content:"Kami mungkin mengemas kini Dasar Cookie ini. Perubahan penting akan diberitahu kepada pengguna melalui pemberitahuan laman web atau e-mel."}}},la:{title:"Politica Cookie",subtitle:"Informatio de usu Cookie in Restarter™",back:"Redire",sections:{intro:{title:"Quid sunt Cookie",content:"Cookie sunt parva texta documenta in tuo apparatu reposita ad meliorandum navigationis experientiam. Cum nostrum situm visitas, possumus cookie in tuo apparatu ponere."},purpose:{title:"Propositum Cookie",content:"Utimur cookie ad: meminisse electiones tuas, analysare usum situs, praebere contentum personalizatum, meliorare efficacitatem situs, securitatem praestare."},types:{title:"Typi Cookie",content:"Utimur sequentibus typis cookie: cookie essentiales (functiones basici situs), cookie efficacitatis (analysis usus), cookie functionales (memoria electionum), cookie publicitatis (contentum personalizatum)."},control:{title:"Controllare Cookie",content:"Potes controllare cookie per configurationes navigatoris. Plurimi navigatores permittunt te prohibere vel delere cookie, sed hoc potest afficere functiones situs."},thirdParty:{title:"Cookie Tertii Partis",content:"Possumus uti servitiis tertii partis sicut instrumenta analysi quae possunt ponere sua propria cookie. Non possumus controllare haec cookie tertii partis."},updates:{title:"Renovationes Politicae",content:"Possumus renovare hanc Politicam Cookie. Mutationes importantes notificabuntur usuariis per notificationes situs vel email."}}}};function aB(){const e=le(),{lang:t}=mw(),n=rB[t]||rB["zh-TW"];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[f.jsx("button",{onClick:()=>e("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:n.back}),f.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:n.title}),f.jsx("div",{style:{width:80}})]}),f.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:n.subtitle}),f.jsx("div",{style:{lineHeight:1.6},children:Object.entries(n.sections).map(([e,t])=>f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:t.title}),f.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:t.content})]},e))})]}),f.jsx(vI,{})]})}const oB={"zh-TW":{title:"兒童隱私保護",subtitle:"關於Restarter™對兒童隱私的保護措施",back:"返回",sections:{intro:{title:"兒童隱私保護聲明",content:"Restarter™重視兒童隱私保護，嚴格遵守相關法律法規。我們不會故意收集13歲以下兒童的個人信息，除非獲得家長或監護人的明確同意。"},ageLimit:{title:"年齡限制",content:"我們的服務主要面向13歲以上的用戶。13歲以下兒童如需使用服務，必須在家長或監護人的監督下進行。"},parentalConsent:{title:"家長同意",content:"如果我們發現收集了13歲以下兒童的信息，會立即刪除相關數據並通知家長。家長有權要求查看、修改或刪除子女的個人信息。"},dataProtection:{title:"數據保護",content:"我們對兒童數據實施額外的保護措施，包括加密存儲、訪問限制、定期審查等，確保兒童隱私安全。"},contact:{title:"聯繫我們",content:"如果您對兒童隱私保護有任何疑問，請通過應用程式內的意見箱與我們聯繫。我們會認真處理每一項相關請求。"}}},"zh-CN":{title:"儿童隐私保护",subtitle:"关于Restarter™对儿童隐私的保护措施",back:"返回",sections:{intro:{title:"儿童隐私保护声明",content:"Restarter™重视儿童隐私保护，严格遵守相关法律法规。我们不会故意收集13岁以下儿童的个人信息，除非获得家长或监护人的明确同意。"},ageLimit:{title:"年龄限制",content:"我们的服务主要面向13岁以上的用户。13岁以下儿童如需使用服务，必须在家长或监护人的监督下进行。"},parentalConsent:{title:"家长同意",content:"如果我们发现收集了13岁以下儿童的信息，会立即删除相关数据并通知家长。家长有权要求查看、修改或删除子女的个人信息。"},dataProtection:{title:"数据保护",content:"我们对儿童数据实施额外的保护措施，包括加密存储、访问限制、定期审查等，确保儿童隐私安全。"},contact:{title:"联系我们",content:"如果您对儿童隐私保护有任何疑问，请通过应用程序内的意见箱与我们联系。我们会认真处理每一项相关请求。"}}},en:{title:"Children's Privacy",subtitle:"Restarter™ protection measures for children's privacy",back:"Back",sections:{intro:{title:"Children's Privacy Statement",content:"Restarter™ values children's privacy protection and strictly complies with relevant laws and regulations. We do not knowingly collect personal information from children under 13 unless we obtain explicit consent from parents or guardians."},ageLimit:{title:"Age Restrictions",content:"Our services are primarily intended for users aged 13 and above. Children under 13 must use our services under parental or guardian supervision."},parentalConsent:{title:"Parental Consent",content:"If we discover that we have collected information from children under 13, we will immediately delete the relevant data and notify parents. Parents have the right to request to view, modify, or delete their children's personal information."},dataProtection:{title:"Data Protection",content:"We implement additional protection measures for children's data, including encrypted storage, access restrictions, regular reviews, etc., to ensure children's privacy security."},contact:{title:"Contact Us",content:"If you have any questions about children's privacy protection, please contact us through the feedback box in the app. We will seriously handle every related request."}}},ja:{title:"児童プライバシー保護",subtitle:"Restarter™の児童プライバシー保護措置について",back:"戻る",sections:{intro:{title:"児童プライバシー保護声明",content:"Restarter™は児童のプライバシー保護を重視し、関連する法律・規制を厳格に遵守しています。保護者または後見人の明確な同意がない限り、13歳未満の児童の個人情報を故意に収集することはありません。"},ageLimit:{title:"年齢制限",content:"当社のサービスは主に13歳以上のユーザーを対象としています。13歳未満の児童がサービスを使用する場合は、保護者または後見人の監督下で行う必要があります。"},parentalConsent:{title:"保護者の同意",content:"13歳未満の児童からの情報収集を発見した場合、関連データを即座に削除し保護者に通知します。保護者は子供の個人情報の閲覧、修正、削除を要求する権利があります。"},dataProtection:{title:"データ保護",content:"児童データに対して暗号化保存、アクセス制限、定期レビューなどの追加保護措置を実施し、児童のプライバシーセキュリティを確保します。"},contact:{title:"お問い合わせ",content:"児童プライバシー保護についてご質問がございましたら、アプリ内のフィードバックボックスを通じてお問い合わせください。すべての関連リクエストを真摯に処理いたします。"}}},ko:{title:"아동 개인정보 보호",subtitle:"Restarter™의 아동 개인정보 보호 조치에 대해",back:"뒤로",sections:{intro:{title:"아동 개인정보 보호 성명",content:"Restarter™는 아동 개인정보 보호를 중시하며 관련 법률 및 규정을 엄격히 준수합니다. 부모 또는 보호자의 명시적 동의가 없는 한 13세 미만 아동의 개인정보를 고의로 수집하지 않습니다."},ageLimit:{title:"연령 제한",content:"당사의 서비스는 주로 13세 이상 사용자를 대상으로 합니다. 13세 미만 아동이 서비스를 사용하려면 부모 또는 보호자의 감독 하에 이루어져야 합니다."},parentalConsent:{title:"부모 동의",content:"13세 미만 아동으로부터 정보 수집을 발견한 경우 관련 데이터를 즉시 삭제하고 부모에게 알립니다. 부모는 자녀의 개인정보 조회, 수정, 삭제를 요청할 권리가 있습니다."},dataProtection:{title:"데이터 보호",content:"아동 데이터에 대해 암호화 저장, 접근 제한, 정기 검토 등의 추가 보호 조치를 시행하여 아동의 개인정보 보안을 보장합니다."},contact:{title:"연락처",content:"아동 개인정보 보호에 대한 질문이 있으시면 앱 내 피드백 상자를 통해 문의해 주세요. 모든 관련 요청을 진지하게 처리하겠습니다."}}},th:{title:"การคุ้มครองความเป็นส่วนตัวของเด็ก",subtitle:"มาตรการคุ้มครองความเป็นส่วนตัวของเด็กของ Restarter™",back:"กลับ",sections:{intro:{title:"คำแถลงการคุ้มครองความเป็นส่วนตัวของเด็ก",content:"Restarter™ ให้ความสำคัญกับการคุ้มครองความเป็นส่วนตัวของเด็กและปฏิบัติตามกฎหมายและระเบียบที่เกี่ยวข้องอย่างเคร่งครัด เราไม่เก็บรวบรวมข้อมูลส่วนบุคคลของเด็กอายุต่ำกว่า 13 ปีโดยเจตนา เว้นแต่จะได้รับความยินยอมอย่างชัดเจนจากผู้ปกครองหรือผู้ดูแล"},ageLimit:{title:"ข้อจำกัดอายุ",content:"บริการของเรามุ่งเน้นไปที่ผู้ใช้อายุ 13 ปีขึ้นไป เด็กอายุต่ำกว่า 13 ปีต้องใช้บริการภายใต้การดูแลของผู้ปกครองหรือผู้ดูแล"},parentalConsent:{title:"ความยินยอมของผู้ปกครอง",content:"หากเราพบว่าเราได้เก็บรวบรวมข้อมูลจากเด็กอายุต่ำกว่า 13 ปี เราจะลบข้อมูลที่เกี่ยวข้องทันทีและแจ้งให้ผู้ปกครองทราบ ผู้ปกครองมีสิทธิ์ขอดู แก้ไข หรือลบข้อมูลส่วนบุคคลของบุตรหลาน"},dataProtection:{title:"การคุ้มครองข้อมูล",content:"เราใช้มาตรการคุ้มครองเพิ่มเติมสำหรับข้อมูลของเด็ก รวมถึงการเข้ารหัสการจัดเก็บ การจำกัดการเข้าถึง การตรวจสอบเป็นประจำ เป็นต้น เพื่อรับประกันความปลอดภัยของความเป็นส่วนตัวของเด็ก"},contact:{title:"ติดต่อเรา",content:"หากคุณมีคำถามเกี่ยวกับการคุ้มครองความเป็นส่วนตัวของเด็ก กรุณาติดต่อเราผ่านกล่องข้อเสนอแนะในแอป เราจะจัดการทุกคำขอที่เกี่ยวข้องอย่างจริงจัง"}}},vi:{title:"Bảo vệ quyền riêng tư trẻ em",subtitle:"Các biện pháp bảo vệ quyền riêng tư trẻ em của Restarter™",back:"Quay lại",sections:{intro:{title:"Tuyên bố bảo vệ quyền riêng tư trẻ em",content:"Restarter™ coi trọng việc bảo vệ quyền riêng tư trẻ em và tuân thủ nghiêm ngặt các luật pháp và quy định liên quan. Chúng tôi không cố ý thu thập thông tin cá nhân của trẻ em dưới 13 tuổi trừ khi có sự đồng ý rõ ràng từ cha mẹ hoặc người giám hộ."},ageLimit:{title:"Hạn chế độ tuổi",content:"Dịch vụ của chúng tôi chủ yếu dành cho người dùng từ 13 tuổi trở lên. Trẻ em dưới 13 tuổi phải sử dụng dịch vụ dưới sự giám sát của cha mẹ hoặc người giám hộ."},parentalConsent:{title:"Sự đồng ý của cha mẹ",content:"Nếu chúng tôi phát hiện đã thu thập thông tin từ trẻ em dưới 13 tuổi, chúng tôi sẽ ngay lập tức xóa dữ liệu liên quan và thông báo cho cha mẹ. Cha mẹ có quyền yêu cầu xem, sửa đổi hoặc xóa thông tin cá nhân của con cái."},dataProtection:{title:"Bảo vệ dữ liệu",content:"Chúng tôi thực hiện các biện pháp bảo vệ bổ sung cho dữ liệu trẻ em, bao gồm lưu trữ mã hóa, hạn chế truy cập, đánh giá định kỳ, v.v., để đảm bảo an toàn quyền riêng tư trẻ em."},contact:{title:"Liên hệ chúng tôi",content:"Nếu bạn có bất kỳ câu hỏi nào về bảo vệ quyền riêng tư trẻ em, vui lòng liên hệ với chúng tôi thông qua hộp phản hồi trong ứng dụng. Chúng tôi sẽ xử lý nghiêm túc mọi yêu cầu liên quan."}}},ms:{title:"Privasi Kanak-kanak",subtitle:"Langkah-langkah perlindungan privasi kanak-kanak Restarter™",back:"Kembali",sections:{intro:{title:"Penyata Privasi Kanak-kanak",content:"Restarter™ menghargai perlindungan privasi kanak-kanak dan mematuhi undang-undang dan peraturan yang berkaitan dengan ketat. Kami tidak sengaja mengumpul maklumat peribadi kanak-kanak di bawah umur 13 tahun melainkan kami memperoleh persetujuan yang jelas daripada ibu bapa atau penjaga."},ageLimit:{title:"Sekatan Umur",content:"Perkhidmatan kami terutamanya bertujuan untuk pengguna berumur 13 tahun ke atas. Kanak-kanak di bawah umur 13 tahun mesti menggunakan perkhidmatan kami di bawah penyeliaan ibu bapa atau penjaga."},parentalConsent:{title:"Persetujuan Ibu Bapa",content:"Jika kami mendapati bahawa kami telah mengumpul maklumat daripada kanak-kanak di bawah umur 13 tahun, kami akan segera memadamkan data yang berkaitan dan memberitahu ibu bapa. Ibu bapa mempunyai hak untuk meminta melihat, mengubah suai, atau memadamkan maklumat peribadi anak-anak mereka."},dataProtection:{title:"Perlindungan Data",content:"Kami melaksanakan langkah-langkah perlindungan tambahan untuk data kanak-kanak, termasuk penyimpanan terenkripsi, sekatan akses, ulasan berkala, dll., untuk memastikan keselamatan privasi kanak-kanak."},contact:{title:"Hubungi Kami",content:"Jika anda mempunyai sebarang soalan tentang perlindungan privasi kanak-kanak, sila hubungi kami melalui kotak maklum balas dalam aplikasi. Kami akan menangani setiap permintaan yang berkaitan dengan serius."}}},la:{title:"Privata Puerorum",subtitle:"Restarter™ mensurae protectionis privatae puerorum",back:"Redire",sections:{intro:{title:"Declaratio Privatae Puerorum",content:"Restarter™ aestimat protectionem privatae puerorum et stricte observat leges et regulas pertinentes. Non scienter colligimus informationem personalem puerorum sub annis 13 nisi obtinemus consensum explicitum a parentibus vel tutoribus."},ageLimit:{title:"Limitationes Aetatis",content:"Servitia nostra principaliter intenduntur pro usuariis annorum 13 et supra. Pueri sub annis 13 debent uti servitiis nostris sub supervisione parentum vel tutorum."},parentalConsent:{title:"Consensus Parentum",content:"Si invenimus nos collegisse informationem a pueris sub annis 13, statim delere data relata et notificare parentes. Parentes habent ius petendi videre, mutare, vel delere informationem personalem filiorum suorum."},dataProtection:{title:"Protectio Datorum",content:"Implementamus mensuras protectionis additas pro datis puerorum, includentes repositorium encryptatum, limitationes accessus, revisiones regulares, etc., ad praestandum securitatem privatae puerorum."},contact:{title:"Contacta Nos",content:"Si habes quaestiones de protectione privatae puerorum, quaeso contacta nos per cistam feedback in app. Tractabimus omnem petitionem relatum serio."}}}};function sB(){const e=le(),{lang:t}=mw(),n=oB[t]||oB["zh-TW"];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[f.jsx("button",{onClick:()=>e("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:n.back}),f.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:n.title}),f.jsx("div",{style:{width:80}})]}),f.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:n.subtitle}),f.jsx("div",{style:{lineHeight:1.6},children:Object.entries(n.sections).map(([e,t])=>f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:t.title}),f.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:t.content})]},e))})]}),f.jsx(vI,{})]})}const lB={"zh-TW":{title:"國際用戶法律聲明",subtitle:"關於Restarter™國際用戶的法律適用說明",back:"返回",sections:{scope:{title:"1. 適用範圍",content:"本聲明適用於所有使用Restarter服務的國際用戶，無論您位於哪個國家或地區。"},crossBorder:{title:"2. 數據跨境傳輸",content:"由於我們的服務可能涉及數據跨境傳輸，我們承諾：",items:["遵守相關國家的數據保護法律","實施適當的安全措施保護您的數據","在必要時獲得必要的法律授權"]},compliance:{title:"3. 當地法律合規",content:"我們努力確保服務符合您所在地區的適用法律，包括但不限於：",items:["數據保護法規（如GDPR、CCPA等）","消費者保護法律","內容監管要求"]},dispute:{title:"4. 爭議解決",content:"如發生爭議，我們將優先通過友好協商解決。如協商不成，將根據相關法律和我們的服務條款進行處理。"},contact:{title:"5. 聯繫信息",content:"如果您對本聲明有任何疑問，或需要了解特定地區的法律適用情況，請通過以下方式聯繫我們：",email:"郵箱：legal@restarter.com"},updates:{title:"6. 更新通知",content:"我們可能會根據法律變化或業務需要更新本聲明。重要更新將通過應用內通知或郵件方式告知用戶。"}}},"zh-CN":{title:"国际用户法律声明",subtitle:"关于Restarter™国际用户的法律适用说明",back:"返回",sections:{scope:{title:"1. 适用范围",content:"本声明适用于所有使用Restarter服务的国际用户，无论您位于哪个国家或地区。"},crossBorder:{title:"2. 数据跨境传输",content:"由于我们的服务可能涉及数据跨境传输，我们承诺：",items:["遵守相关国家的数据保护法律","实施适当的安全措施保护您的数据","在必要时获得必要的法律授权"]},compliance:{title:"3. 当地法律合规",content:"我们努力确保服务符合您所在地区的适用法律，包括但不限于：",items:["数据保护法规（如GDPR、CCPA等）","消费者保护法律","内容监管要求"]},dispute:{title:"4. 争议解决",content:"如发生争议，我们将优先通过友好协商解决。如协商不成，将根据相关法律和我们的服务条款进行处理。"},contact:{title:"5. 联系信息",content:"如果您对本声明有任何疑问，或需要了解特定地区的法律适用情况，请通过以下方式联系我们：",email:"邮箱：legal@restarter.com"},updates:{title:"6. 更新通知",content:"我们可能会根据法律变化或业务需要更新本声明。重要更新将通过应用内通知或邮件方式告知用户。"}}},en:{title:"International Users Legal Statement",subtitle:"Legal applicability information for Restarter™ international users",back:"Back",sections:{scope:{title:"1. Scope of Application",content:"This statement applies to all international users of Restarter services, regardless of which country or region you are located in."},crossBorder:{title:"2. Cross-Border Data Transmission",content:"As our services may involve cross-border data transmission, we commit to:",items:["Comply with data protection laws of relevant countries","Implement appropriate security measures to protect your data","Obtain necessary legal authorization when required"]},compliance:{title:"3. Local Legal Compliance",content:"We strive to ensure that our services comply with applicable laws in your region, including but not limited to:",items:["Data protection regulations (such as GDPR, CCPA, etc.)","Consumer protection laws","Content regulation requirements"]},dispute:{title:"4. Dispute Resolution",content:"In the event of disputes, we will prioritize resolution through friendly negotiation. If negotiation fails, we will handle the matter according to relevant laws and our service terms."},contact:{title:"5. Contact Information",content:"If you have any questions about this statement, or need to understand the legal applicability in specific regions, please contact us through:",email:"Email: legal@restarter.com"},updates:{title:"6. Update Notifications",content:"We may update this statement based on legal changes or business needs. Important updates will be notified to users through in-app notifications or email."}}},ja:{title:"国際ユーザー法的声明",subtitle:"Restarter™国際ユーザー向け法的適用性に関する説明",back:"戻る",sections:{scope:{title:"1. 適用範囲",content:"本声明は、どの国や地域に所在するかを問わず、Restarterサービスを利用するすべての国際ユーザーに適用されます。"},crossBorder:{title:"2. データの越境転送",content:"当社のサービスにはデータの越境転送が含まれる可能性があるため、以下のことを約束します：",items:["関連国のデータ保護法を遵守する","適切なセキュリティ対策を実施してデータを保護する","必要に応じて必要な法的認可を取得する"]},compliance:{title:"3. 現地法規制への準拠",content:"当社は、お客様の地域の適用法に準拠するようサービスを提供することを目指しており、以下を含みますが、これらに限定されません：",items:["データ保護規制（GDPR、CCPAなど）","消費者保護法","コンテンツ規制要件"]},dispute:{title:"4. 紛争解決",content:"紛争が発生した場合、当社は友好的な交渉による解決を優先します。交渉が失敗した場合、関連法および当社のサービス条項に従って処理します。"},contact:{title:"5. 連絡先情報",content:"本声明についてご質問がある場合、または特定地域の法的適用性について知りたい場合は、以下を通じてお問い合わせください：",email:"メール：legal@restarter.com"},updates:{title:"6. 更新通知",content:"法的変更やビジネスニーズに基づいて本声明を更新する場合があります。重要な更新は、アプリ内通知またはメールでユーザーに通知されます。"}}},ko:{title:"국제 사용자 법적 성명",subtitle:"Restarter™ 국제 사용자를 위한 법적 적용성 정보",back:"뒤로",sections:{scope:{title:"1. 적용 범위",content:"본 성명은 어느 국가나 지역에 위치하든 상관없이 Restarter 서비스를 이용하는 모든 국제 사용자에게 적용됩니다."},crossBorder:{title:"2. 데이터 국경 간 전송",content:"당사의 서비스에는 데이터 국경 간 전송이 포함될 수 있으므로 다음을 약속합니다:",items:["관련 국가의 데이터 보호법을 준수합니다","적절한 보안 조치를 시행하여 데이터를 보호합니다","필요시 필요한 법적 승인을 받습니다"]},compliance:{title:"3. 현지 법적 준수",content:"당사는 귀하의 지역의 적용 법률을 준수하도록 서비스를 제공하기 위해 노력하며, 다음을 포함하지만 이에 국한되지 않습니다:",items:["데이터 보호 규정(GDPR, CCPA 등)","소비자 보호법","콘텐츠 규제 요구사항"]},dispute:{title:"4. 분쟁 해결",content:"분쟁이 발생할 경우, 당사는 우선적으로 친선적 협상을 통한 해결을 추구합니다. 협상이 실패할 경우, 관련 법률과 당사의 서비스 약관에 따라 처리합니다."},contact:{title:"5. 연락처 정보",content:"본 성명에 대한 질문이 있거나 특정 지역의 법적 적용성에 대해 알고 싶으시면 다음을 통해 연락해 주세요:",email:"이메일: legal@restarter.com"},updates:{title:"6. 업데이트 알림",content:"법적 변경사항이나 비즈니스 요구사항에 따라 본 성명을 업데이트할 수 있습니다. 중요한 업데이트는 앱 내 알림이나 이메일로 사용자에게 통지됩니다."}}},th:{title:"คำแถลงทางกฎหมายสำหรับผู้ใช้ระหว่างประเทศ",subtitle:"ข้อมูลการบังคับใช้กฎหมายสำหรับผู้ใช้ Restarter™ ระหว่างประเทศ",back:"กลับ",sections:{scope:{title:"1. ขอบเขตการบังคับใช้",content:"คำแถลงนี้ใช้กับผู้ใช้ระหว่างประเทศทั้งหมดของบริการ Restarter โดยไม่คำนึงถึงประเทศหรือภูมิภาคที่คุณตั้งอยู่"},crossBorder:{title:"2. การส่งข้อมูลข้ามพรมแดน",content:"เนื่องจากบริการของเราอาจเกี่ยวข้องกับการส่งข้อมูลข้ามพรมแดน เรามุ่งมั่นที่จะ:",items:["ปฏิบัติตามกฎหมายการคุ้มครองข้อมูลของประเทศที่เกี่ยวข้อง","ดำเนินการมาตรการรักษาความปลอดภัยที่เหมาะสมเพื่อปกป้องข้อมูลของคุณ","ขออนุญาตทางกฎหมายที่จำเป็นเมื่อจำเป็น"]},compliance:{title:"3. การปฏิบัติตามกฎหมายท้องถิ่น",content:"เรามุ่งมั่นที่จะให้บริการที่สอดคล้องกับกฎหมายที่บังคับใช้ในภูมิภาคของคุณ รวมถึงแต่ไม่จำกัดเฉพาะ:",items:["กฎระเบียบการคุ้มครองข้อมูล (เช่น GDPR, CCPA เป็นต้น)","กฎหมายคุ้มครองผู้บริโภค","ข้อกำหนดการกำกับดูแลเนื้อหา"]},dispute:{title:"4. การแก้ไขข้อพิพาท",content:"ในกรณีที่มีข้อพิพาท เราจะให้ความสำคัญกับการแก้ไขผ่านการเจรจาอย่างเป็นมิตร หากการเจรจาล้มเหลว เราจะจัดการตามกฎหมายที่เกี่ยวข้องและข้อกำหนดการให้บริการของเรา"},contact:{title:"5. ข้อมูลการติดต่อ",content:"หากคุณมีคำถามเกี่ยวกับคำแถลงนี้ หรือต้องการทราบการบังคับใช้กฎหมายในภูมิภาคเฉพาะ กรุณาติดต่อเราผ่าน:",email:"อีเมล: legal@restarter.com"},updates:{title:"6. การแจ้งเตือนการอัปเดต",content:"เราอาจอัปเดตคำแถลงนี้ตามการเปลี่ยนแปลงทางกฎหมายหรือความต้องการทางธุรกิจ การอัปเดตที่สำคัญจะแจ้งให้ผู้ใช้ทราบผ่านการแจ้งเตือนในแอปหรืออีเมล"}}},vi:{title:"Tuyên bố pháp lý cho người dùng quốc tế",subtitle:"Thông tin về khả năng áp dụng pháp lý cho người dùng Restarter™ quốc tế",back:"Quay lại",sections:{scope:{title:"1. Phạm vi áp dụng",content:"Tuyên bố này áp dụng cho tất cả người dùng quốc tế của dịch vụ Restarter, bất kể bạn ở quốc gia hoặc khu vực nào."},crossBorder:{title:"2. Truyền dữ liệu xuyên biên giới",content:"Vì dịch vụ của chúng tôi có thể liên quan đến việc truyền dữ liệu xuyên biên giới, chúng tôi cam kết:",items:["Tuân thủ luật bảo vệ dữ liệu của các quốc gia liên quan","Thực hiện các biện pháp bảo mật phù hợp để bảo vệ dữ liệu của bạn","Có được ủy quyền pháp lý cần thiết khi cần thiết"]},compliance:{title:"3. Tuân thủ pháp luật địa phương",content:"Chúng tôi nỗ lực đảm bảo dịch vụ tuân thủ luật pháp áp dụng trong khu vực của bạn, bao gồm nhưng không giới hạn ở:",items:["Quy định bảo vệ dữ liệu (như GDPR, CCPA, v.v.)","Luật bảo vệ người tiêu dùng","Yêu cầu quản lý nội dung"]},dispute:{title:"4. Giải quyết tranh chấp",content:"Trong trường hợp có tranh chấp, chúng tôi sẽ ưu tiên giải quyết thông qua đàm phán thân thiện. Nếu đàm phán thất bại, chúng tôi sẽ xử lý theo luật pháp liên quan và điều khoản dịch vụ của chúng tôi."},contact:{title:"5. Thông tin liên hệ",content:"Nếu bạn có bất kỳ câu hỏi nào về tuyên bố này, hoặc cần hiểu về khả năng áp dụng pháp lý ở các khu vực cụ thể, vui lòng liên hệ chúng tôi qua:",email:"Email: legal@restarter.com"},updates:{title:"6. Thông báo cập nhật",content:"Chúng tôi có thể cập nhật tuyên bố này dựa trên thay đổi pháp lý hoặc nhu cầu kinh doanh. Các cập nhật quan trọng sẽ được thông báo cho người dùng thông qua thông báo trong ứng dụng hoặc email."}}},ms:{title:"Penyata Undang-undang Pengguna Antarabangsa",subtitle:"Maklumat kebolehgunaan undang-undang untuk pengguna Restarter™ antarabangsa",back:"Kembali",sections:{scope:{title:"1. Skop Permohonan",content:"Penyata ini terpakai kepada semua pengguna antarabangsa perkhidmatan Restarter, tanpa mengira negara atau rantau mana anda berada."},crossBorder:{title:"2. Pemindahan Data Merentasi Sempadan",content:"Oleh kerana perkhidmatan kami mungkin melibatkan pemindahan data merentasi sempadan, kami berjanji untuk:",items:["Mematuhi undang-undang perlindungan data negara-negara yang berkaitan","Melaksanakan langkah-langkah keselamatan yang sesuai untuk melindungi data anda","Mendapatkan kebenaran undang-undang yang diperlukan apabila diperlukan"]},compliance:{title:"3. Pematuhan Undang-undang Tempatan",content:"Kami berusaha untuk memastikan perkhidmatan mematuhi undang-undang yang berkenaan di rantau anda, termasuk tetapi tidak terhad kepada:",items:["Peraturan perlindungan data (seperti GDPR, CCPA, dll.)","Undang-undang perlindungan pengguna","Keperluan pengawalseliaan kandungan"]},dispute:{title:"4. Penyelesaian Pertikaian",content:"Sekiranya berlaku pertikaian, kami akan mengutamakan penyelesaian melalui rundingan secara baik. Jika rundingan gagal, kami akan mengendalikan perkara mengikut undang-undang yang berkaitan dan terma perkhidmatan kami."},contact:{title:"5. Maklumat Perhubungan",content:"Jika anda mempunyai sebarang soalan tentang penyata ini, atau perlu memahami kebolehgunaan undang-undang di rantau tertentu, sila hubungi kami melalui:",email:"E-mel: legal@restarter.com"},updates:{title:"6. Pemberitahuan Kemas Kini",content:"Kami mungkin mengemas kini penyata ini berdasarkan perubahan undang-undang atau keperluan perniagaan. Kemas kini penting akan diberitahu kepada pengguna melalui pemberitahuan dalam aplikasi atau e-mel."}}},la:{title:"Declaratio Iuridica Usuarii Internationalis",subtitle:"Informatio de applicabilitate iuridica pro usuariis Restarter™ internationalibus",back:"Redire",sections:{scope:{title:"1. Scopum Applicationis",content:"Haec declaratio applicatur omnibus usuariis internationalibus servitiorum Restarter, quocumque in regione vel civitate sitis."},crossBorder:{title:"2. Transmissio Datorum Trans Fines",content:"Cum servitia nostra transmissionem datorum trans fines involvere possint, nos promittimus:",items:["Leges protectionis datorum civitatum pertinentium observare","Mensuras securitatis aptas implementare ad data tua protegenda","Auctoritatem iuridicam necessariam obtinere cum necesse est"]},compliance:{title:"3. Observantia Legis Localis",content:"Nos conamur ut servitia nostra legibus applicabilibus in regione tua conformia sint, includendo sed non limitando ad:",items:["Regulationes protectionis datorum (sicut GDPR, CCPA, etc.)","Leges protectionis consumptorum","Requisitiones regulationis contenti"]},dispute:{title:"4. Resolutio Controversiarum",content:"In casu controversiarum, nos controversias per negotiationem amicabilem resolvere praeferimus. Si negotiatio defecit, nos materiam secundum leges pertinentes et terminos servitiorum nostrorum tractabimus."},contact:{title:"5. Informatio Contactus",content:"Si quaestiones de hac declaratione habes, vel necesse est intellegere applicabilitatem iuridicam in regionibus specificis, quaeso nos contacta per:",email:"Epistula: legal@restarter.com"},updates:{title:"6. Notificationes Renovationis",content:"Nos hanc declarationem renovare possumus secundum mutationes iuridicas vel necessitates negotii. Renovationes importantes per notificationes in app vel epistulam usuariis notificabuntur."}}}},cB=()=>{const e=le(),{lang:t}=mw(),n=lB[t]||lB["zh-TW"];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[f.jsx("button",{onClick:()=>e("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:n.back}),f.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:n.title}),f.jsx("div",{style:{width:80}})]}),f.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:n.subtitle}),f.jsx("div",{style:{lineHeight:1.6},children:Object.entries(n.sections).map(([e,t])=>f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:t.title}),f.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:t.content}),t.items&&f.jsx("ul",{style:{color:"#333",fontSize:16,paddingLeft:20,marginTop:8},children:t.items.map((e,t)=>f.jsx("li",{style:{marginBottom:4},children:e},t))}),t.email&&f.jsx("p",{style:{color:"#6B5BFF",fontSize:16,fontWeight:600,marginTop:8},children:t.email})]},e))})]}),f.jsx(vI,{})]})},dB={"zh-TW":{title:"安全聲明",subtitle:"關於Restarter™數據安全和隱私保護的聲明",back:"返回",sections:{commitment:{title:"1. 數據安全承諾",content:"Restarter致力於保護您的個人信息和數據安全。我們採用行業標準的安全措施來保護您的數據。"},encryption:{title:"2. 數據加密",content:"我們使用以下加密技術保護您的數據：",items:["傳輸層安全協議（TLS）加密所有數據傳輸","數據庫級別的加密存儲","端到端加密保護敏感信息"]},accessControl:{title:"3. 訪問控制",content:"我們實施嚴格的數據訪問控制：",items:["基於角色的訪問控制（RBAC）","多因素認證（MFA）","定期安全審計和監控","最小權限原則"]},infrastructure:{title:"4. 安全基礎設施",content:"我們的基礎設施安全措施包括：",items:["雲服務提供商的安全認證","定期安全漏洞掃描","入侵檢測和防護系統","災難恢復和業務連續性計劃"]},employees:{title:"5. 員工安全",content:"我們確保所有員工：",items:["接受定期安全培訓","簽署保密協議","遵循數據保護最佳實踐"]},incidentResponse:{title:"6. 安全事件響應",content:"如發生安全事件，我們將：",items:["立即啟動應急響應程序","評估事件影響範圍","及時通知受影響的用戶","採取補救措施防止類似事件"]},thirdParty:{title:"7. 第三方安全",content:"我們嚴格審查第三方服務提供商的安全標準，確保他們符合我們的安全要求。"},reporting:{title:"8. 安全報告",content:"如果您發現安全漏洞或有安全相關問題，請立即聯繫我們：",email:"安全郵箱：security@restarter.com"}}},"zh-CN":{title:"安全声明",subtitle:"关于Restarter™数据安全和隐私保护的声明",back:"返回",sections:{commitment:{title:"1. 数据安全承诺",content:"Restarter致力于保护您的个人信息和数据安全。我们采用行业标准的安全措施来保护您的数据。"},encryption:{title:"2. 数据加密",content:"我们使用以下加密技术保护您的数据：",items:["传输层安全协议（TLS）加密所有数据传输","数据库级别的加密存储","端到端加密保护敏感信息"]},accessControl:{title:"3. 访问控制",content:"我们实施严格的数据访问控制：",items:["基于角色的访问控制（RBAC）","多因素认证（MFA）","定期安全审计和监控","最小权限原则"]},infrastructure:{title:"4. 安全基础设施",content:"我们的基础设施安全措施包括：",items:["云服务提供商的安全认证","定期安全漏洞扫描","入侵检测和防护系统","灾难恢复和业务连续性计划"]},employees:{title:"5. 员工安全",content:"我们确保所有员工：",items:["接受定期安全培训","签署保密协议","遵循数据保护最佳实践"]},incidentResponse:{title:"6. 安全事件响应",content:"如发生安全事件，我们将：",items:["立即启动应急响应程序","评估事件影响范围","及时通知受影响的用户","采取补救措施防止类似事件"]},thirdParty:{title:"7. 第三方安全",content:"我们严格审查第三方服务提供商的安全标准，确保他们符合我们的安全要求。"},reporting:{title:"8. 安全报告",content:"如果您发现安全漏洞或有安全相关问题，请立即联系我们：",email:"安全邮箱：security@restarter.com"}}},en:{title:"Security Statement",subtitle:"Statement on Restarter™ data security and privacy protection",back:"Back",sections:{commitment:{title:"1. Data Security Commitment",content:"Restarter is committed to protecting your personal information and data security. We adopt industry-standard security measures to protect your data."},encryption:{title:"2. Data Encryption",content:"We use the following encryption technologies to protect your data:",items:["Transport Layer Security (TLS) encryption for all data transmission","Database-level encrypted storage","End-to-end encryption for sensitive information"]},accessControl:{title:"3. Access Control",content:"We implement strict data access controls:",items:["Role-based access control (RBAC)","Multi-factor authentication (MFA)","Regular security audits and monitoring","Principle of least privilege"]},infrastructure:{title:"4. Security Infrastructure",content:"Our infrastructure security measures include:",items:["Cloud service provider security certifications","Regular security vulnerability scanning","Intrusion detection and prevention systems","Disaster recovery and business continuity plans"]},employees:{title:"5. Employee Security",content:"We ensure all employees:",items:["Receive regular security training","Sign confidentiality agreements","Follow data protection best practices"]},incidentResponse:{title:"6. Security Incident Response",content:"In the event of a security incident, we will:",items:["Immediately activate emergency response procedures","Assess the scope of the incident","Timely notify affected users","Take remedial measures to prevent similar incidents"]},thirdParty:{title:"7. Third-Party Security",content:"We strictly review the security standards of third-party service providers to ensure they meet our security requirements."},reporting:{title:"8. Security Reporting",content:"If you discover security vulnerabilities or have security-related issues, please contact us immediately:",email:"Security email: security@restarter.com"}}},ja:{title:"セキュリティ声明",subtitle:"Restarter™データセキュリティとプライバシー保護に関する声明",back:"戻る",sections:{commitment:{title:"1. データセキュリティへの取り組み",content:"Restarterは、お客様の個人情報とデータセキュリティの保護に取り組んでいます。暗号化技術、アクセス制御、セキュリティ監視など、業界標準のセキュリティ対策を採用してデータを保護しています。"},encryption:{title:"2. データ暗号化",content:"お客様のデータを保護するために、多層暗号化技術を使用しています：",items:["データ伝送暗号化のためのTransport Layer Security（TLS）","データベースレベルの暗号化ストレージ","機密情報のエンドツーエンド暗号化"]},access:{title:"3. アクセス制御",content:"ロールベースアクセス制御（RBAC）や多要素認証を含む厳格なデータアクセス制御を実装し、承認された担当者のみがデータにアクセスできるようにしています。"},monitoring:{title:"4. セキュリティ監視",content:"異常検知、侵入検知、定期的なセキュリティ監査を含むシステムセキュリティを継続的に監視し、データセキュリティを確保しています。"},incident:{title:"5. セキュリティインシデント対応",content:"セキュリティインシデントが発生した場合、緊急対応手順を即座に開始し、影響を受けたユーザーに72時間以内に通知します。"},compliance:{title:"6. コンプライアンス",content:"GDPR、CCPAなどの関連データ保護規制を遵守し、最新の法的要件を満たすためにセキュリティ対策を定期的に更新しています。"}}},ko:{title:"보안 성명",subtitle:"Restarter™ 데이터 보안 및 개인정보 보호에 관한 성명",back:"뒤로",sections:{commitment:{title:"1. 데이터 보안 약속",content:"Restarter는 귀하의 개인정보와 데이터 보안을 보호하기 위해 노력합니다. 암호화 기술, 접근 제어, 보안 모니터링을 포함한 업계 표준 보안 조치를 채택하여 데이터를 보호합니다."},encryption:{title:"2. 데이터 암호화",content:"귀하의 데이터를 보호하기 위해 다층 암호화 기술을 사용합니다:",items:["데이터 전송 암호화를 위한 Transport Layer Security(TLS)","데이터베이스 레벨 암호화 저장","민감한 정보의 엔드투엔드 암호화"]},access:{title:"3. 접근 제어",content:"역할 기반 접근 제어(RBAC)와 다중 인증을 포함한 엄격한 데이터 접근 제어를 구현하여 승인된 인원만 데이터에 접근할 수 있도록 합니다."},monitoring:{title:"4. 보안 모니터링",content:"이상 탐지, 침입 탐지, 정기 보안 감사를 포함한 시스템 보안을 지속적으로 모니터링하여 데이터 보안을 보장합니다."},incident:{title:"5. 보안 사고 대응",content:"보안 사고가 발생할 경우, 즉시 비상 대응 절차를 시작하고 영향을 받은 사용자에게 72시간 이내에 통지합니다."},compliance:{title:"6. 준수",content:"GDPR, CCPA 등의 관련 데이터 보호 규정을 준수하며, 최신 법적 요구사항을 충족하기 위해 보안 조치를 정기적으로 업데이트합니다."}}},th:{title:"คำแถลงความปลอดภัย",subtitle:"คำแถลงเกี่ยวกับความปลอดภัยของข้อมูลและความเป็นส่วนตัวของ Restarter™",back:"กลับ",sections:{commitment:{title:"1. ความมุ่งมั่นด้านความปลอดภัยของข้อมูล",content:"Restarter มุ่งมั่นที่จะปกป้องข้อมูลส่วนบุคคลและความปลอดภัยของข้อมูลของคุณ เราใช้มาตรการความปลอดภัยตามมาตรฐานอุตสาหกรรมเพื่อปกป้องข้อมูลของคุณ รวมถึงแต่ไม่จำกัดเฉพาะเทคโนโลยีการเข้ารหัส การควบคุมการเข้าถึง และการตรวจสอบความปลอดภัย"},encryption:{title:"2. การเข้ารหัสข้อมูล",content:"เราใช้เทคโนโลยีการเข้ารหัสหลายชั้นเพื่อปกป้องข้อมูลของคุณ:",items:["Transport Layer Security (TLS) สำหรับการเข้ารหัสการส่งข้อมูล","การจัดเก็บข้อมูลแบบเข้ารหัสระดับฐานข้อมูล","การเข้ารหัสแบบ end-to-end สำหรับข้อมูลที่ละเอียดอ่อน"]},access:{title:"3. การควบคุมการเข้าถึง",content:"เราใช้การควบคุมการเข้าถึงข้อมูลที่เข้มงวด รวมถึงการควบคุมการเข้าถึงแบบ Role-Based Access Control (RBAC) และการยืนยันตัวตนหลายปัจจัย เพื่อให้แน่ใจว่าบุคลากรที่ได้รับอนุญาตเท่านั้นที่สามารถเข้าถึงข้อมูลของคุณได้"},monitoring:{title:"4. การตรวจสอบความปลอดภัย",content:"เราเฝ้าติดตามความปลอดภัยของระบบอย่างต่อเนื่อง รวมถึงการตรวจจับความผิดปกติ การตรวจจับการบุกรุก และการตรวจสอบความปลอดภัยเป็นประจำ เพื่อให้แน่ใจในความปลอดภัยของข้อมูลของคุณ"},incident:{title:"5. การตอบสนองต่อเหตุการณ์ความปลอดภัย",content:"ในกรณีที่เกิดเหตุการณ์ความปลอดภัย เราจะเปิดใช้งานขั้นตอนการตอบสนองฉุกเฉินทันทีและแจ้งเตือนผู้ใช้ที่ได้รับผลกระทบภายใน 72 ชั่วโมง"},compliance:{title:"6. การปฏิบัติตามกฎระเบียบ",content:"เราปฏิบัติตามกฎระเบียบการคุ้มครองข้อมูลที่เกี่ยวข้อง รวมถึง GDPR, CCPA เป็นต้น และอัปเดตมาตรการความปลอดภัยเป็นประจำเพื่อให้ตรงตามข้อกำหนดทางกฎหมายล่าสุด"}}},vi:{title:"Tuyên bố bảo mật",subtitle:"Tuyên bố về bảo mật dữ liệu và bảo vệ quyền riêng tư của Restarter™",back:"Quay lại",sections:{commitment:{title:"1. Cam kết bảo mật dữ liệu",content:"Restarter cam kết bảo vệ thông tin cá nhân và bảo mật dữ liệu của bạn. Chúng tôi sử dụng các biện pháp bảo mật theo tiêu chuẩn ngành để bảo vệ dữ liệu của bạn, bao gồm nhưng không giới hạn ở công nghệ mã hóa, kiểm soát truy cập và giám sát bảo mật."},encryption:{title:"2. Mã hóa dữ liệu",content:"Chúng tôi sử dụng công nghệ mã hóa nhiều lớp để bảo vệ dữ liệu của bạn:",items:["Transport Layer Security (TLS) để mã hóa truyền dữ liệu","Lưu trữ mã hóa cấp độ cơ sở dữ liệu","Mã hóa end-to-end cho thông tin nhạy cảm"]},access:{title:"3. Kiểm soát truy cập",content:"Chúng tôi thực hiện kiểm soát truy cập dữ liệu nghiêm ngặt, bao gồm Kiểm soát truy cập dựa trên vai trò (RBAC) và xác thực đa yếu tố, đảm bảo chỉ nhân viên được ủy quyền mới có thể truy cập dữ liệu của bạn."},monitoring:{title:"4. Giám sát bảo mật",content:"Chúng tôi liên tục giám sát bảo mật hệ thống, bao gồm phát hiện bất thường, phát hiện xâm nhập và kiểm toán bảo mật định kỳ, để đảm bảo bảo mật dữ liệu của bạn."},incident:{title:"5. Phản ứng sự cố bảo mật",content:"Trong trường hợp xảy ra sự cố bảo mật, chúng tôi sẽ ngay lập tức kích hoạt các thủ tục phản ứng khẩn cấp và thông báo cho người dùng bị ảnh hưởng trong vòng 72 giờ."},compliance:{title:"6. Tuân thủ",content:"Chúng tôi tuân thủ các quy định bảo vệ dữ liệu liên quan, bao gồm GDPR, CCPA, v.v., và thường xuyên cập nhật các biện pháp bảo mật để đáp ứng các yêu cầu pháp lý mới nhất."}}},ms:{title:"Penyata Keselamatan",subtitle:"Penyata mengenai Keselamatan Data dan Perlindungan Privasi Restarter™",back:"Kembali",sections:{commitment:{title:"1. Komitmen Keselamatan Data",content:"Restarter komited untuk melindungi maklumat peribadi dan keselamatan data anda. Kami menggunakan langkah-langkah keselamatan standard industri untuk melindungi data anda, termasuk tetapi tidak terhad kepada teknologi penyulitan, kawalan akses, dan pemantauan keselamatan."},encryption:{title:"2. Penyulitan Data",content:"Kami menggunakan teknologi penyulitan berbilang lapisan untuk melindungi data anda:",items:["Transport Layer Security (TLS) untuk penyulitan penghantaran data","Penyimpanan tersulit peringkat pangkalan data","Penyulitan end-to-end untuk maklumat sensitif"]},access:{title:"3. Kawalan Akses",content:"Kami melaksanakan kawalan akses data yang ketat, termasuk Kawalan Akses Berasaskan Peranan (RBAC) dan pengesahan berbilang faktor, memastikan hanya kakitangan yang diberi kuasa dapat mengakses data anda."},monitoring:{title:"4. Pemantauan Keselamatan",content:"Kami sentiasa memantau keselamatan sistem, termasuk pengesanan anomali, pengesanan pencerobohan, dan audit keselamatan berkala, untuk memastikan keselamatan data anda."},incident:{title:"5. Tindak Balas Insiden Keselamatan",content:"Dalam kes insiden keselamatan, kami akan segera mengaktifkan prosedur tindak balas kecemasan dan memberitahu pengguna yang terjejas dalam tempoh 72 jam."},compliance:{title:"6. Pematuhan",content:"Kami mematuhi peraturan perlindungan data yang berkaitan, termasuk GDPR, CCPA, dll., dan mengemas kini langkah-langkah keselamatan secara berkala untuk memenuhi keperluan undang-undang terkini."}}},la:{title:"Declaratio Securitatis",subtitle:"Declaratio de Securitate Datorum et Protectione Privatae Restarter™",back:"Redire",sections:{commitment:{title:"1. Promissio Securitatis Datorum",content:"Restarter promittit protegere informationem personalem et securitatem datorum tuorum. Nos utimur mensuris securitatis standard industriae ad protegenda data tua, includendo sed non limitando ad technologiam encryptionis, controlum accessus, et monitoring securitatis."},encryption:{title:"2. Encryptio Datorum",content:"Nos utimur technologia encryptionis multi-strata ad protegenda data tua:",items:["Transport Layer Security (TLS) pro encryptione transmissionis datorum","Repositorium encryptum nivelis database","Encryptio end-to-end pro informatione sensibili"]},access:{title:"3. Controlum Accessus",content:"Nos implementamus controla stricta accessus datorum, includendo Controlum Accessus Basatum in Rolam (RBAC) et authenticationem multi-factor, securos solum personalem auctorizatum posse accedere data tua."},monitoring:{title:"4. Monitoring Securitatis",content:"Nos continue monitamus securitatem systematis, includendo detectionem anomaliae, detectionem intrusionis, et auditum securitatis periodicum, ad securam securitatem datorum tuorum."},incident:{title:"5. Responsum Incidentis Securitatis",content:"In casu incidentis securitatis, nos immediate activabimus proceduras responsi urgentis et notificabimus usuarios affectatos intra 72 horas."},compliance:{title:"6. Observantia",content:"Nos observamus regulationes protectionis datorum pertinentes, includendo GDPR, CCPA, etc., et regulariter renovamus mensuras securitatis ad satisfaciendas requisitiones iuridicas recentissimas."}}}},uB=()=>{const e=le(),{lang:t}=mw(),n=dB[t]||dB["zh-TW"];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[f.jsx("button",{onClick:()=>e("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:n.back}),f.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:n.title}),f.jsx("div",{style:{width:80}})]}),f.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:n.subtitle}),f.jsx("div",{style:{lineHeight:1.6},children:Object.entries(n.sections).map(([e,t])=>f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:t.title}),f.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:t.content}),t.items&&f.jsx("ul",{style:{color:"#333",fontSize:16,paddingLeft:20,marginTop:8},children:t.items.map((e,t)=>f.jsx("li",{style:{marginBottom:4},children:e},t))}),t.email&&f.jsx("p",{style:{color:"#6B5BFF",fontSize:16,fontWeight:600,marginTop:8},children:t.email})]},e))})]}),f.jsx(vI,{})]})},hB={"zh-TW":{title:"更新通知政策",subtitle:"關於Restarter™法律文件更新通知的說明",back:"返回",sections:{overview:{title:"1. 政策概述",content:"本政策說明Restarter如何通知用戶關於法律文件的更新。我們致力於保持透明度，確保用戶能夠及時了解可能影響其權利和義務的重要變更。"},types:{title:"2. 更新類型",content:"我們可能會更新以下類型的法律文件：",items:["服務條款","隱私政策","Cookie政策","兒童隱私政策","其他法律聲明"]},methods:{title:"3. 通知方式",content:"我們將通過以下方式通知用戶重要更新：",items:["應用內通知","電子郵件通知","網站公告","推送通知（如適用）"]},timing:{title:"4. 通知時機",content:"對於重大變更，我們將在生效前至少30天通知用戶。對於緊急安全更新，我們可能會立即通知。"},review:{title:"5. 審查權利",content:"用戶有權在更新生效前審查變更內容。如果您不同意更新，您可以在生效日期前停止使用我們的服務。"},contact:{title:"6. 聯繫我們",content:"如果您對本政策或任何法律文件更新有任何疑問，請通過以下方式聯繫我們：",email:"郵箱：legal@restarter.com"}}},"zh-CN":{title:"更新通知政策",subtitle:"关于Restarter™法律文件更新通知的说明",back:"返回",sections:{overview:{title:"1. 政策概述",content:"本政策说明Restarter如何通知用户关于法律文件的更新。我们致力于保持透明度，确保用户能够及时了解可能影响其权利和义务的重要变更。"},types:{title:"2. 更新类型",content:"我们可能会更新以下类型的法律文件：",items:["服务条款","隐私政策","Cookie政策","儿童隐私政策","其他法律声明"]},methods:{title:"3. 通知方式",content:"我们将通过以下方式通知用户重要更新：",items:["应用内通知","电子邮件通知","网站公告","推送通知（如适用）"]},timing:{title:"4. 通知时机",content:"对于重大变更，我们将在生效前至少30天通知用户。对于紧急安全更新，我们可能会立即通知。"},review:{title:"5. 审查权利",content:"用户有权在更新生效前审查变更内容。如果您不同意更新，您可以在生效日期前停止使用我们的服务。"},contact:{title:"6. 联系我们",content:"如果您对本政策或任何法律文件更新有任何疑问，请通过以下方式联系我们：",email:"邮箱：legal@restarter.com"}}},en:{title:"Update Notification Policy",subtitle:"Explanation regarding Restarter™ legal document update notifications",back:"Back",sections:{overview:{title:"1. Policy Overview",content:"This policy explains how Restarter notifies users about updates to legal documents. We are committed to maintaining transparency and ensuring users are promptly informed of important changes that may affect their rights and obligations."},types:{title:"2. Update Types",content:"We may update the following types of legal documents:",items:["Terms of Service","Privacy Policy","Cookie Policy","Children's Privacy Policy","Other Legal Statements"]},methods:{title:"3. Notification Methods",content:"We will notify users of important updates through the following methods:",items:["In-app notifications","Email notifications","Website announcements","Push notifications (where applicable)"]},timing:{title:"4. Notification Timing",content:"For significant changes, we will notify users at least 30 days before the effective date. For urgent security updates, we may notify immediately."},review:{title:"5. Review Rights",content:"Users have the right to review changes before they take effect. If you do not agree to the updates, you may stop using our services before the effective date."},contact:{title:"6. Contact Us",content:"If you have any questions about this policy or any legal document updates, please contact us through:",email:"Email: legal@restarter.com"}}},ja:{title:"更新通知ポリシー",subtitle:"Restarter™法的文書更新通知に関する説明",back:"戻る",sections:{overview:{title:"1. ポリシー概要",content:"このポリシーは、Restarterが法的文書の更新についてユーザーに通知する方法を説明しています。透明性を維持し、ユーザーの権利と義務に影響を与える可能性のある重要な変更について、ユーザーが迅速に通知されることを確保することに取り組んでいます。"},types:{title:"2. 更新タイプ",content:"以下のタイプの法的文書を更新する場合があります：",items:["利用規約","プライバシーポリシー","Cookieポリシー","児童プライバシーポリシー","その他の法的声明"]},methods:{title:"3. 通知方法",content:"重要な更新について、以下の方法でユーザーに通知します：",items:["アプリ内通知","メール通知","ウェブサイト公告","プッシュ通知（該当する場合）"]},timing:{title:"4. 通知タイミング",content:"重要な変更については、発効日の少なくとも30日前にユーザーに通知します。緊急のセキュリティ更新については、即座に通知する場合があります。"},review:{title:"5. レビュー権利",content:"ユーザーは、変更が発効する前に変更内容をレビューする権利があります。更新に同意しない場合は、発効日前に当社のサービスの利用を停止できます。"},contact:{title:"6. お問い合わせ",content:"このポリシーまたは法的文書の更新についてご質問がある場合は、以下を通じてお問い合わせください：",email:"メール：legal@restarter.com"}}},ko:{title:"업데이트 알림 정책",subtitle:"Restarter™ 법적 문서 업데이트 알림에 대한 설명",back:"뒤로",sections:{overview:{title:"1. 정책 개요",content:"이 정책은 Restarter가 법적 문서 업데이트에 대해 사용자에게 알리는 방법을 설명합니다. 우리는 투명성을 유지하고 사용자의 권리와 의무에 영향을 미칠 수 있는 중요한 변경사항에 대해 사용자가 즉시 알림받을 수 있도록 보장하기 위해 노력합니다."},types:{title:"2. 업데이트 유형",content:"다음 유형의 법적 문서를 업데이트할 수 있습니다:",items:["서비스 약관","개인정보 처리방침","쿠키 정책","아동 개인정보 처리방침","기타 법적 성명"]},methods:{title:"3. 알림 방법",content:"중요한 업데이트에 대해 다음 방법으로 사용자에게 알림합니다:",items:["앱 내 알림","이메일 알림","웹사이트 공지","푸시 알림(해당하는 경우)"]},timing:{title:"4. 알림 시기",content:"중요한 변경사항의 경우, 발효일 최소 30일 전에 사용자에게 알림합니다. 긴급 보안 업데이트의 경우 즉시 알림할 수 있습니다."},review:{title:"5. 검토 권리",content:"사용자는 변경사항이 발효되기 전에 변경 내용을 검토할 권리가 있습니다. 업데이트에 동의하지 않는 경우 발효일 전에 서비스 이용을 중단할 수 있습니다."},contact:{title:"6. 문의하기",content:"이 정책이나 법적 문서 업데이트에 대한 질문이 있으시면 다음을 통해 연락해 주세요:",email:"이메일: legal@restarter.com"}}},th:{title:"นโยบายการแจ้งเตือนการอัปเดต",subtitle:"คำอธิบายเกี่ยวกับการแจ้งเตือนการอัปเดตเอกสารทางกฎหมายของ Restarter™",back:"กลับ",sections:{overview:{title:"1. ภาพรวมนโยบาย",content:"นโยบายนี้อธิบายว่า Restarter แจ้งเตือนผู้ใช้เกี่ยวกับการอัปเดตเอกสารทางกฎหมายอย่างไร เราให้คำมั่นที่จะรักษาความโปร่งใสและให้แน่ใจว่าผู้ใช้ได้รับการแจ้งเตือนอย่างรวดเร็วเกี่ยวกับการเปลี่ยนแปลงที่สำคัญที่อาจส่งผลกระทบต่อสิทธิ์และหน้าที่ของพวกเขา"},types:{title:"2. ประเภทการอัปเดต",content:"เราอาจอัปเดตเอกสารทางกฎหมายประเภทต่อไปนี้:",items:["ข้อกำหนดการให้บริการ","นโยบายความเป็นส่วนตัว","นโยบายคุกกี้","นโยบายความเป็นส่วนตัวของเด็ก","คำแถลงทางกฎหมายอื่นๆ"]},methods:{title:"3. วิธีการแจ้งเตือน",content:"เราจะแจ้งเตือนผู้ใช้เกี่ยวกับการอัปเดตที่สำคัญผ่านวิธีการต่อไปนี้:",items:["การแจ้งเตือนในแอป","การแจ้งเตือนทางอีเมล","ประกาศบนเว็บไซต์","การแจ้งเตือนแบบพุช (ในกรณีที่เหมาะสม)"]},timing:{title:"4. เวลาการแจ้งเตือน",content:"สำหรับการเปลี่ยนแปลงที่สำคัญ เราจะแจ้งเตือนผู้ใช้อย่างน้อย 30 วันก่อนวันที่มีผลบังคับใช้ สำหรับการอัปเดตความปลอดภัยที่เร่งด่วน เราอาจแจ้งเตือนทันที"},review:{title:"5. สิทธิในการตรวจสอบ",content:"ผู้ใช้มีสิทธิ์ตรวจสอบการเปลี่ยนแปลงก่อนที่จะมีผลบังคับใช้ หากคุณไม่เห็นด้วยกับการอัปเดต คุณสามารถหยุดใช้บริการของเราได้ก่อนวันที่มีผลบังคับใช้"},contact:{title:"6. ติดต่อเรา",content:"หากคุณมีคำถามเกี่ยวกับนโยบายนี้หรือการอัปเดตเอกสารทางกฎหมายใดๆ กรุณาติดต่อเราผ่าน:",email:"อีเมล: legal@restarter.com"}}},vi:{title:"Chính sách thông báo cập nhật",subtitle:"Giải thích về thông báo cập nhật tài liệu pháp lý Restarter™",back:"Quay lại",sections:{overview:{title:"1. Tổng quan chính sách",content:"Chính sách này giải thích cách Restarter thông báo cho người dùng về các cập nhật tài liệu pháp lý. Chúng tôi cam kết duy trì tính minh bạch và đảm bảo người dùng được thông báo kịp thời về những thay đổi quan trọng có thể ảnh hưởng đến quyền và nghĩa vụ của họ."},types:{title:"2. Loại cập nhật",content:"Chúng tôi có thể cập nhật các loại tài liệu pháp lý sau:",items:["Điều khoản dịch vụ","Chính sách bảo mật","Chính sách Cookie","Chính sách bảo mật trẻ em","Tuyên bố pháp lý khác"]},methods:{title:"3. Phương thức thông báo",content:"Chúng tôi sẽ thông báo cho người dùng về các cập nhật quan trọng thông qua các phương thức sau:",items:["Thông báo trong ứng dụng","Thông báo qua email","Thông báo trên trang web","Thông báo đẩy (nếu có)"]},timing:{title:"4. Thời gian thông báo",content:"Đối với những thay đổi quan trọng, chúng tôi sẽ thông báo cho người dùng ít nhất 30 ngày trước ngày có hiệu lực. Đối với các cập nhật bảo mật khẩn cấp, chúng tôi có thể thông báo ngay lập tức."},review:{title:"5. Quyền xem xét",content:"Người dùng có quyền xem xét các thay đổi trước khi chúng có hiệu lực. Nếu bạn không đồng ý với các cập nhật, bạn có thể ngừng sử dụng dịch vụ của chúng tôi trước ngày có hiệu lực."},contact:{title:"6. Liên hệ chúng tôi",content:"Nếu bạn có bất kỳ câu hỏi nào về chính sách này hoặc bất kỳ cập nhật tài liệu pháp lý nào, vui lòng liên hệ chúng tôi qua:",email:"Email: legal@restarter.com"}}},ms:{title:"Dasar Pemberitahuan Kemas Kini",subtitle:"Penjelasan mengenai pemberitahuan kemas kini dokumen undang-undang Restarter™",back:"Kembali",sections:{overview:{title:"1. Gambaran Keseluruhan Dasar",content:"Dasar ini menerangkan bagaimana Restarter memberitahu pengguna tentang kemas kini dokumen undang-undang. Kami komited untuk mengekalkan ketelusan dan memastikan pengguna diberitahu dengan segera tentang perubahan penting yang mungkin menjejaskan hak dan obligasi mereka."},types:{title:"2. Jenis Kemas Kini",content:"Kami mungkin mengemas kini jenis dokumen undang-undang berikut:",items:["Terma Perkhidmatan","Dasar Privasi","Dasar Cookie","Dasar Privasi Kanak-kanak","Penyata Undang-undang Lain"]},methods:{title:"3. Kaedah Pemberitahuan",content:"Kami akan memberitahu pengguna tentang kemas kini penting melalui kaedah berikut:",items:["Pemberitahuan dalam aplikasi","Pemberitahuan e-mel","Pengumuman laman web","Pemberitahuan push (jika berkenaan)"]},timing:{title:"4. Masa Pemberitahuan",content:"Untuk perubahan penting, kami akan memberitahu pengguna sekurang-kurangnya 30 hari sebelum tarikh berkuat kuasa. Untuk kemas kini keselamatan yang mendesak, kami mungkin memberitahu dengan segera."},review:{title:"5. Hak Semakan",content:"Pengguna mempunyai hak untuk menyemak perubahan sebelum ia berkuat kuasa. Jika anda tidak bersetuju dengan kemas kini, anda boleh berhenti menggunakan perkhidmatan kami sebelum tarikh berkuat kuasa."},contact:{title:"6. Hubungi Kami",content:"Jika anda mempunyai sebarang soalan tentang dasar ini atau sebarang kemas kini dokumen undang-undang, sila hubungi kami melalui:",email:"E-mel: legal@restarter.com"}}},la:{title:"Politica Notificationis Renovationis",subtitle:"Explicatio de notificationibus renovationis documentorum iuridicorum Restarter™",back:"Redire",sections:{overview:{title:"1. Conspectus Politicae",content:"Haec politica explicat quomodo Restarter notificat usuarios de renovationibus documentorum iuridicorum. Nos promittimus transparenciam conservare et usuarios prompte notificatos esse de mutationibus importantibus quae possunt afficere iura et obligationes eorum."},types:{title:"2. Typi Renovationis",content:"Nos possumus renovare sequentes typos documentorum iuridicorum:",items:["Termini Servitii","Politica Privatae","Politica Cookie","Politica Privatae Puerorum","Aliae Declarationes Iuridicae"]},methods:{title:"3. Methodi Notificationis",content:"Nos notificabimus usuarios de renovationibus importantibus per sequentes methodos:",items:["Notificationes in app","Notificationes epistulae","Annunciationes situs","Notificationes push (ubi applicabilia)"]},timing:{title:"4. Tempus Notificationis",content:"Pro mutationibus significantibus, nos notificabimus usuarios saltem 30 dies ante diem effectivum. Pro renovationibus securitatis urgentibus, nos possumus statim notificare."},review:{title:"5. Iura Revisionis",content:"Usuarii habent ius revisionis mutationum antequam effectivae fiant. Si non consentis renovationibus, potes desistere uti servitiis nostris ante diem effectivum."},contact:{title:"6. Contacta Nos",content:"Si quaestiones habes de hac politica vel quavis renovatione documentorum iuridicorum, quaeso nos contacta per:",email:"Epistula: legal@restarter.com"}}}},pB=()=>{const e=le(),{lang:t}=mw(),n=hB[t]||hB["zh-TW"];return f.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[f.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[f.jsx("button",{onClick:()=>e("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:n.back}),f.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:n.title}),f.jsx("div",{style:{width:80}})]}),f.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:n.subtitle}),f.jsx("div",{style:{lineHeight:1.6},children:Object.entries(n.sections).map(([e,t])=>f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:t.title}),f.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:t.content}),t.items&&f.jsx("ul",{style:{color:"#333",fontSize:16,paddingLeft:20,marginTop:8},children:t.items.map((e,t)=>f.jsx("li",{style:{marginBottom:4},children:e},t))}),t.email&&f.jsx("p",{style:{color:"#6B5BFF",fontSize:16,fontWeight:600,marginTop:8},children:t.email}),t.phone&&f.jsx("p",{style:{color:"#6B5BFF",fontSize:16,fontWeight:600,marginTop:4},children:t.phone})]},e))})]}),f.jsx(vI,{})]})},mB=[{name:"免費版",price:"NT$0",period:"永久免費",features:["❌ 無語音功能權限","❌ 無權限使用OpenAI API功能","❌ 無法與其他使用者互動","✅ 基礎功能使用15次/月","💰 成本限制: NT$0/月"],highlight:!1,buttonText:"立即註冊",buttonAction:"register"},{name:"基礎版",price:"NT$149",period:"/月 或 NT$1490/年",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],highlight:!0,buttonText:"選擇基礎版",buttonAction:"basic"},{name:"進階版",price:"NT$249",period:"/月 或 NT$2490/年",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇進階版",buttonAction:"advanced"},{name:"專業版",price:"NT$349",period:"/月 或 NT$3490/年",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇專業版",buttonAction:"professional"},{name:"無限版",price:"NT$499",period:"/月 或 NT$4990/年",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],highlight:!1,buttonText:"選擇無限版",buttonAction:"unlimited"}],gB=["選擇適合您的訂閱方案","完成付款（支援信用卡/Apple Pay/Google Pay）","付款成功後自動升級，立即享有所有訂閱權益"],fB=[{q:"升級後可以隨時取消嗎？",a:"可以，訂閱會員可隨時取消，權益將保留至本期結束。"},{q:"付款方式有哪些？",a:"支援信用卡、Apple Pay、Google Pay 等多種方式。"},{q:"各版本的AI功能限制是什麼？",a:"Token 用完僅暫停語音功能，文字功能可繼續使用至各自限制。各功能獨立檢查使用次數。"},{q:"Token 用完可以續購嗎？",a:"可以！Token 用完但未滿一個月時，可以續購並從今天重新計算使用期，更划算。"},{q:"無限版真的無限制嗎？",a:"無限版除了AI Token上限外，其他功能都無限制使用。"},{q:"可以中途升級或降級嗎？",a:"可以，升級立即生效，降級將在當前週期結束後生效。"}];function xB(){const t=le(),n=Fv().currentUser;localStorage.getItem("lang");const[i,r]=e.useState(!1),[a,o]=e.useState(null);return f.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[f.jsx("button",{onClick:()=>t("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),f.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[f.jsx("h1",{style:{fontSize:36,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"Restarter 訂閱方案"}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:24,marginBottom:32},children:mB.map((e,i)=>f.jsxs("div",{style:{background:e.highlight?"linear-gradient(135deg, #f3f7ff 0%, #e8f4ff 100%)":"#fff",border:e.highlight?"2px solid #6B5BFF":"1px solid #e0e0e0",borderRadius:16,padding:24,position:"relative",boxShadow:e.highlight?"0 8px 32px #6B5BFF22":"0 4px 16px #0001",transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>(e=>{n?(o(e),t(`/payment?plan=${e.buttonAction}`)):r(!0)})(e),children:[e.highlight&&f.jsx("div",{style:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)",background:"#6B5BFF",color:"#fff",padding:"4px 16px",borderRadius:12,fontSize:14,fontWeight:700},children:"推薦方案"}),f.jsx("h3",{style:{fontSize:24,fontWeight:800,color:e.highlight?"#6B5BFF":"#333",marginBottom:8,textAlign:"center"},children:e.name}),f.jsxs("div",{style:{textAlign:"center",marginBottom:20},children:[f.jsx("span",{style:{fontSize:32,fontWeight:900,color:e.highlight?"#6B5BFF":"#333"},children:e.price}),f.jsx("span",{style:{fontSize:16,color:"#666"},children:e.period})]}),f.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:e.features.map((e,t)=>f.jsx("li",{style:{marginBottom:12,fontSize:14,lineHeight:1.5,color:"#555",display:"flex",alignItems:"flex-start",gap:8},children:f.jsx("span",{style:{fontSize:16,marginTop:1},children:e})},t))}),f.jsx("button",{style:{width:"100%",background:e.highlight?"linear-gradient(90deg, #6B5BFF, #00CFFF)":"#f0f0f0",color:e.highlight?"#fff":"#666",border:"none",borderRadius:8,padding:"12px 0",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:20,transition:"all 0.2s ease"},children:e.buttonText})]},e.name))}),f.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"升級流程"}),f.jsx("ol",{style:{fontSize:18,lineHeight:1.8,marginBottom:32,paddingLeft:24},children:gB.map((e,t)=>f.jsx("li",{children:e},t))}),f.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"常見問題"}),f.jsx("div",{style:{marginBottom:32},children:fB.map((e,t)=>f.jsxs("div",{style:{marginBottom:18},children:[f.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF"},children:e.q}),f.jsx("div",{style:{fontSize:17,color:"#444",marginLeft:8,marginTop:2},children:e.a})]},t))}),f.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:32},children:f.jsx("button",{onClick:()=>t("/register"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:20,padding:"14px 38px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer",transition:"0.2s",position:"relative",zIndex:1e3,minHeight:"48px",minWidth:"200px",touchAction:"manipulation"},children:"立即註冊免費版"})}),i&&f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,boxShadow:"0 8px 32px rgba(0,0,0,0.2)",minWidth:380,textAlign:"center"},children:[f.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),f.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#6B5BFF",marginBottom:12},children:"歡迎加入 Restarter！"}),f.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.5},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[f.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),f.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",f.jsx("br",{}),"• 個人化使用記錄",f.jsx("br",{}),"• 安全可靠的服務"]})]}),f.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[f.jsx("button",{onClick:()=>{r(!1),t("/register")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),f.jsx("button",{onClick:()=>r(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,fontSize:16,cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9ff",e.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})]})]})}const yB={basic:{name:"基礎版",price:"NT$149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月"],buttonAction:"basic"},advanced:{name:"進階版",price:"NT$249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月"],buttonAction:"advanced"},professional:{name:"專業版",price:"NT$349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月"],buttonAction:"professional"},unlimited:{name:"無限版",price:"NT$499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制"],buttonAction:"unlimited"}};function bB(){const t=le(),[n]=Re(),i=Fv().currentUser,[r,a]=e.useState(null),[o,s]=e.useState("credit"),[l,c]=e.useState(!1),[d,u]=e.useState(!1);e.useEffect(()=>{const e=n.get("plan");e&&yB[e]?a(yB[e]):t("/plans")},[n,t]);return r?f.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[f.jsx("button",{onClick:()=>t("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),f.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[f.jsx("h1",{style:{fontSize:32,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"完成訂閱"}),f.jsxs("div",{style:{background:"#f8f9ff",borderRadius:12,padding:24,marginBottom:32},children:[f.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"選擇的方案"}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[f.jsx("span",{style:{fontSize:18,fontWeight:600},children:r.name}),f.jsxs("span",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF"},children:[r.price,r.period]})]}),f.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:r.features.map((e,t)=>f.jsxs("li",{style:{marginBottom:8,fontSize:14,color:"#666"},children:["• ",e]},t))})]}),f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"付款方式"}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[f.jsx("input",{type:"radio",name:"payment",value:"credit",checked:"credit"===o,onChange:e=>s(e.target.value),style:{width:18,height:18}}),f.jsx("span",{style:{fontSize:16},children:"💳 信用卡"})]}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[f.jsx("input",{type:"radio",name:"payment",value:"apple",checked:"apple"===o,onChange:e=>s(e.target.value),style:{width:18,height:18}}),f.jsx("span",{style:{fontSize:16},children:"🍎 Apple Pay"})]}),f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[f.jsx("input",{type:"radio",name:"payment",value:"google",checked:"google"===o,onChange:e=>s(e.target.value),style:{width:18,height:18}}),f.jsx("span",{style:{fontSize:16},children:"🤖 Google Pay"})]})]})]}),f.jsx("button",{onClick:async()=>{if(i){c(!0);try{const e=await fetch("/api/subscription/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i.uid,plan:r.buttonAction,paymentMethod:o,transactionId:`txn_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:parseInt(r.price.replace("NT$","")),currency:"TWD"})}),n=await e.json();if(!n.success)throw new Error(n.error||"支付失敗");c(!1),u(!0),setTimeout(()=>{t("/")},3e3)}catch(e){c(!1),alert("支付失敗，請重試")}}else t("/login")},disabled:l,style:{width:"100%",background:l?"#ccc":"linear-gradient(90deg,#6B5BFF,#00CFFF)",color:"#fff",border:"none",borderRadius:12,padding:"16px 0",fontSize:18,fontWeight:700,cursor:l?"not-allowed":"pointer",transition:"all 0.2s ease"},children:l?"處理中...":`立即付款 ${r.price}`}),d&&f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[f.jsx("div",{style:{fontSize:48,marginBottom:16},children:"✅"}),f.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"付款成功！"}),f.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:16},children:"您的訂閱已生效，即將跳轉到首頁..."})]})})]})]}):f.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:f.jsx("div",{children:"載入中..."})})}const vB={basic:{name:"基礎版",price:"NT$ 149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_basic_monthly_link",paypalLink:"https://www.paypal.com/your_basic_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_basic_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_basic_monthly_link"},advanced:{name:"進階版",price:"NT$ 249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_advanced_monthly_link",paypalLink:"https://www.paypal.com/your_advanced_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_advanced_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_advanced_monthly_link"},professional:{name:"專業版",price:"NT$ 349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_professional_monthly_link",paypalLink:"https://www.paypal.com/your_professional_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_professional_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_professional_monthly_link"},unlimited:{name:"無限版",price:"NT$ 499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],stripeLink:"https://buy.stripe.com/your_unlimited_monthly_link",paypalLink:"https://www.paypal.com/your_unlimited_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_unlimited_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_unlimited_monthly_link"}};function kB(){const t=le(),n=Fv().currentUser,[i,r]=e.useState(!1),[a,o]=e.useState("basic"),[s,l]=e.useState("stripe"),[c,d]=e.useState(!1),[u,h]=e.useState(null);localStorage.getItem("lang");const p=async()=>{if(n)try{const e=`TXN_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i=await fetch("/api/subscription/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n.uid,plan:a,paymentMethod:s,transactionId:e,amount:m(a),currency:"TWD"})});if(i.ok){const e=await i.json();h(e),d(!0),setTimeout(()=>{t("/home")},3e3)}else alert("付款處理失敗，請聯絡客服")}catch(e){alert("付款處理失敗，請聯絡客服")}},m=e=>({basic:149,advanced:249,professional:349,unlimited:499}[e]||0);return f.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0,overflowY:"auto"},children:[f.jsx("button",{onClick:()=>t("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),f.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[f.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"升級訂閱"}),f.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"選擇最適合您的訂閱方案，立即享有完整功能"}),f.jsx("div",{style:{display:"flex",gap:24,marginBottom:32,justifyContent:"center"},children:Object.entries(vB).map(([e,t])=>f.jsxs("div",{onClick:()=>o(e),style:{background:a===e?"#6B5BFF":"#fff",color:a===e?"#fff":"#333",border:"2px solid "+(a===e?"#6B5BFF":"#ddd"),borderRadius:12,padding:"24px",cursor:"pointer",minWidth:200,textAlign:"center",transition:"all 0.3s ease"},children:[f.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:8},children:t.name}),f.jsxs("div",{style:{fontSize:32,fontWeight:900,marginBottom:4},children:[t.price,f.jsx("span",{style:{fontSize:16,fontWeight:400},children:t.period})]}),t.originalPrice&&f.jsx("div",{style:{fontSize:14,textDecoration:"line-through",opacity:.7,marginBottom:4},children:t.originalPrice}),t.discount&&f.jsx("div",{style:{fontSize:14,color:"#ff6b6b",fontWeight:700},children:t.discount})]},e))}),f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"選擇付款方式"}),f.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[{key:"stripe",name:"Stripe",icon:"💳"},{key:"paypal",name:"PayPal",icon:"🔵"},{key:"ecpay",name:"綠界",icon:"🟢"},{key:"newebpay",name:"藍新",icon:"🔵"}].map(e=>f.jsxs("button",{onClick:()=>l(e.key),style:{background:s===e.key?"#6B5BFF":"#fff",color:s===e.key?"#fff":"#333",border:"2px solid "+(s===e.key?"#6B5BFF":"#ddd"),borderRadius:8,padding:"12px 20px",cursor:"pointer",fontSize:16,fontWeight:600,transition:"all 0.3s ease"},children:[e.icon," ",e.name]},e.key))})]}),f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"訂閱權益"}),f.jsx("div",{style:{display:"grid",gap:12},children:vB[a].features.map((e,t)=>f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[f.jsx("span",{style:{color:"#6B5BFF",fontSize:18},children:"✓"}),f.jsx("span",{style:{color:"#333",fontSize:16},children:e})]},t))})]}),f.jsx("div",{style:{textAlign:"center",marginTop:24},children:f.jsx("button",{onClick:()=>{if(!n)return void r(!0);const e=vB[a],t=e[`${s}Link`];t&&!t.includes("your_")?p():alert(`請聯絡客服完成付款設定\n\n選擇方案：${e.name}\n付款方式：${"stripe"===s?"Stripe":"paypal"===s?"PayPal":"ecpay"===s?"綠界":"藍新"}\n\n客服 Email：support@restarter.com`)},style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"立即升級"})}),f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginTop:32},children:[f.jsx("button",{onClick:()=>t("/payment-info"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"付款說明"}),f.jsx("button",{onClick:()=>t("/contact"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"聯絡客服"})]})]})}),i&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:f.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:450,textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.2)"},children:[f.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),f.jsx("h3",{style:{color:"#6B5BFF",fontWeight:700,fontSize:22,marginBottom:12},children:"歡迎加入 Restarter！"}),f.jsx("p",{style:{color:"#666",marginBottom:20,lineHeight:1.5,fontSize:16},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[f.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),f.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",f.jsx("br",{}),"• 個人化使用記錄",f.jsx("br",{}),"• 安全可靠的服務"]})]}),f.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[f.jsx("button",{onClick:()=>t("/register"),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,cursor:"pointer",fontSize:16,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),f.jsx("button",{onClick:()=>r(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,cursor:"pointer",fontSize:16,transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.background="#6B5BFF",e.currentTarget.style.color="#fff"},onMouseLeave:e=>{e.currentTarget.style.background="#f8f9ff",e.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})}),c&&u&&f.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:f.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[f.jsx("div",{style:{fontSize:64,marginBottom:16,color:"#52c41a"},children:"✅"}),f.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"付款成功！"}),f.jsx("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:u.message}),f.jsxs("div",{style:{background:"linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #b7eb8f"},children:[f.jsx("div",{style:{fontSize:14,color:"#52c41a",fontWeight:600,marginBottom:8},children:"🎉 訂閱詳情"}),f.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 方案：",(g=a,{basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"}[g]||g),f.jsx("br",{}),"• 剩餘天數：",u.remainingDays," 天",f.jsx("br",{}),"• AI Token：",u.plan.limits.aiCostLimit,"K tokens",f.jsx("br",{}),"• 立即生效，可開始使用所有 AI 功能"]})]}),f.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:f.jsx("button",{onClick:()=>t("/home"),style:{background:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #52c41a33",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px #52c41a44"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 12px #52c41a33"},children:"🚀 立即開始使用"})}),f.jsx("div",{style:{marginTop:16,fontSize:14,color:"#888"},children:"3秒後自動跳轉到首頁..."})]})})]});var g}function wB(){const e=le(),t=Fv().currentUser;return localStorage.getItem("lang"),t?f.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[f.jsx("button",{onClick:()=>e("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回首頁"}),f.jsxs("div",{style:{maxWidth:500,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64,textAlign:"center"},children:[f.jsx("img",{src:t.photoURL||"/avatars/Derxl.png",alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff",background:"#eee",marginBottom:18}}),f.jsx("div",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:t.displayName||t.email||"用戶"}),f.jsx("div",{style:{fontSize:16,color:"#888",marginBottom:18},children:t.email}),f.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:18,marginTop:24},children:[f.jsx("button",{onClick:()=>e("/CompleteProfile"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer"},children:"編輯個人資料"}),f.jsx("button",{onClick:()=>e("/upgrade"),style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",border:"none",cursor:"pointer"},children:"升級訂閱"})]})]})]}):f.jsx("div",{style:{minHeight:"100vh",background:"#f7faff",display:"flex",alignItems:"center",justifyContent:"center"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[f.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:18},children:"請先註冊/登入才能進入個人中心"}),f.jsx("button",{onClick:()=>e("/register"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 32px",fontWeight:700,fontSize:18,cursor:"pointer",marginTop:8},children:"前往註冊/登入"})]})})}function jB(){const e=le();return f.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[f.jsx("button",{onClick:()=>e("/upgrade"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),f.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:f.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[f.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"付款設定說明"}),f.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"了解如何設定付款方式與完成訂閱"}),f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"支援的付款方式"}),f.jsxs("div",{style:{display:"grid",gap:16},children:[f.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[f.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"💳 Stripe"}),f.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際信用卡支付，支援 Visa、Mastercard、American Express 等主要信用卡。"})]}),f.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[f.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 PayPal"}),f.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際電子錢包，支援 PayPal 帳戶或信用卡付款。"})]}),f.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[f.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🟢 綠界"}),f.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]}),f.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[f.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 藍新"}),f.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]})]})]}),f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"付款設定步驟"}),f.jsxs("ol",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[f.jsx("li",{children:"選擇您想要的訂閱方案（月費或年費）"}),f.jsx("li",{children:"選擇付款方式（Stripe、PayPal、綠界、藍新）"}),f.jsx("li",{children:"點擊「立即升級」按鈕"}),f.jsx("li",{children:"系統會導向對應的付款頁面"}),f.jsx("li",{children:"完成付款後自動升級會員權益"})]})]}),f.jsxs("div",{style:{marginBottom:32},children:[f.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"注意事項"}),f.jsxs("ul",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[f.jsx("li",{children:"付款成功後，會員權益會立即生效"}),f.jsx("li",{children:"月費方案每月自動續費，年費方案每年自動續費"}),f.jsx("li",{children:"可隨時在會員中心取消自動續費"}),f.jsx("li",{children:"如有付款問題，請聯絡客服：support@restarter.com"})]})]}),f.jsx("div",{style:{textAlign:"center",marginTop:32},children:f.jsx("button",{onClick:()=>e("/upgrade"),style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"返回升級頁面"})})]})})]})}function SB(){const e=le();return f.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[f.jsx("button",{onClick:()=>e("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),f.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64},children:[f.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:24,letterSpacing:1},children:"聯絡客服"}),f.jsx("div",{style:{fontSize:18,color:"#333",marginBottom:24,lineHeight:1.8},children:"如有任何問題、付款疑問、升級需求，歡迎透過以下方式聯絡我們："}),f.jsxs("ul",{style:{fontSize:17,color:"#666",marginBottom:32,marginLeft:24},children:[f.jsxs("li",{children:["Email：",f.jsx("span",{href:"mailto:support@restarter.app",style:{color:"#6B5BFF",textDecoration:"underline"},children:"support@restarter.app"})]}),f.jsxs("li",{children:["LINE 客服：",f.jsx("span",{href:"https://line.me/R/ti/p/@restarter",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"@restarter"})]}),f.jsxs("li",{children:["Messenger：",f.jsx("span",{href:"https://m.me/restarterapp",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"Restarter 粉專"})]}),f.jsxs("li",{children:["線上表單：",f.jsx("span",{href:"https://forms.gle/xxxxxx",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"填寫表單"})]})]}),f.jsx("div",{style:{fontSize:16,color:"#888",marginTop:24},children:"客服回覆時間：週一至週五 10:00-18:00"})]})]})}const TB=i.createContext({isTestMode:!1,setIsTestMode:()=>{}}),CB=()=>i.useContext(TB);function IB(){const{isMicOn:t}=(()=>{const t=e.useContext(aI);if(void 0===t)throw new Error("useMicStatus must be used within a MicStatusProvider");return t})();return t?f.jsx("div",{style:{position:"fixed",top:"12px",left:"50%",transform:"translateX(-50%)",zIndex:9999,background:"#ff6347",borderRadius:"50%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.35)",border:"2px solid white"},children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"white",children:f.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"})})}):null}function BB(){const[t,n]=e.useState(null),[i,r]=e.useState(!0),[a,o]=e.useState(!1),s=Fv(lw);return e.useEffect(()=>{const e=yb(s,e=>{n(e),r(!1)});return()=>e()},[s]),i?f.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"2rem"},children:"Loading..."}):f.jsx(gw,{children:f.jsx(oI,{children:f.jsx(lI,{children:f.jsx(sC,{children:f.jsx(Se,{children:f.jsxs(TB.Provider,{value:{isTestMode:a,setIsTestMode:o},children:[f.jsx(ZT,{onTestModeChange:o}),f.jsx(IB,{}),f.jsx(rI,{children:f.jsxs(ve,{children:[f.jsx(ye,{path:"/splash",element:f.jsx(Ae,{})}),f.jsx(ye,{path:"/terms",element:f.jsx(bC,{})}),f.jsx(ye,{path:"/",element:f.jsx(Bw,{})}),f.jsx(ye,{path:"/home",element:f.jsx(Bw,{})}),f.jsx(ye,{path:"/register",element:f.jsx(PT,{})}),f.jsx(ye,{path:"/confirm-registration",element:f.jsx(ZI,{})}),t&&f.jsx(ye,{path:"/wall",element:f.jsx(Nw,{})}),t&&f.jsx(ye,{path:"/echo-box",element:f.jsx(Ww,{})}),t&&f.jsx(ye,{path:"/my-story",element:f.jsx(qw,{})}),t&&f.jsx(ye,{path:"/chat",element:f.jsx(yT,{})}),t&&f.jsx(ye,{path:"/friend",element:f.jsx(KT,{})}),t&&f.jsx(ye,{path:"/inbox",element:f.jsx($T,{})}),t&&f.jsx(ye,{path:"/ai",element:f.jsx(QT,{})}),t&&f.jsx(ye,{path:"/tts",element:f.jsx(XT,{})}),t&&f.jsx(ye,{path:"/journal",element:f.jsx(dI,{})}),t&&f.jsx(ye,{path:"/missions",element:f.jsx(iC,{})}),t&&f.jsx(ye,{path:"/restart-missions",element:f.jsx(iC,{})}),t&&f.jsx(ye,{path:"/pairtalk",element:f.jsx(mC,{})}),t&&f.jsx(ye,{path:"/skillbox",element:f.jsx(fC,{})}),t&&f.jsx(ye,{path:"/skillbox/:scenarioId",element:f.jsx(jC,{})}),t&&f.jsx(ye,{path:"/practice",element:f.jsx(jC,{})}),t&&f.jsx(ye,{path:"/realistic-tts",element:f.jsx(XT,{})}),t&&f.jsx(ye,{path:"/storywall",element:f.jsx(eI,{})}),t&&f.jsx(ye,{path:"/chatroom",element:f.jsx(pI,{})}),t&&f.jsx(ye,{path:"/invites",element:f.jsx(UT,{})}),t&&f.jsx(ye,{path:"/mylinks",element:f.jsx(OT,{})}),f.jsx(ye,{path:"/about",element:f.jsx(fI,{})}),f.jsx(ye,{path:"/feedback",element:f.jsx(jI,{})}),f.jsx(ye,{path:"/admin/feedback",element:f.jsx(SI,{})}),f.jsx(ye,{path:"/CompleteProfile",element:f.jsx(CI,{})}),f.jsx(ye,{path:"/privacy-policy",element:f.jsx(RI,{})}),f.jsx(ye,{path:"/data-deletion",element:f.jsx(zI,{})}),f.jsx(ye,{path:"/HelpLab",element:f.jsx(WI,{})}),f.jsx(ye,{path:"/emotion-release",element:f.jsx(qI,{})}),t&&f.jsx(ye,{path:"/social-integration",element:f.jsx(YI,{})}),f.jsx(ye,{path:"/ai-statement",element:f.jsx(tB,{})}),f.jsx(ye,{path:"/mental-health-disclaimer",element:f.jsx(iB,{})}),f.jsx(ye,{path:"/cookie-policy",element:f.jsx(aB,{})}),f.jsx(ye,{path:"/children-privacy",element:f.jsx(sB,{})}),f.jsx(ye,{path:"/international-users",element:f.jsx(cB,{})}),f.jsx(ye,{path:"/security-statement",element:f.jsx(uB,{})}),f.jsx(ye,{path:"/update-notification",element:f.jsx(pB,{})}),f.jsx(ye,{path:"/plans",element:f.jsx(xB,{})}),f.jsx(ye,{path:"/payment",element:f.jsx(bB,{})}),f.jsx(ye,{path:"/upgrade",element:f.jsx(kB,{})}),f.jsx(ye,{path:"/profile",element:f.jsx(wB,{})}),f.jsx(ye,{path:"/payment-info",element:f.jsx(jB,{})}),f.jsx(ye,{path:"/contact",element:f.jsx(SB,{})}),!1]})})]})})})})})})}p(document.getElementById("root")).render(f.jsx(BB,{}));
